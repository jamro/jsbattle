{"version":3,"sources":["webpack://jsbattle-engine/../lib/ajv.ts","webpack://jsbattle-engine/../lib/compile/codegen/code.ts","webpack://jsbattle-engine/../lib/compile/codegen/index.ts","webpack://jsbattle-engine/../lib/compile/codegen/scope.ts","webpack://jsbattle-engine/../lib/compile/context.ts","webpack://jsbattle-engine/../lib/compile/error_classes.ts","webpack://jsbattle-engine/../lib/compile/errors.ts","webpack://jsbattle-engine/../lib/compile/index.ts","webpack://jsbattle-engine/../lib/compile/names.ts","webpack://jsbattle-engine/../lib/compile/resolve.ts","webpack://jsbattle-engine/../lib/compile/rules.ts","webpack://jsbattle-engine/../lib/compile/subschema.ts","webpack://jsbattle-engine/../lib/compile/ucs2length.ts","webpack://jsbattle-engine/../lib/compile/util.ts","webpack://jsbattle-engine/../lib/compile/validate/applicability.ts","webpack://jsbattle-engine/../lib/compile/validate/boolSchema.ts","webpack://jsbattle-engine/../lib/compile/validate/dataType.ts","webpack://jsbattle-engine/../lib/compile/validate/defaults.ts","webpack://jsbattle-engine/../lib/compile/validate/index.ts","webpack://jsbattle-engine/../lib/compile/validate/iterate.ts","webpack://jsbattle-engine/../lib/compile/validate/keyword.ts","webpack://jsbattle-engine/../lib/core.ts","webpack://jsbattle-engine/../lib/vocabularies/applicator/additionalItems.ts","webpack://jsbattle-engine/../lib/vocabularies/applicator/additionalProperties.ts","webpack://jsbattle-engine/../lib/vocabularies/applicator/allOf.ts","webpack://jsbattle-engine/../lib/vocabularies/applicator/anyOf.ts","webpack://jsbattle-engine/../lib/vocabularies/applicator/contains.ts","webpack://jsbattle-engine/../lib/vocabularies/applicator/dependencies.ts","webpack://jsbattle-engine/../lib/vocabularies/applicator/if.ts","webpack://jsbattle-engine/../lib/vocabularies/applicator/index.ts","webpack://jsbattle-engine/../lib/vocabularies/applicator/items.ts","webpack://jsbattle-engine/../lib/vocabularies/applicator/not.ts","webpack://jsbattle-engine/../lib/vocabularies/applicator/oneOf.ts","webpack://jsbattle-engine/../lib/vocabularies/applicator/patternProperties.ts","webpack://jsbattle-engine/../lib/vocabularies/applicator/properties.ts","webpack://jsbattle-engine/../lib/vocabularies/applicator/propertyNames.ts","webpack://jsbattle-engine/../lib/vocabularies/applicator/thenElse.ts","webpack://jsbattle-engine/../lib/vocabularies/code.ts","webpack://jsbattle-engine/../lib/vocabularies/core/id.ts","webpack://jsbattle-engine/../lib/vocabularies/core/index.ts","webpack://jsbattle-engine/../lib/vocabularies/core/ref.ts","webpack://jsbattle-engine/../lib/vocabularies/draft7.ts","webpack://jsbattle-engine/../lib/vocabularies/format/format.ts","webpack://jsbattle-engine/../lib/vocabularies/format/index.ts","webpack://jsbattle-engine/../lib/vocabularies/metadata.ts","webpack://jsbattle-engine/../lib/vocabularies/validation/const.ts","webpack://jsbattle-engine/../lib/vocabularies/validation/enum.ts","webpack://jsbattle-engine/../lib/vocabularies/validation/index.ts","webpack://jsbattle-engine/../lib/vocabularies/validation/limitItems.ts","webpack://jsbattle-engine/../lib/vocabularies/validation/limitLength.ts","webpack://jsbattle-engine/../lib/vocabularies/validation/limitNumber.ts","webpack://jsbattle-engine/../lib/vocabularies/validation/limitProperties.ts","webpack://jsbattle-engine/../lib/vocabularies/validation/multipleOf.ts","webpack://jsbattle-engine/../lib/vocabularies/validation/pattern.ts","webpack://jsbattle-engine/../lib/vocabularies/validation/required.ts","webpack://jsbattle-engine/../lib/vocabularies/validation/uniqueItems.ts","webpack://jsbattle-engine/./node_modules/fast-deep-equal/index.js","webpack://jsbattle-engine/./node_modules/json-schema-traverse/index.js","webpack://jsbattle-engine/./node_modules/sat/SAT.js","webpack://jsbattle-engine/./node_modules/seedrandom/index.js","webpack://jsbattle-engine/./node_modules/seedrandom/lib/alea.js","webpack://jsbattle-engine/./node_modules/seedrandom/lib/tychei.js","webpack://jsbattle-engine/./node_modules/seedrandom/lib/xor128.js","webpack://jsbattle-engine/./node_modules/seedrandom/lib/xor4096.js","webpack://jsbattle-engine/./node_modules/seedrandom/lib/xorshift7.js","webpack://jsbattle-engine/./node_modules/seedrandom/lib/xorwow.js","webpack://jsbattle-engine/./node_modules/seedrandom/seedrandom.js","webpack://jsbattle-engine/../src/util.ts","webpack://jsbattle-engine/../src/regexps-uri.ts","webpack://jsbattle-engine/../src/regexps-iri.ts","webpack://jsbattle-engine/../node_modules/punycode/punycode.es6.js","webpack://jsbattle-engine/../src/uri.ts","webpack://jsbattle-engine/../src/schemes/http.ts","webpack://jsbattle-engine/../src/schemes/https.ts","webpack://jsbattle-engine/../src/schemes/ws.ts","webpack://jsbattle-engine/../src/schemes/wss.ts","webpack://jsbattle-engine/../src/schemes/mailto.ts","webpack://jsbattle-engine/../src/schemes/urn.ts","webpack://jsbattle-engine/../src/schemes/urn-uuid.ts","webpack://jsbattle-engine/../src/index.ts","webpack://jsbattle-engine/./src/engine/EvalWorker.js","webpack://jsbattle-engine/./src/tanks/lib/extendedMath.js","webpack://jsbattle-engine/webpack/bootstrap","webpack://jsbattle-engine/webpack/runtime/amd define","webpack://jsbattle-engine/webpack/runtime/amd options","webpack://jsbattle-engine/webpack/runtime/compat get default export","webpack://jsbattle-engine/webpack/runtime/define property getters","webpack://jsbattle-engine/webpack/runtime/hasOwnProperty shorthand","webpack://jsbattle-engine/webpack/runtime/node module decorator","webpack://jsbattle-engine/./src/engine/Tank.js","webpack://jsbattle-engine/./src/engine/Team.js","webpack://jsbattle-engine/./src/engine/Bullet.js","webpack://jsbattle-engine/./src/engine/Battlefield.js","webpack://jsbattle-engine/./src/engine/EventStore.js","webpack://jsbattle-engine/./src/engine/CollisionResolver.js","webpack://jsbattle-engine/./src/engine/AiWrapper.js","webpack://jsbattle-engine/./src/engine/PerformanceMonitor.js","webpack://jsbattle-engine/./src/engine/AiDefinition.js","webpack://jsbattle-engine/./src/engine/UltimateBattleDescriptor.js","webpack://jsbattle-engine/./src/engine/finishCondition.js","webpack://jsbattle-engine/./src/engine/Simulation.js","webpack://jsbattle-engine/./src/engine/renderers/Renderer.js","webpack://jsbattle-engine/external \"PIXI\"","webpack://jsbattle-engine/./src/engine/renderers/abstract/AbstractView.js","webpack://jsbattle-engine/./src/engine/renderers/abstract/AbstractRenderer.js","webpack://jsbattle-engine/./src/engine/renderers/abstractPixi/AbstractPixiView.js","webpack://jsbattle-engine/./src/engine/renderers/abstractPixi/AbstractPixiTankView.js","webpack://jsbattle-engine/./src/engine/renderers/abstractPixi/PixiRendererClockModel.js","webpack://jsbattle-engine/./src/engine/renderers/abstractPixi/AbstractPixiRenderer.js","webpack://jsbattle-engine/./src/engine/renderers/debug/DebugBattlefieldView.js","webpack://jsbattle-engine/./src/engine/renderers/debug/DebugClockView.js","webpack://jsbattle-engine/./src/engine/renderers/abstractPixi/AbstractPixiBulletView.js","webpack://jsbattle-engine/./src/engine/renderers/debug/DebugBulletView.js","webpack://jsbattle-engine/./src/engine/renderers/debug/DebugTankView.js","webpack://jsbattle-engine/./src/engine/renderers/debug/DebugRenderer.js","webpack://jsbattle-engine/./src/engine/renderers/bw/BWBattlefieldView.js","webpack://jsbattle-engine/./src/engine/renderers/bw/BWClockView.js","webpack://jsbattle-engine/./src/engine/renderers/bw/BWBulletView.js","webpack://jsbattle-engine/./src/engine/renderers/bw/BWTankView.js","webpack://jsbattle-engine/./src/engine/renderers/bw/BWRenderer.js","webpack://jsbattle-engine/./src/engine/renderers/brody/BrodyBattlefieldView.js","webpack://jsbattle-engine/./src/engine/renderers/brody/BrodyClockView.js","webpack://jsbattle-engine/./src/engine/renderers/brody/BrodyBulletView.js","webpack://jsbattle-engine/./src/engine/renderers/brody/BrodyTankView.js","webpack://jsbattle-engine/./src/engine/renderers/brody/BrodySettings.js","webpack://jsbattle-engine/./src/engine/renderers/brody/BrodyRenderer.js","webpack://jsbattle-engine/./src/engine/renderers/void/VoidRenderer.js","webpack://jsbattle-engine/./src/engine/lib.js","webpack://jsbattle-engine/./src/engine/entry.js"],"names":["code","i","e","this","name","Scope","exports","gen","valid","codegen_1","schema","Name","default","countKeys","add","isJSONType","rules","shouldUseRule","boolError","message","$async","types","_","dataType","COERCIBLE","checkDataTypes","it","o","cxt","applicator","validate_1","checkStrictMode","schArr","validatePatternProperties","def","keyword","type","schemaType","additionalProperties_1","core","getValidate","draft7Vocabularies","format","validation","t","module","equal","a","b","constructor","length","keys","Array","isArray","RegExp","source","flags","valueOf","Object","prototype","toString","hasOwnProperty","call","key","traverse","opts","cb","_traverse","pre","post","jsonPtr","rootSchema","parentJsonPtr","parentKeyword","parentSchema","keyIndex","sch","arrayKeywords","propsKeywords","prop","replace","keywords","allKeys","skipKeywords","additionalItems","items","contains","additionalProperties","propertyNames","not","if","then","else","allOf","anyOf","oneOf","$defs","definitions","properties","patternProperties","dependencies","enum","const","required","maximum","minimum","exclusiveMaximum","exclusiveMinimum","multipleOf","maxLength","minLength","pattern","maxItems","minItems","uniqueItems","maxProperties","minProperties","root","factory","define","SAT","Vector","x","y","Circle","pos","r","Polygon","points","setPoints","Box","w","h","Response","clear","copy","other","clone","perp","rotate","angle","Math","cos","sin","reverse","normalize","d","len","sub","scale","project","amt","dot","len2","projectN","reflect","axis","reflectN","sqrt","getAABB","toPolygon","setOffset","offset","calcPoints","edges","normals","p1","p2","push","splice","_recalc","setAngle","translate","calcPoint","xMin","yMin","xMax","yMax","point","getCentroid","cx","cy","ar","Number","MAX_VALUE","T_VECTORS","T_ARRAYS","T_RESPONSE","TEST_POINT","flattenPointsOn","normal","result","min","max","isSeparatingAxis","aPos","bPos","aPoints","bPoints","response","rangeA","pop","rangeB","offsetV","projectedOffset","option1","option2","overlap","absOverlap","abs","voronoiRegion","line","dp","LEFT_VORONOI_REGION","RIGHT_VORONOI_REGION","MIDDLE_VORONOI_REGION","testPolygonCircle","polygon","circle","circlePos","radius","radius2","edge","next","prev","overlapN","region","point2","dist","distAbs","testPolygonPolygon","aLen","bLen","p","c","differenceV","radiusSq","distanceSq","poly","totalRadius","totalRadiusSq","aInB","alea","require","xor128","xorwow","xorshift7","xor4096","tychei","sr","global","Alea","seed","n","me","mash","data","String","charCodeAt","s0","s1","s2","f","impl","xg","state","prng","int32","quick","XorGen","strseed","floor","k","z","v","X","j","limit","init","slice","Date","pool","math","nodecrypto","width","startdenom","pow","significance","overflow","mask","seedrandom","options","callback","shortseed","mixkey","flatten","entropy","tostring","out","randomBytes","Uint8Array","crypto","msCrypto","getRandomValues","browser","navigator","plugins","screen","autoseed","arc4","ARC4","g","S","pass","is_math_call","keylen","s","count","obj","depth","typ","smear","stringseed","fromCharCode","apply","random","ex","self","sets","xl","join","str","undefined","split","shift","ALPHA$$","DIGIT$$","HEXDIG$$","merge","PCT_ENCODED$","subexp","SUB_DELIMS$$","RESERVED$$","isIRI","SCHEME$","USERINFO$","UNRESERVED$$","DEC_OCTET_RELAXED$","H16$","LS32$","IPV6ADDRESS1$","IPV6ADDRESS2$","IPV6ADDRESS3$","IPV6ADDRESS4$","IPV6ADDRESS5$","IPV6ADDRESS6$","IPV6ADDRESS7$","IPV6ADDRESS8$","IPV6ADDRESS9$","ZONEID$","IPV6ADDRESS$","IP_LITERAL$","IPV6ADDRZ_RELAXED$","HOST$","IPV4ADDRESS$","REG_NAME$","PORT$","AUTHORITY$","PCHAR$","SEGMENT$","SEGMENT_NZ$","SEGMENT_NZ_NC$","PATH_ABEMPTY$","PATH_ABSOLUTE$","QUERY$","PATH_NOSCHEME$","PATH_ROOTLESS$","FRAGMENT$","HIER_PART$","URI$","RELATIVE_PART$","RELATIVE$","buildExps","maxInt","base","regexPunycode","regexNonASCII","regexSeparators","errors","stringFromCharCode","RangeError","parts","string","encoded","array","fn","map","digitToBasic","digit","flag","adapt","firstTime","delta","baseMinusTMin","punycode","mapDomain","input","test","output","inputLength","counter","value","extra","ucs2decode","bias","currentValue","basicLength","handledCPCount","m","handledCPCountPlusOne","q","qMinusT","baseMinusT","encode","basic","lastIndexOf","index","oldi","codePoint","fromCodePoint","decode","SCHEMES","chr","newStr","il","parseInt","substr","c2","c3","decodeUnreserved","decStr","pctDecChars","match","protocol","components","scheme","userinfo","host","path","query","fragment","matches","address","_stripLeadingZeros","zone","toLowerCase","last","first","firstFields","lastFields","isLastFieldIPv4Address","IPV4ADDRESS","fieldCount","lastFieldsStart","fields","_normalizeIPv4","longestZeroFields","reduce","field","lastLongest","acc","sort","newHost","newFirst","newLast","URI_PARSE","NO_MATCH_IS_UNDEFINED","iri","IRI_PROTOCOL","reference","uriString","isNaN","indexOf","_normalizeIPv6","port","error","schemeHandler","domainHost","uriTokens","$1","$2","RDS1","RDS2","RDS3","RDS5","im","Error","serialize","IPV6ADDRESS","authority","_recomposeAuthority","charAt","removeDotSegments","skipNormalization","target","parse","relative","URI_PROTOCOL","handler","secure","http","wsComponents","isSecure","resourceName","ws","O","VCHAR$$","UNRESERVED","PCT_ENCODED","NOT_LOCAL_PART","NOT_HFNAME","NOT_HFVALUE","mailtoComponents","to","unknownHeaders","headers","hfields","hfield","toAddrs","unescapeComponent","addr","toAddr","atIdx","localPart","domain","toUpperCase","pctEncChar","URN_PARSE","urnComponents","nid","nss","urnScheme","uriComponents","UUID","uuidComponents","uuid","https","wss","mailto","urn","schemelessOptions","assign","resolveComponents","baseURI","relativeURI","uri","typeOf","uriA","uriB","extendedMath","TankController","_initCallback","_loopCallback","EvalWorker","onmessage","msg","_callStackLimit","_callStackCount","_tankController","inputData","command","settings","info","tank","eval","control","setTimeout","deg","rad","PI","deg2rad","rad2deg","atan2","distance","x1","y1","x2","y2","dx","dy","randomRange","__webpack_module_cache__","__webpack_require__","moduleId","id","loaded","__webpack_modules__","amdD","amdO","getter","__esModule","definition","defineProperty","enumerable","get","nmd","paths","children","normalizeAngle","aiDefinition","_id","_name","_team","_maxEnergy","_energy","_x","_y","_lastX","_lastY","_angle","_gunAngle","_radarAngle","_throttle","_actualThrottle","_speed","_turn","_gunTurn","_radarTurn","_wallHit","_enemyHit","_allyHit","_beingRammed","_radarRange","_radarFocal","_enemySpot","_allySpot","_bulletsSpot","_gunReloadTime","_gunTimer","_shootingPower","_targetingAlarmTimer","_debugData","_score","_state","_hasBoost","_maxBoost","_boost","_wallDistance","_skin","damage","onDamage","speed","round","enemy","ally","bullet","team","xPosition","yPosition","isReloading","getTime","rng","SKIN","collisionResolver","oldX","oldY","maxSpeed","hasBoost","accelerationFactor","rotation","checkTank","updateTank","scanTanks","scanBullets","scanWalls","enemyData","allyData","bulletsData","throttle","energy","boost","collisions","wall","radar","targetingAlarm","wallDistance","bullets","gun","reloading","radio","inbox","getMessages","_members","_inboxMap","_outboxMap","fullName","receiverId","senderId","messages","concat","sum","score","maxEnergy","aliveCount","Bullet","owner","power","_owner","gunAngle","gunLength","_power","_damage","_exploded","Battlefield","height","_width","_height","_startSlotList","_offsetX","_offsetY","margin","slotSize","minX","maxX","minY","maxY","temporaryValue","randomIndex","currentIndex","EventStore","_data","event","CollisionResolver","_wallList","_tankMap","_bulletMap","_radarBeamMap","_battlefield","battlefield","tankShape","_getTankShape","enemyShape","bulletShape","_getBulletShape","onWallHit","energyBefore","onEnemyHit","isAlly","onEnemyHitScore","onEnemyKillScore","hitTest","areAllies","onAllyHit","onBeingRam","radarBeamShape","_getRadarBeamShape","radarAngle","enemies","closestEnemy","closestEnemyDistance","radarRange","closestAlly","closestAllyDistance","onAllySpot","onEnemySpot","onTargetingAlarm","spottedBullets","onBulletSpot","_getWallDistance","onWallSpot","d1","d2","distanceNorth","distanceSouth","distanceWest","distanceEast","shape","exploded","tan","radarFocal","AiWrapper","_tank","_aiWorker","_aiProcessingStart","_aiProcessingCheckInterval","_aiProcessingResolveCallback","_aiProcessingRejectCallback","_slowAiChances","_onActivationCallback","_onDectivationCallback","_aiProcessingTimeLimit","_aiDefinition","_isReady","_controlData","THROTTLE","BOOST","TURN","RADAR_TURN","GUN_TURN","SHOOT","OUTBOX","DEBUG","_onDeactivationCallback","err","lineno","resolve","reject","_createWorker","onerror","console","_formatError","performanceIssues","tankName","tankId","clearInterval","setInterval","executionLimit","commandEvent","_configureTank","bind","_controlTank","dt","warn","teamInfo","size","mates","members","infoData","initData","postMessage","terminate","setThrottle","setBoost","setTurn","setRadarTurn","setGunTurn","setDebugData","shoot","JSON","stringify","sendMessages","useSandbox","Worker","filePath","PerformanceMonitor","_simulationStepDuration","_stepCounter","_checkLoop","_started","_desiredPerfomance","_actualPerfomance","_perfomanceIndex","_desiredQuality","_quality","_checkInterval","_check","ceil","_updateQuality","lowestQuality","decreaseStep","targetQuality","SUSSPEND_AI_SANDBOX_WARNING","uid","_code","_initData","_useSandbox","_executionLimit","AiDefinition","fromJSON","toJSON","teamName","_version","_aiList","_rngSeed","_teamMode","_timeLimit","ai","json","version","rngSeed","teamMode","timeLimit","aiList","unsecureMode","validateJsonData","aiJson","validate","Ajv","compile","UltimateBattleDescriptor","setRngSeed","getRngSeed","setTeamMode","getTeamMode","setTimeLimit","getTimeLimit","aiClone","getAiList","addAiDefinition","simulaiton","teamsLeft","_teamMap","isAlive","renderer","debug","_debug","_allTankList","_tankList","_bulletList","_explodedTankList","_explodedBulletList","_simulationTimeout","_renderInterval","_renderStepDuration","_renderer","_isRunning","_collisionResolver","_rng","_speedMultiplier","_onSimulationStepCallback","_onRenderStepCallback","_onFinishCallback","_onErrorCallback","_onStartCallback","_timeElapsed","_finishCondition","finishCondition","_customFinishCondition","_eventStore","_nextTankId","_nextBulletId","_rendererQuality","_perfMon","setSimulationStepDuration","_teamList","_ultimateBattleDescriptor","log","setSize","randomize","initBatlefield","updateBattlefield","_activateAi","_updateView","clearTimeout","start","_simulationStep","onSimulationStep","startTime","_updateModel","_updateAi","stop","processingTime","startSlot","getStartSlot","hasTeams","_createTank","getRandom","moveTo","Team","addTank","_createAiWrapper","setSpeed","deactivate","done","_runInSequence","objectList","methodName","argument","wrapCallback","args","arguments","args2","doneWrapper","errorWrapper","simulationStep","killCount","removeTank","newAiList","isShooting","handleShoot","_createBullet","onSurviveScore","hitTestBullet","removeBullet","processMessages","quality","qualityLevel","preRender","renderClock","renderTank","renderBullet","renderTankStats","postRender","Tank","events","msElapsed","msLimit","tankList","PIXI","AbstractView","model","_model","_view","_isAlive","AbstractRenderer","offsetX","offsetY","_renderModel","_createTankView","_createBulletView","view","update","Renderer","AbstractPixiView","Container","_create","parent","removeChild","container","AbstractPixiTankView","_hudView","_createHud","body","energyBar","label","text","hudView","_onEvent","_onShoot","_onDestroy","destroy","_body","_createBody","_gun","_createGun","_radar","_createRadar","addChild","_label","_createLabel","_energyBar","_createEnergyBar","_createHudBackground","Sprite","Text","PixiRendererClockModel","_msElapsed","_msLimit","msTotal","ms","AbstractPixiRenderer","_isDisposed","_masterContainer","_tankContainer","_bulletContainer","_hudContainer","_stage","_clockModel","_clockView","_battlefieldView","window","devicePixelRatio","_rendererScale","rendererSettings","_canvas","antialias","backgroundColor","resolution","autoDetectRenderer","_createBattlefieldView","_createClockView","render","canvas","urlPrefix","loader","Loader","loadedResources","res","resources","_getSpritesheetUrls","filter","url","forEach","load","resLoader","utils","onAssetsLoaded","getTankView","getBulletView","rendererName","rendererScale","clock","context","gl","getExtension","loseContext","DebugBattlefieldView","background","Graphics","beginFill","lineStyle","drawRect","endFill","DebugClockView","labelStyle","TextStyle","fontFamily","fontSize","fill","AbstractPixiBulletView","DebugBulletView","drawCircle","DebugTankView","lineTo","anchor","set","statusBarBg","DebugRenderer","_frameCounter","_fpsLabel","_scoreBoard","stage","alpha","scores","toFixed","BWBattlefieldView","BWClockView","BWBulletView","BWTankView","_shoot","gunContainer","tankGun","tankRadar","BWRenderer","_bigBoomAnim","_smallBoomAnim","_shakeTimer","Texture","_addExplosion","masterContainer","anim","AnimatedSprite","loop","onComplete","play","BrodyBattlefieldView","_holeList","_settings","groundMask","_craterContainer","wallMask","_holesContainer","crater","blendMode","BLEND_MODES","visible","skratchLimit","showCraters","hole","BrodyClockView","BrodyBulletView","_glow","showGlow","glow","BrodyTankView","_lightTimer","_tankGun","enemySpot","_light","skin","stroke","strokeThickness","BrodySettings","_particleLimit","_skratchLimit","_showDirt","_showGlow","_showCraters","_dropFrames","BrodyRenderer","_particleContainer","_particleList","_explosionList","_frameTimer","_fpsInterval","_fps","battlefieldView","configure","ParticleContainer","position","_addTankExplosion","directionCorrection","dirtAngle","corner1X","corner1Y","corner2X","corner2Y","speedMultiplier","_addDirt","_addBulletExplosion","addBulletHole","particle","particleCount","alphaSpeed","lifetime","particleLimit","dropFrames","addCrater","_addSparks","_addGlow","sparks","animationSpeed","amount","showDirt","VoidRenderer","createSimulation","Simulation","createAiDefinition","createUBD","createRenderer","JsBattle","JsBattleLib"],"mappings":";w3IAuBA,QAAO,QAKP,YAGA,SACA,UACA,SAEM,EAAoB,CAAC,eAErB,EAAiB,yCAEF,E,gwBACH,WACd,qDACA,UAAmB,SAAQ,SAAC,GAAD,OAAO,EAAK,cAAc,Q,8CAIrD,0DADmB,MAEG,KAAK,KAApB,EAFY,EAEZ,MACP,GAHmB,EAEL,KACd,CACA,IAAM,EAAa,EACf,KAAK,gBAAgB,EAAkB,GACvC,EACJ,KAAK,cAAc,EAAY,GAAgB,GAC/C,KAAK,KAAK,iCAAmC,K,oCAI7C,OAAQ,KAAK,KAAK,YAChB,kDAAwB,KAAK,UAAU,GAAkB,OAAiB,Q,oBAnB/C,WAAjC,Q,onECvCsB,E,wBAAtB,gBAOa,aAAa,wB,IAEb,E,8BAET,SAAF,EAAY,GAAS,MAEnB,GAFmB,UACf,EAAJ,cACK,aAAW,KAAK,GAAI,MAAM,IAAI,MAAM,4CAFtB,OAGnB,EAAK,IAAM,EAHQ,E,6CAOnB,OAAO,KAAK,M,iCAIZ,OAAO,I,4BAIP,O,EAAA,GAAoB,G,EAAX,KAAK,O,mCAAM,E,iDAAA,E,iBAjBE,GAA1B,S,IAqBa,E,8BAKT,SAAF,EAAY,GAAkC,wBACxC,EAAJ,cACK,OAAyB,iBAAT,EAAoB,CAAC,GAAQ,EAFN,E,6CAM5C,OAAO,KAAK,M,iCAIZ,GAAI,KAAK,OAAO,OAAS,EAAG,OAAO,EAC7B,MAAO,KAAK,OAAO,GACnB,MAAU,KAAT,GAAwB,OAAT,I,gCAItB,OAAiB,QAAV,EAAC,KAAK,YAAI,QAAT,KAAK,KAAS,KAAK,OAAO,QAAO,SAAC,EAAW,GAAZ,gBAA+B,GAA/B,OAAmC,KAAK,M,kCAIjF,OAAmB,QAAZ,EAAC,KAAK,cAAM,QAAX,KAAK,OAAW,KAAK,OAAO,QAAO,SAAC,EAAkB,GAE5D,OADI,aAAa,IAAM,EAAM,EAAE,MAAQ,EAAM,EAAE,MAAQ,GAAK,GACrD,IACN,Q,GA5BoB,GA4C3B,SAAgB,EAAE,GAA8C,IAC9D,IAAM,EAAmB,CAAC,EAAK,IAC3B,EAAI,EAFsD,mBAAf,EAAe,iCAAf,EAAe,kBAG9D,KAAO,EAAI,EAAK,QACd,EAAW,EAAM,EAAK,IAClBA,EAAC,KAAK,IAAO,IAEjB,OAAK,IAAI,EAAM,GAnDnB,UAwCa,MAAM,IAAI,EAAM,IAI7B,MAUA,IAAM,EAAO,IAAI,EAAM,KAEvB,SAAgB,EAAI,GAA2D,IAC3E,IAAI,EAAmB,CAAC,EAAc,EAAK,KACzCC,EAAI,EAFqE,mBAA5B,EAA4B,iCAA5B,EAA4B,kBAG3E,KAAK,EAAI,EAAK,QACV,EAAC,KAAK,GACN,EAAO,EAAM,EAAK,IAClB,EAAC,KAAK,EAAM,EAAc,IAAO,KAGrC,OADA,EAAO,GACF,IAAI,EAAM,GAGnB,SAAgB,EAAW,EAAkB,GAuC7C,IAAqB,E,EAtCf,aAAe,EAAO,EAAK,KAAL,Q,+CAAa,EAAI,S,8iBAClC,aAAe,EAAM,EAAK,KAAK,GACnC,EAAK,KAqCS,iBADA,EApCQ,IAqCgB,kBAAL,GAAwB,OAAN,EACpD,EACA,EAAc,MAAM,QAAQ,GAAK,EAAE,KAAK,KAAO,IApCrD,SAAS,EAAS,GAEd,IADA,IAAE,EAAI,EACD,EAAI,EAAK,OAAS,GAAG,CACtB,KAAK,KAAO,EAAM,CACpB,IAAM,EAAM,EAAe,EAAK,EAAI,GAAI,EAAK,EAAI,IAC3C,QAAM,IAAR,EAAmB,CACrB,EAAK,OAAO,EAAI,EAAG,EAAG,GACtB,SAEF,EAAK,KAAO,IAEV,KAIR,SAAS,EAAe,EAAa,GACnC,GAAU,OAAN,EAAY,OAAO,EACvB,GAAU,OAAN,EAAY,OAAO,EACvB,GAAgB,iBAAL,EAAe,CACxB,GAAI,aAAa,GAA4B,MAApB,EAAE,EAAE,OAAS,GAAY,OAClD,MAAgB,iBAAL,EAAe,UAAU,EAAE,MAAM,GAAI,IAAtB,OAA2B,EAA3B,KACb,MAAT,EAAE,GAAmB,EAAE,MAAM,GAAI,GAAK,EAAE,MAAM,QAC9C,EAEN,MAAgB,iBAAL,GAA0B,MAAT,EAAE,IAAgB,aAAa,OAA3D,EAAkE,WAAW,GAAX,OAAe,EAAE,MAAM,IAmB3F,SAAgB,EAAc,GAC5B,OAAO,KAAK,UAAU,GACnB,QAAQ,UAAW,WACnB,QAAQ,UAAW,WAhExB,QAYA,eAkCA,qBAA0B,EAAU,GAChC,OAAK,EAAG,WAAa,EAAK,EAAG,WAAa,EAAK,EAArB,IAA2B,EAAK,IAU9D,qBAA0B,GACxB,OAAO,IAAI,EAAM,EAAc,KAGjC,kBAMA,uBAA4B,GAC1B,MAAqB,iBAAP,GAAmB,aAAW,KAAK,GAAO,IAAI,EAAJ,WAAc,IAAS,EAAxE,IAA6E,K,kiJCzJtF,cACA,UAEA,UAAQ,wEAAG,4EAAK,wFAAW,4EAAK,4FAAa,wFAAW,8EACxD,IAAI,EAAJ,QAAQ,gFAAmB,0FAAY,kGAAgC,sFAQ1D,YAAY,CACvB,GAAI,IAAI,QAAM,KACd,IAAK,IAAI,QAAM,MACf,GAAI,IAAI,QAAM,KACd,IAAK,IAAI,QAAM,MACf,GAAI,IAAI,QAAM,OACZ,IAAG,IAAI,QAAM,OACb,IAAG,IAAI,QAAM,KACb,GAAE,IAAI,QAAM,MACZ,IAAG,IAAI,QAAM,O,IAGF,E,oFAIX,OAAO,O,oCAGK,EAAmB,GAC/B,OAAO,S,KAQL,E,8BACF,SAAF,EAA6B,EAAgC,EAAoB,GAAc,wBAC7F,gBAD2B,UAAgC,SAAoB,QAAc,E,4CAIpE,IAAnB,EAAmB,EAAnB,IAAK,EAAc,EAAd,GACL,EAAU,EAAM,eAAe,KAAK,QACpC,OAAmB,IAAb,KAAK,IAAoB,GAAzB,aAAoC,KAAK,KACrD,MAAO,UAAG,EAAH,YAAc,KAAK,MAAnB,OAA0B,EAA1B,KAAmC,I,oCAG9B,EAAkB,GACxB,GAAD,EAAM,KAAK,KAAK,KAErB,OADI,KAAK,MAAK,KAAK,IAAM,GAAa,KAAK,IAAK,EAAO,IAChD,O,4BAIP,OAAO,KAAK,eAAe,cAAc,KAAK,IAAI,MAAQ,O,GAlB5C,GAsBZ,E,8BACF,SAAF,EACmB,EACT,EACS,GAAqB,wBAEtC,gBAJiB,MACT,QACS,gBAAqB,E,4CAKlB,IAAd,EAAc,EAAd,GACN,MAAO,UAAG,KAAK,IAAR,cAAiB,KAAK,IAAtB,KAA+B,I,oCAG1B,EAAkB,GAC9B,KAAI,KAAK,eAAe,SAAS,EAAM,KAAK,IAAI,MAAS,KAAK,YAE9D,OADA,KAAK,IAAM,GAAa,KAAK,IAAK,EAAO,GAClC,O,4BAKP,OAAO,GADO,KAAK,eAAe,OAAO,GAA3B,KAAoC,KAAK,IAAI,OAChC,KAAK,S,GArBf,GAyBf,E,8BAEJ,WAAqB,GAAW,wBAC9B,gBADmB,QADZ,QAAmB,GACI,E,4CAIV,IAAd,EAAc,EAAd,GACN,MAAO,UAAG,KAAK,MAAR,KAAmB,M,GAPV,GAWd,E,8BAEJ,WAAqB,GAAY,wBAC/B,gBADmB,QADZ,QAAmB,GACK,E,4CAIX,IAAd,EAAc,EAAd,GACA,EAAQ,KAAK,MAAL,WAAiB,KAAK,OAAU,GAC9C,MAAO,eAAQ,EAAR,KAAmB,M,GARV,GAYd,E,8BACF,SAAF,EAAqB,GAAW,wBAC9B,gBADmB,QAAW,E,4CAIV,IAAd,EAAc,EAAd,GACN,MAAO,gBAAS,KAAK,MAAd,KAAyB,I,4BAIhC,OAAO,KAAK,MAAM,U,GAVF,GAcd,E,8BACF,SAAF,EAAoB,GAAc,wBAC5B,EAAJ,cADkB,OAAc,E,4CAIZ,IAAd,EAAc,EAAd,GACN,MAAO,UAAG,KAAK,KAAR,KAAkB,I,sCAIzB,MAAO,UAAG,KAAK,MAAS,UAAO,I,oCAGnB,EAAkB,GAE9B,OADA,KAAK,KAAO,GAAa,KAAKD,KAAM,EAAO,GACpC,O,4BAIP,OAAO,KAAK,gBAAgB,cAAc,KAAK,KAAK,MAAQ,O,GAnB1C,GAuBP,E,8BACX,SAAF,IAA4C,MAAvB,EAAuB,uDAAF,GAAE,kBACtC,EAAJ,cADmB,QAAuB,E,yCAIrC,GACL,OAAO,KAAK,MAAM,QAAO,SAAC,EAAM,GAAP,OAAa,EAAO,EAAE,OAAO,KAAO,M,sCAMvD,IAHK,IACJ,EAAS,KAAT,MACH,EAAI,EAAM,OACP,KAAK,CACV,IAAM,EAAI,EAAM,GAAG,gBACf,MAAM,QAAQ,GAAI,EAAM,OAAN,QAAK,CAAQ,EAAG,GAAX,SAAiB,KACnC,EAAG,EAAM,GAAK,EAClB,EAAM,OAAO,EAAG,GAEvB,OAAO,EAAM,OAAS,EAAI,UAAO,I,oCAGrB,EAAkB,GAG9B,IAHkD,IAC3C,EAAS,KAAT,MACH,EAAI,EAAM,OACP,KAAK,CAEV,IAAM,EAAI,EAAM,GACZ,EAAE,cAAc,EAAO,KAC3B,GAAc,EAAO,EAAE,OACvB,EAAM,OAAO,EAAG,IAElB,OAAO,EAAM,OAAS,EAAI,UAAO,I,4BAIjC,OAAO,KAAK,MAAM,QAAO,SAAC,EAAkB,GAAnB,OAAyB,EAAS,EAAO,EAAE,SAAQ,Q,GAnC9C,GA2CnB,E,6HACN,GACL,MAAO,IAAM,EAAK,GAAX,0CAA6B,GAAQ,IAAM,EAAK,O,GAF1B,GAM3B,E,8FAAa,GAEb,E,8FAAa,GACD,OAAO,O,IAGnB,E,8BAGF,SAAF,EAAoB,EAA2B,GAAmB,wBAC5D,EAAJ,YAAM,IADY,YAA8C,E,yCAI3D,GACC,IAAF,EAAO,aAAM,KAAK,UAAX,+CAAuC,GAElD,OADI,YAAW,GAAQ,QAAU,UAAU,OAAO,IAC3C,I,sCAIP,kDACM,MAAO,KAAK,UAClB,IAAa,IAAT,EAAe,OAAO,KAAK,MAC/B,IAAI,EAAI,UACR,GAAI,EAAG,CACL,IAAM,EAAK,EAAE,gBACb,EAAI,UAAY,MAAM,QAAQ,GAAM,IAAI,EAAK,GAAO,EAEtD,OAAI,GACW,IAAT,EAAuBE,aAAa,EAAK,EAAI,EAAE,MAC/C,KAAK,MAAM,OAAe,KACvB,IAAI,EAAG,GAAI,GAAO,aAAa,EAAK,CAAC,GAAK,EAAE,QAExC,IAAT,GAAmB,KAAK,MAAM,OAC3B,UADP,I,oCAIY,EAAkB,G,MAE9B,GADA,UAAqB,QAAZ,EAAG,iBAAS,eAAE,cAAc,EAAO,GACtC,iDAAoB,EAAO,IAAc,UAE/C,OADA,KAAK,UAAY,GAAa,KAAK,UAAW,EAAO,GAC9C,O,4BAIP,IAAM,EAAK,+BAGX,OAFA,GAAa,EAAO,KAAK,WACrB,WAAW,EAAS,EAAO,UAAU,OAClC,M,GA1CM,GACC,OAAO,K,IAiDV,E,8FAAY,GACT,OAAO,M,IAGnB,E,8BACF,SAAF,EAAoB,GAAe,wBACjC,gBADkB,YAAe,E,yCAI5B,GACL,MAAO,cAAO,KAAK,UAAZ,+CAAwC,K,oCAGnC,EAAkB,GAC9B,GAAI,iDAAqB,EAAO,GAEhC,OADA,KAAK,UAAY,GAAa,KAAK,UAAW,EAAO,GAC9C,O,4BAIP,OAAO,EAAQ,+BAAc,KAAK,UAAU,W,GAhB1B,GAoBhB,E,8BACF,SAAF,EACmB,EACA,EACA,EACA,GAAY,wBAEzB,EAAJ,cALiB,UACA,SACA,SACA,OAAY,E,yCAKxB,GACL,IAAM,EAAU,EAAK,IAAM,eAAe,KAAK,QACxC,EAAkB,KAAlB,KAAM,EAAY,KAAZ,KAAM,EAAM,KAAN,GACnB,MAAO,cAAO,EAAP,YAAkB,EAAlB,YAA0B,EAA1B,aAAmC,EAAnC,YAA2C,EAA3C,aAAkD,EAAlD,iDAA2E,K,4BAIlF,IAAM,EAAQ,GAAY,+BAAc,KAAK,MAC7C,OAAO,GAAa,EAAO,KAAK,Q,GAlBb,GAsBjB,E,8BACF,SAAF,EACmB,EACA,EACA,EACT,GAAc,wBAElB,EAAJ,cALiB,OACA,YACA,SACT,aAAc,E,yCAKjB,GACL,MAAO,cAAO,KAAK,QAAZ,YAAuB,KAAK,KAA5B,YAAoC,KAAK,KAAzC,YAAiD,KAAK,SAAtD,+CAAiF,K,oCAG5E,EAAkB,GACxB,GAAF,iDAAqB,EAAO,GAE1B,OADN,KAAK,SAAW,GAAa,KAAK,SAAU,EAAO,GAC5C,O,4BAIP,OAAO,EAAQ,+BAAc,KAAK,SAAS,W,GArBzB,GAyBhB,E,8BAEF,SAAF,EAAmB,EAAmB,EAAmB,GAAe,wBAClE,EAAJ,cADiB,OAAmB,SAAmB,UAAe,E,yCAIjE,GACL,IAAM,EAAS,KAAK,MAAQ,SAAW,GACvC,MAAO,UAAG,EAAH,oBAAqB,KAAK,KAA1B,YAAkC,KAAK,KAAvC,+CAA8D,O,GARtD,GACD,OAAO,O,IAWnB,E,6HAGG,GACL,MAAO,oDAAyB,O,GAJf,GACH,OAAO,S,IAOnB,E,6HAIG,GACL,IAAI,EAAO,gDAAqB,GAGhC,OAFI,aAAY,GAAQ,WAAW,OAAO,IACtC,eAAc,GAAQ,aAAa,OAAO,IACvC,I,8CAOP,OAHA,kDACU,QAAV,oBAAU,SAAE,gBACA,QAAZ,sBAAY,SAAE,gBACP,O,oCAGK,EAAkB,G,QAI9B,OAHA,iDAAoB,EAAO,GACjB,QAAV,oBAAU,SAAE,cAAc,EAAO,GACrB,QAAZ,sBAAY,SAAE,cAAc,EAAO,GAC5B,O,4BAIP,IAAM,EAAK,+BAGX,OAFI,YAAY,EAAS,EAAO,WAAW,OACvC,cAAc,EAAS,EAAO,aAAa,OACxC,M,GA7BO,GAqCZ,E,8BAEF,SAAF,EAAqB,GAAW,wBAC1B,EAAJ,cADmB,QAAW,E,yCAIzB,GACL,MAAO,gBAAS,KAAK,MAAd,+CAAsC,O,GAP7B,GACF,OAAO,Q,IAUnB,E,6HAEG,GACL,MAAO,oDAAyB,O,GAHd,GACJ,OAAO,U,IAiCZ,E,WAST,SAAF,EAAY,GAA+C,IAAzB,EAAyB,uDAAF,GAAE,UANlD,aAA0B,GAElB,kBAAyB,GACzB,gBAAwB,GAInC,KAAC,KAAL,OAAgB,GAAhB,IAAsB,GAAI,EAAK,MAAQ,KAAO,KAC1C,KAAC,UAAY,EACb,KAAC,OAAS,IAAI,QAAM,CAAC,OAAQ,IAC7B,KAAC,OAAS,CAAC,IAAI,G,6CAInB,OAAO,KAAK,MAAM,OAAO,KAAK,Q,2BAI3B,GACH,OAAO,KAAK,OAAO,KAAK,K,gCAIhB,GACF,OAAC,KAAK,UAAU,KAAK,K,iCAIlB,EAAuC,GAChD,IAAM,EAAO,KAAK,UAAU,MAAM,EAAc,GAGhD,OAFWC,KAAK,QAAQ,EAAK,UAAY,KAAK,QAAQ,EAAK,QAAU,IAAI,MACtE,IAAI,GACA,I,oCAGK,EAAgB,GAC5B,OAAO,KAAK,UAAU,SAAS,EAAQ,K,gCAK/B,GACR,OAAO,KAAK,UAAU,UAAU,EAAW,KAAK,W,kCAIhD,OAAO,KAAK,UAAU,UAAU,KAAK,W,2BAIrC,EACA,EACA,EACA,GAEA,IAAM,EAAO,KAAK,OAAO,OAAO,GAGhC,YAFY,IAAR,GAAqB,IAAU,KAAK,WAAW,EAAK,KAAO,GAC/D,KAAK,UAAU,IAAI,EAAI,EAAS,EAAM,IAC/B,I,4BAIH,EAA6B,EAAe,GAC1C,OAAC,KAAK,KAAK,iBAAgB,EAAc,EAAK,K,0BAIlD,EAA6B,EAAgB,GAC/C,OAAO,KAAK,KAAK,eAAc,EAAc,EAAK,K,0BAIhD,EAA6B,EAAgB,GAC/C,OAAO,KAAK,KAAK,eAAc,EAAc,EAAK,K,6BAI7C,EAAW,EAAe,GAC/B,OAAO,KAAK,UAAU,IAAI,EAAO,EAAK,EAAK,M,2BAIxC,GAGH,MAFgB,mBAAL,EAAiB,IACnB,IAAM,OAAK,KAAK,UAAU,IAAI,EAAQ,IACxC,O,+BAIgD,IACvD,IAAM,EAAmB,CAAC,KAD6B,mBAA/C,EAA+C,yBAA/C,EAA+C,gBAEvD,cAA2B,EAA3B,eAAsC,iBAA1B,EAA0B,KAArB,EAAqB,KAChC,EAAK,OAAS,GAAG,EAAK,KAAK,KAC/B,EAAK,KAAK,IACN,IAAQ,GAAS,KAAK,KAAK,OAC7B,EAAK,KAAK,KACV,aAAW,EAAM,IAIf,OADN,EAAK,KAAK,KACH,IAAI,QAAM,K,yBAIhB,EAA2B,EAAkB,GAGxC,GAFA,KAAD,WAAW,IAAI,EAAG,IAEnB,GAAY,EACd,KAAK,KAAK,GAAV,OAA2B,KAAK,GAAU,aACrC,GAAI,EACT,KAAK,KAAK,GAAU,aACf,GAAI,EACT,MAAM,IAAI,MAAM,4CAElB,OAAO,O,6BAIF,GACL,OAAO,KAAK,UAAU,IAAI,EAAG,M,6BAK7B,OAAO,KAAK,UAAU,IAAI,K,8BAK1B,OAAO,KAAK,cAAc,EAAI,K,2BAGnB,EAAW,GAGtB,OAFM,KAAD,WAAW,GACZ,GAAS,KAAK,KAAK,GAAS,SACzB,O,0BAIL,EAAiB,GACnB,OAAO,KAAK,KAAK,IAAI,EAAQ,GAAY,K,+BAKzC,EACA,EACA,EACA,GAC2D,IAA3D,EAA2D,uDAA3C,KAAK,KAAK,IAAM,eAAe,eAEzC,EAAO,KAAK,OAAO,OAAO,GAC1B,OAAC,KAAK,KAAK,IAAI,EAAS,EAAS,EAAM,EAAM,IAAK,kBAAM,EAAQ,Q,4BAKtE,EACA,EACA,GAC8B,WAA9B,EAA8B,uDAAd,iBAEV,EAAO,KAAK,OAAO,OAAO,GAChC,GAAI,KAAK,KAAK,IAAK,CACjB,IAAM,EAAM,aAAoB,OAAO,EAAW,SAAS,OAAQ,GACnE,OAAO,KAAK,SAAS,KAAM,EAAG,IAAvB,IAA2B,IAAc,SAAC,GAC/C,EAAI,IAAK,EAAM,IAAf,IAAmB,EAAO,IAC1B,EAAQ,MAGZ,OAAO,KAAK,KAAK,IAAI,EAAQ,KAAM,EAAS,EAAM,IAAW,kBAAM,EAAQ,Q,4BAM3E,EACA,EACA,GAC6D,IAA7D,EAA6D,uDAA7C,KAAK,KAAK,IAAM,eAAe,iBAE/C,GAAI,KAAK,KAAK,cACZ,OAAO,KAAK,MAAM,EAAc,IAAzB,IAAyC,GAAQ,GAE1D,IAAM,EAAO,KAAK,OAAO,OAAO,GAChC,OAAO,KAAK,KAAK,IAAI,EAAQ,KAAM,EAAS,EAAM,IAAM,kBAAM,EAAQ,Q,+BAKtE,OAAO,KAAK,cAAc,K,4BAItB,GACJ,OAAO,KAAK,UAAU,IAAI,EAAM,M,4BAI5B,GACJ,OAAO,KAAK,UAAU,IAAI,EAAM,M,6BAI3B,GACL,IAAM,EAAO,IAAI,EAGjB,GAFA,KAAK,WAAW,GACV,KAAD,KAAK,GACgB,IAAtB,EAAK,MAAM,OAAc,MAAM,IAAI,MAAM,0CACvC,OAAC,KAAK,cAAc,K,0BAIxB,EAAgB,EAA+B,GACjD,IAAK,IAAc,EAAa,MAAM,IAAI,MAAM,gDAChD,IAAM,EAAO,IAAI,EAGjB,GAFA,KAAK,WAAW,GACV,KAAD,KAAK,GACN,EAAW,CACb,IAAM,EAAQ,KAAK,KAAK,KACxB,KAAK,UAAY,EAAI,MAAS,IAAI,EAAM,GACxC,EAAU,GAMZ,OAJI,IACF,KAAK,UAAY,EAAI,QAAW,IAAI,EACpC,KAAK,KAAK,IAEL,KAAK,cAAc,EAAO,K,4BAI7B,GACJ,OAAO,KAAK,UAAU,IAAI,EAAM,M,4BAI5B,EAAc,GAGlB,OAFA,KAAK,aAAa,KAAK,KAAK,OAAO,QAC/B,GAAM,KAAK,KAAK,GAAM,SAAS,GAC5B,O,+BAIA,GACP,IAAM,EAAM,KAAK,aAAa,MAC9B,QAAY,IAAR,EAAmB,MAAM,IAAI,MAAM,wCACvC,IAAM,EAAU,KAAK,OAAO,OAAS,EACrC,GAAI,EAAU,QAAoB,IAAd,GAA2B,IAAY,EACzD,MAAM,IAAI,MAAJ,0CAA6C,EAA7C,eAA2D,EAA3D,cAGR,OADA,KAAK,OAAO,OAAS,EACd,O,2BAIJ,GAA+D,IAAnD,EAAmD,uDAAtC,MAAK,EAAiC,uCAAhB,EAAgB,uCAGlE,OAFA,KAAK,WAAW,IAAI,EAAK,EAAM,EAAM,IACjC,GAAU,KAAK,KAAK,GAAU,UAC3B,O,gCAKP,OAAO,KAAK,cAAc,K,iCAI1B,IADY,IAAL,EAAK,uDAAD,EACJ,KAAM,GACX,KAAK,MAAM,gBACX,KAAK,MAAM,cAAc,KAAK,MAAM,MAAO,KAAK,c,gCAIlC,GAEhB,OADA,KAAK,UAAU,MAAM,KAAK,GACnB,O,iCAGU,GACjB,KAAK,UAAU,MAAM,KAAK,GAC1B,KAAK,OAAO,KAAK,K,oCAGG,EAAsB,GAC1C,IAAM,EAAI,KAAK,UACf,GAAI,aAAa,GAAO,GAAM,aAAa,EAEzC,OADA,KAAK,OAAO,MACL,KAET,MAAM,IAAI,MAAJ,iCAAoC,EAAE,UAAM,EAAG,KAAT,YAAiB,EAAG,MAAS,EAAG,KAAtE,Q,gCAGU,GAChB,IAAM,EAAI,KAAK,UACf,KAAM,aAAa,GACjB,MAAM,IAAI,MAAM,gCAGlB,OADA,KAAK,UAAY,EAAC,KAAQ,EACnB,O,4BAIP,OAAO,KAAK,OAAO,K,gCAInB,IAAM,EAAK,KAAK,OAChB,OAAO,EAAG,EAAG,OAAS,I,aAGF,GACpB,IAAM,EAAK,KAAK,OAChB,EAAG,EAAG,OAAS,GAAK,M,KAQxB,SAAS,EAAS,EAAkB,GAClC,IAAK,IAAM,KAAK,EAAM,EAAM,IAAM,EAAM,IAAM,IAAM,EAAK,IAAM,GAC/D,OAAO,EAGT,SAAS,GAAa,EAAkB,GACtC,OAAO,aAAgB,cAAc,EAAS,EAAO,EAAK,OAAS,EAIrE,SAAS,GAAa,EAAgB,EAAkB,GACtD,OAAI,aAAgB,OAAa,EAAY,IAkBxB,EAjBJ,aAmBA,SACb,EAAE,OAAO,MACP,SAAC,GAAD,OAAO,aAAa,QAAyB,IAAjB,EAAM,EAAE,WAAmC,IAArB,EAAU,EAAE,QApB7D,IAAI,QACT,EAAK,OAAO,QAAO,SAAC,EAAmB,GAIrC,OAHI,aAAa,SAAM,EAAI,EAAY,IACnC,aAAa,QAAO,EAAM,KAAN,QAAK,EAAS,EAAE,SACnC,EAAM,KAAK,GACT,IACN,KAP0B,EAiB/B,IAAqB,EAPrB,SAAS,EAAY,GACnB,IAAM,EAAI,EAAU,EAAE,KACtB,YAAU,IAAN,GAAoC,IAAjB,EAAM,EAAE,KAAmB,UAC3C,EAAM,EAAE,KACR,IAaX,SAAS,GAAc,EAAkB,GACvC,IAAK,IAAM,KAAK,EAAM,EAAM,IAAM,EAAM,IAAM,IAAM,EAAK,IAAM,GAIjE,SAAgB,GAAI,GAClB,MAAmB,kBAAL,GAA8B,iBAAL,GAAuB,OAAN,GAAc,EAAI,IAAnE,IAAwE,GAAI,IAhXrF,YA+WA,SAIA,IAAM,GAAU,GAAQ,YAAU,KAGlC,iBAAmC,2BAAZ,EAAY,yBAAZ,EAAY,gBACjC,OAAO,EAAK,OAAO,KAGrB,IAAM,GAAS,GAAQ,YAAU,IASjC,SAAS,GAAQ,GACf,OAAO,SAAC,EAAG,GAAJ,OAAW,IAAM,MAAM,EAAI,IAAM,MAAM,EAAI,IAAhB,IAAoB,GAAI,GAAM,EAAM,GAAI,KAG5E,SAAS,GAAI,GACX,OAAO,aAAa,OAAO,EAAI,IAAxB,IAA6B,GAXtC,gBAAkC,2BAAZ,EAAY,yBAAZ,EAAY,gBAChC,OAAO,EAAK,OAAO,M,+/GCxyBrB,cAeM,E,8BAEF,SAAF,EAAYC,GAAoB,wBAC1B,EAAJ,0CAA6B,EAA7B,kBACK,MAAQ,EAAK,MAFY,E,YAFT,QA6BZ,WAAW,CACpB,MAAK,IAAI,OAAK,SACd,IAAG,IAAI,OAAK,OACZ,IAAG,IAAI,OAAK,Q,IAGHC,E,WAKT,SAAF,IAAiD,6DAAF,GAAlC,EAAoC,EAApC,SAAU,EAA0B,EAA1B,OAA0B,UAJ9B,YAA2C,GAKxDF,KAAC,UAAY,EACbA,KAAC,QAAU,E,yCAGV,GACL,OAAO,aAAwB,OAAO,EAAe,KAAK,KAAK,K,2BAG5D,GACH,OAAO,IAAI,OAAK,KAAK,SAAS,M,+BAGb,GACjB,IAAM,EAAK,KAAK,OAAO,IAAW,KAAK,WAAW,GAClD,gBAAU,GAAV,OAAmB,EAAG,W,iCAGL,G,QACX,IAAqB,QAAvB,EAAY,QAAZ,OAAK,eAAO,eAAE,iBAAS,eAAE,IAAI,KAAY,KAAK,YAAc,KAAK,UAAU,IAAI,GACjF,MAAM,IAAI,MAAJ,2BAA8B,EAA9B,mCAER,OAAQ,KAAK,OAAO,GAAU,CAAC,SAAQ,MAAO,O,KA3BlDG,EAAQ,MAAR,E,IAoCa,E,8BAKT,SAAF,EAAY,EAAgB,GAAe,wBACrC,EAAJ,YAAM,IACD,OAAS,EAF2B,E,2CAKlC,E,GAAkD,IAA/B,EAA+B,EAA/B,SAAU,EAAqB,EAArB,UAC9B,KAAD,MAAQ,EACP,KAAD,UAAY,IAAjB,IAAsB,IAAI,OAAK,GAAa,O,GAZZ,QAApC,mBAoBA,IAAM,EAAO,IAAH,KAEG,E,8BAKT,SAAF,EAAY,GAAuB,wBAC7B,EAAJ,YAAM,IALW,QAAuB,GAMpC,EAAC,OAAS,EAAK,MACf,EAAC,KAAL,OAAgB,GAAhB,IAAsB,GAAI,EAAK,MAAQ,EAAO,QAHb,E,wCAO3B,OAAC,KAAK,S,2BAGT,GACG,OAAC,IAAI,EAAe,EAAQ,KAAK,SAAS,M,4BAG5C,EAAuC,G,MACrC,QAAY,IAAd,EAAM,IAAmB,MAAM,IAAI,MAAM,wCACvC,MAAO,KAAK,OAAO,GAClB,EAAU,EAAV,OACD,EAAoB,QAAZ,EAAG,EAAM,WAAG,QAAI,EAAM,IAChC,EAAK,KAAK,QAAQ,GACtB,GAAI,EAAI,CACN,IAAM,EAAQ,EAAG,IAAI,GACrB,GAAI,EAAO,OAAO,OAElB,EAAK,KAAK,QAAQ,GAAU,IAAI,IAElC,EAAG,IAAI,EAAU,GAEjB,IAAM,EAAI,KAAK,OAAO,KAAY,KAAK,OAAO,GAAU,IAClD,EAAY,EAAE,OAGpB,OAFA,EAAE,GAAa,EAAM,IACrB,EAAK,SAAS,EAAO,CAAC,SAAU,EAAQ,cACjC,I,+BAGA,EAAgB,GACvB,IAAM,EAAK,KAAK,QAAQ,GACxB,GAAK,EACL,OAAO,EAAG,IAAI,K,gCAGN,GAAoE,IAAnD,EAAmD,uDAAZ,KAAK,QACrE,OAAO,KAAK,cAAc,GAAQ,SAAC,GACjC,QAAuB,IAAnB,EAAK,UAAyB,MAAM,IAAI,MAAJ,yBAA4B,EAA5B,mBACxC,OAAO,IAAP,IAAW,EAAY,EAAK,gB,kCAOmB,IAFjD,EAEiD,uDAFV,KAAK,QAC5C,EACiD,uCAAjD,EAAiD,uCAEjD,OAAO,KAAK,cACV,GACA,SAAC,GACC,QAAmB,IAAf,EAAK,MAAqB,MAAM,IAAI,MAAJ,yBAA4B,EAA5B,mBACpC,OAAO,EAAK,MAAM,OAEpB,EACA,K,oCAKF,EACA,GAEiD,WADjD,EACiD,uDADpB,GAC7B,EAAiD,uCAE7C,EAAa,MAFgC,WAGtC,GACT,IAAM,EAAK,EAAO,GAClB,IAAK,EAAI,iBACT,IAAM,EAAW,EAAW,GAAU,EAAW,IAAW,IAAI,IAChE,EAAG,SAAQ,SAAC,GACV,IAAI,EAAQ,IAAI,GAAhB,CACA,EAAQ,IAAI,GACZ,IAAI,EAAI,EAAU,GAClB,GAAI,EAAG,CACL,IAAM,EAAM,EAAK,KAAK,IAAM,eAAe,iBAC3C,EAAO,IAAH,IAAO,EAAO,EAAO,EAAU,EAAK,EAAK,KAAK,QAC7C,MAAK,EAAI,aAAO,EAAP,EAAU,IAGxB,MAAM,IAAI,EAAW,GAFrB,EAAO,IAAH,IAAO,EAAO,EAAI,EAAK,KAAK,UAZtC,IAAK,IAAM,KAAU,EAAQ,EAAlB,GAkBX,OAAO,M,GA9FqB,GAAhC,gB,8mCCpGA,cACA,UACA,SAOA,UACA,UACA,SAEqB,E,WAiBjB,SAAF,EAAY,EAAkB,EAA6B,GAerD,G,4FAfoE,SAwK5E,WAEE,EACA,GAAe,IAFd,EAEc,EAFd,OAAQ,EAEM,EAFN,KAAM,EAEA,EAFA,KAKb,GAAE,MAAM,QAAQ,EAAI,UAAY,EAAI,QAAQ,SAAS,GAAW,EAAI,UAAY,EAC5E,MAAE,IAAI,MAAM,4BAGhB,IAAI,EAAO,EAAI,aACf,GAAE,aAAI,EAAJ,EAAM,MAAK,SAAC,GAAD,OAAU,OAAO,UAAU,eAAe,KAAK,EAAQ,MAChE,MAAE,IAAI,MAAJ,kDAAqD,EAArD,aAAiE,EAAK,KAAK,OAGjF,GAAE,EAAI,iBACQ,EAAI,eAAe,EAAO,IAC5B,CACV,IAAM,EAAM,6BAA+B,EAAK,WAAW,EAAI,eAAe,QAC9E,GAA4B,QAAxB,EAAK,eACJ,MAAM,IAAI,MAAM,GADc,EAAK,OAAO,MAAM,IA1LnD,CAAiB,EAAI,EAAK,GAC1B,KAAC,IAAM,EAAG,IACV,KAAC,UAAY,EAAG,UAChB,KAAC,QAAU,EACX,KAAC,KAAO,EAAG,KACX,KAAC,OAAS,EAAG,OAAO,GACpB,KAAC,MAAQ,EAAI,OAAS,EAAG,KAAK,OAAS,KAAK,QAAU,KAAK,OAAO,MAClE,KAAC,YAAc,iBAAe,EAAI,KAAK,OAAQ,EAAS,KAAK,OAC7D,KAAC,WAAa,EAAI,WAClB,KAAC,aAAe,EAAG,OACnB,KAAC,OAAS,GACV,KAAC,GAAK,EACN,KAAC,IAAM,EAEP,KAAK,MACP,KAAK,WAAa,EAAG,IAAH,MAAa,UAAW,EAAQ,KAAK,MAAO,SAG9D,GADA,KAAK,WAAa,KAAK,aAwI7B,SAAyB,EAAiB,GAA8C,IAAtB,EAAsB,wDAEtF,OACG,EAAW,QACZ,EAAW,MAAK,SAAC,GAAD,MACP,UAAP,EACI,MAAM,QAAQ,GACP,WAAP,EACA,GAA2B,UAAjB,EAAO,KAAuB,MAAM,QAAQ,GACtD,EAAO,IAAU,GAAO,QAAmC,IAAV,KAhJhD,CAAgB,KAAK,OAAQ,EAAI,WAAY,EAAI,gBACpD,MAAM,IAAI,MAAJ,UAAa,EAAb,0BAAsC,KAAK,UAAU,EAAI,eAI/D,SAAU,EAAM,EAAI,aAA6B,IAAf,EAAI,UAClC,KAAD,UAAY,EAAG,IAAH,MAAa,QAAS,UAAE,S,oDAItC,EAAiB,EAA4B,GAClD,KAAK,IAAL,GAAY,MAAI,IACZ,EAAY,IACX,KAAK,QACN,GACF,KAAK,IAAL,OACA,IACI,KAAK,WAAW,KAAK,IAAI,SAEzB,KAAK,UAAW,KAAK,IAAI,QACxB,KAAK,IAAL,S,2BAIJ,EAAiB,GACpB,KAAK,OAAO,OAAW,EAAW,K,2BAG/B,GACH,QAAkB,IAAd,EAGF,OAFA,KAAK,aACA,KAAK,WAAW,KAAK,IAAL,IAAY,IAGnC,KAAK,IAAL,GAAY,GACZ,KAAK,QACD,KAAK,UAAW,KAAK,IAAI,QACxB,KAAK,IAAL,S,gCAGG,GACR,IAAK,KAAK,MAAO,OAAO,KAAK,KAAK,GADX,IAEhB,EAAc,KAAd,WACP,KAAK,KAAK,IAAV,IAAc,EAAgC,KAAG,KAAK,eAAgB,O,4BAGlE,IACF,EAAS,mBAAmB,eAAa,KAAM,KAAK,IAAI,OAAS,kB,mCAInE,cAAY,KAAM,KAAK,IAAI,YAAc,uB,8BAIzC,QAAuB,IAAnB,KAAK,UAAyB,MAAM,IAAI,MAAM,2CAC5C,EAAN,iBAAiB,KAAK,IAAK,KAAK,a,yBAG/B,GACI,KAAK,WAAW,KAAKC,IAAL,GAAY,K,gCAGzB,EAAuB,GAC3B,EAAQ,OAAO,OAAO,KAAK,OAAQ,GAClC,KAAK,OAAS,I,iCAGV,EAAa,GAA6C,WAAtB,EAAsB,uDAAH,MAC1D,KAAD,IAAI,OAAM,WACL,EAAH,WAAW,EAAO,GACf,S,mCAIwC,IAAzC,EAAyC,uDAA3B,MAAK,EAAsB,uDAAH,MACzC,GAAD,KAAK,MAAJ,CAD4C,IAE3C,EAAoC,KAApC,IAAK,EAA+B,KAA/B,WAAY,EAAmB,KAAnB,WAAY,EAAO,KAAP,IACpC,EAAG,GAAI,KAAG,IAAH,IAAO,GAA4B,IACtC,IAAU,OAAK,EAAI,OAAO,GAAO,IACjC,EAAW,QAAU,EAAI,kBACnB,EAAJ,OAAO,KAAK,gBAChB,KAAK,aACD,IAAU,OAAK,EAAI,OAAO,GAAO,IAEvC,EAAG,U,qCAGO,IACH,EAAwC,KAAxC,IAAK,EAAmC,KAAnC,WAAY,EAAuB,KAAvB,WAAY,EAAW,KAAX,IAAK,EAAM,KAAN,GACzC,OAAO,KAED,WACJ,GAAI,EAAW,OAAQ,CAErB,KAAM,aAAsB,QAAO,MAAM,IAAI,MAAM,4BACnD,IAAM,EAAK,MAAM,QAAQ,GAAc,EAAa,CAAC,GACrD,OAAO,IAAP,IAAW,iBAAe,EAAI,EAAY,EAAG,KAAK,OAAQ,WAAS,QAErE,OAAO,MATC,GAYV,WACE,GAAI,EAAI,eAAgB,CACtB,IAAM,EAAoB,EAAI,WAAW,gBAAiB,CAAC,IAAK,EAAI,iBACpE,OAAO,IAAP,IAAY,EAAqB,GAEnC,OAAO,MAjBmB,M,gCAqBpB,EAAqB,GAC7B,OAAO,iBAAe,KAAK,GAAI,EAAM,K,qCAGxB,EAAsB,GAAoB,IAChD,EAAW,KAAX,GAAI,EAAO,KAAP,IACN,EAAG,KAAK,eACI,IAAb,EAAG,YAAsC,IAApB,EAAU,QACjC,EAAG,MAAQ,iBAAe,MAAM,EAAK,EAAU,MAAO,EAAG,MAAO,KAEjD,IAAb,EAAG,YAAsC,IAApB,EAAU,QACjC,EAAG,MAAQ,iBAAe,MAAM,EAAK,EAAU,MAAO,EAAG,MAAO,O,0CAIhD,EAAsB,GAAW,WAC5C,EAAW,KAAX,GAAI,EAAO,KAAP,IACX,GAAI,EAAG,KAAK,eAA6B,IAAb,EAAG,QAA+B,IAAb,EAAG,OAElD,OADA,EAAG,GAAIC,GAAO,kBAAM,EAAK,eAAe,EAAW,YAC5C,O,sBAtKb,YAkNA,IAAM,EAAe,sBACf,EAAwB,mCAC9B,SAAgB,EACd,EADF,GAEgD,IAE1C,EACA,EAHH,EAA6C,EAA7C,UAAW,EAAkC,EAAlC,UAAW,EAAuB,EAAvB,YAIvB,GAAc,KAAV,EAAc,OAAO,UAAE,SAC3B,GAAiB,MAAb,EAAM,GAAY,CACpB,IAAK,EAAa,KAAK,GAAQ,MAAM,IAAI,MAAJ,gCAAmC,IACxE,EAAc,EACd,EAAO,UAAE,aACJ,CACL,IAAM,EAAU,EAAsB,KAAK,GAC3C,IAAK,EAAS,MAAM,IAAI,MAAJ,gCAAmC,IACvD,IAAM,GAAc,EAAQ,GAE5B,GAAoB,OADpB,EAAc,EAAQ,IACG,CACvB,GAAI,GAAM,EAAW,MAAM,IAAI,MAAM,EAAS,iBAAkB,IAChE,OAAO,EAAY,EAAY,GAEjC,GAAI,EAAK,EAAW,MAAM,IAAI,MAAM,EAAS,OAAQ,IAErD,GADA,EAAO,EAAU,EAAY,IACxB,EAAa,OAAO,EAG3B,IAvB8C,EAuB1C,EAAO,EAvBmC,E,w5BAAA,CAwB7B,EAAY,MAAM,MAxBW,IAyB9C,2BAAgC,KAArB,EAAqB,QAC1B,IACF,EAAO,IAAH,IAAO,EAAO,cAAY,sBAAoB,KAClD,EAAO,IAAH,IAAO,EAAW,KA5BoB,8BA+B9C,OAAO,EAEP,SAAS,EAAS,EAAqB,GACrC,8BAAwB,EAAxB,YAAuC,EAAvC,wCAAyE,IApC7E,a,4oECxOA,cAEa,E,8BAKT,SAAF,EAAY,GAA8B,wBACxC,cAAM,sBACD,OAAS,EACd,EAAK,IAAM,EAAK,YAAa,EAHW,E,YALP,QAArC,oB,IAYa,E,8BAIX,WAAY,EAAgB,GAAW,wBACrC,gDAAiC,EAAjC,oBAAgD,KAC3C,WAAa,aAAW,EAAQ,GACrC,EAAK,cAAgB,cAAY,cAAY,EAAK,aAHb,E,YAJJ,QAArC,oBAWA,EAAO,QAAU,CACf,kBACA,oB,u5DC1BF,cAEA,UAyEA,SAAS,EAAS,EAAc,GAC5B,IAAI,EAAM,EAAG,MAAO,MAAO,GAC7B,EAAG,GACD,IADF,IACM,UAAE,UACN,kBAAM,EAAI,OAAO,UAAE,QAAS,IAAtB,IAA2B,MACjC,IAHF,IAGM,UAAE,QAAgB,IAEtB,EAAE,KAAK,IAAT,IAAa,UAAE,SAGjB,SAAS,EAAa,EAAe,GAAU,IACtC,EAAgC,EAAhC,IAAK,EAA2B,EAA3B,aAA2B,EAAb,UACZ,OACZ,EAAG,MAAO,IAAV,IAAkB,EAAG,gBAA2B,KAE5C,SAAO,IAAX,IAAe,GAAuB,GACtC,EAAG,QAAQ,IAvFF,eAAuC,CAClD,QAAS,gBAAE,EAAF,EAAE,QAAF,OAAe,MAAf,IAAkC,KAGhC,oBAA4C,CACrD,QAAO,gBAAE,EAAF,EAAE,QAAS,EAAX,EAAW,WAAX,OACP,EACI,MADM,IACC,EAA4B,GACnC,MAFM,IAEC,KAGf,uBACE,EACA,EACA,GAA2B,IAEpB,EAAM,EAAN,GACA,EAAiC,EAAjC,IAAK,EAA4B,EAA5B,cAAe,EAAa,EAAb,UACrB,EAAS,EAAgB,EAAK,IAChC,UAAsB,GAAiB,GACzC,EAAS,EAAK,GAEd,EAAa,EAAI,IAAL,IAAU,KAI1B,4BAAiC,EAAsB,GAA6B,IAC3E,EAAM,EAAN,GACA,EAAiC,EAAjC,IAAK,EAA4B,EAA5B,cAAe,EAAa,EAAb,UAEzB,EAAO,EADM,EAAgB,EAAK,IAE9B,GAAiB,GACrB,EAAa,EAAI,UAAE,UAIvB,4BAAiC,EAAc,GAC3C,EAAE,OAAO,UAAE,OAAQ,GACnB,EAAC,GAAI,IAAP,IAAW,UAAE,UAAoB,kBAC/BD,EAAG,GACD,GACA,kBAAM,EAAI,OAAO,IAAX,IAAe,UAAE,SAAkB,MACzC,kBAAM,EAAI,OAAO,UAAE,QAAS,aAKlC,2BAOkB,IANhB,EAMgB,EANhB,IACA,EAKgB,EALhB,QACA,EAIgB,EAJhB,YACA,EAGgB,EAHhB,KACA,EAEgB,EAFhB,UACA,EACgB,EADhB,GAGE,QAAgB,IAAd,EAAyB,MAAM,IAAI,MAAM,4BAC3C,IAAI,EAAM,EAAI,KAAK,OACnB,EAAE,SAAS,IAAK,EAAW,UAAE,QAAQ,SAAC,GACtC,EAAG,MAAO,EAAK,IAAf,IAAmB,UAAE,QAAW,IAChC,EAAG,GAAI,IAAP,IAAW,IAA8B,kBACvC,EAAI,OAAO,IAAX,IAAe,GAAgB,YAAU,UAAE,SAAU,EAAG,eAE1D,EAAI,OAAO,IAAX,IAAe,GAAkB,MAAjC,IAAuC,EAAG,cAAiB,IACvD,EAAG,KAAK,UACV,EAAI,OAAO,IAAX,IAAe,GAAc,GAC7B,EAAI,OAAOE,EAAU,EAArB,IAAe,GAAY,QAyBjC,IAAM,EAAI,CACN,QAAO,IAAI,OAAK,WAChB,WAAU,IAAI,OAAK,cACnB,OAAM,IAAI,OAAK,UACjB,aAAc,IAAI,OAAK,gBACvB,QAAS,IAAI,OAAK,WAClB,OAAQ,IAAI,OAAK,UACjB,aAAc,IAAI,OAAK,iBAGzB,SAAS,EAAgB,EAAsB,GAA6B,IAExE,EAIE,EAJF,QACA,EAGE,EAHF,KACA,EAEE,EAFF,YAJwE,EAMtE,EADF,GAAK,EALmE,EAKnE,IAAK,EAL8D,EAK9D,aAAc,EALgD,EAKhD,aAAc,EALkC,EAKlC,WAAY,EALsB,EAKtB,UAAW,EALW,EAKX,cAAe,EALJ,EAKI,aAAc,EALlB,EAKkB,KAE5F,IAAqB,IAAjB,EAAwB,OAAO,IAAP,KAP8C,IAQnE,EAAmB,EAAnB,OAAQ,EAAW,EAAX,QACT,EAAyC,CAC7C,CAAC,EAAE,QAAS,GACZ,CAAC,UAAE,SAAU,YAAU,UAAE,SAAU,IACnC,CAAC,EAAE,WAAY,MAAf,IAAqB,EAAiB,IACtC,CAAC,EAAE,OAAyB,mBAAV,EAAuB,EAAO,GAAO,GAAU,IAAJ,OAG/D,GADI,GAAc,EAAU,KAAK,CAAC,EAAE,aAAc,KAC5B,IAAlB,EAAK,SAAoB,CAC3B,IAAM,EAAwB,mBAAX,EAAwB,EAAQ,GAAO,EAC1D,EAAU,KAAK,CAAC,EAAE,QAAS,IAS7B,OAPI,EAAK,SACP,EAAU,KACR,CAAC,EAAE,OAAQ,GACX,CAAC,EAAE,aAAc,IAAjB,IAAqB,EAAe,IACpC,CAAC,UAAE,KAAM,IAGN,EAAI,OAAJ,QAAc,K,ypDC5HvB,cACA,SACA,UACA,UACA,UACA,UACA,SAqDa,EAYX,WAAY,G,MACN,G,4FADwB,SALrB,UAAmB,GACnB,oBAA2C,GAMzB,UAArB,EAAO,EAAI,UAAoB,EAAS,EAAI,QAC9C,KAAG,OAAS,EAAI,OAChB,KAAG,KAAO,EAAI,MAAQ,KACtB,KAAG,OAAmB,QAAb,EAAG,EAAI,cAAM,QAAI,cAAY,aAAM,EAAN,EAAQ,KAC9C,KAAG,UAAY,EAAI,UACnB,KAAG,KAAO,EAAI,KACd,KAAG,OAAS,aAAM,EAAN,EAAQ,OACpB,KAAG,KAAO,IAQhB,SAAgB,EAAyB,GAErC,IAAI,EAAO,EAAmB,KAAK,KAAM,GACzC,GAAE,EAAM,OAAO,EACf,IAIE,EAJE,EAAS,cAAY,EAAI,KAAK,QAJiB,EAKhC,KAAK,KAAK,KAAxB,EAL8C,EAK9C,IAAK,EALyC,EAKzC,MACL,EAAiB,KAAK,KAAtB,cACD,EAAM,IAAI,UAAQ,KAAK,MAAO,CAAC,MAAK,QAAO,kBAE7C,EAAI,SACF,EAAe,EAAI,WAAW,QAAS,CACzC,IAAK,kBACL,KAAM,IAAF,QAIN,IAAI,EAAe,EAAI,UAAU,YACjC,EAAE,aAAe,EAEjB,IA8BE,EA9BE,EAAuB,CACvB,IAAJ,EACA,UAAW,KAAK,KAAK,UACrB,KAAM,UAAE,KACJ,WAAQ,UAAE,WACd,mBAAoB,UAAE,mBACtB,UAAW,CAAC,UAAE,MACd,YAAa,CAAC,OACd,UAAW,EACX,UAAW,GACX,aAAc,EAAI,WAChB,UAC0B,IAA1B,KAAK,KAAK,KAAK,OACX,CAAC,IAAK,EAAI,OAAQ,KAAM,YAAU,EAAI,SACtC,CAAC,IAAK,EAAI,SAEZ,aAAJ,EACI,gBAAa,EACb,OAAI,EAAI,OACZ,UAAW,EACX,cAAc,EACV,OAAJ,EACA,OAAQ,EAAI,QAAU,EACtB,WAAY,MACZ,cAAe,IACf,UAAW,IAAF,KACT,KAAM,KAAK,KACP,KAAE,MAIR,IACE,KAAK,cAAc,IAAI,GACnB,EAAJ,qBAAqB,GACjB,WAAS,KAAK,KAAK,KAAK,UAE5B,IAAM,EAAe,EAAI,WACzB,EAAU,UAAM,EAAI,UAAU,UAAE,OAAtB,kBAAsC,GAE5C,KAAK,KAAK,KAAK,UAAS,EAAa,KAAK,KAAK,KAAK,QAAQ,EAAY,IAE5E,IACM,EADe,IAAI,SAAJ,UAAgB,UAAE,MAAlB,UAA6B,UAAE,OAAS,EACvB,CAAa,KAAM,KAAK,MAAM,OAUpE,GATA,KAAK,MAAM,MAAM,EAAc,CAAC,IAAK,IAErC,EAAS,OAAS,KAClB,EAAS,OAAS,EAAI,OAClB,EAAK,UAAY,EACjB,EAAI,SAAS,EAAmC,QAAS,IAC/B,IAA1B,KAAK,KAAK,KAAK,SACjB,EAAS,OAAS,CAAC,eAAc,eAAc,YAAa,EAAI,UAE9D,KAAK,KAAK,YAAa,KAClB,EAAgB,EAAhB,MAAO,EAAS,EAAT,MACd,EAAS,UAAY,CACnB,MAAO,aAAiB,YAAO,EAAY,EAC3C,MAAO,aAAiB,YAAO,EAAY,EAC3C,aAAc,aAAiB,OAC/B,aAAc,aAAiB,QAE7B,EAAS,SAAQ,EAAS,OAAO,UAAY,YAAU,EAAS,YAGtE,OADA,EAAI,SAAW,EACR,EACP,MAAO,GAKP,aAJO,EAAI,gBACJ,EAAI,aACP,GAAY,KAAK,OAAO,MAAM,yCAA0C,GAEtE,EAtCR,QAwCE,KAAK,cAAL,OAA0B,IAwB9B,SAAS,EAA2B,GAChC,OAAE,YAAU,EAAI,OAAQ,KAAK,KAAK,YAAoB,EAAI,OACrD,EAAI,SAAW,EAAM,EAAc,KAAK,KAAM,GAIvD,SAAS,EAA8B,GAAiB,MAMjC,EAAe,EANkB,IACpC,KAAK,eAD+B,IAClD,IAAJ,uBAAsC,KAA3B,EAA2B,QACpC,GAIkC,EAJX,GAIJ,EAJD,GAKVC,SAAW,EAAG,QAAU,EAAG,OAAS,EAAG,MAAQ,EAAG,SAAW,EAAG,OALxC,OAAO,GAFa,+BAYxD,SAAS,EAEP,EACA,GAGA,IADA,IAAI,EACoC,iBAAzB,EAAM,KAAK,KAAK,KAAmB,EAAM,EACxD,OAAO,GAAO,KAAK,QAAQ,IAAQ,EAAc,KAAK,KAAM,EAAM,GAIpE,SAAgB,EAEd,EACA,GAEA,IAAM,EAAI,EAAI,MAAM,GACd,EAAU,eAAa,GACvB,EAAS,cAAY,EAAK,QAEhC,GAAI,OAAO,KAAK,EAAK,QAAQ,OAAS,GAAK,IAAY,EACrD,OAAO,EAAe,KAAK,KAAM,EAAG,GAGtC,IAAM,EAAK,cAAY,GACjB,EAAW,KAAK,KAAK,IAAO,KAAK,QAAQ,GAC/C,GAAuB,iBAAZ,EAAsB,CAC/B,IAAM,EAAM,EAAc,KAAK,KAAM,EAAM,GAC3C,GAA2B,WAAvB,EAAO,aAAG,EAAH,EAAK,QAAqB,OACrC,OAAO,EAAe,KAAK,KAAM,EAAG,GAGtC,MAAgC,WAA5B,EAAO,aAAQ,EAAR,EAAU,SAChB,EAAS,UAAU,EAAc,KAAK,KAAM,GAC7C,IAAO,cAAY,GAAa,IAAI,EAAU,CAAC,OAAQ,EAAS,OAAQ,OAAM,WAC3E,EAAe,KAAK,KAAM,EAAG,SAHpC,EAjMF,cA6BA,kBA8FA,sBAEE,EACA,EACA,G,MAEE,EAAI,aAAW,EAAQ,GACvB,IAAI,EAAY,EAAK,KAAK,GAC1B,GAAE,EAAW,OAAO,EAEtB,IAAI,EAAO,EAAQ,KAAK,KAAM,EAAM,GAClC,QAAW,IAAT,EAAoB,CACtB,IAAM,EAAuB,QAAjB,EAAG,EAAK,iBAAS,eAAG,GAC5B,IAAQ,EAAO,IAAI,EAAU,CAAC,SAAQ,OAAM,YAGhD,YAAW,IAAT,EACI,EAAK,KAAK,GAAO,EAAgB,KAAK,KAAM,QADlD,GAiCJ,kBA2BA,IAAM,EAAuB,IAAI,IAAI,CACnC,aACA,oBACA,OACA,eACA,gBAGF,SAAS,EAEP,EAFF,GAGmC,I,EAAhC,EAAgC,EAAhC,OAAQ,EAAwB,EAAxB,OAAQ,EAAgB,EAAhB,KAEjB,GAAgC,OAAV,QAAlB,IAAU,gBAAQ,eAAG,IAAzB,CAFiC,MAY7B,EAZ6B,IAGd,EAAU,SAAS,MAAM,GAAG,MAAM,MAHpB,IAGjC,2BAA2D,KAAhD,EAAgD,QACzD,GAAqB,kBAAV,EAAqB,OAEhC,QAAe,KADf,EAAS,EAAO,mBAAiB,KACP,QAErB,EAAqB,IAAI,IAA0B,UAAjB,EAAO,IAAsB,EAAO,MACzE,EAAS,aAAW,EAAQ,EAAO,OATN,8BAajC,GAAqB,kBAAV,GAAuB,EAAO,OAAS,uBAAqB,EAAQ,KAAK,OAAQ,CAC1F,IAAM,EAAO,aAAW,EAAQ,EAAO,MACvC,EAAM,EAAc,KAAK,KAAM,EAAM,GAKvC,OADA,EAAM,GAAO,IAAI,EAAU,CAAC,SAAQ,OAAM,YAClC,SAAW,EAAI,KAAK,OAAe,OAA3C,K,6EC3SF,cAEM,EAAQ,CAEV,KAAI,IAAI,OAAK,QAEb,OAAM,IAAI,OAAK,UACf,SAAQ,IAAID,EAAUE,KAAL,YACjB,WAAU,IAAIF,EAAUE,KAAL,cACnB,mBAAkB,IAAI,OAAK,sBAC3B,SAAQ,IAAI,OAAK,YACjB,eAAc,IAAI,OAAK,kBAEvB,QAAO,IAAI,OAAK,WAChB,OAAM,IAAI,OAAK,UACf,KAAI,IAAI,OAAK,QAEb,KAAI,IAAI,OAAK,QACb,MAAK,IAAI,OAAK,UAGlBL,EAAQM,QAAO,G,6YCnBf,cACA,UACA,UACA,SAMM,EAAiB,IAAI,IAAI,CAC7B,OACA,SACA,UACA,YACA,YACA,gBACA,gBACA,WACA,WACA,UACA,UACA,cACA,aACA,WACA,OACA,UAGF,qBAA0B,GAAiD,IAA9B,IAA8B,yDACvE,MAAmB,kBAAV,KACG,IAAV,GAAwB,EAAO,KAC9B,GACE,EAAU,IAAW,IAG9B,IAAM,EAAe,IAAI,IAAI,CAC3B,OACA,gBACA,mBACA,cACA,mBAGF,SAAS,EAAO,GACZ,IAAG,IAAM,KAAO,EAAQ,CACpB,KAAa,IAAI,GAAM,OAAO,EAC9B,IAAE,EAAM,EAAO,GACf,SAAM,QAAQ,IAAQ,EAAI,KAAK,GAAS,OAAO,EAC/C,GAAc,UAAd,EAAO,IAAmB,EAAO,GAAM,OAAO,EAElD,OAAK,EAGT,SAASC,EAAUH,GACf,IAAE,EAAQ,EACV,IAAG,IAAM,KAAO,EAAQ,CACpB,GAAQ,SAAR,EAAgB,OAAO,IAEvB,GADA,KACA,EAAe,IAAI,KACG,UAAtB,EAAO,EAAO,KACV,EAAN,SAAS,EAAO,IAAM,SAAC,GAAD,OAAU,GAAS,EAAU,MAEjD,IAAU,KAAU,OAAO,IAE/B,OAAK,EAGT,SAAgB,IAAwC,IAA5B,EAA4B,uDAAvB,GAAI,EAAmB,wCACpC,IAAd,IAAqB,EAAK,EAAY,IAC1C,IAAM,EAAI,EAAI,MAAM,GAClB,OAAK,EAAa,GAGtB,SAAgB,EAAa,GAC3B,OAAO,EAAI,UAAU,GAAG,MAAM,KAAK,GAAK,IAP1C,gBAMA,iBAIA,IAAM,EAAsB,QAC5B,SAAgB,EAAY,GAC1B,OAAO,EAAK,EAAG,QAAQ,EAAqB,IAAM,GADpD,gBAIA,sBAA2B,EAAgB,GAEzC,OADA,EAAK,EAAY,GACV,EAAI,QAAQ,EAAQ,IAG7B,IAAM,EAAS,wBAEfJ,EAAQ,cAAR,SAAyC,GAAiB,WACxD,GAAqB,kBAAV,EAAqB,MAAO,GACvC,IAAM,EAAW,EAAY,EAAO,KAC9B,EAA0C,CAAC,GAAI,GAC/C,EAAa,EAAY,GAAU,GACnC,EAAuB,GACvB,EAA0B,IAAI,IAsClC,OApCA,EAAO,EAAQ,CAAC,SAAS,IAAO,SAAC,EAAK,EAAS,EAAG,GAClD,QAAsB,IAAlB,EAAJ,CACA,IAAM,EAAW,EAAa,EAC1B,EAAS,EAAQ,GACC,iBAAX,EAAI,MAAiB,EAAS,EAAO,KAAK,EAAM,EAAI,MAC3D,EAAM,KAAK,EAAM,EAAI,SACrB,EAAM,KAAK,EAAM,EAAI,gBACrB,EAAI,GAAW,EAEf,SAAK,EAAkB,GAEzB,GADA,EAAM,EAAY,EAAS,EAAI,QAAQ,EAAQ,GAAO,GAClD,EAAW,IAAI,GAAM,MAAM,EAAS,GACxC,EAAWQ,IAAI,GACT,IAAF,EAAW,KAAK,KAAK,GAYnB,MAXiB,iBAAZ,IAAsB,EAAW,KAAK,KAAK,IAC/B,UAAnB,EAAO,GACT,EAAiB,EAAK,EAAS,OAAQ,GAC9B,IAAQ,EAAY,KACd,MAAX,EAAI,IACN,EAAiB,EAAK,EAAU,GAAM,GACtC,EAAU,GAAO,GAEjB,KAAK,KAAK,GAAO,GAGd,EAGL,SAAK,EAAqB,GACtB,GAAe,iBAAV,EAAoB,CACrB,IAAH,EAAO,KAAK,GAAS,MAAM,IAAI,MAAJ,0BAA6B,EAA7B,MAChC,EAAO,KAAK,KAAZ,WAAsB,SAKrB,EAEL,SAAO,EAAiB,EAAiB,EAA6B,GAClE,QAAS,IAAT,IAAuB,EAAM,EAAM,GAAO,MAAM,EAAS,GAG7D,SAAO,EAAS,GAChB,OAAO,IAAI,MAAJ,qBAAwB,EAAxB,0C,iyBC5IX,IAIM,EAAyB,IAAI,IAJhB,CAAC,SAAU,SAAU,UAAW,UAAW,OAAQ,SAAU,UAMhFR,EAAQS,WAAR,SAA2B,GACzB,MAAmB,iBAAL,GAAiB,EAAU,IAAI,IA0B/C,sBACE,IAAM,EAAsE,CAC1E,OAAQ,CAAC,KAAM,SAAU,MAAO,IAChC,OAAQ,CAAC,KAAM,SAAU,MAAO,IAChC,MAAO,CAAC,KAAM,QAAS,MAAO,IAC9B,OAAQ,CAAC,KAAM,SAAU,MAAO,KAElC,MAAO,CACL,MAAK,OAAM,GAAN,IAAc,SAAS,EAAM,SAAS,EAAM,MAAM,IACvD,MAAO,CAAC,CAAC,MAAO,IAAK,EAAO,OAAQ,EAAO,OAAQ,EAAO,MAAO,EAAO,QACxE,KAAM,CAAC,MAAO,IACd,IAAK,CAAC,MAAM,EAAM,UAAU,GAC5B,SAAU,CAAC,MAAM,EAAM,UAAU,M,0zEC7CrC,IA0BY,EA1BZ,UACA,UACA,WAwBA,SAAY,GACR,EAAF,eACE,EAAF,eAFF,CAAY,kBAAI,KAuBhB,0BAA+B,EAAkB,EAAqB,GACpE,IAAM,EAQR,SACE,EADF,GAUkB,IAPd,EAOc,EAPd,QACA,EAMc,EANd,WACA,EAKc,EALd,OACA,EAIc,EAJd,aACA,EAGc,EAHd,WACA,EAEc,EAFd,cACA,EACc,EADd,aAGA,QAAc,IAAZ,QAAoC,IAAX,EACvB,MAAE,IAAI,MAAM,wDAGhB,QAAc,IAAZ,EAAuB,CACrB,IAAE,EAAM,EAAG,OAAO,GAClB,YAAkB,IAAf,EACH,CACE,OAAQ,EACR,WAAY,IAAF,IAAM,EAAG,WAAa,cAAY,IAC5C,cAAa,UAAK,EAAG,cAAR,YAAyB,IAExC,CACE,OAAQ,EAAI,GACZ,WAAY,IAAF,IAAM,EAAG,WAAa,cAAY,GAAW,cAAY,IACnE,cAAa,UAAK,EAAG,cAAR,YAAyB,EAAzB,YAAoC,iBAAe,KAIxE,QAAe,IAAX,EAAsB,CACxB,QAAmB,IAAf,QAA8C,IAAlB,QAAgD,IAAjB,EAC7D,MAAM,IAAI,MAAM,+EAEd,MAAG,CACC,OAAN,EACM,aAAN,EACM,WAAN,EACM,aAAN,EACM,cAAN,GAIJ,MAAM,IAAI,MAAM,+CApDE,CAAa,EAAI,IAuDrC,SACE,EACA,EAFF,GAGgF,IAA7E,EAA6E,EAA7E,SAAwB,EAAqD,EAAnE,aAAsB,EAA6C,EAA7C,KAAM,EAAuC,EAAvC,UAAW,EAA4B,EAA5B,aAElD,QAAa,IAAT,QAAmC,IAAb,EACxB,MAAM,IAAI,MAAM,uDAH4D,IAMvE,EAAO,EAAP,IAEP,QAAiB,IAAb,EAAwB,KACnB,EAAgC,EAAhC,UAAW,EAAqB,EAArB,YAAa,EAAQ,EAAR,KAE/B,EADiB,EAAG,IAAK,OAAQ,IAAhB,IAAoB,EAAG,KAAO,cAAY,KAAa,IAExE,EAAU,UAAY,MAAtB,IAA4B,EAiChC,SACE,EACA,EACA,GAGA,GAAI,aAAoB,OAAM,CAC5B,IAAM,EAAW,IAAiB,EAAK,IACvC,OAAO,EACH,EACE,IADM,IACI,GACV,IAFM,IAEK,GACb,EACA,IADQ,IACE,GACV,IAFQ,IAEE,GAEhB,OAAO,EAAmB,cAAY,GAAU,WAAa,IAAM,oBAAkB,GAjD3C,CAAa,EAAU,EAAQ,EAAK,mBAC5E,EAAU,mBAAqB,IAA/B,IAAmC,GACnC,EAAU,YAAV,YAA4B,GAA5B,CAAyC,EAAU,qBAYrD,SAAS,EAAiB,GACxB,EAAU,KAAO,EACjB,EAAU,UAAY,EAAG,UAAY,EACrC,EAAU,UAAY,GACtB,EAAU,WAAa,EAAG,KAC1B,EAAU,UAAV,YAA0B,EAAG,WAA7B,CAAwC,SAd7B,IAAT,IAEF,EADiB,aAAgB,OAAO,EAAO,EAAG,IAAK,OAAQ,GAAM,SAEhD,IAAjB,IAA4B,EAAU,aAAe,IAIvD,IAAW,EAAU,UAAY,GAjFnC,CAAkB,EAAW,EAAI,GA4FrC,SACE,EADF,GAEuE,IAApE,EAAoE,EAApE,cAAe,EAAqD,EAArD,aAAc,EAAuC,EAAvC,UAAW,EAA4B,EAA5B,kBAEnB,IAAlB,IAA6B,EAAU,cAAgB,QACtC,IAAjB,IAA4B,EAAU,aAAe,QACvC,IAAd,IAAyB,EAAU,UAAY,GACnD,EAAU,aAAe,EAlGvB,CAAkB,EAAW,GAC7B,IAAI,EAAW,SAAO,GAAO,GAAd,IAAyB,WAAO,EAAW,WAAO,IAEjE,OADA,EAAF,cAAc,EAAa,GACpB,I,2ECvDT,mBAAmC,GAK/B,IAJF,IAGI,EAHE,EAAM,EAAI,OACZ,EAAS,EACT,EAAM,EAEH,EAAM,GACX,KACA,EAAQ,EAAI,WAAW,OACV,OAAU,GAAS,OAAU,EAAM,GAGrB,QAAZ,OADb,EAAQ,EAAI,WAAW,MACU,IAGnC,OAAK,I,olGCdT,cAEA,UAgBA,SAAgB,EAAkB,GAA4C,IAA7B,EAA6B,uDAAT,EAAG,OAC/D,EAAc,EAAd,KAAM,EAAQ,EAAR,KACb,GAAK,EAAK,QACY,kBAAX,EAAT,CACA,IAAI,EAAQ,EAAK,MAAM,SACvB,IAAG,IAAM,KAAO,EACX,EAAM,IAAM,kBAAgB,EAAhB,4BAAyC,EAAzC,OAIrB,SAAgB,EACd,EACA,GAEA,GAAqB,kBAAV,EAAqB,OAAQ,EACxC,IAAK,IAAM,KAAO,EAAQ,GAAIC,EAAM,GAAM,OAAO,EAC/C,OAAK,EA8BT,SAAgB,EAAkB,GAChC,MAAkB,iBAAP,EAAiB,UAAU,GAC/B,EAAI,QAAQ,KAAM,MAAM,QAAQ,MAAO,MAGhD,SAAgB,EAAoB,GAChC,OAAK,EAAI,QAAQ,MAAO,KAAK,QAAQ,MAAO,KA2BhD,SAAS,EAAT,GAKuB,IAJrB,EAIqB,EAJrB,WACA,EAGqB,EAHrB,YACA,EAEqB,EAFrB,YACA,EACqB,EADrB,aAEE,OAAK,SAAC,EAAK,EAAM,EAAI,GACjB,IAAE,OACG,IAAP,EACI,EACA,aAAc,QACb,aAAgB,OAAO,EAAW,EAAK,EAAM,GAAM,EAAY,EAAK,EAAM,GAAK,GAChF,aAAgB,QACf,EAAY,EAAK,EAAI,GAAO,GAC7B,EAAY,EAAM,GACpB,OAAG,IAAW,QAAU,aAAe,OAAiC,EAAzB,EAAa,EAAK,IA6CzE,SAAgB,EAAqB,EAAc,GACjD,IAAW,IAAP,EAAa,OAAO,EAAG,IAAK,SAAS,GACzC,IAAM,EAAQ,EAAG,IAAK,QAAS,IAAjB,MAEd,YADW,IAAP,GAAkB,EAAa,EAAK,EAAO,GACxC,EAGT,SAAgB,EAAa,EAAc,EAAa,GACtD,OAAO,KAAK,GAAI,SAAQ,SAAC,GAAD,OAAO,EAAI,OAAO,IAAX,IAAe,EAAQ,cAAY,KAAM,MAhK1E,kBAAkD,GAC9C,IADsD,EAClD,EAA0B,GADwB,IAErC,GAFqC,IAEpD,IAAJ,uBAAwB,EAAxB,UAAqC,EAFmB,8BAGtD,OAAK,GAGT,6BAAkC,EAAe,GAC7C,MAAmB,kBAAV,EAA4B,EACJ,IAA/B,OAAO,KAAK,GAAQ,SACtB,EAAgB,EAAI,IACd,EAAe,EAAQ,EAAG,KAAK,MAAM,OAG/C,sBAUA,mBASA,gCAAqC,EAAmB,GACpD,GAAmB,kBAAV,EAAqB,OAAQ,EACtC,IAAG,IAAM,KAAO,EAAQ,GAAY,SAAR,GAAkB,EAAM,IAAI,GAAM,OAAO,EACvE,OAAO,GAGT,4BAEE,EACA,EACA,GAAsB,IAHrB,EAGqB,EAHrB,aAAc,EAGO,EAHP,WAKf,IAAK,EAAO,CACV,GAAqB,iBAAV,GAAuC,kBAAV,EAAqB,OAAO,EACpE,GAAqB,iBAAV,EAAoB,OAAO,IAAP,IAAW,GAE1C,OAAK,IAAP,IAAW,EAAe,EAAa,cAAY,KAGrD,4BAAiC,GAC7B,OAAK,EAAoB,mBAAmB,KAGhDV,EAAQ,eAAR,SAA+B,GAC7B,OAAO,mBAAmB,EAAkB,KAG9CA,EAAQ,kBAAR,EAKA,wBAIA,oBAA4B,EAAa,GACvC,GAAI,MAAM,QAAQ,GAAK,WACL,GADK,IACrB,2BAAoB,EAApB,SADqB,oCAGrB,EAAE,IA4CO,iBAAiC,CAC1C,MAAK,EAAmB,CACxB,WAAY,SAAC,EAAK,EAAM,GAAZ,OACV,EAAG,GAAI,IAAP,IAAW,EAAkB,IAAsB,WACjD,EAAG,GACD,IADF,IACM,IACJ,kBAAM,EAAI,OAAO,GAAI,MACrB,kBAAM,EAAI,KAAK,IAAT,IAA2B,EAAO,WAG9C,YAAa,SAAC,EAAK,EAAM,GAAZ,OACX,EAAG,GAAI,IAAP,IAAW,IAAe,YACX,IAAT,EACF,EAAI,OAAO,GAAI,IAEf,EAAI,OAAO,EAAI,IAAf,IAAmB,IACnB,EAAa,EAAK,EAAI,QAG5B,YAAa,SAAC,EAAM,GAAP,OAAwB,IAAT,UAA2B,GAAS,IAChE,aAAc,IAEhB,MAAO,EAAmB,CACxB,WAAY,SAAC,EAAK,EAAM,GAAZ,OACV,EAAG,GAAI,IAAP,IAAW,EAAkB,IAAsB,kBACjD,EAAI,OAAO,EAAI,IAAf,IAAmB,EAA0B,EAAQ,EAAU,EAAQ,QAE3E,YAAa,SAAC,EAAK,EAAM,GAAZ,OACX,EAAG,GAAI,IAAP,IAAW,IAAe,kBACxB,EAAI,OAAO,GAAa,IAAT,GAAuB,IAAvB,IAA2B,EAAQ,EAAU,EAAQ,QAExE,YAAa,SAAC,EAAM,GAAP,OAAwB,IAAT,GAAuB,KAAK,IAAI,EAAM,IAClE,aAAc,SAAC,EAAK,GAAN,OAAgB,EAAG,IAAK,QAAS,OAInD,yBAOA,kB,0BC1JA,SAAgB,EAAe,EAAyB,GACpD,OAAK,EAAM,MAAM,MAAK,SAAC,GAAD,OAAU,EAAc,EAAQ,MAG1D,SAAgB,EAAc,EAAyB,G,MACrD,YAC2B,IAAzB,EAAO,EAAK,WACc,QADQ,EAClC,EAAK,WAAL,kBAA0B,eAAE,MAAK,SAAC,GAAD,YAAyB,IAAhB,EAAO,O,iHAfrD,mCAEE,GAAc,IADb,EACa,EADb,OAGK,EAFQ,EADL,KAGU,MAAM,MAAM,GAC7B,OAAK,IAAmB,IAAV,GAAkB,EAAe,EAAQ,IAG3D,mBAIAA,EAAQW,cAAgBA,G,wgBCdxB,aACA,UACA,UAEMC,EAAoC,CACtCC,QAAO,2BAyBX,SAAS,EAAiB,EAAe,GAA2B,IAG5D,EAAuB,CAC3B,IAHkB,EAAb,IAIL,QAAS,eACL,KALc,EAAR,KAMN,QAAI,EACJ,YAAQ,EACR,aAAS,EACT,OAAI,GACJ,GAAJ,GAEA,EAAF,YAAY,EAAK,EAAW,GAnC9B,gCAAqC,GAAa,IACzC,EAA6B,EAA7B,IAAK,EAAwB,EAAxB,OAAQ,EAAgB,EAAhB,cACL,IAAX,EACF,EAAiB,GAAI,GACK,UAAjB,EAAOT,KAAwC,IAAlBA,EAAOU,OACzCb,EAAD,OAAQ,UAAE,OAEb,EAAI,OAAO,IAAX,IAAe,GAAuB,MAClCA,EAAD,QAAQ,KAIfD,EAAQ,kBAAR,SAAkC,EAAe,GAAW,IACnD,EAAe,EAAf,KACQ,IADO,EAAV,QAEV,EAAG,IAAK,GAAO,GACX,EAAa,IAEjB,EAAG,IAAK,GAAO,K,wsGCrBnB,IAMY,EANZ,UACI,EAAJ,QACA,SACA,UACA,UAqBA,SAAgB,EAAa,GACzB,IAAI,EAAmB,MAAM,QAAQ,GAAM,EAAK,EAAK,CAAC,GAAM,GAC5D,GAAE,EAAM,MAAM,cAAa,OAAO,EACpC,MAAM,IAAI,MAAM,wCAA0C,EAAM,KAAK,OAtBvE,SAAY,GACR,EAAF,uBACE,EAAF,mBAFF,CAAY,0BAAQ,KAKpB,0BAA+B,GAC3B,IAAI,EAAQ,EAAa,EAAO,MAEhC,GADc,EAAM,SAAS,SAEzB,IAAoB,IAApB,EAAO,SAAoB,MAAM,IAAI,MAAM,8CAC1C,CACD,IAAC,EAAM,aAA8B,IAApB,EAAO,SACpB,UAAI,MAAM,6CAEM,IAApB,EAAO,UAAmB,EAAM,KAAK,QAE3C,OAAO,GAGT,iBAMA,kCAAuC,EAAkB,GAAiB,IACjE,EAAmB,EAAnB,IAAK,EAAc,EAAd,KAAM,EAAQ,EAAR,KACZ,EAeR,SAAuBe,EAAmB,GACtC,OAAK,EACH,EAAM,QAAO,SAAC,GAAD,OAAO,EAAU,IAAI,IAAuB,UAAhB,GAAiC,UAAN,KACpE,GAlBa,CAAc,EAAO,EAAK,aACrC,EACJ,EAAM,OAAS,KACO,IAApB,EAAS,QAAiC,IAAjB,EAAM,QAAgB,wBAAsB,EAAI,EAAM,KACjF,GAAE,EAAY,CACV,IAAE,EAAY,EAAe,EAAO,EAAM,EAAK,OAAQ,EAAS,OAChE,EAAD,GAAI,GAAW,WACZ,EAAS,OAcnB,SAAoB,EAAkB,EAAmB,GAAoB,IACpE,EAAmB,EAAnB,IAAK,EAAc,EAAd,KAAM,EAAQ,EAAR,KACZ,EAAW,EAAG,IAAK,WAAYZ,EAAUa,EAA9B,IAA+B,IAC1C,EAAU,EAAG,IAAK,UAAW,IAAnB,MACS,UAArB,EAAK,aACH,EAAD,GAAI,IAAP,IAAW,EAAyC,EAAY,IAAoB,kBAClF,EACG,OAAO,EAAM,IADhB,IACoB,IACjB,OAAO,EAAU,IAFpB,IAE+B,IAF/B,GAGM,EAAe,EAAO,EAAM,EAAK,SAAS,kBAAM,EAAI,OAAO,EAAS,SAG5E,EAAC,GAAI,IAAP,IAAW,IAZgE,Q,w5BAAA,CAa3D,GAb2D,IAavE,IAAJ,uBAA0B,KAAf,EAAe,SACpB,EAAU,IAAI,IAAa,UAAN,GAAsC,UAArB,EAAK,cAC7C,EAAmB,IAfoD,8BA2BzE,SAAO,EAAmB,GACtB,OAAI,GACA,IAAD,SAMK,YALA,EACL,OAAO,IADV,IACc,EAA2B,IACtC,OAAO,EAAS,IAFnB,IAE4B,IACzB,OAAO,IAHV,IAGc,IACX,OAAO,EAAS,IAJnB,MAMI,IAAD,SAOH,YANA,EACG,OACC,IAFJ,IAEQ,EAA4B,EACxBC,EAA2B,EAAW,EAAY,IAE3D,OAAO,EAAS,IALnB,IAKwB,IAEpB,IAAD,UAOK,YANA,EACL,OACC,IAFJ,IAEQ,EAA6B,EACzB,EAA4B,EAAW,EAAY,EAAa,IAEzE,OAAO,EAAS,IALnB,IAKwB,IAEpB,IAAD,UAMK,YALA,EACL,OAAO,IADV,IACc,EAAuB,EAAiB,IACnD,OAAO,GAAS,GAChB,OAAO,IAHV,IAGc,EAAsB,IACjC,OAAO,GAAS,GAErB,IAAK,OAGH,OAFA,EAAI,OAAO,IAAX,IAAe,EAAkB,EAAiB,SAClD,EAAI,OAAO,EAAS,MAGtB,IAAK,QACH,EACG,OACC,IAFJ,IAEQ,EAA4B,EACzB,EAA6B,IAErC,OAAO,EAAS,IALnB,IAKwB,KApD5BhB,EAAC,OACD,EAAc,GACd,EAAE,QAEF,EAAC,GAAI,IAAP,IAAW,IAAyB,WAC9B,SAAO,EAAM,GAoDrB,WAA+E,GAAU,IAA9D,EAA8D,EAA9D,IAAK,EAAyD,EAAzD,WAAY,EAA6C,EAA7C,mBAExC,EAAC,GAAI,IAAP,IAAW,IAA4B,kBACrC,EAAI,OAAO,IAAX,IAAe,EAAc,GAAuB,MAtDhD,CAAa,EAAI,MAtCE,CAAW,EAAI,EAAO,GACtC,EAAgB,MAGvB,OAAK,GAGT,IAAMiB,EAA2B,IAAI,IAAI,CAAC,SAAU,SAAU,UAAW,UAAW,SAyFpF,SAAgB,EACd,EACA,EACA,GAC0B,IAGtB,EAHJ,EAA0B,uDAAhB,EAAS,QAEb,EAAK,IAAY,EAAS,QAAU,YAAU,GAAK,YAAU,IAEjE,OAAM,GACN,IAAK,OACH,OAAO,IAAP,IAAW,EAAQ,GACrB,IAAK,QACH,EAAO,IAAH,IAAqB,GACzB,MACF,IAAK,SACH,EAAO,IAAH,IAAO,EAAkB,EAAsC,GACnE,MACF,IAAK,UACH,EAAO,EAAQ,IAAD,IAAO,EAAuB,IAC5C,MACE,IAAC,SACH,EAAO,IACP,MACF,QACE,OAAO,IAAP,IAAkB,EAAQ,EAAM,GAElC,OAAK,IAAY,EAAS,QAAU,EAAO,MAAI,GAE/C,SAAO,IAAyB,IAAjB,EAAiB,uDAAH,MAC7B,OAAO,MAAI,IAAJ,IAAe,GAAoB,EAAO,EAAa,IAAH,IAAgB,GAAU,QAIzF,SAAgB,EACd,EACA,EACA,EACA,GAEE,GAAuB,IAArB,EAAU,OACZ,OAAO,EAAc,EAAU,GAAI,EAAM,EAAY,GAEvD,IAAI,EACE,EAAQ,SAAO,GACnB,GAAE,EAAM,OAAS,EAAM,OAAQ,CAC/B,IAAM,EAAS,IAAH,IAAc,GAC1B,EAAO,EAAK,KAAQ,EAAS,IAAtB,IAA2B,EAAW,UACtC,EAAK,YACL,EAAM,aACN,EAAM,YAET,EAAG,MAGP,IAAG,IAAM,KADP,EAAM,eAAe,EAAM,QACf,EAAO,EAAO,MAAI,EAAM,EAAc,EAAe,EAAM,EAAY,IACrF,OAAK,EAvDT,kBAiCAlB,EAAQmB,eAAiBA,EA2BzB,IAAM,EAAoC,CACxC,QAAS,gBAAE,EAAF,EAAE,OAAF,OAAc,MAAd,IAA8B,IACvC,OAAQ,gBAAE,EAAF,EAAE,OAAQ,EAAV,EAAU,YAAV,MACW,iBAAV,EAAqB,IAA5B,IAAuC,GAAY,IAAnD,IAA8D,KAGlE,SAAgB,EAAgB,GAC9B,IAAM,EAIR,SAA6B,GAAgB,IACpC,EAAqB,EAArB,IAAK,EAAgB,EAAhB,KAAM,EAAU,EAAV,OACZ,EAAa,iBAAe,EAAI,EAAQ,QAC9C,MAAO,CACL,MACA,QAAS,OACT,OACA,OAAQ,EAAO,KACf,aACA,YAAa,EACb,aAAc,EACd,OAAQ,GACR,MAhBU,CAAoB,GAChC,cAAY,EAAK,GAFnB,qB,ogBChNA,cACA,UAaA,SAAS,EAAc,EAAkB,EAAuB,GAAqB,IAC5E,EAAkC,EAAlC,IAAK,EAA6B,EAA7B,cAAe,EAAc,EAAd,KAAM,EAAQ,EAAR,KACjC,QAAqB,IAAjB,EAAJ,CACE,IAAI,EAAY,IAAH,IAAO,EAAO,cAAY,IACvC,GAAE,EACE,EAAJ,gBAAgB,EAAhB,kCAA+C,QAD/C,CAKA,IAAE,EAAY,IAAH,IAAO,GACK,UAArB,EAAK,cACP,EAAY,IAAH,IAAO,EAAgB,EAAyB,IAIzD,EAAC,GAAI,EAAW,IAAlB,IAAsB,EAAe,YAAU,OA1BjD,0BAA+B,EAAkB,GAAW,MAC9B,EAAG,OAAxB,EADmD,EACnD,WAAY,EADuC,EACvC,MACjB,GAAS,WAAP,GAAmB,EACrB,IAAK,IAAM,KAAO,EAChB,EAAc,EAAI,EAAK,EAAW,GAAX,aAET,UAAP,GAAkB,MAAM,QAAQ,IACzC,EAAM,SAAQ,SAAC,EAAK,GAAN,OAAoB,EAAc,EAAI,EAAG,EAAG,c,2sFCR9D,aACA,UACA,UACA,UACA,UACA,UACA,UAcA,SAAS,EAAT,EAEE,GAAW,IADV,EACU,EADV,IAAK,EACK,EADL,aAAc,EACT,EADS,OAAQ,EACjB,EADiB,UAAW,EAC5B,EAD4B,KAGnC,EAAK,KAAK,IACR,OAAK,EAAc,IAAvB,IAA2B,UAAE,KAAS,UAAE,QAAU,EAAU,QAAQ,WAClE,EAAI,KAAK,IAAT,IAA2B,EAAc,EAAQ,KAiBvD,SAA8B,EAAc,GACxC,EAAC,GACD,UAAE,QACF,WACE,EAAG,IAAK,UAAE,SAAU,IAApB,IAAwB,UAAE,OAAU,UAAE,WAClC,EAAD,IAAK,UAAE,WAAY,IAAtB,IAA0B,UAAE,OAAU,UAAE,aACxC,EAAG,IAAK,UAAE,mBAAoB,IAA9B,IAAkC,UAAE,OAAU,UAAE,qBAChD,EAAG,IAAK,UAAE,SAAU,IAApB,IAAwB,UAAE,OAAU,UAAE,WAClC,EAAK,YAAY,EAAG,IAAK,UAAE,eAAgB,IAA1B,IAA8B,UAAE,OAAU,UAAE,oBAEnE,WACE,EAAG,IAAK,UAAE,SAAU,IAApB,MACI,EAAD,IAAK,UAAE,WAAY,IAAtB,MACA,EAAG,IAAK,UAAE,mBAAoB,IAA9B,MACA,EAAG,IAAK,UAAE,SAAU,UAAE,MAClB,EAAK,YAAY,EAAG,IAAK,UAAE,eAAgB,IAA1B,SA/BrB,CAAqB,EAAK,GAC1B,EAAI,KAAK,MAGX,EAAI,KAAK,EAAc,IAAvB,IAA2B,UAAE,KAMjC,SAA2B,GACvB,OAAK,IAAP,IAAY,UAAE,SAAgB,UAAE,WAAe,UAAE,mBAAuB,UAAE,SAAY,UAAE,KACtF,EAAK,WAAa,IAAlB,IAAwB,UAAE,gBAAsB,OARV,CAAkB,IAAS,EAAU,QAAQ,kBACjF,EAAI,KAAK,EAAc,EAAQ,IAAO,KAAK,MAqDjD,SAAS,EAAc,EAAmB,GACtC,MAAsB,UAAjB,EAAO,IAAsB,EAAO,MAAQ,EAAK,KAAK,QAAU,EAAK,KAAK,SAC7E,IADG,IACe,EAAO,KACzB,MAeN,SAAgB,EAAhB,GAA2D,IAAxB,EAAwB,EAAxB,OAAQ,EAAgB,EAAhB,KACvC,GAAmB,kBAAV,EAAqB,OAAQ,EACtC,IAAG,IAAM,KAAO,EAAQ,GAAI,EAAK,MAAM,IAAI,GAAM,OAAO,EACxD,OAAK,EAGT,SAAS,EAAY,GACjB,MAAyB,kBAAb,EAAG,OAcnB,SAAS,EAAc,GACnB,EAAF,kBAAkB,GAUpB,SAA8B,GAAgB,IACrC,EAAqC,EAArC,OAAQ,EAA6B,EAA7B,cAAe,EAAc,EAAd,KAAM,EAAQ,EAAR,KAChC,EAAO,MAAQ,EAAK,uBAAyB,uBAAqB,EAAQ,EAAK,QACjF,EAAK,OAAO,KAAZ,oDAA8D,EAA9D,MAZA,CAAmB,GAGvB,SAAS,EAAgB,EAAkB,GACvC,IAAI,EAAQ,iBAAe,EAAG,QAC1B,EAAe,yBAAuB,EAAI,GAC9C,EAAF,eAAe,EAAI,GAAQ,EAAc,GAyB3C,SAAS,EAAT,GAAmF,IAA1D,EAA0D,EAA1D,IAAK,EAAqD,EAArD,UAAW,EAA0C,EAA1C,OAAQ,EAAkC,EAAlC,cAAe,EAAmB,EAAnB,KACxD,EAAM,EAAO,SACjB,IAAoB,IAAlB,EAAK,SACHlB,EAAA,KAAK,IAAT,IAAa,UAAE,KAAmB,SAC7B,GAA4B,mBAAjB,EAAK,SAAwB,CACzC,IAAE,EAAa,MAAH,IAAS,GACnB,EAAW,EAAI,WAAW,OAAQ,CAAC,IAAK,EAAU,OACxD,EAAI,KAAK,IAAT,IAAa,UAAE,KAAsB,EAAQ,EAAe,KAyBhE,SAAgB,EAAgB,EAAe,GAAkC,IAArB,EAAqB,uDAAd,EAAG,KAAK,OACzE,GAAK,EAAL,CAEA,GADA,EAAG,uBAAmB,IACT,IAAT,EAAe,MAAM,IAAI,MAAM,GACnC,EAAG,KAAK,OAAO,KAAK,IAxLtB,gCAAqC,GAC/B,EAAY,KACV,EAAU,GACV,EAAkB,IAmD1B,SAA0B,GAAgB,IACjC,EAAqB,EAArB,OAAQ,EAAa,EAAb,KAAM,EAAO,EAAP,IACrB,EAAiB,GAAI,WACf,EAAK,UAAY,EAAO,UAAU,EAAe,GA4EzD,SAAwB,GAAgB,IAC/B,EAAgB,EAAhB,OAAQ,EAAQ,EAAR,UACQ,IAAnB,EAAM,SAA0B,EAAK,aAAe,EAAK,QACvD,EAAY,EAAI,yCA9EpB,CAAe,GACf,EAAG,IAAK,UAAE,QAAS,MACnB,EAAG,IAAK,UAAE,OAAQ,GACd,EAAK,aAOb,SAAwB,GAAgB,IAE/B,EAAqB,EAArB,IAAK,EAAgB,EAAhB,aACV,EAAC,UAAY,EAAG,MAAO,YAAa,IAAvB,IAA2B,IACxC,EAAC,GAAI,IAAP,IAAW,EAAG,YAA0B,kBAAM,EAAI,OAAO,IAAX,IAAe,EAAG,WAAmB,IAArC,SAC5C,EAAC,GAAI,IAAP,IAAW,EAAG,YAA0B,kBAAM,EAAI,OAAO,IAAX,IAAe,EAAG,WAAmB,IAArC,SAZtB,CAAe,GACrC,EAAgB,GAiGpB,SAAuB,GAAa,IAC3B,EAAuD,EAAvD,IAAK,EAAkD,EAAlD,UAAW,EAAuC,EAAvC,aAAc,EAAyB,EAAzB,gBAAiB,EAAQ,EAAR,KAClD,EAAU,OAEZ,EAAG,GACD,IADF,IACM,UAAE,SACN,kBAAM,EAAG,OAAQ,UAAE,SACnB,kBAAM,EAAG,MAAO,IAAV,IAAkB,EAA2B,UAAE,cAGvD,EAAI,OAAO,IAAX,IAAe,GAAuB,UAAE,SACpC,EAAK,aAKb,YAAkE,IAAxC,EAAwC,EAAxC,IAAK,EAAmC,EAAnC,UAAW,EAAwB,EAAxB,MAAO,EAAiB,EAAjB,MAC3C,aAAiB,QAAM,EAAI,OAAO,IAAX,IAAe,GAAmB,GACzD,aAAiB,QAAM,EAAI,OAAO,IAAX,IAAe,GAAmB,GAPrC,CAAgB,GACtC,EAAG,OAAQ,IAAX,IAAe,UAAE,UA5GjB,CAAc,MA3DN,CAAW,GAIrB,EAAiB,GAAI,kBAAM,uBAAqB,OA2ElD,yBAA8B,EAAe,GACvC,EAAY,KACV,EAAU,GACV,EAAkB,IAkB1B,SAA0B,EAAkB,GAAW,IAC9C,EAAqB,EAArB,OAAQ,EAAa,EAAb,IAAa,EAAR,KACX,UAAY,EAAO,UAAU,EAAe,GAkCvD,SAAuB,GACjB,EAAG,OAAO,MAAK,EAAG,OAAS,aAAW,EAAG,OAAQ,EAAG,OAAO,MAlC/D,CAAc,GAqChB,SAAoB,GAChB,GAAE,EAAG,OAAO,SAAW,EAAG,UAAU,OAAQ,MAAM,IAAI,MAAM,+BArC9D,CAAW,GACT,IAAI,EAAY,EAAG,MAAO,QAAS,UAAE,QACrC,EAAc,EAAI,GAEpB,EAAG,IAAK,EAAO,IAAf,IAAmB,EAAiB,UAAE,SAzBlC,CAAiB,EAAI,GAIvB,EAAF,kBAAkB,EAAI,IAGxB,sBAsFA,qB,o/CC9LA,cACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UAsCA,SAAS,EAAgB,EAAkB,GAAgB,IAEvDA,EAGE,EAHFA,IACA,EAEE,EAFF,OAEE,EADF,KAAO,aAEQ,iBAAe,EAAI,EAAM,MACxC,EAAE,OAAM,WAAK,UACM,EAAM,OADZ,IACb,2BAAgC,KAArB,EAAqB,QAC1B,gBAAc,EAAQ,IACxB,cAAY,EAAI,EAAK,QAAS,EAAK,WAAY,EAAM,OAH5C,kCAqDjB,SAAS,EAAa,EAAgB,GACpC,OAAO,EAAG,SAAS,IAAa,YAAN,GAAmB,EAAG,SAAS,UAG3D,SAAS,EAAiB,EAAkB,GAC1C,IAAM,EAAa,EAAG,UAAU,OAAS,EAAG,cAC5C,GAAG,eAAY,EAAZ,mBACH,kBAAgB,EAAI,EAAK,EAAG,KAAK,aAvGnC,0BACE,EACA,EACA,EACA,GAAgB,IAET,EAA4C,EAA5C,IAAK,EAAuC,EAAvC,OAAQ,EAA+B,EAA/B,KAAM,EAAyB,EAAzB,UAAW,EAAc,EAAd,KAC9B,EAD4C,EAAR,KACpC,MAWL,SAAO,EAAc,GAChB,iBAAe,EAAQ,KACxB,EAAM,MACF,EAAH,GAAI,gBAAc,EAAM,KAAM,EAAM,EAAK,SACtC,EAAU,EAAI,GACC,IAAjB,EAAM,QAAgB,EAAM,KAAO,EAAM,MAAQ,IACnD,EAAG,OACH,kBAAgB,IAElB,EAAI,SAEJ,EAAgB,EAAI,GAGjB,GAAW,EAAG,GAAI,IAAP,IAAW,UAAE,OAAc,GAAa,MAxBtD,EAAO,OAAS,EAAK,uBAA0B,uBAAqB,EAAQ,IA4ClF,SAA0BmB,EAAkB,IACtC,EAAG,UAAU,MAAS,EAAG,KAAK,cAMpC,SAA2B,EAAkB,GACtC,EAAM,SACN,EAAG,UAAU,QAIhB,EAAI,SAAQ,SAAC,GACR,EAAa,EAAG,UAAW,IAC9B,EAAiB,EAAD,gBAAc,EAAd,qCAA4C,EAAG,UAAU,KAAK,KAA9D,SAGlB,EAAC,UAAY,EAAG,UAAU,QAAO,SAAC,GAAD,OAAO,EAAa,EAAO,OARxD,EAAD,UAAY,GARjB,CAAkB,EAAI,GACjB,EAAG,KAAK,iBAkBf,SAA4B,EAAkB,GACxC,EAAG,OAAS,IAAqB,IAAd,EAAG,SAAgB,EAAG,SAAS,UACpD,EAAiB,EAAI,mDApBO,CAAmB,EAAI,GAwBvD,SAA2B,EAAkB,GACzC,IAAI,EAAQ,EAAG,KAAK,MAAM,IAC1B,IAAG,IAAM,KAAW,EAAO,CACvB,IAAE,EAAO,EAAM,GACnB,GAAmB,UAAf,EAAO,IAAoB,gBAAc,EAAG,OAAQ,GAAO,KACtD,EAAQ,EAAK,WAAb,KACH,EAAK,SAAW,EAAK,MAAK,SAAC,GAAD,OAOU,EAPmB,GAOtC,EAPkC,GAQ9C,SAAS,IAAmB,WAAT,GAAqB,EAAM,SAAS,WADtE,IAA2B,EAAmB,MANtC,EAAiB,EAAD,wBAAsB,EAAK,KAAK,KAAhC,0BAAsD,EAAtD,QA9BpB,CAAgB,EAAI,EAAG,YA5CvB,CAAe,EAAI,GACnB,EAAE,OAAM,WAAK,UACO,EAAM,OADb,IACb,2BAAiC,EAAjC,SADa,8BAET,EAAU,EAAM,UANhB,SAAM,kBAAM,cAAY,EAAI,OAAS,EAAM,IAAI,KAAc,iB,k6BCXrE,cACA,SACA,UACA,UACA,UA0CA,SAAS,EAAgB,EAAiB,G,MACjC,EAAiD,EAAjD,IAAK,EAA4C,EAA5C,QAAS,EAAmC,EAAnC,OAAQ,EAA2B,EAA3B,aAAc,EAAa,EAAb,MAAO,EAAM,EAAN,IA4EpD,WAA+C,GAA0B,IAApD,EAAoD,EAApD,UACnB,GAAI,EAAI,QAAU,EAAU,OAAQ,MAAM,IAAI,MAAM,gCA5ElD,CAAS,EAAI,GACb,IAAI,GACH,GAAS,EAAI,QAAU,EAAI,QAAQ,KAAK,EAAG,KAAM,EAAQ,EAAc,GAAM,EAAI,SAC9E,EAAc,EAAW,EAAK,EAAS,GACvC,EAAQ,EAAG,IAAK,SAqCpB,SAAO,IAAsD,IAA1C,EAA0C,uDAA3B,EAAI,MAAQ,IAAZ,KAAwB,MACpD,EAAU,EAAG,KAAK,YAAc,eAAS,UAAE,KAC3C,IAAgB,YAAa,IAAQ,IAAyB,IAAf,EAAI,QACzD,EAAI,OACF,EACA,IAFF,IAEM,EAAS,mBAAiB,EAAK,EAAa,EAAS,IACzD,EAAI,WAIR,SAAS,EAAW,G,MAClB,EAAG,GAAI,MAAa,QAAV,EAAC,EAAI,aAAK,QAAI,GAAQ,GA/ChC,EAAE,WAAW,GAGb,WACA,IAAmB,IAAf,EAAI,OACN,IACI,EAAI,WAAW,EAAW,GAC9B,GAAW,kBAAM,EAAI,eAChB,CACL,IAAM,EAAW,EAAI,MAMvB,WACA,IAAM,EAAW,EAAG,IAAK,WAAY,MAUrC,OATI,EAAD,KACD,kBAAM,EAAY,IAAD,SACjB,SAAC,GAAD,OACE,EAAI,OAAO,GAAO,GAAlB,GACE,IADF,IACM,EAAgB,EAAG,kBACvB,kBAAM,EAAI,OAAO,EAAU,IAArB,IAAyB,OAC/B,kBAAM,EAAG,MAAO,SAGf,EAjBwB,IAqBzB,EAAe,EAAAJ,EAAH,IAAO,GACrB,SAAO,EAAc,MACzB,EAAY,OACL,GAvBD,EAAI,WAAW,EAAW,GAC9B,GAAW,kBA6CjB,SAAiB,EAAiB,GAAU,IACnC,EAAO,EAAP,IACP,EAAG,GACD,IADF,IACoB,IAClB,WACE,EACG,OAAO,UAAE,QAAS,IADrB,IACyB,UAAE,QAAsB,EAAU,UAAE,QAAkB,IAC5E,OAAO,UAAE,OAAQ,IAFpB,IAEwB,UAAE,UAC1B,eAAa,MAEf,kBAAM,EAAI,WAvDS,CAAQ,EAAK,MAkBhC,IACM,KA7BN,EAAE,GAAY,QAAV,EAAC,EAAI,aAAK,QAAI,GAkDtB,SAAS,EAAW,GAAe,IAC1B,EAAiB,EAAjB,IAAK,EAAY,EAAZ,KAAM,EAAM,EAAN,GAClB,EAAG,GAAI,EAAG,YAAY,kBAAM,EAAI,OAAO,EAAM,IAAjB,IAAqB,EAAG,WAAc,EAAG,wBAqBvE,SAAS,EAAW,EAAc,EAAiB,GACjD,QAAe,IAAX,EAAsB,MAAM,IAAI,MAAJ,mBAAsB,EAAtB,wBAChC,OAAO,EAAI,WACT,UACiB,mBAAV,EAAuB,CAAC,IAAK,GAAU,CAAC,IAAK,EAAQ,KAAM,YAAU,KA3HhF,uBACE,EACA,EACA,EACA,GAEA,IAAM,EAAM,IAAI,UAAW,EAAI,EAAK,GAChC,SAAU,EACZ,EAAI,KAAK,EAAK,GACL,EAAI,OAAS,EAAI,SAC1B,EAAgB,EAAK,GACZ,UAAW,EAOxB,SAA0B,EAAiB,GAA2B,IAC7D,EAA0C,EAA1C,IAAK,EAAqC,EAArC,QAAS,EAA4B,EAA5B,OAAQ,EAAoB,EAApB,aAAc,EAAM,EAAN,GACrC,EAAc,EAAI,MAAM,KAAK,EAAG,KAAM,EAAQ,EAAc,GAC5D,EAAY,EAAW,EAAK,EAAS,IACZ,IAA3B,EAAG,KAAK,gBAA0B,EAAG,KAAK,eAAe,GAAa,GAExE,IAAI,EAAQ,EAAI,KAAK,SACrB,EAAE,UACF,CACE,OAAQ,EACR,WAAY,MACZ,cAAa,UAAK,EAAG,cAAR,YAAyB,GACtC,aAAc,EACd,eAAe,GAEjB,GAEA,EAAE,KAAK,GAAO,kBAAM,EAAI,OAAM,MAvB9B,CAAiB,EAAK,IACb,EAAI,SAAW,EAAI,WACxB,EAAY,EAAK,K,6mFCJzB,cACQ,aADD,UAKP,cAAQ,wEAAG,4EAAK,wFAAW,4EAAK,8EAAY,oFAmB5C,aACA,UACA,UACA,UACA,UACA,UACA,UAEA,UAEM,EAAyC,CAAC,mBAAoB,cAAe,eAC7E,EAAkB,IAAI,IAAI,CAC9B,WACA,UACA,OACA,SACA,UACA,UACA,UACA,gBACA,OACA,MACA,UA4FI,EAA8C,CAChD,cAAa,GACb,OAAM,gDACN,SAAQ,8CACR,aAAY,mDACZ,WAAU,wDACV,YAAW,sEACX,YAAW,oEACX,WAAU,oCACV,SAAQ,mDACR,eAAc,0CACd,eAAc,0CACd,cAAa,0CACb,YAAW,6CACX,eAAc,+EACd,MAAK,8CACL,UAAS,+CAGP,EAAoD,CACtD,sBAAqB,GACrB,iBAAgB,GAChB,QAAO,sEAoBX,SAAS,EAAgB,G,4BACjB,EAAiB,QAAX,EAAGK,EAAE,cAAM,SACjB,IAAY,GAAS,MACrB,EAAc,QAAT,EAAG,EAAE,YAAI,eAAE,SAChB,GAAqB,IAAV,QAA4B,IAAV,EAAsB,EAAI,GAAS,EACpE,MAAK,CACL,SACA,YAA0B,QAAf,EAAE,EAAE,mBAAW,QAAI,EAC9B,aAA4B,QAAhB,EAAE,EAAE,oBAAY,QAAI,EAChC,KAAM,EAAE,KAAF,OAAa,EAAE,MAAf,IAAqB,aAAY,CAAC,YACxC,aAA4B,QAAhB,EAAE,EAAE,oBAAY,QAAI,IAC5B,SAAgB,QAAZ,EAAE,EAAE,gBAAQ,QAAI,IACpB,KAAQ,QAAR,EAAE,EAAE,YAAI,SACZ,SAAoB,QAAZ,EAAE,EAAE,gBAAQ,SACpB,WAAwB,QAAd,EAAE,EAAE,kBAAU,SACxB,cAA8B,QAAjB,EAAE,EAAE,qBAAa,SAC1B,eAA4B,QAAlB,EAAE,EAAE,sBAAc,SAC5B,gBAA8B,QAAnB,EAAE,EAAE,uBAAe,U,IAUjB,E,WAkBjB,SAAF,IAA8B,IAAlB,EAAkB,uDAAF,GAAE,UAZjB,KAAJ,QAAyC,GACzC,UAA+C,GAC3C,KAAJ,QAA4C,GAE5C,mBAAgC,IAAI,IAC5B,cAAyD,GACzD,YAAoC,IAAI,IAOnD,EAAG,KAAK,KAAL,OAAgB,GAAS,EAAgB,IADpB,MAEP,KAAK,KAAK,KAAxB,EAFqB,EAErB,IAAK,EAFgB,EAEhB,MACR,KAAC,MAAQ,IAAI,aAAW,CAAC,MAAO,GAAI,SAAU,EAAiB,MAAK,UACpE,KAAC,OAAS,EAAU,EAAK,QACzB,IAAE,EAAY,EAAK,gBACnB,EAAC,iBAAkB,EAEvB,KAAK,MAAQ,aACb,EAAa,KAAK,KAAM,EAAgB,EAAM,iBAC9C,EAAa,KAAK,KAAM,EAAmB,EAAM,aAAc,QAC/D,KAAK,UAAY,EAAqB,KAAK,MAEvC,EAAK,SAAS,EAAkB,KAAK,MACrC,KAAC,mBACD,KAAC,wBACD,EAAK,UAAU,EAAmB,KAAK,KAAM,EAAK,UAC9B,UAApB,EAAO,EAAK,OAAkB,KAAK,cAAc,EAAK,MACtD,EAAc,KAAK,MACnB,EAAC,gBAAkB,E,gEAIjB,KAAD,WAAW,Y,8CAGG,MACG,KAAK,KAApB,EADY,EACZ,MADY,EACL,MACF,GAAO,KAAK,cAAc,EAAgB,EAAe,KAAK,K,oCAGjE,IACF,EAAQ,KAAK,KAAb,KACD,OAAE,KAAK,KAAK,YAA6B,UAAf,EAAO,GAAmB,EAAK,KAAO,OAAO,I,+BAW7E,EACI,GAEJ,IAAI,EACJ,GAA2B,iBAAhB,GAET,KADA,EAAI,KAAK,UAAa,IACd,MAAM,IAAI,MAAJ,qCAAwC,EAAxC,WAEd,EAAI,KAAK,QAAW,GAGtB,IAAM,EAAQ,EAAE,GAEhB,MADM,WAAY,IAAI,KAAK,OAAS,EAAE,QAC/B,I,8BAQY,EAAmB,GAChC,MAAM,KAAK,WAAW,EAAQ,GAC9B,OAAE,EAAI,UAAY,KAAK,kBAAkB,K,mCAkB/C,EACA,GAEA,GAAmC,mBAAxBxB,KAAK,KAAK,WACnB,MAAM,IAAI,MAAM,2CAHJ,IAKP,EAAc,KAAK,KAAnB,WACP,OAAO,EAAgB,KAAK,KAAM,EAAQ,GAN5B,SAQC,EARD,qFAQd,WAEE,EACA,GAHF,sGAKQ,EAAe,KAAK,KAAM,EAAQ,SAL1C,cAMQ,EAAM,KAAK,WAAW,EAAS,GANvC,kBAOS,EAAI,UAAY,EAAc,KAAK,KAAM,IAPlD,iDARc,+BAkBC,EAlBD,mFAkBd,WAAyC,GAAzC,oFACM,GAAS,KAAK,UAAU,GAD9B,gCAEU,EAAgB,KAAK,KAAM,CAAC,SAAO,GAF7C,iDAlBc,+BAwBC,EAxBD,mFAwBd,WAAwC,GAAxC,kHAEWA,KAAK,kBAAkB,IAFlC,mCAIU,gBAAa,kBAJvB,yCAKI,EAAY,KAAK,KAAjB,MALJ,UAMU,EAAkB,KAAK,KAAM,KAAE,eANzC,iCAOW,EAAc,KAAK,KAAM,IAPpC,0DAxBc,sBAmCR,SAAG,EAAT,GAAiF,IAAjC,EAAiC,EAAhD,cAAoB,EAA4B,EAA5B,WACnD,GAAI,KAAK,KAAK,GACZ,MAAM,IAAI,MAAJ,oBAAuB,EAAvB,0BAA4C,EAA5C,wBArCI,SAyCC,EAzCD,mFAyCd,WAA4C,GAA5C,sGACwB,EAAY,KAAK,KAAM,GAD/C,UACQ,EADR,OAEO,KAAK,KAAK,GAFjB,gCAE6B,EAAe,KAAK,KAAM,EAAQ,SAF/D,OAGO,KAAK,KAAK,IAAM,KAAK,UAAU,EAAS,EAAK,GAHpD,iDAzCc,+BA+CC,EA/CD,mFA+Cd,WAAsC,GAA5B,IAAV,EAAU,OAAV,qCAAY,OAAZ,kCACQ,EAAI,KAAK,SAAS,IAD1B,yCAEgB,GAFhB,gCAIkB,KAAK,SAAS,GAAO,EAAW,GAJlD,sEAMW,KAAK,SAAS,GANzB,0EA/Cc,yB,gCA4Dd,EACI,EACA,G,IAOA,EANJ,E,uDAAkB,KAAK,KAAK,eAEtB,GAAF,MAAM,QAAQ,GAAS,WACP,GADO,IACf,IAAV,wBAAY,IAAD,EAAX,QAA0B,KAAK,UAAU,OAAK,EAAW,EAAO,IADvC,8BAEjB,OAAD,KAGT,GAAsB,WAAlB,EAAO,SAEE,KADX,EAAK,EAAO,MACyB,iBAAN,EAAgB,MAAM,IAAI,MAAM,4BAK3D,OAHN,EAAM,cAAY,GAAO,GACzB,KAAK,aAAa,GAClB,KAAK,QAAQ,GAAO,KAAK,WAAW,EAAQ,EAAO,GAAiB,GAC7D,O,oCAMP,EACA,G,IACA,E,uDAAkB,KAAK,KAAK,eAG5B,OADA,KAAK,UAAU,EAAQ,GAAK,EAAM,GAC3B,O,qCAIM,EAAmB,GAChC,GAAqB,kBAAV,EAAqB,OAAO,EACjC,IAAF,EAEJ,QAAgB,KADhB,EAAU,EAAO,UAC8B,iBAAX,EAClC,MAAM,IAAI,MAAM,4BAGlB,KADM,EAAI,GAAW,KAAK,KAAK,aAAe,KAAK,eAIjD,OAFA,KAAK,OAAO,KAAK,6BACjB,KAAK,OAAS,MACP,EAET,IAAM,EAAQ,KAAK,SAAS,EAAS,GACrC,IAAK,GAAS,EAAiB,CAC7B,IAAM,EAAU,sBAAwB,KAAK,aAC7C,GAAiC,QAA7B,KAAK,KAAK,eACT,MAAM,IAAI,MAAM,GADmB,KAAK,OAAO,MAAM,GAGtD,OAAC,I,gCAKc,GAErB,IADA,IAAI,EACkD,iBAAvC,EAAM,EAAU,KAAK,KAAM,KAAsB,EAAS,EACzE,QAAY,IAAR,EAAmB,CACrB,IAAM,EAAO,IAAI,YAAU,CAAC,OAAQ,KAEpC,KADA,EAAM,gBAAc,KAAK,KAAM,EAAM,IAC3B,OACV,KAAK,KAAK,GAAU,EAEhB,OAAE,EAAI,UAAY,KAAK,kBAAkB,K,mCAOpC,GACX,GAAI,aAAwB,OAG1B,OAFA,KAAK,kBAAkB,KAAK,QAAS,GACrC,KAAK,kBAAkB,KAAK,KAAM,GAC3B,KAET,SAAe,IACb,IAAK,YAIH,OAHA,KAAK,kBAAkB,KAAK,SAC5B,KAAK,kBAAkB,KAAK,MAC5B,KAAK,OAAO,QACL,KACT,IAAK,SACH,IAAM,EAAM,EAAU,KAAK,KAAM,GAIjC,MAHkB,UAAd,EAAO,IAAiB,KAAK,OAAL,OAAmB,EAAI,eAC5C,KAAK,QAAQ,UACb,KAAK,KAAK,GACV,KAET,IAAK,SACH,IAAM,EAAW,EACjB,KAAK,OAAL,OAAmB,GACnB,IAAI,EAAK,EAAa,IAMtB,OALI,IACF,EAAK,cAAY,UACV,KAAK,QAAQ,UACb,KAAK,KAAK,IAEZ,KAET,QACE,MAAM,IAAI,MAAM,0C,oCAKR,GAAuB,UACjB,GADiB,IACnC,gCAAW,EAAX,QAA+B,KAAK,WAAW,IADZ,8BAEnC,OAAO,O,iCAIP,EACA,G,IAEI,E,OACJ,GAAuB,iBAAZ,EACT,EAAU,EACQ,UAAd,EAAO,KACT,KAAK,OAAO,KAAK,4DACjB,EAAI,QAAU,OAEX,IAAuB,UAAnB,EAAO,SAAgC,IAAR,EAOxC,MAAM,IAAI,MAAM,kCAJhB,GADA,GADA,EAAM,GACQ,QACV,MAAM,QAAQ,KAAa,EAAQ,OACrC,MAAM,IAAI,MAAM,0DAOpB,GADA,EAAa,KAAK,KAAM,EAAS,IAC5B,EAEH,OADA,WAAS,GAAS,SAAC,GAAD,OAAS,EAAQ,KAAK,EAAM,MACvC,KAET,EAAkB,KAAK,KAAM,GAC7B,IAAM,EAAU,OACX,GADW,IAEd,KAAM,eAAa,EAAI,MACvB,WAAY,eAAa,EAAI,cAQzB,OANN,WACE,EAC2B,IAA3B,EAAW,KAAK,OACZ,SAAC,GAAD,OAAO,EAAQ,KAAK,EAAM,EAAG,IAC7B,SAAC,GAAD,OAAO,EAAW,KAAK,SAAQ,SAAC,GAAD,OAAO,EAAQ,KAAK,EAAM,EAAG,EAAY,QAEvE,O,iCAGE,GACT,IAAM,EAAO,KAAK,MAAM,IAAI,GAC5B,MAAsB,UAAf,EAAO,GAAmB,EAAK,aAAe,I,oCAIzC,GAAe,IAEpB,EAAS,KAAT,aACA,EAAM,SAAS,UACf,EAAM,IAAI,GAJU,UAKP,EAAM,OALC,IAK3B,2BAAiC,KAAtB,EAAsB,QACzB,EAAI,EAAM,MAAM,WAAU,SAAC,GAAD,OAAU,EAAK,UAAY,KACvD,GAAK,GAAG,EAAM,MAAM,OAAO,EAAG,IAPT,8BAS3B,OAAO,O,gCAIC,EAAc,GAGtB,MAFqB,iBAAV,IAAoB,EAAS,IAAI,OAAO,IACnD,KAAK,QAAQ,GAAQ,EACd,O,uCAIP,E,uDAA2C,KAAK,O,yDACU,G,IAAzD,iB,MAAY,K,MAAM,e,MAAU,O,EAE7B,OAAK,GAA4B,IAAlB,EAAO,OACf,EACJ,KAAI,SAAC,GAAD,gBAAU,GAAV,OAAoB,EAAE,SAAtB,YAAkC,EAAE,YACxC,QAAO,SAAC,EAAM,GAAP,OAAe,EAAO,EAAY,KAHD,c,sCAM7B,EAA6B,GAC3C,IAAM,EAAQ,KAAK,MAAM,IACzB,EAAa,KAAK,MAAM,KAAK,UAAU,IAFkC,UAG/C,GAH+C,IAGzE,2BAAgD,OACxC,EADwC,QACjB,MAAM,KAAK,MAAM,GAC1C,EAAW,EAF+B,IAG5B,GAH4B,IAG9C,2BAA4B,EAAW,EAAvC,SAH8C,8BAK9C,IAAK,IAAM,KAAO,EAAO,CACvB,IAAM,EAAO,EAAM,GACnB,GAAmB,UAAf,EAAO,GAAX,CAFuB,IAGhB,EAAS,EAAK,WAAd,MACD,EAAS,EAAS,GACpB,GAAS,IAAQ,EAAS,GAAO,EAAa,OAbmB,8BAiBzE,OAAO,I,wCAGiB,EAAiD,GACzE,IAAK,IAAM,KAAU,EAAS,CAC5B,IAAM,EAAM,EAAQ,GACf,IAAS,EAAM,KAAK,KACL,iBAAP,SACF,EAAQ,GACN,IAAQ,EAAI,OACrB,KAAK,OAAL,OAAmB,EAAI,eAChB,EAAQ,Q,iCAOrB,EACA,GAEmC,IADnC,EACmC,uDADlB,KAAK,KAAK,eAC3B,EAAmC,uDAAvB,KAAK,KAAK,cAEtB,GAAqB,UAAjB,EAAO,IAAuC,kBAAV,EACtC,MAAM,IAAI,MAAM,oCAElB,IAAI,EAAM,KAAK,OAAO,IAAI,GAC1B,QAAY,IAAR,EAAmB,OAAO,EAE9B,IAAM,EAAY,gBAAc,KAAK,KAAM,GAC3C,EAAM,IAAI,YAAU,CAAC,SAAQ,OAAM,cACnC,KAAK,OAAO,IAAI,EAAI,OAAQ,GAC5B,IAAM,EAAK,EAAI,OAOf,OANI,IAAc,EAAG,WAAW,OAE1B,GAAI,KAAK,aAAa,GAC1B,KAAK,KAAK,GAAM,GAEd,GAAgB,KAAK,eAAe,GAAQ,GACzC,I,mCAGY,GACnB,GAAI,KAAK,QAAQ,IAAO,KAAK,KAAK,GAChC,MAAM,IAAI,MAAJ,iCAAoC,EAApC,uB,wCAIgB,GAKxB,GAJI,EAAI,KAAM,KAAK,mBAAmB,GACjC,gBAAc,KAAK,KAAM,IAGzB,EAAI,SAAU,MAAM,IAAI,MAAM,4BACnC,OAAO,EAAI,W,yCAGc,GACzB,IAAM,EAAc,KAAK,KACzB,KAAK,KAAO,KAAK,UACjB,IACE,gBAAc,KAAK,KAAM,GAD3B,QAGE,KAAK,KAAO,Q,sBAUlB,SAAS,EAEP,EACA,EACA,GAC+B,IAA/B,EAA+B,uDAAP,QAExB,IAAK,IAAM,KAAO,EAAW,CAC3B,IAAM,EAAM,EACR,KAAO,GAAS,KAAK,OAAO,GAAZ,UAAoB,EAApB,oBAAmC,EAAnC,aAA2C,EAAU,MAI7E,SAAS,EAAqB,GAE5B,OADA,EAAS,cAAY,GACd,KAAK,QAAQ,IAAW,KAAK,KAAK,GAG3C,SAAS,IACP,IAAM,EAAc,KAAK,KAAK,QAC9B,GAAK,EACL,GAAI,MAAM,QAAQ,GAAc,KAAK,UAAU,QAC1C,IAAK,IAAM,KAAO,EAAa,KAAK,UAAU,EAAY,GAAmB,GAGpF,SAAS,IACP,IAAK,IAAM,KAAQ,KAAK,KAAK,QAAS,CACpC,IAAM,EAAS,KAAK,KAAK,QAAQ,GAC7B,GAAQ,KAAK,UAAU,EAAM,IAIrC,SAAS,EAEP,GAEA,GAAI,MAAM,QAAQ,GAChB,KAAK,cAAc,QAIrB,IAAK,IAAM,KADX,KAAK,OAAO,KAAK,oDACK,EAAM,CAC1B,IAAM,EAAM,EAAK,GACZ,EAAI,UAAS,EAAI,QAAU,GAChC,KAAK,WAAW,IAIpB,SAAS,IACP,IAD2B,EACrB,EAAQ,KAAO,KAAK,MADC,IAET,GAFS,IAE3B,kCAA8C,EAA9C,SAF2B,8BAG3B,OAAO,EA9eT,YAeS,kBAAkB,kBAClB,kBAAkB,kBAie3B,IAAM,EAAS,CAAC,IAAD,aAAW,KAAX,aAAsB,MAAtB,cAEf,SAAS,EAAU,GACjB,IAAe,IAAX,EAAkB,OAAO,EAC7B,QAAe,IAAX,EAAsB,OAAO,QACjC,GAAI,EAAO,KAAO,EAAO,MAAQ,EAAO,MAAO,OAAO,EACtD,MAAM,IAAI,MAAM,qDAGlB,IAAM,EAAe,yBAErB,SAAS,EAAwB,EAA4B,GAAuB,IAC3E,EAAS,KAAT,MAKP,GAJA,WAAS,GAAS,SAAC,GACjB,GAAI,EAAM,SAAS,GAAM,MAAM,IAAI,MAAJ,kBAAqB,EAArB,wBAC/B,IAAK,EAAa,KAAK,GAAM,MAAM,IAAI,MAAJ,kBAAqB,EAArB,yBAEhC,GACD,EAAI,SAAW,SAAU,MAAO,aAAc,GAChD,MAAM,IAAI,MAAM,yDAIpB,SAAS,EAEP,EACA,EACA,GAAmB,I,EAAA,OAEb,EAAO,aAAU,EAAV,EAAY,KACzB,GAAI,GAAY,EAAM,MAAM,IAAI,MAAM,+CAHnB,IAIZ,EAAS,KAAT,MACH,EAAY,EAAO,EAAM,KAAO,EAAM,MAAM,MAAK,qBAAE,OAAmB,KAM1E,GALK,IACH,EAAY,CAAC,KAAM,EAAU,MAAO,IACpC,EAAM,MAAM,KAAK,IAEnB,EAAM,SAAS,IAAW,EACrB,EAAL,CAEA,IAAM,EAAa,CACjB,UACA,WAAU,OACL,GADK,IAER,KAAM,eAAa,EAAW,MAC9B,WAAY,eAAa,EAAW,eAGpC,EAAW,OAAQ,EAAc,KAAK,KAAM,EAAW,EAAM,EAAW,QACvE,EAAU,MAAM,KAAK,GAC1B,EAAM,IAAI,GAAW,EACA,QAArB,IAAU,kBAAW,SAAE,SAAQ,SAAC,GAAD,OAAS,EAAK,WAAW,OAG1D,SAAS,EAAyB,EAAsB,EAAY,GAClE,IAAM,EAAI,EAAU,MAAM,WAAU,SAAC,GAAD,OAAW,EAAM,UAAY,KAC7D,GAAK,EACP,EAAU,MAAM,OAAO,EAAG,EAAG,IAE7B,EAAU,MAAM,KAAK,GACrB,KAAK,OAAO,KAAZ,eAAyB,EAAzB,qBAIJ,SAAS,EAA6B,GAAsB,IACrD,EAAc,EAAd,gBACc,IAAf,IACA,EAAI,OAAS,KAAK,KAAK,QAAO,EAAa,EAAa,IAC5D,EAAI,eAAiB,KAAK,QAAQ,GAAY,IAGhD,IAAM,EAAW,CACf,KAAM,kFAGR,SAAS,EAAa,GACpB,MAAO,CAAC,MAAO,CAAC,EAAQ,M,wxBCjyB1B,cACA,SACA,UACA,UASM,EAA6B,CAC/B,QAAO,kBACP,KAAI,QACJ,WAAU,CAAC,UAAW,UACtB,OAAM,cACN,MAVkC,CAClC,QAAO,gBAAW,EAAX,EAAE,OAAS,IAAX,OAAqB,MAArB,IAAqD,IAC5D,OAAM,gBAAW,EAAX,EAAE,OAAS,IAAX,OAAqB,IAArB,IAAiC,KASvC,KAN+B,SAM5B,GAAe,IACX,EAAuC,EAAvC,IAAK,EAAkC,EAAlC,OAAQ,EAA0B,EAA1B,aAAc,EAAY,EAAZ,KAAM,EAAM,EAAN,GACjC,EAAS,EAAT,MACH,GAAC,MAAM,QAAQ,GAAf,CAIA,EAAD,OAAQ,EACP,IAAE,EAAM,EAAG,MAAO,MAAO,IAAjB,IAAqB,IAC7B,IAAW,IAAX,EACI,EAAF,UAAU,CAAC,IAAK,EAAM,SACpB,EAAF,KAAK,IAAT,IAAa,EAAU,EAAM,cACxB,GAAqB,UAAjB,EAAO,KAAuB,oBAAkB,EAAI,GAAS,CAChE,MAAQI,EAAG,IAAK,QAAS,IAAjB,IAAqB,EAAU,EAAM,SAC7C,EAAH,GAAI,MAAI,IAAQ,kBAIrB,SAAuB,GACrB,EAAI,SAAS,IAAK,EAAM,OAAQ,GAAK,SAAC,GACpC,EAAI,UAAU,CAAC,QAAS,kBAAmB,SAAU,EAAG,aAAc,OAAK,KAAM,GAC5E,EAAG,WAAW,EAAG,GAAI,MAAI,IAAQ,kBAAM,EAAG,cAPxB,CAAc,MACvC,EAAI,GAAG,SAXP,kBAAgB,EAAI,0EAuB1B,UAAe,G,soDC7Cf,cACA,UACA,UACA,SACA,UAaM,EAAsD,CACxD,QAAO,uBACP,KAAI,CAAC,UACL,WAAU,CAAC,UAAW,UACtB,gBAAc,EACd,aAAW,EACX,MAXkC,CAClC,QAAO,wCACP,OAAM,gBAAE,EAAF,EAAE,OAAF,OAAc,IAAd,IAAuC,EAAO,sBAUpD,KAPwD,SAOrD,GAAG,IACC,EAAkD,EAAlD,IAAK,EAA6C,EAA7C,OAAQ,EAAqC,EAArC,aAAc,EAAuB,EAAvB,KAAM,EAAiB,EAAjB,UAAW,EAAM,EAAN,GAE/C,IAAC,EAAW,MAAM,IAAI,MAAM,4BAH1B,IAIC,EAAmB,EAAnB,UAAW,EAAQ,EAAR,KAEd,GADA,EAAD,OAAQ,EACmB,QAA1B,EAAK,mBAA8B,oBAAkB,EAAI,GAAzD,CACA,IAAE,EAAQ,sBAAoB,EAAa,YACzC,EAAW,sBAAoB,EAAa,mBAK1C,EAAF,MAAM,MAAO,GAAM,SAAC,GACjB,EAAM,QAAW,EAAS,OAC1B,EAAG,GAIR,SAAkB,GACd,IAAF,EACE,GAAF,EAAM,OAAS,EAAG,CAEpB,IAAM,EAAc,iBAAe,EAAI,EAAa,WAAY,cAChE,EAAc,IAAH,IAAO,EAA8B,QAEhD,EADS,EAAM,OACD,eAAM,EAAM,KAAI,SAAC,GAAD,OAAO,IAAP,IAAW,EAAW,QAEtC,MAKV,OAHF,EAAS,SACH,EAAM,cAAG,GAAH,SAAmB,EAAS,KAAI,SAAC,GAAD,OAAO,IAAP,IAAW,aAAW,EAAK,GAAW,UAE/E,IAAP,IAAa,GAlBC,CAAa,IAAM,kBAAM,EAAuB,MADrB,EAAuB,MAJ9D,KAAG,IAAP,IAAW,EAAiB,UAAE,SA0B1B,SAAK,EAAiB,GAClB,EAAF,KAAK,IAAT,IAAoB,EAAQ,IAG1B,SAAK,EAAuB,GACxB,GAAwB,QAA1B,EAAK,kBAA+B,EAAK,mBAA+B,IAAX,EACvD,EAAS,OADb,CAKA,IAAS,IAAX,EAIM,OAHA,EAAJ,UAAU,CAAC,mBAAoB,IAC3B,EAAJ,aACC,GAAW,EAAG,SAIf,GAAe,UAAjB,EAAO,KAAuB,oBAAkB,EAAI,GAAS,CACvD,IAAF,EAAQ,EAAI,KAAK,SACO,YAA1B,EAAK,kBACP,EAAsB,EAAK,GAAO,GAClC,EAAG,GAAI,MAAI,IAAQ,WACjB,EAAI,QACJ,EAAiB,QAGnB,EAAsB,EAAK,GACtB,GAAW,EAAG,GAAI,MAAI,IAAQ,kBAAM,EAAG,cAK9C,SAAK,EAAsB,EAAW,EAAa,GAC/C,MAA2B,CAC/B,QAAS,uBACT,SAAU,EACV,aAAc,OAAK,IACnB,aAAc,EAAG,eAEJ,IAAX,GACF,OAAO,OAAO,EAAW,CACvB,eAAe,EACf,cAAc,EACd,WAAW,IAGf,EAAI,UAAU,EAAW,MAK/B,UAAe,G,6ECpHf,cAEM,EAA6B,CAC/B,QAAO,QACP,WAAU,QACV,KAH+B,SAG5B,GAAe,IACX,EAAmB,EAAnB,IAAK,EAAc,EAAd,OAAQ,EAAM,EAAN,GAEhB,IAAC,MAAM,QAAQ,GAAS,MAAM,IAAI,MAAM,4BACxC,IAAE,EAAQ,EAAI,KAAK,SACnBG,EAAG,SAAQ,SAAC,EAAgB,GACxB,IAAF,oBAAkB,EAAI,GAApB,CACA,MAAS,EAAI,UAAU,CAAC,QAAS,QAAS,WAAY,GAAI,GAC1D,EAAF,GAAG,GACDkB,EAAF,eAAe,SAKzBtB,EAAQM,QAAO,G,kPCnBf,cACA,UAIM,EAA6B,CAC/B,QAAO,QACP,WAAU,QACV,aAAW,EACX,KAJ+B,SAI5B,GAAe,IACX,EAAmB,EAAnB,IAAK,EAAc,EAAd,OAAQ,EAAM,EAAN,GAEhB,IAAC,MAAM,QAAQ,GAAS,MAAM,IAAI,MAAM,4BAExC,IADgB,EAAO,MAAK,SAAC,GAAD,OAAoB,oBAAkB,EAAI,OACtD,EAAG,KAAK,YAAxB,CAEA,IAAE,EAAQ,EAAG,IAAK,SAAS,GACzB,EAAW,EAAI,KAAK,UAEtB,SAAM,kBACR,EAAO,SAAQ,SAAC,EAAiB,GAC/B,IAAM,EAAS,EAAI,UACjB,CACE,QAAS,QACT,WAAY,EACZ,eAAe,GAEjB,GAEF,EAAI,OAAOJ,EAAO,IAAlB,IAAsB,EAAY,IACnB,EAAI,oBAAoB,EAAQ,IAGlC,EAAG,GAAI,MAAI,UAI5B,EAAI,OACF,GACA,kBAAM,EAAI,WACV,kBAAM,EAAI,OAAM,QAGpB,MAAO,CACL,QAAS,sCAIb,UAAe,G,4iCC3Cf,cACA,SACA,UACA,UAiBM,EAA6B,CAC/B,QAAO,WACP,KAAI,QACJ,WAAU,CAAC,SAAU,WACrB,OAAM,cACN,aAAW,EACX,MAfkC,CAClC,QAAO,oBAAE,OAAS,EAAX,EAAW,IAAK,EAAhB,EAAgB,IAAhB,YACC,IAAR,EACI,MADJ,IACkC,GAC9B,MAFJ,IAEkC,EAAwB,IAC1D,OAAM,oBAAE,OAAS,EAAX,EAAW,IAAK,EAAhB,EAAgB,IAAhB,YACE,IAAR,EAAoB,IAApB,IAAsC,GAAS,IAA/C,IAAiE,EAAqB,KAUtF,KAP+B,SAO5B,GAAe,IAEd,EACA,EAFG,EAAuC,EAAvC,IAAK,EAAkC,EAAlC,OAAQ,EAA0B,EAA1B,aAAc,EAAY,EAAZ,KAAM,EAAM,EAAN,GAGjC,EAA4B,EAA5B,YAAa,EAAe,EAAf,YAChB,EAAG,KAAK,MACJ,OAAgB,IAAhB,EAA4B,EAAI,EACtC,EAAM,GAEA,IAEJ,IAAE,EAAM,EAAG,MAAO,MAAO,EAAAc,EAAjB,IAAqB,IAE7B,GADA,YAAU,CAAC,MAAK,aACR,IAAR,GAA6B,IAAR,EAArB,CAIA,QAAQ,IAAR,GAAqB,EAAM,EAG7B,OAFM,EAAN,gBAAgB,EAAhB,wDACA,EAAI,OAGF,uBAAkB,EAAI,GAAS,CAC3B,IAAF,EAAO,IAAH,IAAO,EAAU,GAGzB,YAFY,IAAR,IAAmB,EAAO,IAAH,IAAO,EAAW,EAAU,SACvD,EAAI,KAAK,GAIP,EAAD,OAAQ,EACP,IAAE,EAAQ,EAAI,KAAK,SACnB,QAAQ,IAAR,GAA6B,IAAR,EACjB,EAAQ,GAAO,kBAAM,EAAG,GAAI,GAAO,kBAAM,EAAG,kBAC7C,CACC,EAAH,IAAK,GAAO,GACT,MAAW,EAAI,KAAK,UACpB,EAAQ,EAAG,IAAK,QAAS,GAC/B,EAAc,GAAU,kBAAM,EAAG,GAAI,GAAU,kBAmBjD,SAAqB,GACnB,EAAI,KAAK,IAAT,IAAa,SACD,IAAR,EACF,EAAG,GAAI,IAAP,IAAW,EAAY,IAAO,kBAAM,EAAI,OAAO,GAAO,GAAlB,YAEpC,EAAG,GAAI,IAAP,IAAW,EAAW,IAAO,kBAAM,EAAI,OAAO,GAAO,GAAlB,WACvB,IAAR,EAAW,EAAI,OAAO,GAAO,GAC5B,EAAG,GAAI,IAAP,IAAW,EAAY,IAAO,kBAAM,EAAI,OAAO,GAAO,OA1BR,CAAY,SAE/D,SAAO,GAAO,kBAAM,EAAI,gBAzB1B,kBAAgB,EAAhB,wEA2BE,SAAK,EAAc,EAAc,GAC7B,EAAF,SAAS,IAAK,EAAG,GAAK,SAAC,GACzB,EAAI,UACF,CACE,QAAS,WACT,SAAU,EACV,aAAc,OAAK,IACnB,eAAe,GAEjB,GAEF,UAiBR,UAAe,G,6jDC/Ff,cACA,UACA,UAmBa,QAAgC,CACzC,QAAO,YAA0C,QAAxC,OAAS,EAA+B,EAA/B,SAAU,EAAqB,EAArB,UAAW,EAAU,EAAV,KACjC,EAA6B,IAAd,EAAkB,WAAa,aAChD,OAAG,MAAP,IAAyB,EAAgB,EAAsB,IAE/D,OAAM,oBAAE,OAAS,EAAX,EAAW,SAAU,EAArB,EAAqB,UAAW,EAAhC,EAAgC,KAAM,EAAtC,EAAsC,gBAAtC,OACN,IADM,IACS,EACI,EACN,EACL,KAGZ,IAAM,EAA6B,CAC/B,QAAO,eACP,KAAI,SACJ,WAAU,SACV,MAAF,QACE,KAL+B,SAK5B,GAAe,I,IAAA,G,EAOtB,YAA+C,IAAnB,EAAmB,EAAnB,OACpB,EAAqC,GACrC,EAAiC,GACrC,IAAG,IAAM,KAAO,EACJ,cAAR,KACS,MAAM,QAAQ,EAAO,IAAQ,EAAe,GACpD,GAAO,EAAO,IAEnB,MAAK,CAAC,EAAc,GAdQ,CAAkB,G,EAD5B,E,uhBACX,EADW,KACD,EADC,KAEd,EAAiB,EAAK,GACtB,EAAe,EAAK,KAe5B,SAAgB,EACd,GACqD,IAArD,EAAqD,uDAAV,EAAI,OAExC,EAAiB,EAAjB,IAAK,EAAY,EAAZ,KAAM,EAAM,EAAN,GAChB,GAAuC,IAArC,OAAO,KAAK,GAAc,OAA5B,CACA,IAAI,EAAUf,EAAG,IAAK,WAJ6B,WAK1C,GACL,IAAE,EAAO,EAAa,GACtB,GAAgB,IAAhB,EAAK,OAAc,iBACnB,IAAE,EAAc,iBAAe,EAAM,EAAM,EAAG,KAAK,eACnD,YAAU,CACN,SAAI,EACV,UAAW,EAAK,OAChB,KAAM,EAAK,KAAK,QAEd,EAAG,UACL,EAAG,GAAI,GAAa,WAAK,UACD,GADC,IACvB,2BAA4B,KAAjB,EAAiB,QAC1B,yBAAuB,EAAK,IAFP,mCAMzB,EAAG,GAAI,IAAP,IAAW,EAAmB,mBAAiB,EAAK,EAAM,KAC1D,oBAAkB,EAAK,GACvB,EAAG,SAlBL,IAAG,IAAM,KAAQ,EAAc,EAAtB,IAuBb,SAAgB,EAAmB,GAAmD,IAAlC,EAAkC,uDAAV,EAAI,OACvE,EAA0B,EAA1B,IAAK,EAAqB,EAArB,KAAM,EAAe,EAAf,QAAS,EAAM,EAAN,GACrB,EAAQ,EAAI,KAAK,SAF6D,WAGzE,GACT,GAAI,oBAAkB,EAAI,EAAW,IAAqB,iBAC1D,EAAG,GACD,iBAAe,EAAM,EAAM,EAAG,KAAK,gBACnC,WACE,IAAM,EAAS,EAAI,UAAU,CAAC,UAAS,WAAY,GAAO,GAC1D,EAAI,oBAAoB,EAAQ,MAElC,kBAAM,EAAG,IAAK,GAAO,MAEvB,EAAI,GAAG,IAVT,IAAK,IAAM,KAAQ,EAAY,EAApB,GAjCb,yBA8BA,uBAiBA,UAAe,G,iaCvGf,cACA,UACA,UASM,EAA6B,CAC/B,QAAO,KACP,WAAU,CAAC,SAAU,WACrB,aAAW,EACX,MATkC,CAClC,QAAO,gBAAE,EAAF,EAAE,OAAF,OAAc,MAAd,IAAkC,EAAO,WAChD,OAAM,gBAAE,EAAF,EAAE,OAAF,OAAc,IAAd,IAAmC,EAAO,YAQhD,KAL+B,SAK5B,GAAe,IACX,EAAyB,EAAzB,IAAK,EAAoB,EAApB,aAAc,EAAM,EAAN,QACA,IAAtB,EAAa,WAA4C,IAAtB,EAAY,MACjD,kBAAgB,EAAI,6CAElB,IAAE,EAAU,EAAU,EAAI,QACxB,EAAU,EAAU,EAAI,QAC1B,GAAC,GAAY,EAAb,CAEA,IAkBI,EAlBF,EAAQ,EAAG,IAAK,SAAS,GACzB,EAAW,EAAI,KAAK,UAItB,GAaI,EAAS,EAAI,UACjB,CACE,QAAS,KACD,eAAO,EACf,cAAc,EACN,WAAG,GAEb,GAEF,EAAI,eAAe,GAxBjB,UAEA,GAAW,EAAS,CACtB,IAAM,EAAW,EAAG,IAAK,YACnB,EAAF,UAAU,CAAC,aACT,EAAH,GAAI,EAAU,EAAe,OAAQ,GAAW,EAAe,OAAQ,SACjE,EACH,EAAH,GAAI,EAAU,EAAe,SAE1B,EAAH,GAAI,MAAI,GAAW,EAAe,SAGnC,OAAK,GAAO,kBAAM,EAAI,OAAM,MAehC,SAAS,EAAe,EAAiB,GACvC,OAAO,WACL,IAAM,EAAS,EAAI,UAAU,CAAC,WAAU,GACxC,EAAI,OAAO,EAAO,GAClB,EAAI,oBAAoB,EAAQ,GAC5B,EAAU,EAAI,OAAO,EAAU,IAArB,IAAyB,IAClC,EAAI,UAAU,CAAC,SAAU,QAMtC,SAAS,EAAU,EAAkB,GACnC,IAAM,EAAS,EAAG,OAAO,GACzB,YAAkB,IAAX,IAAyB,oBAAkB,EAAI,GAGxD,UAAe,G,6EC/Ef,cACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UAEMsB,EAAyB,CAE7B,UACA,UACA,UACA,UACA,UACA,UAEA,UACA,UACA,UAEA,UACA,UACA,UACA,UACA,WAGF,UAAe,G,wUClCf,cACA,SACA,UACA,UAEM,EAA6B,CAC/B,QAAO,QACP,KAAI,QACJ,WAAU,CAAC,SAAU,QAAS,WAC9B,OAAM,cACN,KAL+B,SAK5B,GAAe,IAqCV,EApCD,EAAuC,EAAvC,IAAK,EAAkC,EAAlC,OAAQ,EAA0B,EAA1B,aAAc,EAAY,EAAZ,KAAM,EAAM,EAAN,GAClC,EAAM,EAAG,MAAO,MAAO,IAAjB,IAAqB,IAC7B,MAAM,QAAQ,IACZ,EAAG,KAAK,aAAe,EAAO,SAAuB,IAAb,EAAG,QAC7C,EAAG,MAAQ,iBAAe,MAAM,EAAK,EAAO,OAAQ,EAAG,QAQvD,SAAmB,GACf,GAAF,EAAG,KAAK,eAyClB,SAAyB,EAAa,GACpC,OAAO,IAAQ,EAAI,WAAa,IAAQ,EAAI,WAAoC,IAAxB,EAAI,iBA1C3B,CAAgB,EAAO,OAAQ,GAAe,CACjE,IAAF,EAAG,qBAAiB,EAAO,OAAxB,mFACDC,EAAWC,gBAAH,EAAI,EAAK,EAAG,KAAK,cAE7B,MAAQ,EAAI,KAAK,SACjBC,EAAC,SAAQ,SAAC,EAAgB,GAC1B,oBAAkB,EAAI,KAClB,EAAL,GAAI,IAAP,IAAW,EAAS,IAAK,kBACvB,EAAI,UACF,CACE,QAAS,QACT,WAAY,EACZ,SAAU,EACV,aAAc,EAAG,cAEnB,MAGJ,EAAI,GAAG,OAzBT,CAAc,KAERN,EAAH,OAAQ,EACN,oBAAkB,EAAI,KA2BrB,EAAQ,EAAI,KAAK,SACjB,EAAF,SAAS,IAAK,EAAG,GAAK,SAAC,GACjB,EAAJ,UACF,CACE,QAAS,QACT,SAAU,EACV,aAAc,OAAK,IACnB,aAAc,EAAG,cAEnB,GAEG,EAAG,WAAW,EAAG,GAAI,MAAI,IAAQ,kBAAM,EAAG,cAEjD,EAAI,GAAG,OASb,UAAe,G,6ECrEf,cAIM,EAA6B,CAC/B,QAAO,MACP,WAAU,CAAC,SAAU,WACrB,aAAW,EACX,KAJ+B,SAI5B,GAAe,IACX,EAAmB,EAAnB,IAAK,EAAc,EAAd,OAAQ,EAAM,EAAN,GAChB,uBAAkB,EAAI,GACxB,EAAI,WADF,CAKA,IAAE,EAAQ,EAAI,KAAK,SACnB,YACF,CACE,QAAS,MACT,eAAe,EACf,cAAc,EACd,WAAW,GAEb,GAGF,EAAI,OACF,GACA,kBAAM,EAAI,WACV,kBAAM,EAAI,aAGd,MAAO,CACL,QAAS,wBAIb,UAAe,G,yZChCf,cACA,UAUM,EAA6B,CAC/B,QAAO,QACP,WAAU,QACV,aAAW,EACX,MATkC,CAClC,QAAO,2CACP,OAAM,gBAAE,EAAF,EAAE,OAAF,OAAc,IAAd,IAAmC,EAAO,WAQhD,KAL+B,SAK5B,GAAe,IACX,EAAmB,EAAnB,IAAK,EAAc,EAAd,OAAQ,EAAM,EAAN,GAEhB,IAAC,MAAM,QAAQ,GAAS,MAAM,IAAI,MAAM,4BACxC,IAAE,EAAsB,EACtB,EAAQ,EAAG,IAAK,SAAS,GACzB,EAAU,EAAG,IAAK,UAAW,MAC7B,EAAW,EAAI,KAAK,UACtB,YAAU,CAAC,YAGX,SAQA,WACI,EAAC,SAAQ,SAAC,EAAgB,GACtB,IAAJ,EACA,oBAAkB,EAAI,GACxB,EAAG,IAAK,GAAU,GAER,EAAD,EAAI,UACX,CACE,QAAS,QACT,WAAY,EACZ,eAAe,GAEjB,GAIA,EAAI,GACN,EAAG,GACG,IADN,IACU,EAAe,IACtB,OAAO,GAAO,GACd,OAAO,EAAS,IAHnB,IAGwB,EAAY,IAHpC,OAOF,EAAG,GAAI,GAAU,WACf,EAAI,OAAO,GAAO,GAClB,EAAI,OAAO,EAAS,GAChB,GAAQ,EAAI,eAAe,EAAQ,iBAjCzC,SACF,GACA,WAAM,SAAI,WACV,WAAM,SAAI,OAAM,QAqCtB,UAAe,G,obC1Ef,cACA,UACA,SACA,UACA,UAEM,EAA6B,CAC/B,QAAO,oBACP,KAAI,SACJ,WAAU,SACV,KAJ+B,SAI5B,GAAe,IACX,EAAuC,EAAvC,IAAK,EAAkC,EAAlC,OAAQ,EAA0B,EAA1B,KAAM,EAAoB,EAApB,aAAc,EAAM,EAAN,GACjC,EAAQ,EAAR,KACD,EAAW,mBAAiB,EAAI,GAElC,GAAoB,IAApB,EAAS,OAAT,CACA,IAAE,EAAkB,EAAK,SAAW,EAAK,yBAA2B,EAAa,WAC/E,EAAQ,EAAI,KAAK,UACN,IAAb,EAAG,OAAoB,EAAG,iBAAiB,SACvCA,EAAH,MAAQ,uBAAqB,EAAK,EAAG,QATxB,IAWX,EAAS,EAAT,OAGH,WAA8B,Q,w5BAAA,CACd,GADc,IACxB,IAAR,uBAA4B,KAAjB,EAAiB,QACtB,GAAiB,EAAwB,GACzC,EAAG,UACL,EAAmB,IAEnB,EAAG,IAAK,GAAO,GACf,EAAmB,GACnB,EAAG,GAAI,KARqB,+BAF9BO,GAeA,SAAK,EAAwB,GACzB,IAAD,IAAM,KAAQ,EACb,IAAI,OAAO,GAAK,KAAK,IACbH,EAAWC,gBACnB,EADF,mBAEc,EAFd,4BAEsC,EAFtC,mCAQF,SAAK,EAAmB,GACpB,EAAF,MAAM,MAAO,GAAM,SAAC,GACd,EAAL,GAAI,IAAP,IAAW,aAAW,EAAK,GAAa,IAAQ,WACpC,EAAN,UACF,CACE,QAAS,oBACT,WAAY,EACZ,SAAU,EACV,aAAc,OAAK,IACnB,aAAc,EAAG,cAEnB,GAEE,EAAG,KAAK,cAAyB,IAAV,EACzB,EAAI,OAAO,IAAX,IAAe,EAAS,IAAQ,GACtB,EAAG,WAGb,EAAG,GAAI,MAAI,IAAQ,kBAAM,EAAG,oBAQxC,UAAe,G,uLC3Ef,cACA,UACA,UACA,UAEMG,EAA6B,CAC/BC,QAAO,aACPC,KAAI,SACJC,WAAU,SACVrC,KAJ+B,SAI5B,GAAe,IACX,EAAuC,EAAvC,IAAK,EAAkC,EAAlC,OAAQ,EAA0B,EAA1B,aAAc,EAAY,EAAZ,KAAM,EAAM,EAAN,GACP,QAA7B,EAAG,KAAK,uBAAoE,IAAtC,EAAa,sBAC/CsC,EAAN,QAAM,KAAK,IAAI,UAAW,EAAI,UAAO,yBAEnC,IAAE,EAAW,sBAAoB,GACjC,EAAG,KAAK,aAAe,EAAS,SAAuB,IAAb,EAAG,QACzCZ,EAAH,MAAQ,iBAAe,MAAM,EAAK,SAAO,GAAW,EAAG,QAExD,IAAE,EAAa,EAAS,QAAO,SAAC,GAAD,OAAQ,oBAAkB,EAAI,EAAO,OACpE,GAAsB,IAAtB,EAAW,OAAX,CACA,IAXc,EAWZ,EAAQ,EAAI,KAAK,SAXL,E,w5BAAA,CAaC,GAbD,IAalB,2BAA+B,KAApB,EAAoB,QACzB,EAAW,GACb,EAAoB,IAEpB,EAAG,GAAI,iBAAe,EAAM,EAAM,EAAG,KAAK,gBAC1C,EAAoB,GACf,EAAG,WAAW,EAAG,OAAH,IAAe,GAAO,GACzC,EAAI,SAEE,EAAJ,GAAG,IAtBS,+BAyBd,SAAK,EAAW,GAClB,OAAO,EAAG,KAAK,cAAgB,EAAG,oBAA0C,IAAzB,EAAO,GAAP,QAGjD,SAAK,EAAoB,GACrBE,EAAF,UACF,CACE,QAAS,aACT,WAAY,EACZ,SAAU,EACV,aAAc,EAAG,cAEnB,MAMR,UAAe,G,sWC9Cf,cACA,UASM,EAA6B,CAC/B,QAAO,gBACP,KAAI,SACJ,WAAU,CAAC,SAAU,WACrB,MATkC,CAClC,QAAO,gBAAE,EAAF,EAAE,OAAF,OAAc,MAAd,IAAmC,EAAO,eACjD,OAAM,gBAAE,EAAF,EAAE,OAAF,OAAc,IAAd,IAAiC,EAAO,gBAQ9C,KAL+B,SAK5B,GAAe,IACX,EAAyB,EAAzB,IAAK,EAAoB,EAApB,OAAQ,EAAY,EAAZ,KAAM,EAAM,EAAN,GACtB,wBAAkB,EAAI,GAAtB,CACA,IAAE,EAAQ,EAAI,KAAK,SAEnB,QAAM,MAAO,GAAM,SAAC,GAChB,EAAF,UAAU,CAAC,aAAc,IACvB,EAAF,UACF,CACU,QAAC,gBACT,KAAM,EACN,UAAW,CAAC,UACZ,aAAc,EACd,eAAe,EACf,aAAc,EAAG,cAEnB,GAEF,EAAG,GAAI,MAAI,IAAQ,WACjB,EAAI,OAAM,GACL,EAAG,WAAW,EAAG,cAI1B,EAAI,GAAG,MAIX,UAAe,G,6EChDf,cAEM,EAA6B,CAC/B,QAAO,CAAC,OAAQ,QAChB,WAAU,CAAC,SAAU,WACrB,KAH+B,YAGW,IAAtC,EAAsC,EAAtC,QAAS,EAA6B,EAA7B,aAAc,EAAe,EAAf,QACH,IAApB,EAAY,IAAmB,kBAAgB,EAAhB,WAAwB,EAAxB,gCAIvC,UAAe,G,u2CCTf,cACA,UACA,UA2BA,SAAS,EAAc,EAAY,GAC/B,OAAK,IAAP,IAAgD,EAAS,GAQ3D,SAAgB,EACd,EACA,EACA,GAEE,IAAI,EAAO,IAAH,IAAO,EAAO,cAAY,IAClC,OAAK,EAAgB,IAAH,IAAO,EAAY,EAAc,EAAM,IAAc,EAG3E,SAAgB,EAAoB,GAChC,OAAK,EAAY,OAAO,KAAK,GAAW,QAAO,SAAC,GAAD,MAAa,cAAN,KAAqB,GA5C/E,kCAAuC,EAAiB,GAAY,IAC3D,EAAiB,EAAjB,IAAK,EAAY,EAAZ,KAAM,EAAM,EAAN,GAChB,EAAC,GAAI,EAAiB,EAAM,EAAM,EAAG,KAAK,gBAAgB,WACtDA,EAAA,UAAU,CAAC,gBAAiB,IAAF,IAAM,KAAS,GAC7C,EAAI,YAIR,8BAEE,EACA,GAAa,I,EAFZ,EAEY,EAFZ,KAAW,EAEC,EAFN,GAAK,KAIV,OAAK,a,+CACF,EAAW,KACZ,SAAC,GAAD,OAAU,IAAV,IAAc,EAAiB,EAAM,EAAM,EAAK,eAAsB,EAAa,Q,+iBAKzF,6BAAkC,EAAiB,GAC/C,EAAE,UAAU,CAAC,gBAAiB,IAAU,GAC1C,EAAI,SAON,0BAA+B,EAAY,EAAyB,GAChE,IAAI,EAAO,IAAH,IAAO,EAAO,cAAY,IACpC,OAAO,EAAgB,IAAH,IAAO,EAAW,EAAc,EAAM,IAAc,GAG1E,qBASA,wBAIA,4BAAiC,EAAe,GAC5C,OAAK,EAAoB,GAAW,QACpC,SAAC,GAAD,OAAQ,oBAAkB,EAAI,EAAU,QAI5C,8BAEE,EACA,EACA,GAAoB,IAHnB,EAGmB,EAHnB,WAAY,EAGO,EAHP,KAGO,IAHD,GAAK,EAGJ,EAHI,IAAK,EAGT,EAHS,aAAc,EAGvB,EAHuB,WAAY,EAGnC,EAHmC,UAAY,EAG/C,EAH+C,GAK7D,EAAgB,EAAa,IAAH,IAAO,EAAe,EAAS,EAAe,GAAe,EACvF,EAAkC,CACtC,CAAC,UAAE,SAAU,YAAU,UAAE,SAAU,IACnC,CAAC,UAAE,WAAY,EAAG,YAClB,CAAC,UAAE,mBAAoB,EAAG,oBAC1B,CAAC,UAAE,SAAU,UAAE,WAEb,EAAG,KAAK,YAAY,EAAO,KAAK,CAAC,UAAE,eAAgB,UAAE,iBACzD,IAAM,EAAO,IAAH,IAAO,EAAkB,EAAI,OAAJ,QAAc,IACjD,OAAO,IAAY,MAAM,IAAlB,IAAsB,EAAa,EAAY,GAAU,IAAzD,IAA6D,EAAQ,IAG9E,sBAA2B,EAAc,GACvC,OAAO,EAAI,WAAW,UAAW,CAC/B,IAAK,EACL,IAAK,IAAI,OAAO,EAAS,KACzB,KAAM,IAAF,IAAiB,O,2EChFzB,IAAMM,EAA6B,CAC/BC,QAAO,KACPnC,KAF+B,WAG3B,MAAE,IAAI,MAAM,0DAIpB,UAAe,G,6ECRf,cACA,UAEMuC,EAAmB,CACvB,UACA,MACA,QACA,cACA,cACA,UACA,WAGF,UAAe,G,q4BCZf,aACA,UACA,UACA,UACA,UACA,UAEML,EAA6B,CAC/BC,QAAO,OACPE,WAAU,SACVrC,KAH+B,SAG5B,GAAe,IACX,EAAmB,EAAnB,IAAK,EAAc,EAAd,OAAQ,EAAM,EAAN,GACb,EAAoD,EAApD,OAAmB,EAAiC,EAA5C,UAAgB,EAA4B,EAA5B,aAAc,EAAc,EAAd,KAAM,EAAQ,EAAR,KAG/C,GAAW,MAAX,GAA6B,OAAX,EAAiB,OAMnC,WACF,GAAI,IAAQ,EAAI,KAAM,OAAO,EAAQ,EAAK,EAAc,EAAK,EAAI,QACjE,IAAM,EAAW,EAAI,WAAW,OAAQ,CAAC,IAAK,EAAI,OAC5C,OAAC,EAAQ,EAAK,IAAN,IAAU,GAAqB,EAAI,KAAM,EAAI,KAAK,QATpB,GAC1C,IAWkB,EACd,EAZF,EAAW,aAAW,KAAK,EAAM,EAAI,KAAM,EAAQ,GACrD,QAAa,IAAb,EAAwB,MAAM,IAAI,kBAAgB,EAAQ,GAC1D,oBAAoB,aAUhB,EAAI,EAAY,EADF,EATiC,QAWrD,EAAQ,EAAK,EAAG,EAAK,EAAI,SAGvB,SAAqB,GACvB,IAAM,EAAU,EAAI,WAClB,UACqB,IAArB,EAAK,KAAK,OAAkB,CAAC,IAAK,EAAK,KAAM,YAAU,IAAQ,CAAC,IAAK,IAEjE,EAAQ,EAAI,KAAK,SACjB,EAAS,EAAI,UACjB,CACE,OAAQ,EACR,cAAc,EACd,UAAW,GACX,WAAY,MACZ,aAAc,EACd,cAAe,GAEjB,GAEF,EAAI,eAAe,GACnB,EAAI,GAAG,GA/BF,CAAgB,KAoC3B,SAAgB,EAAY,EAAiB,GAAc,IAClD,EAAO,EAAP,IACL,OAAK,EAAI,SACP,EAAI,WAAW,WAAY,CAAC,IAAK,EAAI,WACrC,IAFG,IAEC,EAAI,WAAW,UAAW,CAAC,IAAK,KAG1C,SAAgB,EAAQ,EAAiB,EAAS,EAAiB,GAAgB,IAC1E,EAAW,EAAX,IAAK,EAAM,EAAN,GACL,EAAmC,EAAnC,UAAsB,EAAa,EAAxB,UACZ,EADoC,EAAR,KACb,YAAc,eAAS,MA8B1C,SAAO,EAAc,GACjB,IAAE,EAAO,IAAH,IAAO,GACb,SAAO,UAAE,QAAS,IAAtB,IAA0B,UAAE,QAAsB,EAAU,UAAE,QAAkB,IAC5E,SAAO,UAAE,OAAQ,IAArB,IAAyB,UAAE,UAG3B,SAAO,EAAiB,G,MACpB,GAAC,EAAG,KAAK,YAAT,CACA,IAAE,EAA4B,QAAhB,EAAG,aAAG,EAAH,EAAK,gBAAQ,eAAE,UAEhC,IAAa,IAAb,EAAG,MACL,GAAI,IAAiB,EAAa,kBACL,IAAvB,EAAa,QACf,EAAG,MAAQ,iBAAe,MAAM,EAAK,EAAa,MAAO,EAAG,YAEzD,CACL,IAAM,EAAQ,EAAG,IAAK,QAAS,IAAjB,IAAqB,IACnC,EAAG,MAAQ,iBAAe,MAAM,EAAK,EAAO,EAAG,MAAO,QAGtD,IAAa,IAAb,EAAG,MACL,GAAI,IAAiB,EAAa,kBACL,IAAvB,EAAa,QACf,EAAG,MAAQ,iBAAe,MAAM,EAAK,EAAa,MAAO,EAAG,YAEzD,CACL,IAAM,EAAQ,EAAG,IAAK,QAAS,IAAjB,IAAqB,IACnC,EAAG,MAAQ,iBAAe,MAAM,EAAK,EAAO,EAAG,MAAO,UAxDxD,EAGF,WACI,IAAC,EAAI,OAAQ,MAAM,IAAI,MAAM,0CAC7B,IAAE,EAAQ,EAAG,IAAK,SAClB,EAAD,KACD,WACE,EAAI,KAAK,IAAT,IAAmB,mBAAiB,EAAK,EAAG,KAC5C,EAAiB,GACZ,GAAW,EAAI,OAAO,GAAO,MAEpC,SAAC,GACC,EAAG,GAAI,IAAP,IAAa,EAAgB,EAAG,kBAA4B,kBAAM,EAAG,MAAO,MAC5E,EAAc,GACT,GAAW,EAAI,OAAO,GAAO,MAGtC,EAAI,GAAG,GAlBG,GAsBV,EAAI,OACF,mBAAiB,EAAK,EAAG,IACzB,kBAAM,EAAiB,MACvB,kBAAM,EAAc,MApC1BM,EAAQkC,YAAcA,EAOtB,YAkEA,UAAe,G,6ECjIf,cACA,UACA,UACA,UACA,UAEMC,EAAmC,CACvC,UACA,UACA,UACA,UACA,qBACA,qBAGF,UAAe,G,00DCPf,cAkBM,EAA6B,CAC/B,QAAO,SACP,KAAI,CAAC,SAAU,UACf,WAAU,SACV,OAAK,EACL,MAVkC,CAClC,QAAO,gBAAE,EAAF,EAAE,WAAF,OAAkB,MAAlB,IAA6C,IACpD,OAAM,YAAI,IAAF,EAAF,EAAE,WAAE,OAAc,IAAlB,IAA+B,KASrC,KAN+B,SAM5B,EAAiB,GAAiB,IAS7B,EAIA,EACA,EACA,EAeE,EAGA,EAhCH,EAA4C,EAA5C,IAAK,EAAuC,EAAvC,KAAM,EAAiC,EAAjC,MAAO,EAA0B,EAA1B,OAAQ,EAAkB,EAAlB,WAAY,EAAM,EAAN,GACtC,EAAwC,EAAxC,KAAM,EAAkC,EAAlC,cAAe,EAAmB,EAAnB,UAAW,EAAQ,EAAR,KAClC,EAAK,kBAEN,GAII,EAAO,EAAI,WAAW,UAAW,CAC7B,IAAH,EAAK,QACV,KAAM,EAAK,KAAK,UAEZ,EAAO,EAAG,MAAO,OAAQ,IAAlB,IAAsB,EAAQ,IACrC,EAAQ,EAAG,IAAK,SAChB,EAAS,EAAG,IAAK,UAEjB,EAAH,GACD,IADF,IACa,EAAyB,IACpC,kBAAM,EAAI,OAAO,EAAO,IAAlB,IAAsB,IAAyB,OAAO,EAAQ,IAA9D,IAAkE,OACxE,WAAQ,OAAF,EAAI,OAAO,EAAO,IAAlB,MAA+B,OAAO,EAAQ,MAEhD,EAAF,UAAU,MAGQ,IAAhB,EAAK,OAAyB,MAC3B,IAAP,IAAW,EAAkB,IAIvB,EAAa,EAAU,OACzB,IADe,IACV,EAAsB,EAAU,EAAW,EAAU,GAC1D,IAFe,IAEX,EAAU,GACZ,EAAY,IAAH,IAAe,EAA0B,EAAgB,EAAe,GAChF,IAAP,IAAW,EAAa,EAAsB,EAAa,EAAgB,OAI3E,WACI,MAAqC,EAAK,QAAQ,GAClD,GAAD,GAIC,IAAY,IAAd,EAAE,CANe,I,IAsBF,EACX,EAvBa,GAsBF,EAfyB,EAgBpC,EAAM,EAAI,WAAW,UAAW,CACpC,IAAK,EACL,IAAK,EACL,KAAM,EAAK,KAAK,QAAU,IAApB,IAAwB,EAAK,KAAK,QAAU,cAAY,SAAY,I,EAEvD,UAAjB,EAAO,IAAwB,aAAkB,OAI9C,CAAC,SAAU,EAAQ,GAHjB,CAAC,EAAO,MAAQ,SAAU,EAAO,SAAU,IAA3C,IAA+C,I,EA7BrC,E,kzBAOd,EAPc,KAOL,EAPK,KAOG,EAPH,KAQjB,IAAY,GAAU,EAAI,KA2B9B,WACE,GAAwB,UAApB,EAAO,MAA2B,aAAqB,SAAW,EAAU,MAAO,CACrF,IAAK,EAAU,OAAQ,MAAM,IAAI,MAAM,+BACvC,OAAO,IAAP,IAAiB,EAAU,GAE7B,MAAwB,mBAAV,EAAuB,IAA9B,IAAkC,EAAU,GAAU,IAAtD,IAA0D,EAAe,GAhC/C,UAE7B,WACI,IAAY,IAAhB,EAAK,OAIT,MAAM,IAAI,MAAM,KAEhB,SAAS,IACP,gCAA0B,EAA1B,wCAA0E,EAA1E,KANA,EAAK,OAAO,KAAK,KATX,GAnCP,MA8ET,UAAe,G,6ECpHf,IAEMC,EAAqB,CAF3B,QAE4B,SAE5B,UAAe,G,2HCHF,qBAAiC,CAC5C,QACA,cACA,UACA,aACA,WACA,YACA,YAGW,oBAAgC,CAC3C,mBACA,kBACA,kB,kbCbF,cACA,UASM,EAA6B,CAC/B,QAAO,QACP,OAAK,EACL,MARkC,CACpC,QAAS,8BACP,OAAM,gBAAE,EAAF,EAAE,WAAF,OAAkB,IAAlB,IAAqC,KAO3C,KAJ+B,SAI5B,GACC,IAAE,EAAM,EAAI,IAAI,WAAW,OAAQ,CACrC,IAAK,EACL,KAAM,IAAF,OAGN,EAAI,UAAU,IAAd,IAAmB,EAAO,EAAI,KAAS,EAAI,eAI/C,UAAe,G,m5BCxBf,cACA,UASM,EAA6B,CAC/B,QAAO,OACP,WAAU,QACV,OAAK,EACL,MATkC,CACpC,QAAS,+CACP,OAAM,gBAAE,EAAF,EAAE,WAAF,OAAkB,IAAlB,IAAsC,KAQ5C,KAL+B,SAK5B,GAAe,IACX,EAA4C,EAA5C,IAAK,EAAuC,EAAvC,KAAM,EAAiC,EAAjC,MAAO,EAA0B,EAA1B,OAAQ,EAAkB,EAAlB,WAAY,EAAM,EAAN,GACzC,IAAC,GAA2B,IAAlB,EAAO,OAAc,MAAM,IAAI,MAAM,kCAC/C,IAKA,E,EALE,EAAU,EAAO,QAAU,EAAG,KAAK,SACnC,EAAM,EAAI,IAAI,WAAW,OAAQ,CACrC,IAAK,EACL,KAAM,IAAF,OAGF,MAAW,EACb,EAAQ,EAAG,IAAK,SACV,EAAF,WAAW,GASb,WACF,EAAI,OAAO,GAAO,GAClB,EAAI,MAAM,IAAK,GAAoB,SAAC,GAAD,OACjC,EAAG,GAAI,IAAP,IAAW,EAAO,EAAS,IAAM,kBAAM,EAAI,OAAO,GAAO,GAAlB,qBAXpC,CAEC,IAAD,MAAM,QAAQ,GAAS,MAAM,IAAI,MAAM,4BACtC,MAAU,EAAG,MAAO,UAAW,GACrC,EAAQ,a,+CAAM,EAAO,KAAI,SAAC,EAAa,GAAd,OAWvB,SAAe,EAAe,GAChC,IAAM,EAAM,EAAO,GACnB,OAAO,GAAsB,WAAf,EAAO,GACjB,IADG,IACC,EAAO,EAAS,EAAW,GAC/B,IAFG,IAEC,EAAY,GAfiC,CAAU,EAAS,Q,8iBAEtE,OAAK,KAkBb,UAAe,G,6ECpDf,cACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,SAEMC,EAAyB,CAE7B,UACA,UAEA,UACA,UAEA,UACA,UAEA,UACA,UAEA,CAAC,QAAS,WAAY,WAAY,WAClC,UACA,WAGF,UAAe,G,gbC7Bf,cAUM,EAA6B,CAC/B,QAAO,CAAC,WAAY,YACpB,KAAI,QACJ,WAAU,SACV,OAAK,EACL,MAbkC,CAClC,QADkC,YACP,IAApB,EAAoB,EAApB,QAAS,EAAW,EAAX,WACV,EAAmB,aAAZ,EAAyB,OAAS,QAC/C,OAAO,MAAP,IAA6B,EAAa,IAE5C,OAAQ,gBAAE,EAAF,EAAE,WAAF,OAAkB,IAAlB,IAA8B,KASpC,KAN+B,SAM5B,GAAe,IACX,EAA6B,EAA7B,QAAS,EAAoB,EAApB,KAAM,EAAc,EAAd,WAChB,EAAiB,aAAZ,EAAyB,YAAU,GAAK,YAAU,GAC7D,EAAI,UAAU,IAAd,IAAkB,EAAe,EAAM,MAI3C,UAAe,G,+pBCvBf,cACA,UAUM,EAA6B,CAC/B,QAAO,CAAC,YAAa,aACrB,KAAI,SACJ,WAAU,SACV,OAAK,EACL,MAbkC,CAClC,QADkC,YACP,IAApB,EAAoB,EAApB,QAAS,EAAW,EAAX,WACV,EAAmB,cAAZ,EAA0B,OAAS,QAChD,OAAO,MAAP,IAA6B,EAAa,IAE5C,OAAQ,gBAAE,EAAF,EAAE,WAAF,OAAkB,IAAlB,IAA8B,KASpC,KAN+B,SAM5B,GAAe,IAGd,EAFG,EAAiC,EAAjC,QAAS,EAAwB,EAAxB,KAAM,EAAkB,EAAlB,WAAY,EAAM,EAAN,GAC5B,EAAiB,cAAZ,EAA0B,YAAU,GAAK,YAAU,GAE1D,IAAoB,IAApB,EAAG,KAAK,QACV,EAAM,IAAH,IAAO,OACL,CACC,MAAM,EAAI,IAAI,WAAW,OAAQ,CAC7B,IAAH,UACL,KAAM,IAAF,OAEN,EAAM,IAAH,IAAO,EAAO,GAEnB,EAAI,UAAU,IAAd,IAAkB,EAAO,EAAM,MAInC,UAAe,G,ubClCf,cAEM,EAAM,YAMN,EAAgE,CAClE,QAAO,CAAC,MAAO,KAAM,GAAI,EAAI,IAAK,KAAM,EAAI,IAC5C,QAAO,CAAC,MAAO,KAAM,GAAI,EAAI,IAAK,KAAM,EAAI,IAC9C,iBAAkB,CAAC,MAAO,IAAK,GAAI,EAAI,GAAI,KAAM,EAAI,KACrD,iBAAkB,CAAC,MAAO,IAAK,GAAI,EAAI,GAAI,KAAM,EAAI,MASjD,EAAgC,CACpC,QAAS,gBAAE,EAAF,EAAE,QAAS,EAAX,EAAW,WAAX,OAA2B,MAA3B,IAA2C,EAAK,GAAgB,MAAS,IAClF,OAAQ,gBAAE,EAAF,EAAE,QAAS,EAAX,EAAW,WAAX,OACN,IADM,IACW,EAAK,GAAgB,MAAiB,KAGrD,EAA6B,CACjC,QAAS,OAAO,KAAK,GACrB,KAAM,SACN,WAAY,SACZ,OAAO,EACP,QACA,KANiC,SAM5B,GAAe,IACX,EAA6B,EAA7B,QAAS,EAAoB,EAApB,KAAM,EAAc,EAAd,WACtB,EAAI,UAAU,IAAd,IAAkB,EAAQ,EAAK,GAAgB,KAAQ,EAAuB,MAIlF,UAAe,G,6bCvCf,cAUM,EAA6B,CAC/B,QAAO,CAAC,gBAAiB,iBACzB,KAAI,SACJ,WAAU,SACV,OAAK,EACL,MAbkC,CAClC,QADkC,YACP,IAApB,EAAoB,EAApB,QAAS,EAAW,EAAX,WACV,EAAmB,kBAAZ,EAA8B,OAAS,QACpD,OAAO,MAAP,IAA6B,EAAa,IAE5C,OAAQ,gBAAE,EAAF,EAAE,WAAF,OAAkB,IAAlB,IAA8B,KASpC,KAN+B,SAM5B,GAAe,IACX,EAA6B,EAA7B,QAAS,EAAoB,EAApB,KAAM,EAAc,EAAd,WAChB,EAAiB,kBAAZ,EAA8B,YAAU,GAAK,YAAU,GAClE,EAAI,UAAU,IAAd,IAA8B,EAAgB,EAAM,MAIxD,UAAe,G,gnBCvBf,cAaM,EAA6B,CAC/B,QAAO,aACP,KAAI,SACJ,WAAU,SACV,OAAK,EACL,MAVkC,CAClC,QAAO,gBAAE,EAAF,EAAE,WAAF,OAAkB,MAAlB,IAA8C,IACrD,OAAM,gBAAE,EAAF,EAAE,WAAF,OAAkB,IAAlB,IAAmC,KASzC,KAN+B,SAM5B,GAAe,IACX,EAA6B,EAA7B,IAAK,EAAwB,EAAxB,KAAM,EAAkB,EAAlB,WAEZ,EAF8B,EAAN,GAEd,KAAK,oBACf,EAAM,EAAG,IAAK,OACd,EAAU,EACZ,IADgB,IACQ,EAAU,EAAa,GAC/C,IAFgB,IAEZ,EAAoB,GAC5B,EAAI,UAAU,IAAd,IAAmB,EAAwB,EAAS,EAAQ,EAAe,MAI/E,UAAe,G,ufC/Bf,cACA,UASM,EAA6B,CAC/B,QAAO,UACP,KAAI,SACJ,WAAU,SACV,OAAK,EACL,MAVkC,CACpC,QAAS,gBAAE,EAAF,EAAE,WAAF,OAAkB,MAAlB,IAA8C,IACrD,OAAM,gBAAE,EAAF,EAAE,WAAF,OAAkB,IAAlB,IAAgC,KAStC,KAN+B,SAM5B,GAAe,IACX,EAAwC,EAAxC,IAAK,EAAmC,EAAnC,KAAM,EAA6B,EAA7B,MAAO,EAAsB,EAAtB,OAAQ,EAAc,EAAd,WAC3B,EAAS,EAAQ,IAAH,IAAmB,GAAsB,aAAW,EAAK,GAC7E,EAAI,UAAU,IAAd,IAAmB,EAAe,MAItC,UAAe,G,wdCvBf,cAOA,UAaM,EAA6B,CAC/B,QAAO,WACP,KAAI,SACJ,WAAU,QACV,OAAK,EACL,MAVkC,CAClC,QAAO,gBAAW,EAAX,EAAE,OAAS,gBAAX,OAAiC,MAAjC,IAAsE,IAC7E,OAAM,gBAAW,EAAX,EAAE,OAAS,gBAAX,OAAiC,IAAjC,IAAuD,KAS7D,KAN+B,SAM5B,GAAe,IACX,EAA4C,EAA5C,IAAK,EAAuC,EAAvC,OAAQ,EAA+B,EAA/B,WAAY,EAAmB,EAAnB,KAAM,EAAa,EAAb,MAAO,EAAM,EAAN,GACtC,EAAQ,EAAR,KACH,GAAC,GAA2B,IAAlB,EAAO,OAAjB,CACA,IAAE,EAAU,EAAO,QAAU,EAAK,aAClC,EAAG,UAGH,WACI,GAAF,GAAW,EACLf,EAAJ,WAAW,MAAK,OACf,S,w5BAAA,CACc,GADd,IACL,2BAA2B,KAAhB,EAAgB,QACzB,yBAAuB,EAAK,IAFzB,gCANS,GAad,WACF,IAAM,EAAU,EAAG,IAAK,WAClB,GAAF,GAAW,EAAO,CACZ,IAAF,EAAQ,EAAG,IAAK,SAAS,GACvB,EAAJ,WAAW,GAAO,kBAgB1B,SAA0B,EAAe,GACvC,EAAI,UAAU,CAAC,gBAAiB,IAChC,EAAI,MACF,EACA,GACA,WACE,EAAI,OAAO,EAAO,iBAAe,EAAM,EAAS,EAAK,gBACrD,EAAG,GAAI,MAAI,IAAQ,WACjB,EAAI,QACJ,EAAG,aAGP,OA5B4B,CAAiB,EAAS,MACtD,EAAI,GAAG,QAEP,EAAG,GAAI,mBAAiB,EAAK,EAAQ,IACrC,oBAAkB,EAAK,GACvB,EAAG,OArBF,GAyBD,SAAK,IACD,EAAF,MAAM,OAAQ,GAAoB,SAAC,GACrC,EAAI,UAAU,CAAC,gBAAiB,IAChC,EAAG,GAAI,mBAAiB,EAAM,EAAM,EAAK,gBAAgB,kBAAM,EAAI,iBAsB3E,UAAe,G,ihDClFf,cACA,UACA,UAcM,EAA6B,CAC/B,QAAO,cACP,KAAI,QACJ,WAAU,UACV,OAAK,EACL,MAXkC,CAClC,QAAO,oBAAE,OAAS,EAAX,EAAW,EAAG,EAAd,EAAc,EAAd,OACP,MADO,IACyC,EAAS,IACzD,OAAM,oBAAE,OAAS,EAAX,EAAW,EAAG,EAAd,EAAc,EAAd,OAAsB,IAAtB,IAA8B,EAAS,KAS7C,KAN+B,SAM5B,GAAe,IACX,EAA0D,EAA1D,IAAK,EAAqD,EAArD,KAAM,EAA+C,EAA/C,MAAO,EAAwC,EAAxC,OAAQ,EAAgC,EAAhC,aAAc,EAAkB,EAAlB,WAAY,EAAM,EAAN,GACvD,GAAC,GAAU,EAAX,CACA,IAAE,EAAQ,EAAG,IAAK,SAChB,EAAY,EAAa,MAAQ,iBAAe,EAAa,OAAS,GACxE,aAAW,GAGX,WACF,IAAM,EAAI,EAAG,IAAK,IAAK,IAAb,IAAiB,IACrB,EAAI,EAAG,IAAK,KACZ,EAAF,UAAU,CAAC,IAAG,MACZ,EAAF,OAAO,GAAO,GACZrB,EAAH,GAAI,IAAP,IAAW,IAAS,kBAIb,EAAU,OAAS,IAAM,EAAU,MAAK,SAAC,GAAD,MAAa,WAANqC,GAAwB,UAAN,KAJ7B,EAAQ,GAAQ,EAAG,QARrB,IAA3C,IAA+C,IAC3C,KAAG,GAcH,SAAK,EAAM,EAAS,GAChB,MAAO,EAAI,KAAK,QAChB,EAAY,iBAAe,EAAW,EAAM,EAAG,KAAK,OAAQ,WAAS,OACrE,EAAU,EAAG,MAAO,UAAW,IAArB,MACV,EAAH,IAAK,IAAR,IAAa,IAAQ,WACnB,EAAG,IAAK,EAAM,IAAd,IAAkB,EAAQ,IAC1B,EAAG,GAAI,EAAW,IAAlB,MACI,EAAU,OAAS,GAAG,EAAG,GAAI,IAAP,IAAkB,GAAoB,IAAtC,IAA0C,IACpE,EAAG,GACG,IADN,IACiB,EAAW,IAAqB,WAC7C,EAAI,OAAO,EAAG,IAAd,IAAkB,EAAW,IAC7B,EAAI,QACJ,EAAI,OAAO,GAAO,GAAlB,WAED,KAAK,IANR,IAMY,EAAW,EAAW,OAItC,SAAS,EAAO,EAAS,GACvB,IAAM,EAAM,EAAI,IAAI,WAAW,OAAQ,CACrC,IAAK,EACL,KAAM,IAAF,OAEA,EAAQ,EAAI,KAAK,SACvB,EAAI,MAAM,GAAV,IAAqB,IAArB,IAA0B,IAAQ,kBAChC,EAAG,IAAK,IAAR,IAAY,EAAO,EAAM,IAAQ,kBAC/B,EAAG,GAAI,IAAP,IAAW,EAAO,EAAQ,EAAO,EAAQ,IAAO,WAC9C,EAAI,QACJ,EAAI,OAAO,GAAO,GAAlB,MAA+B,eAQ3C,UAAe,G,2PC1EfC,EAAOvC,QAAU,SAASwC,EAAMC,EAAGC,GACjC,GAAID,IAAMC,EAAG,OAAO,EAEpB,GAAID,GAAKC,GAAiB,UAAZ,EAAOD,IAA6B,UAAZ,EAAOC,GAAe,CAC1D,GAAID,EAAEE,cAAgBD,EAAEC,YAAa,OAAO,EAE5C,IAAIC,EAAQjD,EAAGkD,EACf,GAAIC,MAAMC,QAAQN,GAAI,CAEpB,IADAG,EAASH,EAAEG,SACGF,EAAEE,OAAQ,OAAO,EAC/B,IAAKjD,EAAIiD,EAAgB,GAARjD,KACf,IAAK6C,EAAMC,EAAE9C,GAAI+C,EAAE/C,IAAK,OAAO,EACjC,OAAO,EAKT,GAAI8C,EAAEE,cAAgBK,OAAQ,OAAOP,EAAEQ,SAAWP,EAAEO,QAAUR,EAAES,QAAUR,EAAEQ,MAC5E,GAAIT,EAAEU,UAAYC,OAAOC,UAAUF,QAAS,OAAOV,EAAEU,YAAcT,EAAES,UACrE,GAAIV,EAAEa,WAAaF,OAAOC,UAAUC,SAAU,OAAOb,EAAEa,aAAeZ,EAAEY,WAIxE,IADAV,GADAC,EAAOO,OAAOP,KAAKJ,IACLG,UACCQ,OAAOP,KAAKH,GAAGE,OAAQ,OAAO,EAE7C,IAAKjD,EAAIiD,EAAgB,GAARjD,KACf,IAAKyD,OAAOC,UAAUE,eAAeC,KAAKd,EAAGG,EAAKlD,IAAK,OAAO,EAEhE,IAAKA,EAAIiD,EAAgB,GAARjD,KAAY,CAC3B,IAAI8D,EAAMZ,EAAKlD,GAEf,IAAK6C,EAAMC,EAAEgB,GAAMf,EAAEe,IAAO,OAAO,EAGrC,OAAO,EAIT,OAAOhB,GAAIA,GAAKC,GAAIA,I,2PC1CtB,IAAIgB,EAAWnB,EAAOvC,QAAU,SAAUI,EAAQuD,EAAMC,GAEnC,mBAARD,IACTC,EAAKD,EACLA,EAAO,IAOTE,EAAUF,EAHc,mBADxBC,EAAKD,EAAKC,IAAMA,GACsBA,EAAKA,EAAGE,KAAO,aAC1CF,EAAGG,MAAQ,aAEK3D,EAAQ,GAAIA,IAqDzC,SAASyD,EAAUF,EAAMG,EAAKC,EAAM3D,EAAQ4D,EAASC,EAAYC,EAAeC,EAAeC,EAAcC,GAC3G,GAAIjE,GAA2B,UAAjB,EAAOA,KAAuB0C,MAAMC,QAAQ3C,GAAS,CAEjE,IAAK,IAAIqD,KADTK,EAAI1D,EAAQ4D,EAASC,EAAYC,EAAeC,EAAeC,EAAcC,GAC7DjE,EAAQ,CACtB,IAAIkE,EAAMlE,EAAOqD,GACjB,GAAIX,MAAMC,QAAQuB,IAChB,GAAIb,KAAOC,EAASa,cAClB,IAAK,IAAI5E,EAAE,EAAGA,EAAE2E,EAAI1B,OAAQjD,IAC1BkE,EAAUF,EAAMG,EAAKC,EAAMO,EAAI3E,GAAIqE,EAAU,IAAMP,EAAM,IAAM9D,EAAGsE,EAAYD,EAASP,EAAKrD,EAAQT,QAEnG,GAAI8D,KAAOC,EAASc,eACzB,GAAIF,GAAqB,UAAd,EAAOA,GAChB,IAAK,IAAIG,KAAQH,EACfT,EAAUF,EAAMG,EAAKC,EAAMO,EAAIG,GAAOT,EAAU,IAAMP,EAAM,IAAoBgB,EAY/EC,QAAQ,KAAM,MAAMA,QAAQ,MAAO,MAZmDT,EAAYD,EAASP,EAAKrD,EAAQqE,QAEpHhB,KAAOC,EAASiB,UAAahB,EAAKiB,WAAanB,KAAOC,EAASmB,gBACxEhB,EAAUF,EAAMG,EAAKC,EAAMO,EAAKN,EAAU,IAAMP,EAAKQ,EAAYD,EAASP,EAAKrD,GAGnF2D,EAAK3D,EAAQ4D,EAASC,EAAYC,EAAeC,EAAeC,EAAcC,IApElFX,EAASiB,SAAW,CAClBG,iBAAiB,EACjBC,OAAO,EACPC,UAAU,EACVC,sBAAsB,EACtBC,eAAe,EACfC,KAAK,EACLC,IAAI,EACJC,MAAM,EACNC,MAAM,GAGR5B,EAASa,cAAgB,CACvBQ,OAAO,EACPQ,OAAO,EACPC,OAAO,EACPC,OAAO,GAGT/B,EAASc,cAAgB,CACvBkB,OAAO,EACPC,aAAa,EACbC,YAAY,EACZC,mBAAmB,EACnBC,cAAc,GAGhBpC,EAASmB,aAAe,CACtBvE,SAAS,EACTyF,MAAM,EACNC,OAAO,EACPC,UAAU,EACVC,SAAS,EACTC,SAAS,EACTC,kBAAkB,EAClBC,kBAAkB,EAClBC,YAAY,EACZC,WAAW,EACXC,WAAW,EACXC,SAAS,EACTrE,QAAQ,EACRsE,UAAU,EACVC,UAAU,EACVC,aAAa,EACbC,eAAe,EACfC,eAAe,I,8BCrChB,SAAUC,EAAMC,GACf,kBAEQ,0BAANC,EAMI,WAGN,IAAIC,EAAM,GAeV,SAASC,EAAOC,EAAGC,GACjBxH,KAAA,EAAYuH,GAAK,EACjBvH,KAAA,EAAYwH,GAAK,EA0MnB,SAASC,EAAOC,EAAKC,GACnB3H,KAAA,IAAc0H,GAAO,IAAIJ,EACzBtH,KAAA,EAAY2H,GAAK,EACjB3H,KAAA,OAAiB,IAAIsH,EA6CvB,SAASM,EAAQF,EAAKG,GACpB7H,KAAA,IAAc0H,GAAO,IAAIJ,EACzBtH,KAAA,MAAgB,EAChBA,KAAA,OAAiB,IAAIsH,EACrBtH,KAAK8H,UAAUD,GAAU,IAgO3B,SAASE,EAAIL,EAAKM,EAAGC,GACnBjI,KAAA,IAAc0H,GAAO,IAAIJ,EACzBtH,KAAA,EAAYgI,GAAK,EACjBhI,KAAA,EAAYiI,GAAK,EA6BnB,SAASC,IACPlI,KAAA,EAAY,KACZA,KAAA,EAAY,KACZA,KAAA,SAAmB,IAAIsH,EACvBtH,KAAA,SAAmB,IAAIsH,EACvBtH,KAAKmI,QAjgBPd,EAAG,OAAaC,EAEhBD,EAAG,EAAQC,EAQXA,EAAO9D,UAAP,KAA2B8D,EAAO9D,UAAU4E,KAAO,SAASC,GAG1D,OAFArI,KAAA,EAAYqI,EAAK,EACjBrI,KAAA,EAAYqI,EAAK,EACVrI,MAOTsH,EAAO9D,UAAP,MAA4B8D,EAAO9D,UAAU8E,MAAQ,WACnD,OAAO,IAAIhB,EAAOtH,KAAA,EAAWA,KAAA,IAQ/BsH,EAAO9D,UAAP,KAA2B8D,EAAO9D,UAAU+E,KAAO,WACjD,IAAIhB,EAAIvH,KAAA,EAGR,OAFAA,KAAA,EAAYA,KAAA,EACZA,KAAA,GAAauH,EACNvH,MAQTsH,EAAO9D,UAAP,OAA6B8D,EAAO9D,UAAUgF,OAAS,SAAUC,GAC/D,IAAIlB,EAAIvH,KAAA,EACJwH,EAAIxH,KAAA,EAGR,OAFAA,KAAA,EAAYuH,EAAImB,KAAKC,IAAIF,GAASjB,EAAIkB,KAAKE,IAAIH,GAC/CzI,KAAA,EAAYuH,EAAImB,KAAKE,IAAIH,GAASjB,EAAIkB,KAAKC,IAAIF,GACxCzI,MAOTsH,EAAO9D,UAAP,QAA8B8D,EAAO9D,UAAUqF,QAAU,WAGvD,OAFA7I,KAAA,GAAaA,KAAA,EACbA,KAAA,GAAaA,KAAA,EACNA,MAQTsH,EAAO9D,UAAP,UAAgC8D,EAAO9D,UAAUsF,UAAY,WAC3D,IAAIC,EAAI/I,KAAKgJ,MAKb,OAJGD,EAAI,IACL/I,KAAA,EAAYA,KAAA,EAAY+I,EACxB/I,KAAA,EAAYA,KAAA,EAAY+I,GAEnB/I,MAQTsH,EAAO9D,UAAP,IAA0B8D,EAAO9D,UAAU7C,IAAM,SAAS0H,GAGxD,OAFArI,KAAA,GAAaqI,EAAK,EAClBrI,KAAA,GAAaqI,EAAK,EACXrI,MAQTsH,EAAO9D,UAAP,IAA0B8D,EAAO9D,UAAUyF,IAAM,SAASZ,GAGxD,OAFArI,KAAA,GAAaqI,EAAK,EAClBrI,KAAA,GAAaqI,EAAK,EACXrI,MAWTsH,EAAO9D,UAAP,MAA4B8D,EAAO9D,UAAU0F,MAAQ,SAAS3B,EAAEC,GAG9D,OAFAxH,KAAA,GAAauH,EACbvH,KAAA,QAAyB,IAALwH,EAAmBA,EAAID,EACpCvH,MAQTsH,EAAO9D,UAAP,QAA8B8D,EAAO9D,UAAU2F,QAAU,SAASd,GAChE,IAAIe,EAAMpJ,KAAKqJ,IAAIhB,GAASA,EAAMiB,OAGlC,OAFAtJ,KAAA,EAAYoJ,EAAMf,EAAK,EACvBrI,KAAA,EAAYoJ,EAAMf,EAAK,EAChBrI,MASTsH,EAAO9D,UAAP,SAA+B8D,EAAO9D,UAAU+F,SAAW,SAASlB,GAClE,IAAIe,EAAMpJ,KAAKqJ,IAAIhB,GAGnB,OAFArI,KAAA,EAAYoJ,EAAMf,EAAK,EACvBrI,KAAA,EAAYoJ,EAAMf,EAAK,EAChBrI,MAQTsH,EAAO9D,UAAP,QAA8B8D,EAAO9D,UAAUgG,QAAU,SAASC,GAChE,IAAIlC,EAAIvH,KAAA,EACJwH,EAAIxH,KAAA,EAIR,OAHAA,KAAKmJ,QAAQM,GAAMP,MAAM,GACzBlJ,KAAA,GAAauH,EACbvH,KAAA,GAAawH,EACNxH,MASTsH,EAAO9D,UAAP,SAA+B8D,EAAO9D,UAAUkG,SAAW,SAASD,GAClE,IAAIlC,EAAIvH,KAAA,EACJwH,EAAIxH,KAAA,EAIR,OAHAA,KAAKuJ,SAASE,GAAMP,MAAM,GAC1BlJ,KAAA,GAAauH,EACbvH,KAAA,GAAawH,EACNxH,MAQTsH,EAAO9D,UAAP,IAA0B8D,EAAO9D,UAAU6F,IAAM,SAAShB,GACxD,OAAOrI,KAAA,EAAYqI,EAAK,EAAQrI,KAAA,EAAYqI,EAAK,GAOnDf,EAAO9D,UAAP,KAA2B8D,EAAO9D,UAAU8F,KAAO,WACjD,OAAOtJ,KAAKqJ,IAAIrJ,OAOlBsH,EAAO9D,UAAP,IAA0B8D,EAAO9D,UAAUwF,IAAM,WAC/C,OAAON,KAAKiB,KAAK3J,KAAKsJ,SAoBxBjC,EAAG,OAAaI,EAQhBA,EAAOjE,UAAP,QAA8BiE,EAAOjE,UAAUoG,QAAU,WACvD,IAAIjC,EAAI3H,KAAA,EAER,OAAO,IAAI+H,EADE/H,KAAA,IAAYsI,QAAQ3H,IAAIX,KAAA,QAAgBiJ,IAAI,IAAI3B,EAAOK,EAAGA,IAC9C,EAAFA,EAAO,EAAFA,GAAKkC,aAQnCpC,EAAOjE,UAAP,UAAgCiE,EAAOjE,UAAUsG,UAAY,SAASC,GAEpE,OADA/J,KAAA,OAAiB+J,EACV/J,MA4BTqH,EAAG,QAAcO,EAajBA,EAAQpE,UAAR,UAAiCoE,EAAQpE,UAAUsE,UAAY,SAASD,GAGtE,IADqB7H,KAAA,QAAkBA,KAAA,OAAe+C,SAAW8E,EAAO9E,OACrD,CACjB,IAAIjD,EACAkK,EAAahK,KAAA,WAAqB,GAClCiK,EAAQjK,KAAA,MAAgB,GACxBkK,EAAUlK,KAAA,QAAkB,GAEhC,IAAKF,EAAI,EAAGA,EAAI+H,EAAO9E,OAAQjD,IAAK,CAElC,IAAIqK,EAAKtC,EAAO/H,GACZsK,EAAKtK,EAAI+H,EAAO9E,OAAS,EAAI8E,EAAO/H,EAAI,GAAK+H,EAAO,GACpDsC,IAAOC,GAAMD,EAAG5C,IAAM6C,EAAG7C,GAAK4C,EAAG3C,IAAM4C,EAAG5C,GAK9CwC,EAAWK,KAAK,IAAI/C,GACpB2C,EAAMI,KAAK,IAAI/C,GACf4C,EAAQG,KAAK,IAAI/C,KANfO,EAAOyC,OAAOxK,EAAG,GACjBA,GAAK,IAUX,OAFAE,KAAA,OAAiB6H,EACjB7H,KAAKuK,UACEvK,MAQT4H,EAAQpE,UAAR,SAAgCoE,EAAQpE,UAAUgH,SAAW,SAAS/B,GAGpE,OAFAzI,KAAA,MAAgByI,EAChBzI,KAAKuK,UACEvK,MAQT4H,EAAQpE,UAAR,UAAiCoE,EAAQpE,UAAUsG,UAAY,SAASC,GAGtE,OAFA/J,KAAA,OAAiB+J,EACjB/J,KAAKuK,UACEvK,MAUT4H,EAAQpE,UAAR,OAA8BoE,EAAQpE,UAAUgF,OAAS,SAASC,GAGhE,IAFA,IAAIZ,EAAS7H,KAAA,OACTgJ,EAAMnB,EAAO9E,OACRjD,EAAI,EAAGA,EAAIkJ,EAAKlJ,IACvB+H,EAAO/H,GAAG0I,OAAOC,GAGnB,OADAzI,KAAKuK,UACEvK,MAeT4H,EAAQpE,UAAR,UAAiCoE,EAAQpE,UAAUiH,UAAY,SAAUlD,EAAGC,GAG1E,IAFA,IAAIK,EAAS7H,KAAA,OACTgJ,EAAMnB,EAAO9E,OACRjD,EAAI,EAAGA,EAAIkJ,EAAKlJ,IACvB+H,EAAO/H,GAAP,GAAkByH,EAClBM,EAAO/H,GAAP,GAAkB0H,EAGpB,OADAxH,KAAKuK,UACEvK,MAST4H,EAAQpE,UAAU+G,QAAU,WAG1B,IAcIzK,EAdAkK,EAAahK,KAAA,WAIbiK,EAAQjK,KAAA,MAIRkK,EAAUlK,KAAA,QAEV6H,EAAS7H,KAAA,OACT+J,EAAS/J,KAAA,OACTyI,EAAQzI,KAAA,MACRgJ,EAAMnB,EAAO9E,OAEjB,IAAKjD,EAAI,EAAGA,EAAIkJ,EAAKlJ,IAAK,CACxB,IAAI4K,EAAYV,EAAWlK,GAAGsI,KAAKP,EAAO/H,IAC1C4K,EAAS,GAASX,EAAM,EACxBW,EAAS,GAASX,EAAM,EACV,IAAVtB,GACFiC,EAAUlC,OAAOC,GAIrB,IAAK3I,EAAI,EAAGA,EAAIkJ,EAAKlJ,IAAK,CACxB,IAAIqK,EAAKH,EAAWlK,GAChBsK,EAAKtK,EAAIkJ,EAAM,EAAIgB,EAAWlK,EAAI,GAAKkK,EAAW,GAClDjK,EAAIkK,EAAMnK,GAAGsI,KAAKgC,GAAInB,IAAIkB,GAC9BD,EAAQpK,GAAGsI,KAAKrI,GAAGwI,OAAOO,YAE5B,OAAO9I,MAWT4H,EAAQpE,UAAR,QAA+BoE,EAAQpE,UAAUoG,QAAU,WAOzD,IANA,IAAI/B,EAAS7H,KAAA,WACTgJ,EAAMnB,EAAO9E,OACb4H,EAAO9C,EAAO,GAAP,EACP+C,EAAO/C,EAAO,GAAP,EACPgD,EAAOhD,EAAO,GAAP,EACPiD,EAAOjD,EAAO,GAAP,EACF/H,EAAI,EAAGA,EAAIkJ,EAAKlJ,IAAK,CAC5B,IAAIiL,EAAQlD,EAAO/H,GACfiL,EAAK,EAAQJ,EACfA,EAAOI,EAAK,EAELA,EAAK,EAAQF,IACpBA,EAAOE,EAAK,GAEVA,EAAK,EAAQH,EACfA,EAAOG,EAAK,EAELA,EAAK,EAAQD,IACpBA,EAAOC,EAAK,GAGhB,OAAO,IAAIhD,EAAI/H,KAAA,IAAYsI,QAAQ3H,IAAI,IAAI2G,EAAOqD,EAAMC,IAAQC,EAAOF,EAAMG,EAAOF,GAAMf,aAY5FjC,EAAQpE,UAAR,YAAmCoE,EAAQpE,UAAUwH,YAAc,WAMjE,IALA,IAAInD,EAAS7H,KAAA,WACTgJ,EAAMnB,EAAO9E,OACbkI,EAAK,EACLC,EAAK,EACLC,EAAK,EACArL,EAAI,EAAGA,EAAIkJ,EAAKlJ,IAAK,CAC5B,IAAIqK,EAAKtC,EAAO/H,GACZsK,EAAKtK,IAAMkJ,EAAM,EAAInB,EAAO,GAAKA,EAAO/H,EAAE,GAC1C8C,EAAIuH,EAAE,EAAQC,EAAE,EAAQA,EAAE,EAAQD,EAAE,EACxCc,IAAOd,EAAE,EAAQC,EAAE,GAASxH,EAC5BsI,IAAOf,EAAE,EAAQC,EAAE,GAASxH,EAC5BuI,GAAMvI,EAKR,OAAO,IAAI0E,EAFX2D,GADAE,GAAU,EAEVD,GAAUC,IAwBZ9D,EAAG,IAAUU,EAMbA,EAAIvE,UAAJ,UAA6BuE,EAAIvE,UAAUqG,UAAY,WACrD,IAAInC,EAAM1H,KAAA,IACNgI,EAAIhI,KAAA,EACJiI,EAAIjI,KAAA,EACR,OAAO,IAAI4H,EAAQ,IAAIN,EAAOI,EAAG,EAAOA,EAAG,GAAQ,CAClD,IAAIJ,EAAU,IAAIA,EAAOU,EAAG,GAC5B,IAAIV,EAAOU,EAAEC,GAAI,IAAIX,EAAO,EAAEW,MAsBjCZ,EAAG,SAAea,EAQlBA,EAAS1E,UAAT,MAA8B0E,EAAS1E,UAAU2E,MAAQ,WAIvD,OAHAnI,KAAA,MAAe,EACfA,KAAA,MAAe,EACfA,KAAA,QAAkBoL,OAAOC,UAClBrL,MAWT,IADA,IAAIsL,EAAY,GACPxL,EAAI,EAAGA,EAAI,GAAIA,IAAOwL,EAAUjB,KAAK,IAAI/C,GAOlD,IAAIiE,EAAW,GACf,IAASzL,EAAI,EAAGA,EAAI,EAAGA,IAAOyL,EAASlB,KAAK,IAM5C,IAAImB,EAAa,IAAItD,EAMjBuD,EAAa,IAAI1D,EAAI,IAAIT,EAAU,KAAU,MAAUuC,YAc3D,SAAS6B,EAAgB7D,EAAQ8D,EAAQC,GAIvC,IAHA,IAAIC,EAAMT,OAAOC,UACbS,GAAOV,OAAOC,UACdrC,EAAMnB,EAAO9E,OACRjD,EAAI,EAAGA,EAAIkJ,EAAKlJ,IAAM,CAE7B,IAAIuJ,EAAMxB,EAAO/H,GAAGuJ,IAAIsC,GACpBtC,EAAMwC,IAAOA,EAAMxC,GACnBA,EAAMyC,IAAOA,EAAMzC,GAEzBuC,EAAO,GAAKC,EAAKD,EAAO,GAAKE,EAkB/B,SAASC,EAAiBC,EAAMC,EAAMC,EAASC,EAAS1C,EAAM2C,GAC5D,IAAIC,EAASd,EAASe,MAClBC,EAAShB,EAASe,MAElBE,EAAUlB,EAAUgB,MAAMlE,KAAK6D,GAAMhD,IAAI+C,GACzCS,EAAkBD,EAAQnD,IAAII,GAQlC,GANAiC,EAAgBQ,EAASzC,EAAM4C,GAC/BX,EAAgBS,EAAS1C,EAAM8C,GAE/BA,EAAO,IAAME,EACbF,EAAO,IAAME,EAETJ,EAAO,GAAKE,EAAO,IAAMA,EAAO,GAAKF,EAAO,GAI9C,OAHAf,EAAUjB,KAAKmC,GACfjB,EAASlB,KAAKgC,GACdd,EAASlB,KAAKkC,IACP,EAGT,GAAIH,EAAU,CACZ,IAuBQM,EACAC,EAxBJC,EAAU,EAEVP,EAAO,GAAKE,EAAO,IACrBH,EAAQ,MAAW,EAEfC,EAAO,GAAKE,EAAO,IACrBK,EAAUP,EAAO,GAAKE,EAAO,GAC7BH,EAAQ,MAAW,GAKnBQ,GAFIF,EAAUL,EAAO,GAAKE,EAAO,KAC7BI,EAAUJ,EAAO,GAAKF,EAAO,IACHK,GAAWC,IAI3CP,EAAQ,MAAW,EAEfC,EAAO,GAAKE,EAAO,IACrBK,EAAUP,EAAO,GAAKE,EAAO,GAC7BH,EAAQ,MAAW,GAKnBQ,GAFIF,EAAUL,EAAO,GAAKE,EAAO,KAC7BI,EAAUJ,EAAO,GAAKF,EAAO,IACHK,GAAWC,GAI7C,IAAIE,EAAanE,KAAKoE,IAAIF,GACtBC,EAAaT,EAAQ,UACvBA,EAAQ,QAAcS,EACtBT,EAAQ,SAAahE,KAAKqB,GACtBmD,EAAU,GACZR,EAAQ,SAAavD,WAO3B,OAHAyC,EAAUjB,KAAKmC,GACfjB,EAASlB,KAAKgC,GACdd,EAASlB,KAAKkC,IACP,EAiBT,SAASQ,EAAcC,EAAMjC,GAC3B,IAAIzB,EAAO0D,EAAK1D,OACZ2D,EAAKlC,EAAM1B,IAAI2D,GAGnB,OAAIC,EAAK,EAAYC,EAGZD,EAAK3D,EAAe6D,EAEfC,EAzBhB/F,EAAG,iBAAuB0E,EA+B1B,IAAImB,GAAuB,EAIvBE,EAAwB,EAIxBD,EAAuB,EAiF3B,SAASE,EAAkBC,EAASC,EAAQnB,GAW1C,IATA,IAAIoB,EAAYlC,EAAUgB,MAAMlE,KAAKmF,EAAM,KAAS5M,IAAI4M,EAAM,QAAYtE,IAAIqE,EAAO,KACjFG,EAASF,EAAM,EACfG,EAAUD,EAASA,EACnB5F,EAASyF,EAAO,WAChBtE,EAAMnB,EAAO9E,OACb4K,EAAOrC,EAAUgB,MACjBvB,EAAQO,EAAUgB,MAGbxM,EAAI,EAAGA,EAAIkJ,EAAKlJ,IAAK,CAC5B,IAAI8N,EAAO9N,IAAMkJ,EAAM,EAAI,EAAIlJ,EAAI,EAC/B+N,EAAa,IAAN/N,EAAUkJ,EAAM,EAAIlJ,EAAI,EAC/B8M,EAAU,EACVkB,EAAW,KAGfH,EAAKvF,KAAKkF,EAAO,MAAUxN,IAE3BiL,EAAM3C,KAAKoF,GAAWvE,IAAIpB,EAAO/H,IAK7BsM,GAAYrB,EAAMzB,OAASoE,IAC7BtB,EAAQ,MAAW,GAIrB,IAAI2B,EAAShB,EAAcY,EAAM5C,GAEjC,GAAIgD,IAAWb,EAAqB,CAElCS,EAAKvF,KAAKkF,EAAO,MAAUO,IAE3B,IAAIG,EAAS1C,EAAUgB,MAAMlE,KAAKoF,GAAWvE,IAAIpB,EAAOgG,IAExD,IADAE,EAAShB,EAAcY,EAAMK,MACdb,EAAsB,CAGnC,IADIc,EAAOlD,EAAM/B,OACNyE,EAMT,OAJAnC,EAAUjB,KAAKmD,GACflC,EAAUjB,KAAKsD,GACfrC,EAAUjB,KAAKU,GACfO,EAAUjB,KAAK2D,IACR,EACE5B,IAETA,EAAQ,MAAW,EACnB0B,EAAW/C,EAAMjC,YACjB8D,EAAUa,EAASQ,GAGvB3C,EAAUjB,KAAK2D,QAEV,GAAID,IAAWZ,GAMpB,GAJAQ,EAAKvF,KAAKkF,EAAO,MAAUM,IAE3B7C,EAAM3C,KAAKoF,GAAWvE,IAAIpB,EAAO+F,KACjCG,EAAShB,EAAcY,EAAM5C,MACdmC,EAAqB,CAGlC,IADIe,EAAOlD,EAAM/B,OACNyE,EAKT,OAHAnC,EAAUjB,KAAKmD,GACflC,EAAUjB,KAAKsD,GACfrC,EAAUjB,KAAKU,IACR,EACEqB,IAETA,EAAQ,MAAW,EACnB0B,EAAW/C,EAAMjC,YACjB8D,EAAUa,EAASQ,QAIlB,CAGL,IAAItC,EAASgC,EAAKpF,OAAOO,YAGrBmF,EAAOlD,EAAM1B,IAAIsC,GACjBuC,EAAUxF,KAAKoE,IAAImB,GAEvB,GAAIA,EAAO,GAAKC,EAAUT,EAKxB,OAHAnC,EAAUjB,KAAKmD,GACflC,EAAUjB,KAAKsB,GACfL,EAAUjB,KAAKU,IACR,EACEqB,IAET0B,EAAWnC,EACXiB,EAAUa,EAASQ,GAGfA,GAAQ,GAAKrB,EAAU,EAAIa,KAC7BrB,EAAQ,MAAW,IAOrB0B,GAAY1B,GAAY1D,KAAKoE,IAAIF,GAAWlE,KAAKoE,IAAIV,EAAQ,WAC/DA,EAAQ,QAAcQ,EACtBR,EAAQ,SAAahE,KAAK0F,IAa9B,OARI1B,IACFA,EAAQ,EAAQkB,EAChBlB,EAAQ,EAAQmB,EAChBnB,EAAQ,SAAahE,KAAKgE,EAAQ,UAAclD,MAAMkD,EAAQ,UAEhEd,EAAUjB,KAAKmD,GACflC,EAAUjB,KAAKsD,GACfrC,EAAUjB,KAAKU,IACR,EAyCT,SAASoD,EAAmBvL,EAAGC,EAAGuJ,GAMhC,IALA,IAAIF,EAAUtJ,EAAC,WACXwL,EAAOlC,EAAQnJ,OACfoJ,EAAUtJ,EAAC,WACXwL,EAAOlC,EAAQpJ,OAEVjD,EAAI,EAAGA,EAAIsO,EAAMtO,IACxB,GAAIiM,EAAiBnJ,EAAC,IAASC,EAAC,IAASqJ,EAASC,EAASvJ,EAAC,QAAY9C,GAAIsM,GAC1E,OAAO,EAIX,IAAStM,EAAI,EAAEA,EAAIuO,EAAMvO,IACvB,GAAIiM,EAAiBnJ,EAAC,IAASC,EAAC,IAASqJ,EAASC,EAAStJ,EAAC,QAAY/C,GAAIsM,GAC1E,OAAO,EAWX,OALIA,IACFA,EAAQ,EAAQxJ,EAChBwJ,EAAQ,EAAQvJ,EAChBuJ,EAAQ,SAAahE,KAAKgE,EAAQ,UAAclD,MAAMkD,EAAQ,WAEzD,EAIT,OAjQA/E,EAAG,cARH,SAAuBiH,EAAGC,GACxB,IAAIC,EAAclD,EAAUgB,MAAMlE,KAAKkG,GAAGrF,IAAIsF,EAAC,KAAStF,IAAIsF,EAAC,QACzDE,EAAWF,EAAC,EAAQA,EAAC,EACrBG,EAAaF,EAAYlF,OAG7B,OAFAgC,EAAUjB,KAAKmE,GAERE,GAAcD,GAmBvBpH,EAAG,eATH,SAAwBiH,EAAGK,GACzBlD,EAAU,IAAQrD,KAAKkG,GACvB9C,EAAWrD,QACX,IAAIyD,EAASuC,EAAmB1C,EAAYkD,EAAMnD,GAIlD,OAHII,IACFA,EAASJ,EAAU,MAEdI,GAsCTvE,EAAG,iBA1BH,SAA0BzE,EAAGC,EAAGuJ,GAG9B,IAAIoC,EAAclD,EAAUgB,MAAMlE,KAAKvF,EAAC,KAASlC,IAAIkC,EAAC,QAAYoG,IAAIrG,EAAC,KAASqG,IAAIrG,EAAC,QACjFgM,EAAchM,EAAC,EAAQC,EAAC,EACxBgM,EAAgBD,EAAcA,EAC9BF,EAAaF,EAAYlF,OAE7B,GAAIoF,EAAaG,EAEf,OADAvD,EAAUjB,KAAKmE,IACR,EAGT,GAAIpC,EAAU,CACZ,IAAI6B,EAAOvF,KAAKiB,KAAK+E,GACrBtC,EAAQ,EAAQxJ,EAChBwJ,EAAQ,EAAQvJ,EAChBuJ,EAAQ,QAAcwC,EAAcX,EACpC7B,EAAQ,SAAahE,KAAKoG,EAAY1F,aACtCsD,EAAQ,SAAahE,KAAKoG,GAAatF,MAAMkD,EAAQ,SACrDA,EAAQ,KAAUxJ,EAAC,GAASC,EAAC,GAASoL,GAAQpL,EAAC,EAAQD,EAAC,EACxDwJ,EAAQ,KAAWvJ,EAAC,GAASD,EAAC,GAASqL,GAAQrL,EAAC,EAAQC,EAAC,EAG3D,OADAyI,EAAUjB,KAAKmE,IACR,GA0ITnH,EAAG,kBAAwBgG,EA6B3BhG,EAAG,kBAhBH,SAA2BkG,EAAQD,EAASlB,GAE1C,IAAIR,EAASyB,EAAkBC,EAASC,EAAQnB,GAChD,GAAIR,GAAUQ,EAAU,CAEtB,IAAIxJ,EAAIwJ,EAAQ,EACZ0C,EAAO1C,EAAQ,KACnBA,EAAQ,SAAavD,UACrBuD,EAAQ,SAAavD,UACrBuD,EAAQ,EAAQA,EAAQ,EACxBA,EAAQ,EAAQxJ,EAChBwJ,EAAQ,KAAWA,EAAQ,KAC3BA,EAAQ,KAAW0C,EAErB,OAAOlD,GAuCTvE,EAAG,mBAAyB8G,EAErB9G,IA9+BC,kCAHT,I,eCbD,IAAI0H,EAAOC,EAAQ,MAKfC,EAASD,EAAQ,MAKjBE,EAASF,EAAQ,MAQjBG,EAAYH,EAAQ,MASpBI,EAAUJ,EAAQ,MAOlBK,EAASL,EAAQ,MAIjBM,EAAKN,EAAQ,MAEjBM,EAAGP,KAAOA,EACVO,EAAGL,OAASA,EACZK,EAAGJ,OAASA,EACZI,EAAGH,UAAYA,EACfG,EAAGF,QAAUA,EACbE,EAAGD,OAASA,EAEZ3M,EAAOvC,QAAUmP,G,iQChCjB,SAAUC,EAAQ7M,EAAQ0E,GAE1B,SAASoI,EAAKC,GACZ,IAgDIC,EAhDAC,EAAK3P,KAAM4P,GAgDXF,EAAI,WAEG,SAASG,GAClBA,EAAOC,OAAOD,GACd,IAAK,IAAI/P,EAAI,EAAGA,EAAI+P,EAAK9M,OAAQjD,IAAK,CAEpC,IAAImI,EAAI,oBADRyH,GAAKG,EAAKE,WAAWjQ,IAGrBmI,GADAyH,EAAIzH,IAAM,EAGVyH,GADAzH,GAAKyH,KACK,EAEVA,GAAS,YADTzH,GAAKyH,GAGP,OAAmB,wBAAXA,IAAM,KA5DhBC,EAAG/B,KAAO,WACR,IAAInL,EAAI,QAAUkN,EAAGK,GAAY,uBAAPL,EAAGpB,EAG7B,OAFAoB,EAAGK,GAAKL,EAAGM,GACXN,EAAGM,GAAKN,EAAGO,GACJP,EAAGO,GAAKzN,GAAKkN,EAAGpB,EAAQ,EAAJ9L,IAI7BkN,EAAGpB,EAAI,EACPoB,EAAGK,GAAKJ,EAAK,KACbD,EAAGM,GAAKL,EAAK,KACbD,EAAGO,GAAKN,EAAK,KACbD,EAAGK,IAAMJ,EAAKH,GACVE,EAAGK,GAAK,IAAKL,EAAGK,IAAM,GAC1BL,EAAGM,IAAML,EAAKH,GACVE,EAAGM,GAAK,IAAKN,EAAGM,IAAM,GAC1BN,EAAGO,IAAMN,EAAKH,GACVE,EAAGO,GAAK,IAAKP,EAAGO,IAAM,GAC1BN,EAAO,KAGT,SAASxH,EAAK+H,EAAG1N,GAKf,OAJAA,EAAE8L,EAAI4B,EAAE5B,EACR9L,EAAEuN,GAAKG,EAAEH,GACTvN,EAAEwN,GAAKE,EAAEF,GACTxN,EAAEyN,GAAKC,EAAED,GACFzN,EAGT,SAAS2N,EAAKX,EAAM3L,GAClB,IAAIuM,EAAK,IAAIb,EAAKC,GACda,EAAQxM,GAAQA,EAAKwM,MACrBC,EAAOF,EAAGzC,KAUd,OATA2C,EAAKC,MAAQ,WAAa,OAAoB,WAAZH,EAAGzC,OAAwB,GAC7D2C,EAAI,OAAU,WACZ,OAAOA,IAAmC,uBAAhB,QAATA,IAAoB,IAEvCA,EAAKE,MAAQF,EACTD,IACmB,UAAjB,EAAOA,IAAoBlI,EAAKkI,EAAOD,GAC3CE,EAAKD,MAAQ,WAAa,OAAOlI,EAAKiI,EAAI,MAErCE,EAyBL7N,GAAUA,EAAOvC,QACnBuC,EAAOvC,QAAUiQ,EACRhJ,QAAUA,YACb,KAANA,aAAoB,OAAOgJ,GAArB,8BAENpQ,KAAK+O,KAAOqB,EA7Ed,CAiFEpQ,EACmB,UAAnB,E,aAA+B0C,EAC9B,S,iQC1GH,SAAU6M,EAAQ7M,EAAQ0E,GAE1B,SAASsJ,EAAOjB,GACd,IAAIE,EAAK3P,KAAM2Q,EAAU,GAGzBhB,EAAG/B,KAAO,WACR,IAAI/K,EAAI8M,EAAG9M,EAAG0L,EAAIoB,EAAGpB,EAAGxF,EAAI4G,EAAG5G,EAAGnG,EAAI+M,EAAG/M,EAQzC,OAPAC,EAAKA,GAAK,GAAOA,IAAM,EAAK0L,EAC5BA,EAAKA,EAAIxF,EAAK,EACdA,EAAKA,GAAK,GAAOA,IAAM,EAAKnG,EAC5BA,EAAKA,EAAIC,EAAK,EACd8M,EAAG9M,EAAIA,EAAKA,GAAK,GAAOA,IAAM,GAAM0L,EACpCoB,EAAGpB,EAAIA,EAAKA,EAAIxF,EAAK,EACrB4G,EAAG5G,EAAKA,GAAK,GAAOwF,IAAM,GAAM3L,EACzB+M,EAAG/M,EAAKA,EAAIC,EAAK,GAmB1B8M,EAAG/M,EAAI,EACP+M,EAAG9M,EAAI,EACP8M,EAAGpB,GAAI,WACPoB,EAAG5G,EAAI,WAEH0G,IAAS/G,KAAKkI,MAAMnB,IAEtBE,EAAG/M,EAAK6M,EAAO,WAAe,EAC9BE,EAAG9M,EAAW,EAAP4M,GAGPkB,GAAWlB,EAIb,IAAK,IAAIoB,EAAI,EAAGA,EAAIF,EAAQ5N,OAAS,GAAI8N,IACvClB,EAAG9M,GAA6B,EAAxB8N,EAAQZ,WAAWc,GAC3BlB,EAAG/B,OAIP,SAASxF,EAAK+H,EAAG1N,GAKf,OAJAA,EAAEG,EAAIuN,EAAEvN,EACRH,EAAEI,EAAIsN,EAAEtN,EACRJ,EAAE8L,EAAI4B,EAAE5B,EACR9L,EAAEsG,EAAIoH,EAAEpH,EACDtG,EAGT,SAAS2N,EAAKX,EAAM3L,GAClB,IAAIuM,EAAK,IAAIK,EAAOjB,GAChBa,EAAQxM,GAAQA,EAAKwM,MACrBC,EAAO,WAAa,OAAQF,EAAGzC,SAAW,GAAK,YAenD,OAdA2C,EAAI,OAAU,WACZ,GACE,IAEI3E,IAFMyE,EAAGzC,SAAW,KACbyC,EAAGzC,SAAW,GAAK,aACF,GAAK,UACf,IAAXhC,GACT,OAAOA,GAET2E,EAAKC,MAAQH,EAAGzC,KAChB2C,EAAKE,MAAQF,EACTD,IACmB,UAAjB,EAAOA,IAAoBlI,EAAKkI,EAAOD,GAC3CE,EAAKD,MAAQ,WAAa,OAAOlI,EAAKiI,EAAI,MAErCE,EAGL7N,GAAUA,EAAOvC,QACnBuC,EAAOvC,QAAUiQ,EACRhJ,QAAUA,YACb,KAANA,aAAoB,OAAOgJ,GAArB,8BAENpQ,KAAKqP,OAASe,EAzFhB,CA6FEpQ,EACmB,UAAnB,E,aAA+B0C,EAC9B,S,iQChGH,SAAU6M,EAAQ7M,EAAQ0E,GAE1B,SAASsJ,EAAOjB,GACd,IAAIE,EAAK3P,KAAM2Q,EAAU,GAEzBhB,EAAGpI,EAAI,EACPoI,EAAGnI,EAAI,EACPmI,EAAGmB,EAAI,EACPnB,EAAG3H,EAAI,EAGP2H,EAAG/B,KAAO,WACR,IAAInL,EAAIkN,EAAGpI,EAAKoI,EAAGpI,GAAK,GAIxB,OAHAoI,EAAGpI,EAAIoI,EAAGnI,EACVmI,EAAGnI,EAAImI,EAAGmB,EACVnB,EAAGmB,EAAInB,EAAG3H,EACH2H,EAAG3H,GAAM2H,EAAG3H,IAAM,GAAMvF,EAAKA,IAAM,GAGxCgN,KAAiB,EAAPA,GAEZE,EAAGpI,EAAIkI,EAGPkB,GAAWlB,EAIb,IAAK,IAAIoB,EAAI,EAAGA,EAAIF,EAAQ5N,OAAS,GAAI8N,IACvClB,EAAGpI,GAA6B,EAAxBoJ,EAAQZ,WAAWc,GAC3BlB,EAAG/B,OAIP,SAASxF,EAAK+H,EAAG1N,GAKf,OAJAA,EAAE8E,EAAI4I,EAAE5I,EACR9E,EAAE+E,EAAI2I,EAAE3I,EACR/E,EAAEqO,EAAIX,EAAEW,EACRrO,EAAEuF,EAAImI,EAAEnI,EACDvF,EAGT,SAAS2N,EAAKX,EAAM3L,GAClB,IAAIuM,EAAK,IAAIK,EAAOjB,GAChBa,EAAQxM,GAAQA,EAAKwM,MACrBC,EAAO,WAAa,OAAQF,EAAGzC,SAAW,GAAK,YAenD,OAdA2C,EAAI,OAAU,WACZ,GACE,IAEI3E,IAFMyE,EAAGzC,SAAW,KACbyC,EAAGzC,SAAW,GAAK,aACF,GAAK,UACf,IAAXhC,GACT,OAAOA,GAET2E,EAAKC,MAAQH,EAAGzC,KAChB2C,EAAKE,MAAQF,EACTD,IACmB,UAAjB,EAAOA,IAAoBlI,EAAKkI,EAAOD,GAC3CE,EAAKD,MAAQ,WAAa,OAAOlI,EAAKiI,EAAI,MAErCE,EAGL7N,GAAUA,EAAOvC,QACnBuC,EAAOvC,QAAUiQ,EACRhJ,QAAUA,YACb,KAANA,aAAoB,OAAOgJ,GAArB,8BAENpQ,KAAKiP,OAASmB,EApEhB,CAwEEpQ,EACmB,UAAnB,E,aAA+B0C,EAC9B,S,iQCpDH,SAAU6M,EAAQ7M,EAAQ0E,GAE1B,SAASsJ,EAAOjB,GACd,IAAIE,EAAK3P,KAGT2P,EAAG/B,KAAO,WACR,IACwBnL,EAAGsO,EADvB/I,EAAI2H,EAAG3H,EACPgJ,EAAIrB,EAAGqB,EAAGlR,EAAI6P,EAAG7P,EAcrB,OAZA6P,EAAG3H,EAAIA,EAAKA,EAAI,WAAc,EAE9B+I,EAAIC,EAAGlR,EAAI,GAAM,KACjB2C,EAAIuO,EAAElR,EAAMA,EAAI,EAAK,KACrBiR,GAAKA,GAAK,GACVtO,GAAKA,GAAK,GACVsO,GAAKA,IAAM,GACXtO,GAAKA,IAAM,GAEXsO,EAAIC,EAAElR,GAAKiR,EAAItO,EACfkN,EAAG7P,EAAIA,EAECiR,GAAK/I,EAAKA,IAAM,IAAQ,GAGlC,SAAc2H,EAAIF,GAChB,IAAIhN,EAAGsO,EAAGjR,EAAGmR,EAAGjJ,EAAGgJ,EAAI,GAAIE,EAAQ,IAYnC,IAXIzB,KAAiB,EAAPA,IAEZsB,EAAItB,EACJA,EAAO,OAGPA,GAAc,KACdsB,EAAI,EACJG,EAAQxI,KAAKoD,IAAIoF,EAAOzB,EAAK1M,SAG1BjD,EAAI,EAAGmR,GAAK,GAAIA,EAAIC,IAASD,EAE5BxB,IAAMsB,GAAKtB,EAAKM,YAAYkB,EAAI,IAAMxB,EAAK1M,SAErC,IAANkO,IAASjJ,EAAI+I,GACjBA,GAAKA,GAAK,GACVA,GAAKA,IAAM,GACXA,GAAKA,GAAK,EACVA,GAAKA,IAAM,GACPE,GAAK,IACPjJ,EAAKA,EAAI,WAAc,EAEvBlI,EAAK,IADL2C,EAAKuO,EAAM,IAAJC,IAAaF,EAAI/I,GACTlI,EAAI,EAAI,GAW3B,IAPIA,GAAK,MACPkR,EAA+B,KAA5BvB,GAAQA,EAAK1M,QAAU,KAAa,GAKzCjD,EAAI,IACCmR,EAAI,IAASA,EAAI,IAAKA,EACzBF,EAAIC,EAAGlR,EAAI,GAAM,KACjB2C,EAAIuO,EAAElR,EAAMA,EAAI,EAAK,KACrBiR,GAAKA,GAAK,GACVtO,GAAKA,GAAK,GACVsO,GAAKA,IAAM,GACXtO,GAAKA,IAAM,GACXuO,EAAElR,GAAKiR,EAAItO,EAGbkN,EAAG3H,EAAIA,EACP2H,EAAGqB,EAAIA,EACPrB,EAAG7P,EAAIA,EAGTqR,CAAKxB,EAAIF,GAGX,SAASrH,EAAK+H,EAAG1N,GAIf,OAHAA,EAAE3C,EAAIqQ,EAAErQ,EACR2C,EAAEuF,EAAImI,EAAEnI,EACRvF,EAAEuO,EAAIb,EAAEa,EAAEI,QACH3O,EAGT,SAAS2N,EAAKX,EAAM3L,GACN,MAAR2L,IAAcA,GAAS,IAAI4B,MAC/B,IAAIhB,EAAK,IAAIK,EAAOjB,GAChBa,EAAQxM,GAAQA,EAAKwM,MACrBC,EAAO,WAAa,OAAQF,EAAGzC,SAAW,GAAK,YAenD,OAdA2C,EAAI,OAAU,WACZ,GACE,IAEI3E,IAFMyE,EAAGzC,SAAW,KACbyC,EAAGzC,SAAW,GAAK,aACF,GAAK,UACf,IAAXhC,GACT,OAAOA,GAET2E,EAAKC,MAAQH,EAAGzC,KAChB2C,EAAKE,MAAQF,EACTD,IACEA,EAAMU,GAAG5I,EAAKkI,EAAOD,GACzBE,EAAKD,MAAQ,WAAa,OAAOlI,EAAKiI,EAAI,MAErCE,EAGL7N,GAAUA,EAAOvC,QACnBuC,EAAOvC,QAAUiQ,EACRhJ,QAAUA,YACb,KAANA,aAAoB,OAAOgJ,GAArB,8BAENpQ,KAAKoP,QAAUgB,EAjHjB,CAqHEpQ,EACmB,UAAnB,E,aAA+B0C,EAC9B,S,iQC3IH,SAAU6M,EAAQ7M,EAAQ0E,GAE1B,SAASsJ,EAAOjB,GACd,IAAIE,EAAK3P,KAGT2P,EAAG/B,KAAO,WAER,IAAwBnL,EAAGsO,EAAvBC,EAAIrB,EAAGpI,EAAGzH,EAAI6P,EAAG7P,EAQrB,OAPA2C,EAAIuO,EAAElR,GAAoBiR,GAAhBtO,GAAMA,IAAM,GAAaA,GAAK,GACpBsO,IAApBtO,EAAIuO,EAAGlR,EAAI,EAAK,IAAc2C,IAAM,GAChBsO,IAApBtO,EAAIuO,EAAGlR,EAAI,EAAK,IAAc2C,IAAM,EAChBsO,IAApBtO,EAAIuO,EAAGlR,EAAI,EAAK,IAAc2C,GAAK,EACnCA,EAAIuO,EAAGlR,EAAI,EAAK,GAAuBiR,IAAnBtO,GAASA,GAAK,IAAeA,GAAK,EACtDuO,EAAElR,GAAKiR,EACPpB,EAAG7P,EAAKA,EAAI,EAAK,EACViR,GAGT,SAAcpB,EAAIF,GAChB,IAAIwB,EAAMD,EAAI,GAEd,GAAIvB,KAAiB,EAAPA,GAERuB,EAAE,GAAKvB,OAIX,IADAA,EAAO,GAAKA,EACPwB,EAAI,EAAGA,EAAIxB,EAAK1M,SAAUkO,EAC7BD,EAAM,EAAJC,GAAUD,EAAM,EAAJC,IAAU,GACnBxB,EAAKM,WAAWkB,GAAKD,EAAGC,EAAI,EAAK,IAAM,GAIhD,KAAOD,EAAEjO,OAAS,GAAGiO,EAAE3G,KAAK,GAC5B,IAAK4G,EAAI,EAAGA,EAAI,GAAc,IAATD,EAAEC,KAAYA,GAOnC,IANS,GAALA,EAAYD,EAAE,IAAM,EAAYA,EAAEC,GAEtCtB,EAAGpI,EAAIyJ,EACPrB,EAAG7P,EAAI,EAGFmR,EAAI,IAAKA,EAAI,IAAKA,EACrBtB,EAAG/B,OAIPuD,CAAKxB,EAAIF,GAGX,SAASrH,EAAK+H,EAAG1N,GAGf,OAFAA,EAAE8E,EAAI4I,EAAE5I,EAAE6J,QACV3O,EAAE3C,EAAIqQ,EAAErQ,EACD2C,EAGT,SAAS2N,EAAKX,EAAM3L,GACN,MAAR2L,IAAcA,GAAS,IAAI4B,MAC/B,IAAIhB,EAAK,IAAIK,EAAOjB,GAChBa,EAAQxM,GAAQA,EAAKwM,MACrBC,EAAO,WAAa,OAAQF,EAAGzC,SAAW,GAAK,YAenD,OAdA2C,EAAI,OAAU,WACZ,GACE,IAEI3E,IAFMyE,EAAGzC,SAAW,KACbyC,EAAGzC,SAAW,GAAK,aACF,GAAK,UACf,IAAXhC,GACT,OAAOA,GAET2E,EAAKC,MAAQH,EAAGzC,KAChB2C,EAAKE,MAAQF,EACTD,IACEA,EAAM/I,GAAGa,EAAKkI,EAAOD,GACzBE,EAAKD,MAAQ,WAAa,OAAOlI,EAAKiI,EAAI,MAErCE,EAGL7N,GAAUA,EAAOvC,QACnBuC,EAAOvC,QAAUiQ,EACRhJ,QAAUA,YACb,KAANA,aAAoB,OAAOgJ,GAArB,8BAENpQ,KAAKmP,UAAYiB,EAnFnB,CAuFEpQ,EACmB,UAAnB,E,aAA+B0C,EAC9B,S,iQC3FH,SAAU6M,EAAQ7M,EAAQ0E,GAE1B,SAASsJ,EAAOjB,GACd,IAAIE,EAAK3P,KAAM2Q,EAAU,GAGzBhB,EAAG/B,KAAO,WACR,IAAInL,EAAKkN,EAAGpI,EAAKoI,EAAGpI,IAAM,EAE1B,OADAoI,EAAGpI,EAAIoI,EAAGnI,EAAGmI,EAAGnI,EAAImI,EAAGmB,EAAGnB,EAAGmB,EAAInB,EAAG3H,EAAG2H,EAAG3H,EAAI2H,EAAGoB,GACzCpB,EAAG5G,EAAK4G,EAAG5G,EAAI,OAAS,IAC5B4G,EAAGoB,EAAKpB,EAAGoB,EAAKpB,EAAGoB,GAAK,EAAOtO,EAAKA,GAAK,GAAO,GAGtDkN,EAAGpI,EAAI,EACPoI,EAAGnI,EAAI,EACPmI,EAAGmB,EAAI,EACPnB,EAAG3H,EAAI,EACP2H,EAAGoB,EAAI,EAEHtB,KAAiB,EAAPA,GAEZE,EAAGpI,EAAIkI,EAGPkB,GAAWlB,EAIb,IAAK,IAAIoB,EAAI,EAAGA,EAAIF,EAAQ5N,OAAS,GAAI8N,IACvClB,EAAGpI,GAA6B,EAAxBoJ,EAAQZ,WAAWc,GACvBA,GAAKF,EAAQ5N,SACf4M,EAAG5G,EAAI4G,EAAGpI,GAAK,GAAKoI,EAAGpI,IAAM,GAE/BoI,EAAG/B,OAIP,SAASxF,EAAK+H,EAAG1N,GAOf,OANAA,EAAE8E,EAAI4I,EAAE5I,EACR9E,EAAE+E,EAAI2I,EAAE3I,EACR/E,EAAEqO,EAAIX,EAAEW,EACRrO,EAAEuF,EAAImI,EAAEnI,EACRvF,EAAEsO,EAAIZ,EAAEY,EACRtO,EAAEsG,EAAIoH,EAAEpH,EACDtG,EAGT,SAAS2N,EAAKX,EAAM3L,GAClB,IAAIuM,EAAK,IAAIK,EAAOjB,GAChBa,EAAQxM,GAAQA,EAAKwM,MACrBC,EAAO,WAAa,OAAQF,EAAGzC,SAAW,GAAK,YAenD,OAdA2C,EAAI,OAAU,WACZ,GACE,IAEI3E,IAFMyE,EAAGzC,SAAW,KACbyC,EAAGzC,SAAW,GAAK,aACF,GAAK,UACf,IAAXhC,GACT,OAAOA,GAET2E,EAAKC,MAAQH,EAAGzC,KAChB2C,EAAKE,MAAQF,EACTD,IACmB,UAAjB,EAAOA,IAAoBlI,EAAKkI,EAAOD,GAC3CE,EAAKD,MAAQ,WAAa,OAAOlI,EAAKiI,EAAI,MAErCE,EAGL7N,GAAUA,EAAOvC,QACnBuC,EAAOvC,QAAUiQ,EACRhJ,QAAUA,YACb,KAANA,aAAoB,OAAOgJ,GAArB,8BAENpQ,KAAKkP,OAASkB,EAzEhB,CA6EEpQ,EACmB,UAAnB,E,aAA+B0C,EAC9B,S,2QC1DH,SAAW6M,EAAQ+B,EAAMC,GAKzB,IAQIC,EARAC,EAAQ,IAIRC,EAAaH,EAAKI,IAAIF,EAHb,GAITG,EAAeL,EAAKI,IAAI,EAHf,IAITE,EAA0B,EAAfD,EACXE,EAAOL,IAOX,SAASM,EAAWtC,EAAMuC,EAASC,GACjC,IAAIrO,EAAM,GAINsO,EAAYC,EAAOC,GAHvBJ,EAAsB,GAAXA,EAAmB,CAAEK,SAAS,GAAUL,GAAW,IAIpDK,QAAU,CAAC5C,EAAM6C,EAAShB,IACzB,MAAR7B,EA8IL,WACE,IACE,IAAI8C,EAQJ,OAPIf,IAAee,EAAMf,EAAWgB,aAElCD,EAAMA,EAAId,IAEVc,EAAM,IAAIE,WAAWhB,IACpBlC,EAAOmD,QAAUnD,EAAOoD,UAAUC,gBAAgBL,IAE9CD,EAASC,GAChB,MAAOxS,GACP,IAAI8S,EAAUtD,EAAOuD,UACjBC,EAAUF,GAAWA,EAAQE,QACjC,MAAO,EAAE,IAAI1B,KAAM9B,EAAQwD,EAASxD,EAAOyD,OAAQV,EAAShB,KA5J3C2B,GAAaxD,EAAM,GAAI7L,GAGtCsP,EAAO,IAAIC,EAAKvP,GAIhB2M,EAAO,WAIT,IAHA,IAAIb,EAAIwD,EAAKE,EA5BJ,GA6BLrK,EAAI2I,EACJnK,EAAI,EACDmI,EAAIkC,GACTlC,GAAKA,EAAInI,GAAKkK,EACd1I,GAAK0I,EACLlK,EAAI2L,EAAKE,EAAE,GAEb,KAAO1D,GAAKmC,GACVnC,GAAK,EACL3G,GAAK,EACLxB,KAAO,EAET,OAAQmI,EAAInI,GAAKwB,GAWnB,OARAwH,EAAKC,MAAQ,WAAa,OAAmB,EAAZ0C,EAAKE,EAAE,IACxC7C,EAAKE,MAAQ,WAAa,OAAOyC,EAAKE,EAAE,GAAK,YAC7C7C,EAAI,OAAUA,EAGd4B,EAAOG,EAASY,EAAKG,GAAI/B,IAGjBU,EAAQsB,MAAQrB,GACpB,SAAS1B,EAAMd,EAAM8D,EAAcjD,GAUjC,OATIA,IAEEA,EAAM+C,GAAKjL,EAAKkI,EAAO4C,GAE3B3C,EAAKD,MAAQ,WAAa,OAAOlI,EAAK8K,EAAM,MAK1CK,GAAgBhC,EAAI,OAAYhB,EAAad,GAIrCc,IAElBA,EACA2B,EACA,WAAYF,EAAUA,EAAQzC,OAAUvP,MAAQuR,EAChDS,EAAQ1B,OAaV,SAAS6C,EAAKvP,GACZ,IAAInB,EAAG+Q,EAAS5P,EAAIb,OAChB4M,EAAK3P,KAAMF,EAAI,EAAGmR,EAAItB,EAAG7P,EAAI6P,EAAGsB,EAAI,EAAGwC,EAAI9D,EAAG0D,EAAI,GAMtD,IAHKG,IAAU5P,EAAM,CAAC4P,MAGf1T,EAAI2R,GACTgC,EAAE3T,GAAKA,IAET,IAAKA,EAAI,EAAGA,EAAI2R,EAAO3R,IACrB2T,EAAE3T,GAAK2T,EAAExC,EAAIa,EAAQb,EAAIrN,EAAI9D,EAAI0T,IAAW/Q,EAAIgR,EAAE3T,KAClD2T,EAAExC,GAAKxO,GAIRkN,EAAGyD,EAAI,SAASM,GAIf,IAFA,IAAIjR,EAAGkF,EAAI,EACP7H,EAAI6P,EAAG7P,EAAGmR,EAAItB,EAAGsB,EAAGwC,EAAI9D,EAAG0D,EACxBK,KACLjR,EAAIgR,EAAE3T,EAAIgS,EAAQhS,EAAI,GACtB6H,EAAIA,EAAI8J,EAAQgC,EAAE3B,GAAS2B,EAAE3T,GAAK2T,EAAExC,EAAIa,EAAQb,EAAIxO,KAAQgR,EAAExC,GAAKxO,IAGrE,OADAkN,EAAG7P,EAAIA,EAAG6P,EAAGsB,EAAIA,EACVtJ,IAIN8J,GAOL,SAASrJ,EAAK+H,EAAG1N,GAIf,OAHAA,EAAE3C,EAAIqQ,EAAErQ,EACR2C,EAAEwO,EAAId,EAAEc,EACRxO,EAAE4Q,EAAIlD,EAAEkD,EAAEjC,QACH3O,EAOT,SAAS2P,EAAQuB,EAAKC,GACpB,IAAqChP,EAAjCgH,EAAS,GAAIiI,EAAM,EAAQF,GAC/B,GAAIC,GAAgB,UAAPC,EACX,IAAKjP,KAAQ+O,EACX,IAAM/H,EAAOvB,KAAK+H,EAAQuB,EAAI/O,GAAOgP,EAAQ,IAAO,MAAO7T,IAG/D,OAAQ6L,EAAO7I,OAAS6I,EAAgB,UAAPiI,EAAkBF,EAAMA,EAAM,KAQjE,SAASxB,EAAO1C,EAAM7L,GAEpB,IADA,IAA4BkQ,EAAxBC,EAAatE,EAAO,GAAWwB,EAAI,EAChCA,EAAI8C,EAAWhR,QACpBa,EAAIkO,EAAOb,GACTa,GAASgC,GAAyB,GAAhBlQ,EAAIkO,EAAOb,IAAW8C,EAAWhE,WAAWkB,KAElE,OAAOqB,EAAS1O,GA8BlB,SAAS0O,EAAS1P,GAChB,OAAOkN,OAAOkE,aAAaC,MAAM,EAAGrR,GAgBtC,GANAuP,EAAOZ,EAAK2C,SAAU5C,GAMC,UAAnB,EAAQ5O,IAAuBA,EAAOvC,QAAS,CACjDuC,EAAOvC,QAAU4R,EAEjB,IACEP,EAAaxC,EAAQ,MACrB,MAAOmF,eAEH,KAAN/M,aAAoB,OAAO2K,GAArB,8BAtNR,CAiOmB,oBAATqC,KAAwBA,KAAOpU,KACvC,GACA0I,O,8RC3PF,a,2BAAyB2L,EAAzB,qB,EAAA,gB,GACKA,EAAKtR,OAAT,EAAqB,C,EACpB,GAAUsR,EAAK,GAAGjD,MAAM,GAAxB,G,QACMkD,EAAKD,EAAKtR,OAAhB,EACSwE,EAAT,EAAgBA,EAAhB,M,EACC,GAAU8M,EAAK9M,GAAG6J,MAAM,GAAxB,G,SAED,GAAWiD,EAAKC,GAAIlD,MAApB,GACOiD,EAAKE,KAAZ,I,OAEOF,EAAP,GAIF,c,MACQ,MAAQG,EAAf,IAGD,c,YACcC,IAANjT,EAAkB,YAAqB,OAANA,EAAa,OAAS+B,OAAOC,UAAUC,SAASE,KAAKnC,GAAGkT,MAAM,KAAKpI,MAAMoI,MAAM,KAAKC,QAA5H,cAGD,c,OACQH,EAAP,cCpBD,c,IAEEI,EADD,WAGCC,EAHD,QAKCC,EAAWC,EAAMF,EALlB,YAQCG,EAAeC,EAAOA,EAAO,UAAYH,EAAW,IAAMA,EAAWA,EAAW,IAAMA,EAAhEG,OAA6FA,EAAO,cAAgBH,EAAW,IAAMA,EAArIG,OAAkKA,EAAO,IAAMH,EARtM,IAUCI,EAVD,sCAWCC,EAAaJ,EAXd,6B,EAacK,EAAQ,oBAbtB,K,EAcgBL,EAAMH,EAASC,EAAS,iBAF3BO,EAAQ,8EAZrB,MAeCC,EAAUJ,EAAOL,EAAUG,EAAMH,EAASC,EAAzBD,eAflB,KAgBCU,EAAYL,EAAOA,EAAOD,EAAe,IAAMD,EAAMQ,EAAcL,EAAhDD,UAhBpB,KAkBCO,GADaP,EAAOA,EAAO,WAAa,IAAMA,EAAO,eAAjCA,IAA6DA,EAAO,eAApEA,IAAqGA,EAAO,cAA5GA,IAjBrB,GAkBsBA,EAAOA,EAAO,WAAa,IAAMA,EAAO,eAAjCA,IAA6DA,EAAO,eAApEA,IAAqGA,EAAO,gBAA5GA,QAlB7B,I,EAmBgBA,EAAOO,EAAqB,MAAQA,EAAqB,MAAQA,EAAqB,MAnBtG,GAoBCC,EAAOR,EAAOH,EApBf,SAqBCY,EAAQT,EAAOA,EAAOQ,EAAO,MAAdR,OArBhB,GAsBCU,EAAgBV,EAAmEA,EAAOQ,EAAPR,aAtBpF,G,EAuBiBA,EAAwD,SAAWA,EAAOQ,EAAlB,aAvBzE,G,EAwBiBR,EAAOA,EAAO,GAAPA,UAA4DA,EAAOQ,EAAnER,aAxBxB,G,EAyBiBA,EAAOA,EAAOA,EAAOQ,EAAPR,eAAPA,aAA4DA,EAAOQ,EAAnER,aAzBxB,G,EA0BiBA,EAAOA,EAAOA,EAAOQ,EAAPR,eAAPA,aAA4DA,EAAOQ,EAAnER,aA1BxB,G,EA2BiBA,EAAOA,EAAOA,EAAOQ,EAAPR,eAAPA,qBA3BxB,G,EA4BiBA,EAAOA,EAAOA,EAAOQ,EAAPR,eAAPA,aA5BxB,G,EA6BiBA,EAAOA,EAAOA,EAAOQ,EAAPR,eAAPA,aA7BxB,G,EA8BiBA,EAAOA,EAAOA,EAAOQ,EAAPR,eAAPA,GA9BxB,W,EA+BgBA,EAAO,CAACU,EAAeC,EAAeC,EAAeC,EAAeC,EAAeC,EAAeC,EAAeC,EAAeC,GAAe5B,KA/B/J,MAgCC6B,EAAUnB,EAAOA,EAAOM,EAAe,IAAtBN,GAhClB,K,GAiCcA,EAAOoB,EAAe,QAjCpC,GAkCsBpB,EAAOoB,EAAepB,EAAO,eAAiBH,EAAvCuB,QAlC7B,I,EAmCcpB,EAAO,OAASH,EAAW,OAASC,EAAMQ,EAAcL,EAAjD,SAnCrB,KAoCCoB,EAAcrB,EAAO,MAAQA,EAAOsB,EAAqB,IAAMF,EAAe,IAAzD,GApCtB,O,EAqCapB,EAAOA,EAAOD,EAAe,IAAMD,EAAMQ,EAAlCN,IArCpB,KAsCCuB,EAAQvB,EAAOqB,EAAc,IAAMG,EAAe,MAAQC,EAA3CJ,KAtChB,GAuCCK,EAAQ1B,EAAOJ,UACf+B,EAAa3B,EAAOA,EAAOK,EAAPL,WAAwCA,EAAO,MAA/CA,GAxCrB,KAyCC4B,EAAS5B,EAAOD,EAAe,IAAMD,EAAMQ,EAAcL,EAzC1D,aA0CC4B,EAAW7B,EAAO4B,EA1CnB,KA2CCE,EAAc9B,EAAO4B,EA3CtB,KA4CCG,EAAiB/B,EAAOA,EAAOD,EAAe,IAAMD,EAAMQ,EAAcL,EAAhDD,UA5CzB,KA6CCgC,EAAgBhC,EAAOA,EAAO,MAAPA,GA7CxB,KA8CCiC,EAAiBjC,EAAO,MAAQA,EAAO8B,EAAf,GA9CzB,K,EA+CkB9B,EAAO+B,EA/CzB,G,EAgDkB/B,EAAO8B,EAhDzB,G,EAiDe,MAAQF,EAjDvB,IAmDCM,GADQlC,EAAOgC,EAAgB,IAAMC,EAAiB,IAAME,EAAiB,IAAMC,EAAiB,IAlDrG,GAmDUpC,EAAOA,EAAO4B,EAAS,IAAM9B,EAAM,WAA5BE,IAnDjB,MAoDCqC,EAAYrC,EAAOA,EAAO4B,EAAP5B,aApDpB,KAqDCsC,EAAatC,EAAOA,EAAO,SAAW2B,EAAlB3B,mBArDrB,GAsDCuC,EAAOvC,EAAOI,EAAU,MAAQkC,EAAatC,EAAO,MAAtCI,OAA8DJ,EAAO,MAArEI,GAtDf,KAuDCoC,EAAiBxC,EAAOA,EAAO,SAAW2B,EAAlB3B,mBAvDzB,GAwDCyC,EAAYzC,EAAOwC,EAAiBxC,EAAO,MAAxBwC,OAAgDxC,EAAO,MAAvDwC,GAxDpB,K,OAyDkBxC,EAAOuC,EAAO,IAzDhC,GA0DiBvC,EAAOI,EAAU,MAAQkC,EAAatC,EAAO,MAAtCI,GA1DxB,KA4D0CJ,EAAOA,EAAO,UAAYA,EAAO,IAAMK,EAAzB,iBAAkEL,EAAO,OAAS0B,EAAlF,KAAP1B,+BAAjC,KAAiPA,EAAO,OAASkC,EAAjQ,KAAuRlC,EAAO,OAASqC,EAAvS,KACYrC,EAAOA,EAAO,UAAYA,EAAO,IAAMK,EAAzB,iBAAkEL,EAAO,OAAS0B,EAAlF,KAAP1B,+BAAlB,KAAkOA,EAAO,OAASkC,EAAlP,KAAwQlC,EAAO,OAASqC,EAAxR,KAC0BrC,EAAOA,EAAO,UAAYA,EAAO,IAAMK,EAAzB,iBAAkEL,EAAO,OAAS0B,EAAlF,KAAP1B,+BAAjC,KAAiPA,EAAO,OAASkC,EAAjQ,KACKlC,EAAO,OAASqC,EAAtB,KACQrC,EAAO,IAAMK,EAAnB,MAA4DL,EAAO,OAAS0B,EAA5E,KAGX,C,WACO,IAAIxT,OAAO4R,EAAM,MAAOH,EAASC,EAAjC,eADP,K,aAES,IAAI1R,OAAO4R,EAAM,YAAaQ,EAA9B,GAFT,K,SAGK,IAAIpS,OAAO4R,EAAM,kBAAmBQ,EAApC,GAHL,K,SAIK,IAAIpS,OAAO4R,EAAM,kBAAmBQ,EAApC,GAJL,K,kBAKc,IAAIpS,OAAO4R,EAAM,eAAgBQ,EAAjC,GALd,K,UAMM,IAAIpS,OAAO4R,EAAM,SAAUQ,EAAcL,EAAc,iBAAvD,GANN,K,aAOS,IAAI/R,OAAO4R,EAAM,SAAUQ,EAAcL,EAAzC,kBAPT,K,OAQG,IAAI/R,OAAO4R,EAAM,MAAOQ,EAAxB,GARH,K,WASO,IAAIpS,OAAOoS,EATlB,K,YAUQ,IAAIpS,OAAO4R,EAAM,SAAUQ,EAA3B,GAVR,K,YAWQ,IAAIpS,OAAO6R,EAXnB,K,YAYQ,IAAI7R,OAAO,KAAOsT,EAZ1B,M,YAaQ,IAAItT,OAAO,SAAWkT,EAAe,IAAMpB,EAAOA,EAAO,eAAiBH,EAAxBG,cAAvC,KAbnB,WAiBR,MAAe0C,GAAf,GCrFA,EAAeA,GAAf,G,8YCAMC,EAAN,WAGMC,EAAN,GAUMC,EAAN,QACMC,EAAN,aACMC,EAAN,4BAGMC,EAAS,C,SAAA,kD,YAAA,iD,gBAGG,iBAKZrH,EAAQlI,KAAd,MACMwP,EAAqBpI,OAA3B,aAUA,c,MACO,IAAIqI,WAAWF,EAArB,IA8BD,gB,IACOG,EAAQC,EAAO3D,MAArB,KACI9I,EAAJ,GACIwM,EAAMrV,OAAV,I,EAGUqV,EAAM,GAAf,I,EACSA,EAAT,I,IAKKE,EA/BP,c,QACO1M,EAAN,GACI7I,EAASwV,EAAb,OACOxV,K,EACN,GAAiByV,EAAGD,EAApB,I,OAED,EAyBgBE,E,EAFPJ,EAAOxT,QAAQmT,EAAxB,MACsBtD,MAAtB,KAC4B8D,GAAIjE,KAAhC,K,OACO3I,EAAP,EAgDD,IAmCM8M,EAAe,c,OAGbC,EAAQ,GAAK,IAAMA,EAAnBA,MAAkC,GAACC,IAA1C,IAQKC,EAAQ,gB,IACThI,EAAJ,E,MACQiI,EAAYlI,EAAMmI,EA1K3B,KA0K2CA,GAA1C,E,GACSnI,EAAMmI,EAAf,GAC8BA,EAAQC,IAA2BnI,GAAjE,E,EACSD,EAAMmI,EA3JMlB,I,OA6JdjH,EAAMC,EAAI,MAA+BkI,EAhLjD,MAsZME,EAXU,Y,OACRC,EAAUC,GAAO,Y,OAChBpB,EAAcqB,KAAKf,GACvB,OAzHU,Y,IACRgB,EAAN,GAMIC,G,EAjML,Y,QACOD,EAAN,GACIE,EAAJ,EACMxW,EAASsV,EAAf,OACOkB,EAAP,GAAyB,C,IAClBC,EAAQnB,EAAOtI,WAAWwJ,K,GAC5BC,GAAS,OAAUA,GAAnBA,OAAsCD,EAA1C,EAA4D,C,IAErDE,EAAQpB,EAAOtI,WAAWwJ,KAChC,QAAI,MAACE,G,EACJ,OAAa,KAACD,IAAF,UAA2BC,GAAvC,Q,EAIA,Q,YAID,Q,OAGF,EAyKQC,CAARP,IAGA,OAGIzJ,EA5RL,IA6RKqJ,EAAJ,EACIY,EA/RL,G,+BAkSC,E,EAA2BR,EAA3B,+CAAkC,C,IAAvBS,EAAuB,QAC7BA,EAAJ,K,EACC,KAAY1B,EAAZ,K,iFAIE2B,EAAcR,EAAlB,OACIS,EAAJ,E,IAMA,G,EACC,KA9SF,KAkTQA,EAAP,GAAqC,C,IAIhCC,EAAJ,E,+BACA,E,EAA2BZ,EAA3B,+CAAkC,C,IAAvBS,EAAuB,QAC7BA,GAAgBlK,GAAKkK,EAAzB,I,EACC,I,iFAMII,EAAwBF,EAA9B,EACIC,EAAIrK,EAAIkB,GAAOgH,EAAD,GAAlB,I,EACC,Y,IAGSmC,EAAD,GAAT,E,EACA,E,mCAEA,E,EAA2BZ,EAA3B,+CAAkC,C,IAAvBS,EAAuB,Q,GAC7BA,OAAsBb,EAA1B,G,EACC,YAEGa,GAAJ,EAAuB,C,QAElBK,EAAJ,EACSpJ,EAAT,GAAuCA,GAAvC,EAAkD,C,IAC3CpO,EAAIoO,GAAK8I,EArVpB,EAqVmC9I,GAAK8I,EApVxC,MAoV6D9I,EAAxD,E,GACIoJ,EAAJ,E,UAGMC,EAAUD,EAAhB,EACME,EAAatC,EAAnB,E,EACA,KACCK,EAAmBQ,EAAajW,EAAIyX,EAAjBxB,EADpB,K,EAGI9H,EAAMsJ,EAAV,G,EAGD,KAAYhC,EAAmBQ,EAAauB,EAA5C,K,EACOpB,EAAME,EAAOiB,EAAuBF,GAA3C,G,EACA,IACA,I,+EAIF,IACA,E,OAGMT,EAAO9E,KAAd,IAoCa6F,CADLrC,GAAP,MASIkB,EA9BY,Y,OACVC,EAAUC,GAAO,Y,OAChBrB,EAAcsB,KAAKf,GAhMb,Y,IApDM,EAsDdgB,EAAN,GACMC,EAAcH,EAApB,OACIrZ,EAAJ,EACI4P,EA5LL,IA6LKiK,EA9LL,GAoMKU,EAAQlB,EAAMmB,YAlMnB,KAmMKD,EAAJ,I,EACC,G,IAGI,IAAIpJ,EAAT,EAAgBA,EAAhB,MAEKkI,EAAMpJ,WAAWkB,IAArB,K,EACC,a,EAED,KAAYkI,EAAMpJ,WAAlB,I,IAMI,IAAIwK,EAAQF,EAAQ,EAAIA,EAAZA,EAAjB,EAA4CE,EAA5C,GAA4F,C,QAOvFC,EAAJ,EACSxS,EAAJ,EAAW6I,EAAhB,GAA8CA,GAA9C,EAAyD,CAEpD0J,GAAJ,G,EACC,iB,IAGK5B,GA9FY,EA8FSQ,EAAMpJ,WAAWwK,MA7F9B,GAAhB,GACQE,EAAP,GAEGA,EAAY,GAAhB,GACQA,EAAP,GAEGA,EAAY,GAAhB,GACQA,EAAP,GAED,GAsFM9B,GAASd,GAAQc,EAAQ/H,GAAOgH,EAAD,GAAnC,K,EACC,Y,GAGIe,EAAL,E,IACMlW,EAAIoO,GAAK8I,EA7OlB,EA6OiC9I,GAAK8I,EA5OtC,MA4O2D9I,EAAxD,E,GAEI8H,EAAJ,E,UAIMwB,EAAatC,EAAnB,EACI7P,EAAI4I,EAAMgH,EAAd,I,EACC,Y,GAGD,E,IAIKrF,EAAM8G,EAAOtW,OAAnB,E,EACO8V,EAAM/Y,EAAN+Y,IAAP,GAA4B2B,GAIxB5J,EAAM9Q,EAAN8Q,GAAiBgH,EAArB,G,EACC,Y,GAGIhH,EAAM9Q,EAAX,G,GACA,E,EAGA,OAAcA,IAAd,K,OAIMgQ,OAAO4K,cAAP5K,aAAP,GAgHI6K,CAAOtC,EAAOjH,MAAM,GADhB0G,eAAP,MC3SW8C,EAAN,GAEP,c,IACOrM,EAAIsM,EAAI9K,WAAd,G,OAGIxB,EAAJ,GAAgB,KAAOA,EAAE9K,SAAS,IAAlC,cACS8K,EAAJ,IAAiB,IAAMA,EAAE9K,SAAS,IAAlC,cACI8K,EAAJ,KAAkB,KAAQA,GAAD,EAAD,kBAAN,mBAA2D,GAACA,EAAF,kBAA5E,cACI,KAAQA,GAAD,GAAD,kBAAN,mBAA8DA,GAAD,EAAD,GAAD,kBAA3D,mBAAuH,GAACA,EAAF,kBAA1HxO,cAKN,c,QACK+a,EAAJ,GACIhb,EAAJ,EACMib,EAAKvG,EAAX,OAEO1U,EAAP,GAAe,C,IACRyO,EAAIyM,SAASxG,EAAIyG,OAAOnb,EAAX0U,EAATwG,GAAV,I,GAEIzM,EAAJ,I,GACWuB,OAAOkE,aAAjB,G,GACA,OAEI,GAAIzF,GAAK,KAAOA,EAAhB,IAAyB,C,GACxBwM,EAAD,GAAJ,EAAmB,C,IACZG,EAAKF,SAASxG,EAAIyG,OAAOnb,EAAX0U,EAATwG,GAAX,I,GACUlL,OAAOkE,cAAc,GAACzF,IAAF,EAA9B,GAAiD2M,Q,GAEvC1G,EAAIyG,OAAOnb,EAArB,G,GAED,OAEI,GAAIyO,GAAJ,IAAc,C,GACbwM,EAAD,GAAJ,EAAmB,C,IACZG,EAAKF,SAASxG,EAAIyG,OAAOnb,EAAX0U,EAATwG,GAAX,IACMG,EAAKH,SAASxG,EAAIyG,OAAOnb,EAAX0U,EAATwG,GAAX,I,GACUlL,OAAOkE,cAAc,GAACzF,IAAF,IAAoB,GAAC2M,IAArB,EAA9B,GAAqEC,Q,GAE3D3G,EAAIyG,OAAOnb,EAArB,G,GAED,O,GAGU0U,EAAIyG,OAAOnb,EAArB,G,GACA,E,OAIF,EAGD,gB,SACAsb,EAAC,G,IACOC,EAASC,EAAf,G,OACSD,EAAOE,MAAMC,EAAd,YAAR,EAAQ,E,OAGLC,EAAJ,SAAuBA,EAAWC,OAAS5L,OAAO2L,EAAP3L,gBAAkC0L,EAAlC1L,qCAAgG0L,EAAhG1L,WAApB2L,UACvB,IAAIA,EAAWE,WAAwBF,EAAWE,SAAW7L,OAAO2L,EAAP3L,kBAAoC0L,EAApC1L,uBAAoF0L,EAApF1L,wBAA+H0L,EAA/H1L,YAAtB2L,SACvC,IAAIA,EAAWG,OAAoBH,EAAWG,KAAO9L,OAAO2L,EAAP3L,cAAgC0L,EAAhC1L,qCAA8F0L,EAA9F1L,oBAAqI0L,EAArI1L,YAAlB2L,SACnC,IAAIA,EAAWI,OAAoBJ,EAAWI,KAAO/L,OAAO2L,EAAP3L,cAAgC0L,EAAhC1L,uBAAiF2L,EAAWC,OAASF,EAApBC,SAAwCD,EAAzH1L,6BAA0K0L,EAA1K1L,YAAlB2L,SACnC,IAAIA,EAAWK,QAAqBL,EAAWK,MAAQhM,OAAO2L,EAAP3L,eAAiC0L,EAAjC1L,uBAAiF0L,EAAjF1L,qBAAyH0L,EAAzH1L,YAAnB2L,SACpC,IAAIA,EAAWM,WAAwBN,EAAWM,SAAWjM,OAAO2L,EAAP3L,kBAAoC0L,EAApC1L,uBAAoF0L,EAApF1L,wBAA+H0L,EAA/H1L,YAAtB2L,IAEvC,EAGD,c,OACQjH,EAAI3P,QAAQ,UAAW,OAA9B,IAGD,gB,IACOmX,EAAUJ,EAAKL,MAAMC,EAAXI,cAAhB,GACSK,E,EAFV,Q,OAIC,EACQA,EAAQvH,MAAM,KAAK+D,IAAIyD,GAAoB3H,KAAlD,KAEA,EAIF,gB,IACOyH,EAAUJ,EAAKL,MAAMC,EAAXI,cAAhB,G,IADD,KAEUK,EAFV,KAEmBE,EAFnB,K,GAIC,EAAa,C,UACUF,EAAQG,cAAc1H,MAAM,MADtC,U,SACL2H,EADK,KACCC,EADD,KAENC,EAAcD,EAAQA,EAAM5H,MAAM,KAAK+D,IAAzB6D,GAApB,GACME,EAAaH,EAAK3H,MAAM,KAAK+D,IAAnC,GACMgE,EAAyBjB,EAASkB,YAAYtD,KAAKoD,EAAWA,EAAWzZ,OAA/E,IACM4Z,EAAaF,EAAyB,EAA5C,EACMG,EAAkBJ,EAAWzZ,OAAnC,EACM8Z,EAAS5Z,MAAf,GAESsE,EAAT,EAAgBA,EAAhB,M,EACC,GAAYgV,EAAYhV,IAAMiV,EAAWI,EAA7BL,IAAZ,GAGD,I,EACQI,EAAP,GAAyBG,EAAeD,EAAOF,EAAtBG,GAAzB,I,IAeKC,EAZgBF,EAAOG,QAA4C,gB,IACnEC,GAAL,MAAcA,EAAe,C,IACtBC,EAAcC,EAAIA,EAAIpa,OAA5B,GACIma,GAAeA,EAAY3C,MAAQ2C,EAApBA,SAAnB,E,EACC,S,EAEA,KAAS,CAAE3C,MAAF,EAASxX,OAAlB,I,OAGF,IATD,IAYwCqa,MAAK,c,OAAUva,EAAEE,OAASH,EAArB,UAA7C,GAEIya,S,GACAN,GAAqBA,EAAkBha,OAA3C,EAAuD,C,IAChDua,EAAWT,EAAOzL,MAAM,EAAG2L,EAAjC,OACMQ,EAAUV,EAAOzL,MAAM2L,EAAkBxC,MAAQwC,EAAvD,Q,EACUO,EAAS/I,KAAK,KAAO,KAAOgJ,EAAQhJ,KAA9C,U,EAEUsI,EAAOtI,KAAjB,K,OAGD,I,GACY,IAAX,GAGD,E,OAEA,EAIF,IAAMiJ,EAAN,kIACMC,OAAN,IAAiD,qBAEjD,c,IAAwCzL,EAAxC,0DACOyJ,EAAN,GACMD,GAA4B,IAAhBxJ,EAAQ0L,IAAgBC,EAA1C,EAEA,WAAI3L,EAAQ4L,YAAwBC,GAAa7L,EAAQ0J,OAAS1J,EAAQ0J,OAAzB1J,IAAD,SAAZ6L,G,IAE9B7B,EAAU6B,EAAUtC,MAA1B,G,GAEA,EAAa,CACZ,G,EAEC,OAAoBS,EAApB,G,EACA,SAAsBA,EAAtB,G,EACA,KAAkBA,EAAlB,G,EACA,KAAkBhB,SAASgB,EAAThB,GAAlB,I,EACA,KAAkBgB,EAAQ,IAA1B,G,EACA,MAAmBA,EAAnB,G,EACA,SAAsBA,EAAtB,GAGI8B,MAAMrC,EAAV,Q,EACC,KAAkBO,EAAlB,M,EAID,OAAoBA,EAAQ,SAA5B,E,EACA,UAAuB6B,MAAUE,QAAQ,KAAc/B,EAAhC6B,QAAvB,E,EACA,MAAmBA,MAAUE,QAAQ,MAAe/B,EAAjC6B,QAAnB,E,EACA,KAAkB7C,SAASgB,EAAThB,GAAlB,I,EACA,KAAkBgB,EAAQ,IAA1B,G,EACA,OAAoB6B,MAAUE,QAAQ,KAAc/B,EAAhC6B,QAApB,E,EACA,UAAuBA,MAAUE,QAAQ,KAAc/B,EAAhC6B,QAAvB,EAGIC,MAAMrC,EAAV,Q,EACC,KAAmBoC,EAAUtC,MAAM,iCAAmCS,EAAnD6B,QAAnB,IAIEpC,EAAJ,O,EAEC,KAAkBuC,EAAelB,EAAerB,EAAfqB,KAAfkB,GAAlB,SAIyBvJ,IAAtBgH,EAAWC,aAAXD,IAAmCA,EAAWE,eAA9CF,IAAwEA,EAAWG,WAAnFH,IAAyGA,EAAWwC,MAAuBxC,EAA3IA,WAAJ,IAAkKA,EAAWK,WAEtK,IAAIL,EAAWC,O,EACrB,0BACM,IAAID,EAAWM,S,EACrB,qB,EAEA,gB,EANA,0BAUG/J,EAAQ4L,WAAR5L,WAAqBA,EAAQ4L,WAA0B5L,EAAQ4L,YAAcnC,EAAjF,Y,EACC,MAAmBA,EAAWyC,OAAS,gBAAkBlM,EAAlB,UAAvC,e,IAIKmM,EAAgBvD,GAAS5I,EAAQ0J,QAAUD,EAAlBzJ,QAAD,IAA9B,e,GAGKA,EAAD,gBAA6BmM,GAAkBA,EAAnD,e,EAcC,SAdiF,C,GAE7E1C,EAAWG,OAAS5J,EAAQoM,YAAeD,GAAiBA,EAAhE,Y,MAGE,KAAkBlF,EAAiBwC,EAAWG,KAAK/W,QAAQ2W,EAAxBC,eAAnC,eACC,MAAO1b,G,EACR,MAAmB0b,EAAWyC,OAAS,kEAAvC,E,EAIF,KAOGC,GAAiBA,EAArB,O,EACC,gB,EAGD,MAAmB1C,EAAWyC,OAA9B,yB,OAGD,EAGD,gB,IACO1C,GAA4B,IAAhBxJ,EAAQ0L,IAAgBC,EAA1C,EACMU,EAAN,G,YAEA,IAAI5C,EAAWE,W,EACd,KAAeF,EAAf,U,EACA,gBAGD,IAAIA,EAAWG,M,EAEd,KAAeoC,EAAelB,EAAehN,OAAO2L,EAAtBqB,MAAf,cAAoFtB,EAApF,aAA0G,gB,MAAe,IAAM8C,GAAMC,EAAK,MAALA,EAAZ,IAAf,QAGtH,iBAAO9C,EAAP,MAAJ,iBAAkDA,EAAP,O,EAC1C,U,EACA,KAAe3L,OAAO2L,EAAtB,QAGM4C,EAAUtb,OAASsb,EAAU9J,KAA7B8J,SAAP,EAGD,IAAMG,EAAN,WACMC,EAAN,cACMC,EAAN,gBAEMC,EAAN,yBAEA,c,QACOtF,EAAN,GAEOF,EAAP,Q,GACKA,EAAMoC,MAAV,G,EACSpC,EAAMtU,QAAQ2Z,EAAtB,SACM,GAAIrF,EAAMoC,MAAV,G,EACEpC,EAAMtU,QAAQ4Z,EAAtB,UACM,GAAItF,EAAMoC,MAAV,G,EACEpC,EAAMtU,QAAQ6Z,EAAtB,K,EACA,WACM,GAAc,MAAVvF,GAAJ,OAAqBA,E,EAC3B,OACM,C,IACAyF,EAAKzF,EAAMoC,MAAjB,G,IACA,E,MAKO,IAAIsD,MAAV,oC,IAJMpL,EAAImL,EAAV,G,EACQzF,EAAM/H,MAAMqC,EAApB,Q,EACA,Q,OAOI4F,EAAO9E,KAAd,IAGD,c,IAAoDvC,EAApD,0DACOwJ,EAAYxJ,EAAQ0L,IAAMC,EAAhC,EACMU,EAAN,GAGMF,EAAgBvD,GAAS5I,EAAQ0J,QAAUD,EAAlBzJ,QAAD,IAA9B,e,GAGImM,GAAiBA,EAArB,WAA8CA,EAAcW,UAAUrD,EAAYzJ,GAE9EyJ,EAAJ,K,GAEKD,EAASuD,YAAY3F,KAAKqC,EAA9B,YAKK,GAAIzJ,EAAQoM,YAAeD,GAAiBA,EAA5C,W,MAGH,KAAoBnM,EAAD,IAA4GiH,EAAmBwC,EAAlJ,MAAkCxC,EAAiBwC,EAAWG,KAAK/W,QAAQ2W,EAAxBC,eAAhC,eAClB,MAAO1b,G,EACR,MAAmB0b,EAAWyC,OAAS,+CAAkDlM,EAAD,IAAjD,UAAiD,SAAjD,kBAAvC,E,EAMH,KAE0B,WAAtBA,EAAQ4L,WAA0BnC,EAAtC,S,EACC,KAAeA,EAAf,Q,EACA,W,IAGKuD,EAAYC,EAAoBxD,EAAtC,G,QACA,IAAIuD,IACH,WAAIhN,EAAQ4L,W,EACX,W,EAGD,QAEInC,EAAWI,MAAf,MAAuBJ,EAAWI,KAAKqD,OAAO,I,EAC7C,gBAIF,IAAIzD,EAAWI,KAAoB,C,IAC9BpI,EAAIgI,EAAR,KAEKzJ,EAAD,cAA2BmM,GAAkBA,EAAjD,e,EACKgB,EAAJ1L,SAGD,IAAIuL,I,EACCvL,EAAE5O,QAAQ,QADc,S,EAI7B,Q,YAGD,IAAI4W,EAAWK,Q,EACd,U,EACA,KAAeL,EAAf,aAGD,IAAIA,EAAWM,W,EACd,U,EACA,KAAeN,EAAf,WAGM4C,EAAU9J,KAxElB,IA2EA,gB,IAA8EvC,EAA9E,0DAAuGoN,EAAvG,aACOC,EAAN,G,OAEA,I,EACQC,EAAMR,EAAUjH,EAAhByH,GADgB,G,EAEZA,EAAMR,EAAUS,EAAhBD,GAFY,M,EAIdtN,GAAV,IAEI,UAAqBuN,EAAzB,Q,EACC,OAAgBA,EAAhB,O,EAEA,SAAkBA,EAAlB,S,EACA,KAAcA,EAAd,K,EACA,KAAcA,EAAd,K,EACA,KAAcJ,EAAkBI,EAAS1D,MAAzC,I,EACA,MAAe0D,EAAf,aAE0B9K,IAAtB8K,EAAS5D,eAAT4D,IAAmCA,EAAS3D,WAAhD,IAAsE2D,EAAStB,M,EAE9E,SAAkBsB,EAAlB,S,EACA,KAAcA,EAAd,K,EACA,KAAcA,EAAd,K,EACA,KAAcJ,EAAkBI,EAAS1D,MAAzC,I,EACA,MAAe0D,EAAf,QAEKA,EAAL,MAQC,MAAIA,EAAS1D,KAAKqD,OAAO,G,EACxB,KAAcC,EAAkBI,EAAhC,YAEuB9K,IAAlBoD,EAAK8D,eAAL9D,IAA+BA,EAAK+D,WAArC,IAA2D/D,EAAKoG,MAAwBpG,EAA5F,KAEYA,EAAL,K,EAGN,KAAcA,EAAKgE,KAAKzK,MAAM,EAAGyG,EAAKgE,KAAKvB,YAAY,KAAzCzC,GAAqD0H,EAAnE,K,EAFA,KAAcA,EAAd,K,EAFA,KAAc,IAAMA,EAApB,K,EAMD,KAAcJ,EAAkBE,EAAhC,O,EAED,MAAeE,EAAf,Q,EAnBA,KAAc1H,EAAd,UACA,IAAI0H,EAASzD,M,EACZ,MAAeyD,EAAf,M,EAEA,MAAe1H,EAAf,O,EAkBF,SAAkBA,EAAlB,S,EACA,KAAcA,EAAd,K,EACA,KAAcA,EAAd,M,EAED,OAAgBA,EAAhB,Q,EAGD,SAAkB0H,EAAlB,SAEA,EA0CD,gB,OACQ/K,GAAOA,EAAI/Q,WAAWoB,QAAUmN,GAAYA,EAAb,IAAsD2L,EAA9EnJ,YAAmDgL,EAA3B,YAAtC,GCxiBD,IAAMC,EAA2B,C,OAAA,O,YAAA,E,MAKxB,c,OAEFhE,EAAL,O,EACC,MAAmBA,EAAWyC,OAA9B,+BAGD,G,UAGW,c,IACLwB,EAAN,UAAe5P,OAAO2L,EAAP3L,sB,OAGX2L,EAAWwC,QAAUyB,EAAS,IAA9BjE,KAAJ,KAA+CA,EAAWwC,O,EACzD,aAIIxC,EAAL,O,EACC,UAOD,IC9BIgE,EAA2B,C,OAAA,Q,WAEnBE,EAFmB,W,MAGxBA,EAHwB,M,UAIpBA,EAAKb,WCAlB,c,MACQ,kBAAOc,EAAP,OAA2CA,EAA3C,OAAP,QAAwE9P,OAAO8P,EAAP9P,sBAIzE,IAAM2P,EAA2B,C,OAAA,K,YAAA,E,MAKxB,c,IACDG,EAAN,E,SAGA,OAAsBC,EAAtBD,G,EAGA,cAA6BA,EAAa/D,MAAd,MAA8B+D,EAAa9D,MAAQ,IAAM8D,EAA3BA,MAA1D,I,EACA,Y,EACA,aAEA,G,UAGW,c,GAEPA,EAAa3B,QAAU4B,EAASD,GAAgB,IAAhDA,KAAJ,KAAiEA,EAAa3B,O,EAC7E,aAID,kBAAW2B,EAAP,S,EACH,OAAuBA,EAAaF,OAAS,MAA7C,K,EACA,eAIGE,EAAJ,aAA+B,C,MACRA,EAAaE,aAAapL,MADlB,K,SACvBmH,EADuB,KACjBC,EADiB,K,EAE9B,KAAqBD,SAAQA,EAARA,OAArB,E,EACA,Q,EACA,oB,SAID,gBAEA,ICnDI4D,EAA2B,C,OAAA,M,WAEnBM,EAFmB,W,MAGxBA,EAHwB,M,UAIpBA,EAAGjB,WCSVkB,EAAN,GAIMzK,EAAe,mGACfT,EAAN,cACME,EAAeC,EAAOA,EAAO,sBAA6BH,EAAWA,EAAW,IAAMA,EAAhEG,OAA6FA,EAAO,0BAAiCH,EAArIG,OAAkKA,EAAO,IAAMH,EAA3M,IAeMmL,EAAUlL,EADhB,6DACA,aAqBMmL,EAAa,IAAI/c,OAAOoS,EAA9B,KACM4K,EAAc,IAAIhd,OAAO6R,EAA/B,KACMoL,GAAiB,IAAIjd,OAAO4R,EAAM,MAzBxC,wDAyBwD,QAAS,QAA1C,GAAvB,KAEMsL,GAAa,IAAIld,OAAO4R,EAAM,MAAOQ,EAjB3C,uCAiBA,KACM+K,GAAN,GAIA,e,IACOjF,EAASC,EAAf,G,OACSD,EAAOE,MAAR,GAAR,EAAQ,EAGT,IAAMkE,GAA8C,C,OAAA,S,MAG3C,c,IACDc,EAAN,EACMC,EAAKD,EAAiBC,GAAMD,EAAiB1E,KAAO0E,EAAiB1E,KAAKnH,MAA9C6L,KAAlC,G,KACA,YAEIA,EAAJ,MAA4B,C,QACvBE,GAAJ,EACMC,EAAN,GACMC,EAAUJ,EAAiBzE,MAAMpH,MAAvC,KAESnN,EAAJ,EAAW+M,EAAKqM,EAArB,OAAqCpZ,EAArC,MAAkD,C,IAC3CqZ,EAASD,EAAQpZ,GAAGmN,MAA1B,K,OAEQkM,EAAR,I,IACC,K,QACOC,EAAUD,EAAO,GAAGlM,MAA1B,KACSnN,EAAJ,EAAW+M,EAAKuM,EAArB,OAAqCtZ,EAArC,M,EACC,KAAQsZ,EAAR,I,UAGF,U,EACC,QAA2BC,EAAkBF,EAAlBE,GAA3B,G,UAED,O,EACC,KAAwBA,EAAkBF,EAAlBE,GAAxB,G,iBAGA,E,EACQA,EAAkBF,EAAlBE,GAAR,IAAiDA,EAAkBF,EAAlBE,GAAjD,IAKH,IAAoBP,EAAiBG,QAAUA,G,EAGhD,a,IAEK,IAAInZ,EAAJ,EAAW+M,EAAKkM,EAArB,OAAgCjZ,EAAhC,MAA6C,C,IACtCwZ,EAAOP,EAAG,GAAHA,MAAb,K,KAEA,GAAUM,EAAkBC,EAA5B,IAEK/O,EAAL,e,EAQC,GAAU8O,EAAkBC,EAAlBD,MAAV,mB,MALC,GAAU7H,EAAiB6H,EAAkBC,EAAlBD,MAA3B,eACC,MAAO/gB,G,EACR,MAAyBwgB,EAAiBrC,OAAS,2EAAnD,E,EAMF,GAAQ6C,EAAKxM,KAAb,K,OAGD,G,UAGW,c,IT7Gb,ES8GQkH,EAAN,EACM+E,ET9GA7M,OADR,ES+GqB4M,EAAnB,IT9G2C5M,aAAe1Q,MAAQ0Q,EAAO,iBAAOA,EAAP,QAAkCA,EAAlC,OAA+CA,EAA/C,aAAkEA,EAAlE,KAA6E,CAA7E,GAAqF1Q,MAAMO,UAAU4N,MAAMzN,KAA9KgQ,GAAP,G,GS+GC,EAAQ,C,IACF,IAAIpM,EAAJ,EAAW+M,EAAKkM,EAArB,OAAgCjZ,EAAhC,MAA6C,C,IACtCyZ,EAASlR,OAAO0Q,EAAtB,IACMS,EAAQD,EAAO1G,YAArB,KACM4G,EAAaF,EAAO5P,MAAM,EAAd,yCAAlB,GACI+P,EAASH,EAAO5P,MAAM6P,EAA1B,G,MAIYjP,EAAD,IAAoFiH,EAA9FkI,GAAyBlI,EAAiB6H,EAAkBK,EAAQnP,GAA1D,eACT,MAAOjS,G,EACR,MAAmB0b,EAAWyC,OAAS,wDAA2DlM,EAAD,IAA1D,UAA0D,SAA1D,kBAAvC,E,EAGD,GAAQkP,EAAY,IAApB,E,EAGD,KAAkBV,EAAGjM,KAArB,K,IAGKmM,EAAUH,EAAiBG,QAAUH,EAAiBG,SAA5D,GAEIH,EAAJ,UAA8BG,EAAiB,QAAIH,EAArBG,SAC1BH,EAAJ,OAA2BG,EAAc,KAAIH,EAAlBG,M,IAErB7D,EAAN,G,IACK,IAAL,OACK6D,EAAQzgB,KAAU+f,EAAtB,I,EACC,KACC/f,EAAK4E,QAAQsb,EAAa/E,IAAkBvW,QAAQsb,EAAaiB,GAAavc,QAAQwb,GAAYgB,GAAlGphB,IAEAygB,EAAQzgB,GAAM4E,QAAQsb,EAAa/E,IAAkBvW,QAAQsb,EAAaiB,GAAavc,QAAQyb,GAHhG,I,OAOEzD,EAAJ,S,EACC,MAAmBA,EAAOtI,KAA1B,MAGD,IC/JI+M,GAAN,kBAIM7B,GAAqD,C,OAAA,M,MAGlD,c,IACDzD,EAAUP,EAAWI,MAAQJ,EAAWI,KAAKN,MAAnD,IACIgG,EAAJ,E,GAEA,EAAa,C,IACN7F,EAAS1J,EAAQ0J,QAAU6F,EAAlBvP,QAAf,MACMwP,EAAMxF,EAAQ,GAApB,cACMyF,EAAMzF,EAAZ,GACM0F,EAAehG,EAAfgG,KAAyB1P,EAAQwP,KAAvC,GACMrD,EAAgBvD,EAAtB,G,EAEA,M,EACA,M,EACA,YAEA,I,EACiBuD,EAAcmB,MAAMiC,EAApC,S,EAGD,MAAsBA,EAAcrD,OAApC,yB,OAGD,G,UAGW,c,IACLxC,EAAS1J,EAAQ0J,QAAU6F,EAAlBvP,QAAf,MACMwP,EAAMD,EAAZ,IACMG,EAAehG,EAAfgG,KAAyB1P,EAAQwP,KAAvC,GACMrD,EAAgBvD,EAAtB,GAEA,I,EACiBuD,EAAcW,UAAUyC,EAAxC,I,IAGKI,EAAN,EACMF,EAAMF,EAAZ,I,SACA,MAAwBC,GAAOxP,EAA/B,WAEA,ICxDI4P,GAAN,2DAIMnC,GAAsE,C,OAAA,W,MAGnE,c,IACDoC,EAAN,E,SACAC,KAAsBD,EAAtB,I,EACA,WAEK7P,EAAD,UAAuB6P,EAAD,MAAyBA,EAAeC,KAAKvG,MAAvE,M,EACC,MAAuBsG,EAAe3D,OAAtC,sBAGD,G,UAGW,c,IACLqD,EAAN,E,SAEA,KAAqBM,EAAeC,MAAhB,IAApB,cACA,IC5BFlH,EAAQ+E,EAAR/E,UAGAA,EAAQmH,EAARnH,UAGAA,EAAQmF,EAARnF,UAGAA,EAAQoH,EAARpH,UAGAA,EAAQqH,GAARrH,WAGAA,EAAQsH,GAARtH,WAGAA,EAAQkH,GAARlH,W,yHR6eA,gB,IACOuH,EJpeP,c,IACOxO,EIme2B,CAAE+H,OAAT0G,Q,GJle1B,E,IACM,IAAL,O,EACC,GAAWhf,EAAX,G,OAGF,EI6d0Bgf,CAAO,EAAjC,G,OACOtD,EAAUuD,EAAkB/C,EAAMgD,EAAxBD,GAAqD/C,EAAMiD,EAA3DF,MAAVvD,GAAP,I,YAKD,c,MACC,iBAAW0D,E,EACJ1D,EAAUQ,EAAMkD,EAAhB1D,GAAN,GACM,WAAI2D,EAAOD,K,EACXlD,EAAMR,EAAU,EAAhBQ,GAAN,IAGD,G,QAKD,gB,MACC,iBAAWoD,E,EACH5D,EAAUQ,EAAMoD,EAAhB5D,GAAP,GACM,WAAI2D,EAAOC,K,EACV5D,EAAU,EAAjB,IAGD,iBAAW6D,E,EACH7D,EAAUQ,EAAMqD,EAAhB7D,GAAP,GACM,WAAI2D,EAAOE,K,EACV7D,EAAU,EAAjB,IAGM4D,IAAP,G,kBAGD,c,OACQlO,GAAOA,EAAI/Q,WAAWoB,QAAUmN,GAAYA,EAAb,IAAiD2L,EAAzEnJ,OAAmDgL,EAA3B,OAAtC,I,ktBStiBD,IAAMoD,aAAe5T,oBAAQ,MAEvB6T,e,WACJ,aAAc,wBACZ7iB,KAAK8iB,cAAgB,aACrB9iB,KAAK+iB,cAAgB,a,kDAGlB9Q,GACHjS,KAAK+iB,cAAgB9Q,I,2BAGlBA,GACHjS,KAAK8iB,cAAgB7Q,M,KAInB+Q,W,WAEJ,sBAAc,iCACZhjB,KAAKijB,UAAY,SAACC,KAClBljB,KAAKmjB,gBAAkB,IACvBnjB,KAAKojB,gBAAkB,EACvBpjB,KAAKqjB,gBAAkB,IAAIR,e,8EAGjBS,WAAW,eACjBlX,SAAW,KACf,GAAwB,QAArBkX,UAAUC,QAAmB,CAC9B,IAAID,UAAUzjB,KAAM,KAAM,wBAC1B,IAAI2jB,SAAWF,UAAUE,SACrBC,KAAOH,UAAUG,KACjB/a,KAAOka,eAEPc,KAAO1jB,KAAKqjB,gBAChBM,KAAKL,UAAUzjB,MACf6jB,KAAKZ,cAAcU,SAAUC,MAC7BrX,SAAW,CAACyD,KAAM,CAAC5N,KAAM,OAAQuhB,gBAC5B,GAAyB,UAArBF,UAAUC,QAAqB,CACxC,IAAIjT,MAAQgT,UAAUhT,MAClBsT,QAAUN,UAAUM,QACrB5jB,KAAKqjB,gBAAgBN,eACtB/iB,KAAKqjB,gBAAgBN,cAAczS,MAAOsT,SAC1CxX,SAAW,CAACyD,KAAM+T,UAElBxX,SAAW,CAACyD,KAAM+T,SAGnB5jB,KAAKojB,gBAAkBpjB,KAAKmjB,iBAC7BnjB,KAAKojB,kBACLpjB,KAAKijB,UAAU7W,YAEfpM,KAAKojB,gBAAkB,EACvBS,YAAW,WACT,MAAKZ,UAAU7W,YACd,M,qDAUT,6C,SCjEA1J,EAAOvC,QAAU,WACf,IAAIyL,EAAS,GACT1G,EAAQ,CAAC,OAAQ,KAAM,IAAK,SAAU,QAAS,QAAS,UAAW,MAAO,MAAO,MAAO,MAAO,MAAO,OAAQ,OAAQ,OAAQ,MAAO,MAAO,MAAO,QAAS,SAAU,QAAS,QAAS,OAAQ,OAAQ,MAAO,OACnN,IAAI,IAAIpF,KAAKoF,EACX0G,EAAO1G,EAAMpF,IAAM4I,KAAKxD,EAAMpF,IA6ChC,OA1CA8L,EAAOkY,IAAM,GAEblY,EAAOmY,IAAM,GAEbnY,EAAOkY,IAAIhb,UAAY,SAASlG,GAE9B,IADAA,EAAIwI,OAAOxI,GACLA,EAAI,KAAKA,GAAK,IACpB,KAAMA,IAAM,KAAKA,GAAK,IACtB,OAAOA,GAGTgJ,EAAOmY,IAAIjb,UAAY,SAASlG,GAE9B,IADAA,EAAIwI,OAAOxI,GACLA,EAAIgJ,EAAOoY,IAAIphB,GAAe,EAAVgJ,EAAOoY,GACjC,KAAMphB,IAAMgJ,EAAOoY,IAAIphB,GAAe,EAAVgJ,EAAOoY,GACnC,OAAOphB,GAGTgJ,EAAOqY,QAAU,SAASlT,GACxB,OAAOnF,EAAOmY,IAAIjb,UAAUiI,GAAGnF,EAAOoY,GAAG,OAG3CpY,EAAOsY,QAAU,SAASnT,GACxB,OAAOnF,EAAOkY,IAAIhb,UAAUiI,GAAG,IAAInF,EAAOoY,MAG5CpY,EAAOmY,IAAII,MAAQvY,EAAOuY,MAE1BvY,EAAOkY,IAAIK,MAAQ,SAAS3c,EAAGD,GAC7B,OAAOqE,EAAOsY,QAAQtY,EAAOmY,IAAII,MAAM3c,EAAGD,KAG5CqE,EAAOwY,SAAW,SAASC,EAAIC,EAAIC,EAAIC,GACrC,IAAIC,EAAKF,EAAKF,EACVK,EAAKF,EAAKF,EACd,OAAO1Y,EAAOjC,KAAK8a,EAAGA,EAAKC,EAAGA,IAGhC9Y,EAAO+Y,YAAc,SAAS/hB,EAAGC,GAC/B,GAAGD,EAAIC,EAAG,KAAM,iEAChB,OAAOD,EAAIgJ,EAAOsI,UAAUrR,EAAED,IAEzBgJ,I,aChDLgZ,yBAA2B,GAG/B,SAASC,oBAAoBC,GAE5B,GAAGF,yBAAyBE,GAC3B,OAAOF,yBAAyBE,GAAU3kB,QAG3C,IAAIuC,EAASkiB,yBAAyBE,GAAY,CACjDC,GAAID,EACJE,QAAQ,EACR7kB,QAAS,IAUV,OANA8kB,oBAAoBH,GAAUnhB,KAAKjB,EAAOvC,QAASuC,EAAQA,EAAOvC,QAAS0kB,qBAG3EniB,EAAOsiB,QAAS,EAGTtiB,EAAOvC,QCvBf0kB,oBAAoBK,KAAO,WAC1B,MAAM,IAAIrG,MAAM,mCCDjBgG,oBAAoBM,KAAO,GCC3BN,oBAAoBnV,EAAKhN,IACxB,IAAI0iB,EAAS1iB,GAAUA,EAAO2iB,WAC7B,IAAM3iB,EAAgB,QACtB,IAAMA,EAEP,OADAmiB,oBAAoB9b,EAAEqc,EAAQ,CAAExiB,EAAGwiB,IAC5BA,GCLRP,oBAAoB9b,EAAI,CAAC5I,EAASmlB,KACjC,IAAI,IAAI1hB,KAAO0hB,EACXT,oBAAoBrjB,EAAE8jB,EAAY1hB,KAASihB,oBAAoBrjB,EAAErB,EAASyD,IAC5EL,OAAOgiB,eAAeplB,EAASyD,EAAK,CAAE4hB,YAAY,EAAMC,IAAKH,EAAW1hB,MCJ3EihB,oBAAoBrjB,EAAI,CAACmS,EAAK/O,IAASrB,OAAOC,UAAUE,eAAeC,KAAKgQ,EAAK/O,GCAjFigB,oBAAoBa,IAAOhjB,IAC1BA,EAAOijB,MAAQ,GACVjjB,EAAOkjB,WAAUljB,EAAOkjB,SAAW,IACjCljB,G,ydCCR,SAASmjB,EAAejjB,GACtB,KAAMA,EAAI,KAAKA,GAAK,IACpB,KAAMA,GAAK,KAAKA,GAAK,IACrB,OAAOA,EAqfT,Q,WAteE,WAAYkjB,EAAcf,GACxB,G,4FAD4B,SACF,UAAvB,EAAOe,GACR,KAAM,kCAER9lB,KAAK+lB,IAAMhB,EACX/kB,KAAKgmB,MAAQF,EAAa7lB,KAC1BD,KAAKimB,MAAS,KACdjmB,KAAKkmB,WAAa,IAClBlmB,KAAKmmB,QAAUnmB,KAAKkmB,WACpBlmB,KAAKomB,GAAK,EACVpmB,KAAKqmB,GAAK,EACVrmB,KAAKsmB,OAAS,EACdtmB,KAAKumB,OAAS,EACdvmB,KAAKwmB,OAAS,EACdxmB,KAAKymB,UAAY,EACjBzmB,KAAK0mB,YAAc,EACnB1mB,KAAK2mB,UAAY,EACjB3mB,KAAK4mB,gBAAkB,EACvB5mB,KAAK6mB,OAAS,EACd7mB,KAAK8mB,MAAQ,EACb9mB,KAAK+mB,SAAW,EAChB/mB,KAAKgnB,WAAa,EAClBhnB,KAAKinB,UAAW,EAChBjnB,KAAKknB,WAAY,EACjBlnB,KAAKmnB,UAAW,EAChBnnB,KAAKonB,cAAe,EACpBpnB,KAAKqnB,YAAc,IACnBrnB,KAAKsnB,YAAc,EACnBtnB,KAAKunB,WAAa,KAClBvnB,KAAKwnB,UAAY,KACjBxnB,KAAKynB,aAAe,GACpBznB,KAAK0nB,eAAiB,GACtB1nB,KAAK2nB,UAAY,EACjB3nB,KAAK4nB,eAAiB,EACtB5nB,KAAK6nB,qBAAuB,EAC5B7nB,KAAK8nB,WAAa,GAClB9nB,KAAK+nB,OAAS,EACd/nB,KAAKgoB,OAAS,KACdhoB,KAAKioB,WAAY,EACjBjoB,KAAKkoB,UAAY,IACjBloB,KAAKmoB,OAASnoB,KAAKkoB,UACnBloB,KAAKooB,cAAgB,KACrBpoB,KAAKqoB,MAAQ,Q,6DAqCCC,GACdtoB,KAAK+nB,QAAUO,I,yCAIftoB,KAAK+nB,QAAU,K,uCAIf/nB,KAAK+nB,QAAU,K,kCA8HLhX,GACV/Q,KAAK2mB,UAAYje,KAAKmD,IAAI,EAAGnD,KAAKoD,KAAK,EAAGiF,M,8BAGpCA,GACN/Q,KAAK8mB,MAAQpe,KAAKmD,IAAI,EAAGnD,KAAKoD,KAAK,EAAGiF,M,iCAG7BA,GACT/Q,KAAK+mB,SAAWre,KAAKmD,IAAI,EAAGnD,KAAKoD,KAAK,EAAGiF,M,mCAG9BA,GACX/Q,KAAKgnB,WAAate,KAAKmD,IAAI,EAAGnD,KAAKoD,KAAK,EAAGiF,M,+BAGpCA,GACP/Q,KAAKioB,YAAYlX,I,mCAGNA,GACX/Q,KAAK8nB,WAAa/W,I,kCAIlB/Q,KAAKinB,UAAW,EAChBjnB,KAAKuoB,SAAS,M,mCAIdvoB,KAAKknB,WAAY,EACjBlnB,KAAKuoB,SAAS,M,kCAIdvoB,KAAKmnB,UAAW,EAChBnnB,KAAKuoB,SAAS,M,iCAGLC,GACTxoB,KAAKonB,cAAe,EACpBpnB,KAAKuoB,SAAS,GAA0B,GAApB7f,KAAK+f,MAAY,EAAND,M,kCAGrBE,GACV1oB,KAAKunB,WAAamB,I,iCAGTC,GACT3oB,KAAKwnB,UAAYmB,I,mCAGNC,GACX5oB,KAAKynB,aAAapd,KAAKue,K,iCAGdxE,GACTpkB,KAAKooB,cAAgBhE,I,yCAIrBpkB,KAAK6nB,qBAAuB,I,6BAGvBnE,GACL,QAAI1jB,KAAKimB,SACLvC,EAAKmF,MACF7oB,KAAKimB,MAAMhmB,MAAQyjB,EAAKmF,KAAK5oB,O,+BAU7BqoB,GACPtoB,KAAKmmB,QAAUzd,KAAKoD,IAAI,EAAG9L,KAAKmmB,QAAUmC,K,6BAGrCQ,EAAWC,EAAWtgB,GAC3BzI,KAAKomB,GAAK0C,EACV9oB,KAAKqmB,GAAK0C,EACV/oB,KAAKsmB,OAASwC,EACd9oB,KAAKumB,OAASwC,OACDtU,IAAVhM,IACDzI,KAAKwmB,OAAS/d,K,oCAoBhB,IAAI+Q,EAAQxZ,KAAK4nB,eAEjB,OADA5nB,KAAK4nB,eAAiB,EACfpO,I,4BAOHA,GACJA,EAAQ9Q,KAAKoD,IAAI,GAAKpD,KAAKmD,IAAI,EAAG2N,IAC9BxZ,KAAKgpB,cACPhpB,KAAK2nB,UAAYjf,KAAK+f,MAAMjP,EAAMxZ,KAAK0nB,gBACvC1nB,KAAK4nB,eAAiBpO,K,gCAIhB/J,QACIgF,IAAThF,IACDA,GAAQ,IAAI4B,MAAQ4X,UAAYvgB,KAAK+f,MAAoB,IAAd/f,KAAKwL,WAElD,IAAIgV,EAAMnX,IAAWtC,GACrBzP,KAAKwmB,OAAS9d,KAAK+f,MAAM,IAAIS,KAAO,M,2BAGjC1F,GACAA,GAAYA,EAAS2F,OACtBnpB,KAAKqoB,MAAQ7E,EAAS2F,Q,qCAIXC,GACb,IAAIhV,EAAOpU,KAEX,GAAmB,GAAhBoU,EAAK+R,QAAR,CAIG/R,EAAK6T,WAAa7T,EAAK+T,OAAS,GACjC/T,EAAK+T,SAGP,IAAIkB,EAAOjV,EAAKgS,GACZkD,EAAOlV,EAAKiS,GAEZkD,EAAWnV,EAAKuS,WAAavS,EAAKoV,SAAW,EAAI,GACjDC,EAAsBrV,EAAKoV,SAAW,GAAK,GAC/CpV,EAAKwS,kBAAoB2C,EAAWnV,EAAKwS,iBAAiB6C,EAE1D,IAAI1Y,EAAIqD,EAAKwS,gBACT8C,EAAWtV,EAAKoS,QAAQ9d,KAAKsb,GAAG,KACpC5P,EAAKgS,IAAMrV,EAAErI,KAAKC,IAAI+gB,GACtBtV,EAAKiS,IAAMtV,EAAErI,KAAKE,IAAI8gB,GACtBtV,EAAK6S,UAAW,EAChB7S,EAAK8S,WAAY,EACjB9S,EAAK+S,UAAW,GACDiC,EAAkBO,UAAUvV,KAEzCA,EAAKgS,GAAKiD,EACVjV,EAAKiS,GAAKiD,EACVlV,EAAKwS,gBAAkB,GAEtB5mB,KAAKonB,eAKNhT,EAAK8S,WAAY,EACjBlnB,KAAKonB,cAAe,GAGtBhT,EAAKoS,QAAU,EAAEpS,EAAK0S,MACtB1S,EAAKsS,aAAe,EAAEtS,EAAK4S,WAC3B5S,EAAKqS,WAAa,EAAErS,EAAK2S,SAEzB3S,EAAKoS,OAASX,EAAezR,EAAKoS,QAClCpS,EAAKsS,YAAcb,EAAezR,EAAKsS,aACvCtS,EAAKqS,UAAYZ,EAAezR,EAAKqS,WACrC2C,EAAkBQ,WAAWxV,GAE7BA,EAAKmT,WAAa,KAClBnT,EAAKoT,UAAY,KACjBpT,EAAKgU,cAAgB,KACrBhU,EAAKyT,qBAAuBnf,KAAKoD,IAAI,EAAGsI,EAAKyT,qBAAqB,GAClEuB,EAAkBS,UAAUzV,GAC5BgV,EAAkBU,YAAY1V,GAC9BgV,EAAkBW,UAAU3V,GAEzBA,EAAKuT,UAAY,GAClBvT,EAAKuT,YAMP,IAHA,IAAIqC,EAAY,KACZC,EAAW,KACXC,EAAc,GACZ9V,EAAKqT,aAAa1kB,QAAQ,CAC9B,IAAI6lB,EAASxU,EAAKqT,aAAa9S,QAC/BuV,EAAY7f,KAAK,CACf0a,GAAI6D,EAAO7D,GACXxd,EAAGqhB,EAAOrhB,EACVC,EAAGohB,EAAOphB,EACViB,MAAOmgB,EAAOngB,MACd+f,MAAOI,EAAOJ,MACdF,OAAQM,EAAON,SAIhBlU,EAAKmT,aACNyC,EAAY,CACVjF,GAAI3Q,EAAKmT,WAAWxC,GACpBxd,EAAG6M,EAAKmT,WAAWhgB,EACnBC,EAAG4M,EAAKmT,WAAW/f,EACnBiB,MAAO2L,EAAKmT,WAAW9e,MACvB+f,MAAOpU,EAAKmT,WAAWiB,OAASpU,EAAKmT,WAAW4C,SAAW,GAAK,EAAI,GACpEC,OAAQhW,EAAKmT,WAAW6C,SAGzBhW,EAAKoT,YACNyC,EAAW,CACTlF,GAAI3Q,EAAKoT,UAAUzC,GACnBxd,EAAG6M,EAAKoT,UAAUjgB,EAClBC,EAAG4M,EAAKoT,UAAUhgB,EAClBiB,MAAO2L,EAAKoT,UAAU/e,MACtB+f,MAAOpU,EAAKoT,UAAUgB,MACtB4B,OAAQhW,EAAKoT,UAAU4C,SAI3B,IAAI3F,EAAKrQ,EAAKgS,GAAKhS,EAAKkS,OACpB5B,EAAKtQ,EAAKiS,GAAKjS,EAAKmS,OACxBnS,EAAKyS,OAASne,KAAKiB,KAAK8a,EAAGA,EAAKC,EAAGA,GAEnCtQ,EAAKkS,OAASlS,EAAKgS,GACnBhS,EAAKmS,OAASnS,EAAKiS,GAEnBjS,EAAK4T,OAAS,CACZzgB,EAAG6M,EAAKgS,GACR5e,EAAG4M,EAAKiS,GACR5d,MAAO2L,EAAKoS,OACZ4D,OAAQhW,EAAK+R,QACbkE,MAAOjW,EAAK+T,OACZmC,WAAY,CACVC,KAAMnW,EAAK6S,SACXyB,MAAOtU,EAAK8S,UACZyB,KAAMvU,EAAK+S,UAEbqD,MAAO,CACL/hB,MAAO2L,EAAKsS,YACZ+D,eAAgBrW,EAAKqW,eACrBC,aAActW,EAAKgU,cACnBM,MAAOsB,EACPrB,KAAMsB,EACNU,QAAST,GAEXU,IAAK,CACHniB,MAAO2L,EAAKqS,UACZoE,UAAWzW,EAAK4U,aAElB8B,MAAO,CACLC,MAAO3W,EAAKyU,KAAOzU,EAAKyU,KAAKmC,YAAY5W,EAAK2Q,IAAM,Q,yBA/axD,OAAO/kB,KAAK+lB,M,2BAMZ,OAAO/lB,KAAKqoB,Q,4BAOZ,OAAOroB,KAAKgoB,S,6BAOZ,OAAOhoB,KAAKmmB,U,4BAOZ,OAAOnmB,KAAK+nB,S,gCAmBZ,OAAO/nB,KAAKkmB,a,iCAOZ,OAAOlmB,KAAKqnB,c,iCAOZ,OAAOrnB,KAAKsnB,c,2BAOZ,OAAOtnB,KAAKgmB,Q,+BAOZ,OAAOhmB,KAAKgmB,MAAQ,KAAOhmB,KAAK+lB,M,2BAOhC,OAAO/lB,KAAKimB,Q,wBAOZ,OAAOjmB,KAAKomB,K,wBAOZ,OAAOpmB,KAAKqmB,K,4BAOZ,OAAOrmB,KAAK6mB,S,gCAIZ,OAAO,K,4BAOP,OAAO7mB,KAAKwmB,S,+BAOZ,OAAOxmB,KAAK2mB,Y,+BAMZ,OAAQ3mB,KAAKioB,WAAajoB,KAAKmoB,OAAS,I,4BAOxC,OAAOnoB,KAAKmoB,S,+BAOZ,OAAOnoB,KAAKkoB,Y,+BAOZ,OAAOloB,KAAKymB,Y,iCAOZ,OAAOzmB,KAAK0mB,c,gCAIZ,OAAO1mB,KAAKunB,a,+BAIZ,OAAOvnB,KAAKwnB,Y,qCA6EZ,OAAOxnB,KAAK6nB,qBAAuB,I,gCAqBnC,OAAO7nB,KAAK8nB,a,iCAIZ,OAAO9nB,KAAK4nB,eAAiB,I,oCAI7B,OAAO5nB,KAAK4nB,iB,kCAUZ,OAAO5nB,KAAK2nB,UAAY,O,4LCjQ5B,Q,WAzFE,WAAY1nB,I,4FAAM,SAChBD,KAAKgmB,MAAQ/lB,EACbD,KAAKirB,SAAW,GAChBjrB,KAAKkrB,UAAY,GACjBlrB,KAAKmrB,WAAa,G,qDAGZzH,GACN,GAAGA,EAAKmF,KAAM,KAAM,QAAUnF,EAAK0H,SAAW,gCAAkC1H,EAAKmF,KAAK5oB,KAC1F,IAAI,IAAIH,KAAKE,KAAKirB,SAChB,GAAGjrB,KAAKirB,SAASnrB,GAAGilB,IAAMrB,EAAKqB,GAAI,OAErC/kB,KAAKirB,SAAS5gB,KAAKqZ,GACnBA,EAAKuC,MAAQjmB,KACbA,KAAKkrB,UAAUxH,EAAKqB,IAAM,GAC1B/kB,KAAKmrB,WAAWzH,EAAKqB,IAAM,K,kCAqDjBsG,GACV,OAAOrrB,KAAKmrB,WAAWE,K,mCAGZC,EAAUC,GACrB,IAAI,IAAIzrB,KAAKE,KAAKkrB,UACbprB,GAAKwrB,IACRtrB,KAAKkrB,UAAUprB,GAAKE,KAAKkrB,UAAUprB,GAAG0rB,OAAOD,M,wCAK/C,IAAIzrB,EACJ,IAAIA,KAAKE,KAAKkrB,UACZlrB,KAAKmrB,WAAWrrB,GAAKE,KAAKkrB,UAAUprB,GACpCE,KAAKkrB,UAAUprB,GAAK,K,2BAhEtB,OAAOE,KAAKirB,SAASloB,S,2BAIrB,OAAO/C,KAAKgmB,Q,iCAKZ,IADA,IAAItS,EAAQ,EACJ5T,EAAE,EAAGA,EAAIE,KAAKirB,SAASloB,OAAQjD,IAClCE,KAAKirB,SAASnrB,GAAGsqB,OAAS,GAC3B1W,IAGJ,OAAOA,I,4BAKP,IADA,IAAI+X,EAAM,EACF3rB,EAAE,EAAGA,EAAIE,KAAKirB,SAASloB,OAAQjD,IACrC2rB,GAAOzrB,KAAKirB,SAASnrB,GAAG4rB,MAE1B,OAAOD,I,6BAKP,IADA,IAAIA,EAAM,EACF3rB,EAAE,EAAGA,EAAIE,KAAKirB,SAASloB,OAAQjD,IACrC2rB,GAAOzrB,KAAKirB,SAASnrB,GAAGsqB,OAE1B,OAAOqB,I,gCAKP,IADA,IAAIA,EAAM,EACF3rB,EAAE,EAAGA,EAAIE,KAAKirB,SAASloB,OAAQjD,IACrC2rB,GAAOzrB,KAAKirB,SAASnrB,GAAG6rB,UAE1B,OAAOF,I,8BAIP,OAAOzrB,KAAK4rB,WAAa,I,8BAIzB,OAAO5rB,KAAKirB,c,gMClEKY,E,WAEnB,WAAYC,EAAO/G,EAAIgH,GAIrB,I,4FAJ4B,SAC5B/rB,KAAK+lB,IAAMhB,EACX/kB,KAAKgsB,OAASF,EACd9rB,KAAKwmB,OAASsF,EAAMrjB,MAAQqjB,EAAMG,SAC5BjsB,KAAKwmB,OAAS,KAAKxmB,KAAKwmB,QAAU,IACxC,KAAMxmB,KAAKwmB,QAAU,KAAKxmB,KAAKwmB,QAAU,IACzCxmB,KAAKomB,GAAK0F,EAAMvkB,EAAIukB,EAAMI,UAAUxjB,KAAKC,IAAI3I,KAAKwmB,QAAQ9d,KAAKsb,GAAG,MAClEhkB,KAAKqmB,GAAKyF,EAAMtkB,EAAIskB,EAAMI,UAAUxjB,KAAKE,IAAI5I,KAAKwmB,QAAQ9d,KAAKsb,GAAG,MAClEhkB,KAAK6mB,OAAS,EACd7mB,KAAKmsB,OAASJ,EACd/rB,KAAKosB,QAA2D,IAAjD1jB,KAAK+f,MAAM,IAAOsD,EAAQ,IAAMA,EAAQA,GACvD/rB,KAAKqsB,WAAY,E,yDAuCjBrsB,KAAKqsB,WAAY,I,iCAGR3D,GACT1oB,KAAKqsB,WAAY,EACjB3D,EAAMH,SAASvoB,KAAKosB,W,uCAIpBpsB,KAAKomB,IAAMpmB,KAAK6mB,OAAOne,KAAKC,IAAI3I,KAAKwmB,QAAQ9d,KAAKsb,GAAG,MACrDhkB,KAAKqmB,IAAMrmB,KAAK6mB,OAAOne,KAAKE,IAAI5I,KAAKwmB,QAAQ9d,KAAKsb,GAAG,Q,yBA7CrD,OAAOhkB,KAAK+lB,M,wBAIZ,OAAO/lB,KAAKomB,K,wBAIZ,OAAOpmB,KAAKqmB,K,4BAIZ,OAAOrmB,KAAKwmB,S,4BAIZ,OAAOxmB,KAAK6mB,S,6BAIZ,OAAO7mB,KAAKosB,U,4BAIZ,OAAOpsB,KAAKmsB,S,4BAGZ,OAAOnsB,KAAKgsB,S,+BAIZ,OAAOhsB,KAAKqsB,e,gMC9CKC,E,WAEnB,WAAY7a,EAAO8a,I,4FAAQ,SACzBvsB,KAAKwsB,OAAS,KACdxsB,KAAKysB,QAAU,KACfzsB,KAAK0sB,eAAiB,GACtB1sB,KAAK2sB,SAAW,EAChB3sB,KAAK4sB,SAAW,E,qDAGVnb,EAAO8a,GACbvsB,KAAKwsB,OAAS/a,EAAkB,EAAZzR,KAAK6sB,OACzB7sB,KAAKysB,QAAUF,EAAmB,EAAZvsB,KAAK6sB,S,gCAKnBpd,QACIgF,IAAThF,IACDA,GAAQ,IAAI4B,MAAQ4X,UAAYvgB,KAAK+f,MAAoB,IAAd/f,KAAKwL,WAElD,IAAIgV,EAAMnX,IAAWtC,GAErBzP,KAAK2sB,SAAWjkB,KAAK+f,MAAY,IAANS,IAAY,KACvClpB,KAAK4sB,SAAWlkB,KAAK+f,MAAY,IAANS,IAAY,KAGvClpB,KAAK0sB,eAAiB,GAEtB,IADA,IAAII,EAAW,GACPvlB,EAAIvH,KAAK+sB,KAAOD,EAAUvlB,EAAIvH,KAAKgtB,KAAOF,EAAUvlB,GAAKulB,EAC/D,IAAI,IAAItlB,EAAIxH,KAAKitB,KAAOH,EAAUtlB,EAAIxH,KAAKktB,KAAOJ,EAAUtlB,GAAKslB,EAC/D9sB,KAAK0sB,eAAeriB,KAAK,CAAC9C,EAAGA,EAAGC,EAAGA,IAKvC,IADA,IAA+C2lB,EAAgBC,EAA3DC,EAAertB,KAAK0sB,eAAe3pB,OAChC,IAAMsqB,GACXD,EAAc1kB,KAAKkI,MAAMsY,IAAQmE,GACjCA,GAAgB,EAChBF,EAAiBntB,KAAK0sB,eAAeW,GACrCrtB,KAAK0sB,eAAeW,GAAgBrtB,KAAK0sB,eAAeU,GACxDptB,KAAK0sB,eAAeU,GAAeD,I,qCAyCrC,OAAGntB,KAAK0sB,eAAe3pB,OACd/C,KAAK0sB,eAAepgB,MAEtB,O,4BAvCP,OAAOtM,KAAKwsB,S,6BAIZ,OAAOxsB,KAAKysB,U,6BAIZ,OAAO,K,2BAIP,OAAOzsB,KAAK2sB,SAAW3sB,KAAK6sB,S,2BAI5B,OAAO7sB,KAAK4sB,SAAW5sB,KAAK6sB,S,2BAI5B,OAAO7sB,KAAK2sB,SAAW3sB,KAAKwsB,OAASxsB,KAAK6sB,S,2BAI1C,OAAO7sB,KAAK4sB,SAAW5sB,KAAKysB,QAAUzsB,KAAK6sB,S,8BAI3C,OAAO7sB,KAAK2sB,W,8BAIZ,OAAO3sB,KAAK4sB,c,gMChFKU,E,WAEnB,c,4FAAc,SACZttB,KAAKutB,MAAQ,G,iDAGXhT,EAAOiT,GACLxtB,KAAKutB,MAAMhT,KACbva,KAAKutB,MAAMhT,GAAS,IAEtBva,KAAKutB,MAAMhT,GAAOlQ,KAAKmjB,K,0BAGrBjT,GAIF,OAHIva,KAAKutB,MAAMhT,KACbva,KAAKutB,MAAMhT,GAAS,IAEfva,KAAKutB,MAAMhT,K,4BAGdA,GACJva,KAAKutB,MAAQ,Q,uPCnBIE,E,WAEnB,c,4FAAc,SACZztB,KAAK0tB,UAAY,GACjB1tB,KAAK2tB,SAAW,GAChB3tB,KAAK4tB,WAAa,GAClB5tB,KAAK6tB,cAAgB,GACrB7tB,KAAK8tB,aAAe,K,+DAGJC,GAOhB,IAAIxD,EANJvqB,KAAK8tB,aAAe,CAClBf,KAAMgB,EAAYhB,KAClBE,KAAMc,EAAYd,KAClBD,KAAMe,EAAYf,KAClBE,KAAMa,EAAYb,MAGpB3C,EAAQ,IAAIljB,SAAQ,IAAIA,YAAW0mB,EAAYhB,KAAK,GAAIgB,EAAYd,MAAO,GAAIc,EAAYxB,QAAS1iB,YACpG7J,KAAK0tB,UAAUrjB,KAAKkgB,GACpBA,EAAQ,IAAIljB,SAAQ,IAAIA,YAAW0mB,EAAYhB,KAAMgB,EAAYd,KAAK,IAAKc,EAAYtc,MAAO,IAAK5H,YACnG7J,KAAK0tB,UAAUrjB,KAAKkgB,GACpBA,EAAQ,IAAIljB,SAAQ,IAAIA,YAAW0mB,EAAYf,KAAMe,EAAYd,MAAO,GAAIc,EAAYxB,QAAS1iB,YACjG7J,KAAK0tB,UAAUrjB,KAAKkgB,GACpBA,EAAQ,IAAIljB,SAAQ,IAAIA,YAAW0mB,EAAYhB,KAAMgB,EAAYb,MAAOa,EAAYtc,MAAO,IAAK5H,YAChG7J,KAAK0tB,UAAUrjB,KAAKkgB,K,iCAGX7G,GACT,IAAIsK,EAAahuB,KAAKiuB,cAAcvK,GACpCsK,EAAUtmB,IAAIH,EAAImc,EAAKnc,EACvBymB,EAAUtmB,IAAIF,EAAIkc,EAAKlc,I,mCAGZohB,GACX5oB,KAAK4tB,WAAWhF,EAAO7D,IAAM,O,iCAIpBrB,GACT1jB,KAAK2tB,SAASjK,EAAKqB,IAAM,KACzB/kB,KAAK6tB,cAAcnK,EAAKqB,IAAM,O,oCAGlB6D,GACZ,IAMI9oB,EAEAyqB,EASA2D,EAjBAC,EAAenuB,KAAKouB,gBAAgBxF,GACpCoF,EAAapF,EAAOkD,MAAM1B,OAASpqB,KAAKiuB,cAAcrF,EAAOkD,OAAS,KAQ1E,IAAIhsB,KANJquB,EAAYzmB,IAAIH,EAAIqhB,EAAOrhB,EAC3B4mB,EAAYzmB,IAAIF,EAAIohB,EAAOphB,EAKlBxH,KAAK0tB,UAGZ,GAFAnD,EAAOvqB,KAAK0tB,UAAU5tB,GACZuH,sBAAsB8mB,EAAa5D,GAG3C,OADA3B,EAAOyF,aACA,EAIX,IAAIvuB,KAAKE,KAAK2tB,SAEZ,IADAO,EAAaluB,KAAK2tB,SAAS7tB,KAExBouB,GAAcF,GAGP3mB,qBAAqB8mB,EAAaD,GAChC,CACV,IAAII,EAAeJ,EAAWxK,KAAK0G,OASnC,OARAxB,EAAO2F,WAAWL,EAAWxK,MACbkF,EAAOkD,MAAM0C,OAAON,EAAWxK,OAE7CkF,EAAOkD,MAAM2C,gBAAgBH,EAAeJ,EAAWxK,KAAK0G,QAEjC,GAA1B8D,EAAWxK,KAAK0G,QACjBxB,EAAOkD,MAAM4C,oBAER,EAGX,OAAO,I,gCAGChL,GACR,IAKI5jB,EACA6uB,EACApE,EASA2D,EAhBAF,EAAahuB,KAAKiuB,cAAcvK,GAQpC,IAAI5jB,KANJkuB,EAAUtmB,IAAIH,EAAImc,EAAKnc,EACvBymB,EAAUtmB,IAAIF,EAAIkc,EAAKlc,EAKdxH,KAAK0tB,UAGZ,GAFAnD,EAAOvqB,KAAK0tB,UAAU5tB,GACtB6uB,EAAUtnB,sBAAsB2mB,EAAWzD,GAGzC,OADA7G,EAAK2K,aACE,EAIX,IAAIvuB,KAAKE,KAAK2tB,SAEZ,IADAO,EAAaluB,KAAK2tB,SAAS7tB,KAExBouB,GAAcF,EAAjB,CAGAW,EAAUtnB,qBAAqB2mB,EAAWE,GAC1C,IAAIU,EAAYlL,EAAK8K,OAAON,EAAWxK,MACvC,GAAGiL,EAAS,CACV,GAAIC,EAQF,OADAlL,EAAKmL,aACE,EAPP,IAAIP,EAAeJ,EAAWxK,KAAK0G,OAInC,OAHA1G,EAAK6K,aACLL,EAAWxK,KAAKoL,WAAWpL,EAAK8E,OAChC9E,EAAK+K,gBAAgBH,EAAeJ,EAAWxK,KAAK0G,SAC7C,GAOb,OAAO,I,gCAGC1G,GACR,IAMI5jB,EACAouB,EAPAa,EAAkB/uB,KAAKgvB,mBAAmBtL,GAC1CsK,EAAahuB,KAAKiuB,cAAcvK,GACpCqL,EAAevkB,UAAUkZ,EAAKjb,MAAQib,EAAKuL,YAAYvmB,KAAKsb,GAAG,KAC/D+K,EAAernB,IAAIH,EAAImc,EAAKnc,EAC5BwnB,EAAernB,IAAIF,EAAIkc,EAAKlc,EAK5B,IAAI0nB,EAAU,GAEd,IAAIpvB,KAAKE,KAAK2tB,UACZO,EAAaluB,KAAK2tB,SAAS7tB,KAExBouB,GAAcF,GAGP3mB,sBAAsB0nB,EAAgBb,IAE9CgB,EAAQ7kB,KAAK6jB,EAAWxK,MAG5B,GAAqB,GAAlBwL,EAAQnsB,OACT,OAAO,EAET,IAIIgG,EAAG0b,EAAIC,EAAIiE,EAJXwG,EAAe,KACfC,EAAuB1L,EAAK2L,WAC5BC,EAAc,KACdC,EAAsB7L,EAAK2L,WAE/B,IAAIvvB,KAAKovB,EACPzK,EAAKyK,EAAQpvB,GAAGyH,EAAImc,EAAKnc,EACzBmd,EAAKwK,EAAQpvB,GAAG0H,EAAIkc,EAAKlc,EACzBuB,EAAIL,KAAKiB,KAAK8a,EAAGA,EAAKC,EAAGA,IACzBiE,EAAOuG,EAAQpvB,GAAG0uB,OAAO9K,KACXyL,KAAgBpmB,EAAIqmB,GAGxBzG,KAAU2G,GAAevmB,EAAIwmB,KACrCD,EAAcJ,EAAQpvB,GACtByvB,EAAsBxmB,IAJtBomB,EAAeD,EAAQpvB,GACvBsvB,EAAuBrmB,GAe3B,OATGumB,GACD5L,EAAK8L,WAAWF,GAEfH,IACDzL,EAAK+L,YAAYN,GACjBA,EAAaO,qBAIR,I,kCAGGhM,GACV,IAKI5jB,EAEAquB,EAPAY,EAAkB/uB,KAAKgvB,mBAAmBtL,GAC9CqL,EAAevkB,UAAUkZ,EAAKjb,MAAQib,EAAKuL,YAAYvmB,KAAKsb,GAAG,KAC/D+K,EAAernB,IAAIH,EAAImc,EAAKnc,EAC5BwnB,EAAernB,IAAIF,EAAIkc,EAAKlc,EAK5B,IAAImoB,GAAiB,EAErB,IAAI7vB,KAAKE,KAAK4tB,YACZO,EAAcnuB,KAAK4tB,WAAW9tB,KAE3BquB,EAAYvF,OAAOkD,OAASpI,GACrBrc,sBAAsB8mB,EAAaY,KAE3CrL,EAAKkM,aAAazB,EAAYvF,QAC9B+G,GAAiB,GAIrB,OAAOA,I,gCAICjM,GACR,IAAIU,EAAWpkB,KAAK6vB,iBAAiBnM,GACrC,OAAGU,EAAWV,EAAK2L,aACjB3L,EAAKoM,WAAW1L,IACT,K,uCAKMV,GAEf,IADA,IAAIjb,EAAQib,EAAKjb,MAAQib,EAAKuL,WACxBxmB,EAAQ,KAAKA,GAAS,IAC5B,KAAMA,GAAS,KAAKA,GAAS,IAE7B,IAeIsnB,EAAIC,EAfJC,EAAgBvM,EAAKlc,EAAIxH,KAAK8tB,aAAab,KAC3CiD,EAAgBlwB,KAAK8tB,aAAaZ,KAAOxJ,EAAKlc,EAC9C2oB,EAAezM,EAAKnc,EAAIvH,KAAK8tB,aAAaf,KAC1CqD,EAAepwB,KAAK8tB,aAAad,KAAOtJ,EAAKnc,EAEjD,OAAa,KAAVkB,GAA0B,KAATA,EACX0nB,EACU,GAAT1nB,EACD2nB,GACW,IAAV3nB,EACDwnB,EACU,IAATxnB,EACAynB,GAKPznB,GAAS,KAAOA,GAAS,IAC1BsnB,EAAKI,EAAeznB,KAAKC,KAAKF,EAAM,MAAMC,KAAKsb,GAAG,MAClDgM,EAAKC,EAAgBvnB,KAAKE,KAAKH,EAAM,MAAMC,KAAKsb,GAAG,OAC3Cvb,GAAS,IAAMA,EAAQ,GAC/BsnB,EAAKK,EAAe1nB,KAAKC,KAAMF,GAAQC,KAAKsb,GAAG,MAC/CgM,EAAKC,EAAgBvnB,KAAKE,KAAMH,GAAQC,KAAKsb,GAAG,OACxCvb,EAAQ,GAAKA,EAAQ,IAC7BsnB,EAAKK,EAAe1nB,KAAKC,IAAKF,GAAQC,KAAKsb,GAAG,MAC9CgM,EAAKE,EAAgBxnB,KAAKE,IAAKH,GAAQC,KAAKsb,GAAG,QAE/C+L,EAAKI,EAAeznB,KAAKC,KAAK,IAAIF,IAAQC,KAAKsb,GAAG,MAClDgM,EAAKE,EAAgBxnB,KAAKE,KAAK,IAAIH,IAAQC,KAAKsb,GAAG,OAG9Ctb,KAAKmD,IAAIkkB,EAAIC,M,oCAGRtM,GACZ,IAAI1jB,KAAK2tB,SAASjK,EAAKqB,IAAK,CAC1B,GAAkB,GAAfrB,EAAK0G,OACN,KAAM,yCAER,IAAIiG,EAAQ,IAAIhpB,YAAW,IAAIA,YAAWqc,EAAKnc,EAAEmc,EAAKlc,GAAI,IAC1DxH,KAAK2tB,SAASjK,EAAKqB,IAAMsL,EACzBA,EAAM3M,KAAOA,EAEf,OAAO1jB,KAAK2tB,SAASjK,EAAKqB,M,sCAGZ6D,GACd,IAAI5oB,KAAK4tB,WAAWhF,EAAO7D,IAAK,CAC9B,GAAG6D,EAAO0H,SACR,KAAM,0CAER,IAAID,EAAQ,IAAIhpB,YAAW,IAAIA,YAAWuhB,EAAOrhB,EAAEqhB,EAAOphB,GAAI,GAC9DxH,KAAK4tB,WAAWhF,EAAO7D,IAAMsL,EAC7BA,EAAMzH,OAASA,EAEjB,OAAO5oB,KAAK4tB,WAAWhF,EAAO7D,M,yCAGbrB,GACjB,IAAI1jB,KAAK6tB,cAAcnK,EAAKqB,IAAK,CAC/B,GAAkB,GAAfrB,EAAK0G,OACN,KAAM,oDAER,IAAI3Y,EAAQiS,EAAK2L,WAAa3mB,KAAK6nB,IAAI7M,EAAK8M,YAAY9nB,KAAKsb,GAAG,MAAM,EAClEqM,EAAQ,IAAIhpB,aAAY,IAAIA,YAAWqc,EAAKnc,EAAGmc,EAAKlc,GAAI,CAC1D,IAAIH,YAAW,EAAG,GAClB,IAAIA,YAAW,GAAI,GACnB,IAAIA,YAAWqc,EAAK2L,YAAY5d,GAChC,IAAIpK,YAAWqc,EAAK2L,WAAW5d,KAGjCzR,KAAK6tB,cAAcnK,EAAKqB,IAAMsL,EAC9BA,EAAM3M,KAAOA,EAEf,OAAO1jB,KAAK6tB,cAAcnK,EAAKqB,S,gcC1Sd0L,E,WAEnB,WAAY/M,EAAMoC,GAChB,G,4FAD8B,UAC1BpC,EAAM,KAAM,mBAChB,IAAIoC,EAAc,KAAM,2BACxB9lB,KAAK0wB,MAAQhN,EACb1jB,KAAK2wB,UAAY,KACjB3wB,KAAK4wB,mBAAqB,EAC1B5wB,KAAK6wB,2BAA6B,KAClC7wB,KAAK8wB,6BAA+B,KACpC9wB,KAAK+wB,4BAA8B,KACnC/wB,KAAKgxB,eAAiB,GACtBhxB,KAAKixB,sBAAwB,GAC7BjxB,KAAKkxB,uBAAyB,GAC9BlxB,KAAKmxB,uBAAyB,IAC9BnxB,KAAKoxB,cAAgBtL,EACrB9lB,KAAKqxB,UAAW,EAChBrxB,KAAKsxB,aAAe,CAClBC,SAAU,EACVC,MAAO,EACPC,KAAM,EACNC,WAAY,EACZC,SAAU,EACVC,MAAO,EACPC,OAAQ,GACRC,MAAO,I,gEAIQ/gB,GACjB/Q,KAAKmxB,uBAAyBpgB,I,mCAWnBkB,GACXjS,KAAKixB,sBAAsB5mB,KAAK4H,K,oCAGpBA,GACZjS,KAAK+xB,wBAAwB1nB,KAAK4H,K,mCAGvB+f,GACX,IAAIA,EAAIhxB,QAAS,MAAO,UACxB,IAAIkiB,EAAM8O,EAAIhxB,QAId,OAHGgxB,EAAIC,SACL/O,EAAM,SAAW8O,EAAIC,OAAS,KAAO/O,GAEhCA,I,+BAGAzT,EAAMyiB,EAASC,GACtB,GAAkB,iBAAR1iB,EAAkB,KAAM,2BAA6B,EAAQA,GAAQ,UAC/E,GAAqB,mBAAXyiB,EAAuB,KAAM,yCAA2C,EAAQA,GAAW,UACrG,GAAoB,mBAAVC,EAAsB,KAAM,wCAA0C,EAAQA,GAAU,UAClG,IAAI/d,EAAOpU,KACXoU,EAAKuc,UAAYvc,EAAKge,cAAcpyB,KAAKoxB,eACzChd,EAAKuc,UAAU0B,QAAU,SAACL,GACxBM,QAAQpU,MAAM8T,GACX5d,EAAK2c,8BACN3c,EAAK2c,4BAA4B,CAC/B/vB,QAAS,kBAAoBoT,EAAKsc,MAAMtF,SAAW,wBAA0BhX,EAAKme,aAAaP,GAC/FQ,mBAAmB,EACnBC,SAAUre,EAAKsc,MAAMzwB,KACrByyB,OAAQte,EAAKsc,MAAM3L,KAErB3Q,EAAK0c,6BAA+B,KACpC1c,EAAK2c,4BAA8B,OAIpC3c,EAAKyc,6BACN8B,cAAcve,EAAKyc,4BACnBzc,EAAKyc,2BAA6B,MAGpCzc,EAAKyc,2BAA6B+B,aAAY,WACzCxe,EAAK2c,8BACK,IAAI1f,MAAQ4X,UACR7U,EAAKwc,mBACZxc,EAAK+c,yBACXwB,cAAcve,EAAKyc,4BACnBzc,EAAKyc,2BAA6B,KAClCzc,EAAK2c,4BAA4B,CAC/B/vB,QAAS,0CAA4CoT,EAAKsc,MAAMzwB,KAAO,KAAOmU,EAAKsc,MAAM3L,GAAK,oBAC9FyN,mBAAmB,EACnBC,SAAUre,EAAKsc,MAAMzwB,KACrByyB,OAAQte,EAAKsc,MAAM3L,QAIxBrc,KAAKoD,IAAIsI,EAAKgd,cAAcyB,eAAgBnqB,KAAK+f,MAAMrU,EAAK+c,uBAAuB,KAEtF/c,EAAKuc,UAAU1N,UAAY,SAAC6P,GAC1B,IAAItZ,EAAQsZ,EAAajjB,KACzB,GAAGuE,EAAK0c,6BAA8B,CACpC,GAAiB,QAAdtX,EAAMvX,KAAgB,CACvBmS,EAAK2e,eAAevZ,EAAMgK,SAAWhK,EAAMgK,SAAW,IACtDpP,EAAKid,UAAW,EAChB,IAAI,IAAIvxB,EAAE,EAAGA,EAAIsU,EAAK6c,sBAAsBluB,OAAQjD,IAAKsU,EAAK6c,sBAAsBnxB,GAAGkzB,KAAK5e,EAAnCA,QAEzDA,EAAK6e,aAAazZ,GAGpB,IAAIvH,EAEAihB,GADO,IAAI7hB,MAAQ4X,UACR7U,EAAKwc,mBACpB,GAAGsC,EAAK9e,EAAKgd,cAAcyB,gBAAgC,QAAdrZ,EAAMvX,OACjDmS,EAAK4c,iBACLsB,QAAQa,KAAK,4BAA8B/e,EAAKsc,MAAMzwB,KAAO,KAAOmU,EAAKsc,MAAM3L,GAAK,oBAAsBmO,EAAK,mDAC5G9e,EAAK4c,gBAAkB,GAUxB,OATA/e,EAAWmC,EAAK2c,4BAChB3c,EAAK0c,6BAA+B,KACpC1c,EAAK2c,4BAA8B,UACnC9e,EAAS,CACPjR,QAAS,0CAA4CoT,EAAKsc,MAAMzwB,KAAO,KAAOmU,EAAKsc,MAAM3L,GAAK,0BAC9FyN,mBAAmB,EACnBC,SAAUre,EAAKsc,MAAMzwB,KACrByyB,OAAQte,EAAKsc,MAAM3L,KAKzB9S,EAAWmC,EAAK0c,6BAChB1c,EAAK0c,6BAA+B,KACpC1c,EAAK2c,4BAA8B,KACnC9e,MAKJ,IAAImhB,EAEFA,EADChf,EAAKsc,MAAM7H,MAAQzU,EAAKsc,MAAM7H,KAAKwK,KAAO,EAChC,CACTpzB,KAAMmU,EAAKsc,MAAM7H,KAAK5oB,KACtBqzB,MAAOlf,EAAKsc,MAAM7H,KAAK0K,QAAQ9a,KAAI,SAAChW,GAAD,OAAOA,EAAEsiB,OAGnC,CACT9kB,KAAMmU,EAAKsc,MAAMtF,SACjBkI,MAAO,CAAClf,EAAKsc,MAAM3L,KAGvB,IAAIyO,EAAW,CACbzO,GAAI3Q,EAAKsc,MAAM3L,GACf8D,KAAMuK,GAELhf,EAAKgd,cAAcqC,WACpBD,EAASC,SAAWrf,EAAKgd,cAAcqC,UAEzCrf,EAAKwc,oBAAsB,IAAIvf,MAAQ4X,UACvC7U,EAAK0c,6BAA+BoB,EACpC9d,EAAK2c,4BAA8BoB,EACnC/d,EAAKuc,UAAU+C,YAAY,CACzBnQ,QAAS,OACT9T,KAAMA,EAAO,IAAM2E,EAAKsc,MAAM3L,GAC9BvB,SAAU,CACR2F,KAAM,SAER1F,KAAM+P,EACN3zB,KAAMuU,EAAKgd,cAAcvxB,S,mCAKxBG,KAAK2wB,YACN3wB,KAAK2wB,UAAUgD,YACf3zB,KAAK2wB,UAAY,MAGhB3wB,KAAK6wB,6BACN8B,cAAc3yB,KAAK6wB,4BACnB7wB,KAAK6wB,2BAA6B,MAEpC,IAAI,IAAI/wB,EAAE,EAAGA,EAAIE,KAAKkxB,uBAAuBnuB,OAAQjD,IAAKE,KAAKkxB,uBAAuBpxB,GAAGkzB,KAAKhzB,KAApCA,K,qCAG7CkyB,EAASC,GACtB,GAAqB,mBAAXD,EAAuB,KAAM,yCAA2C,EAAQA,GAAW,UACrG,GAAoB,mBAAVC,EAAsB,KAAM,wCAA0C,EAAQA,GAAU,UAClG,IAAInyB,KAAKqxB,SACP,KAAM,SAAWrxB,KAAK0wB,MAAMtF,SAAW,kBAEzC,IAAIhX,EAAOpU,KACX,GAAGoU,EAAKuc,WAAkC,GAArBvc,EAAKsc,MAAMtG,OAI9B,OAHAhW,EAAKuc,UAAUgD,YACfvf,EAAKuc,UAAY,UACjBuB,IAIF9d,EAAKwc,oBAAsB,IAAIvf,MAAQ4X,UACvC7U,EAAK0c,6BAA+BoB,EACpC9d,EAAK2c,4BAA8BoB,EACnC/d,EAAKuc,UAAU+C,YAAY,CACzBnQ,QAAS,SACTjT,MAAO8D,EAAKsc,MAAMpgB,MAClBsT,QAASxP,EAAKkd,iB,qCAKHnY,GACb,IAAIqK,EAAW,IAGqB,GADrB,CAAC,QAAS,SAAU,QAAS,QAAS,SAAU,OAAQ,SAC3DzF,QAAQ5E,EAAMgQ,QACxB3F,EAAS2F,KAAOhQ,EAAMgQ,MAExBnpB,KAAK0wB,MAAMvf,KAAKqS,K,mCAGLhK,GACX,IAAIpF,EAAOpU,KACXoU,EAAKkd,aAAaC,SAAWnmB,OAAOoO,EAAM+X,UAC1Cnd,EAAKkd,aAAaG,KAAOrmB,OAAOoO,EAAMiY,MACtCrd,EAAKkd,aAAaK,SAAWvmB,OAAOoO,EAAMmY,UAC1Cvd,EAAKkd,aAAaI,WAAatmB,OAAOoO,EAAMkY,YAC5Ctd,EAAKkd,aAAaM,MAAQxmB,OAAOoO,EAAMoY,OACvCxd,EAAKkd,aAAaQ,MAAQtY,EAAMsY,MAChC1d,EAAKkd,aAAaE,MAAQhY,EAAMgY,MAAQ,EAAI,EAE5Cpd,EAAKkd,aAAaC,SAAWzT,MAAM1J,EAAKkd,aAAaC,UAAY,EAAInd,EAAKkd,aAAaC,SACvFnd,EAAKkd,aAAaG,KAAO3T,MAAM1J,EAAKkd,aAAaG,MAAQ,EAAIrd,EAAKkd,aAAaG,KAC/Erd,EAAKkd,aAAaK,SAAW7T,MAAM1J,EAAKkd,aAAaK,UAAY,EAAIvd,EAAKkd,aAAaK,SACvFvd,EAAKkd,aAAaI,WAAa5T,MAAM1J,EAAKkd,aAAaI,YAAc,EAAItd,EAAKkd,aAAaI,WAC3Ftd,EAAKkd,aAAaM,MAAQ9T,MAAM1J,EAAKkd,aAAaM,OAAS,EAAIxd,EAAKkd,aAAaM,MAEjFxd,EAAKkd,aAAaC,SAAW7oB,KAAKmD,IAAI,EAAGnD,KAAKoD,KAAK,EAAGV,OAAOgJ,EAAKkd,aAAaC,YAC/End,EAAKkd,aAAaG,KAAO/oB,KAAKmD,IAAI,EAAGnD,KAAKoD,KAAK,EAAGV,OAAOgJ,EAAKkd,aAAaG,QAC3Erd,EAAKkd,aAAaK,SAAWjpB,KAAKmD,IAAI,EAAGnD,KAAKoD,KAAK,EAAGV,OAAOgJ,EAAKkd,aAAaK,YAC/Evd,EAAKkd,aAAaI,WAAahpB,KAAKmD,IAAI,EAAGnD,KAAKoD,KAAK,EAAGV,OAAOgJ,EAAKkd,aAAaI,cACjFtd,EAAKkd,aAAaM,MAAQlpB,KAAKmD,IAAI,EAAGnD,KAAKoD,IAAI,EAAGV,OAAOgJ,EAAKkd,aAAaM,SAE3Exd,EAAKsc,MAAMkD,YAAYxf,EAAKkd,aAAaC,UACzCnd,EAAKsc,MAAMmD,SAASzf,EAAKkd,aAAaE,OACtCpd,EAAKsc,MAAMoD,QAAQ1f,EAAKkd,aAAaG,MACrCrd,EAAKsc,MAAMqD,aAAa3f,EAAKkd,aAAaI,YAC1Ctd,EAAKsc,MAAMsD,WAAW5f,EAAKkd,aAAaK,UACxCvd,EAAKsc,MAAMuD,aAAa7f,EAAKkd,aAAaQ,OACvC1d,EAAKkd,aAAaM,OACnBxd,EAAKsc,MAAMwD,MAAM9f,EAAKkd,aAAaM,OAErCxd,EAAKkd,aAAaM,MAAQ,EAE1B,IAAIrG,EAAW,GACf,IAAI,IAAIzrB,KAAM0Z,EAAMqY,OAClBtG,EAASlhB,KAAK8pB,KAAK7U,MAAM6U,KAAKC,UAAU5a,EAAMqY,OAAO/xB,MAGpDsU,EAAKsc,MAAM7H,MACZzU,EAAKsc,MAAM7H,KAAKwL,aAAajgB,EAAKsc,MAAM3L,GAAIwG,GAG9CnX,EAAKkd,aAAaO,OAAS,K,oCAGf9vB,GACZ,OAAGA,EAAIuyB,WACE,IAAIC,OAAOxyB,EAAIyyB,UAEf,IAAIxR,M,2BA1Ob,OAAOhjB,KAAK0wB,Q,6BAIZ,OAAO1wB,KAAK2wB,e,gMCxCK8D,E,WAEnB,c,4FAAc,SACZz0B,KAAK00B,wBAA0B,GAC/B10B,KAAK20B,aAAa,EAClB30B,KAAK40B,WAAW,EAChB50B,KAAK60B,UAAS,EACd70B,KAAK80B,mBAAqBpsB,KAAKkI,MAAM,IAAK5Q,KAAK00B,yBAC/C10B,KAAK+0B,kBAAoB/0B,KAAK80B,mBAC9B90B,KAAKg1B,iBAAmB,EACxBh1B,KAAKi1B,gBAAkB,EACvBj1B,KAAKk1B,SAAWl1B,KAAKi1B,gBACrBj1B,KAAKm1B,eAAiB,I,qDAgBtBn1B,KAAK60B,UAAW,EAChB,IAAIzgB,EAAOpU,KACXA,KAAK40B,WAAahC,aAAY,WAC5Bxe,EAAKghB,WACJp1B,KAAKm1B,kB,6BAIRn1B,KAAK60B,UAAW,EACb70B,KAAK40B,aACNjC,cAAc3yB,KAAK40B,YACnB50B,KAAK40B,WAAa,Q,gDAII7jB,GACrBA,GAAK/Q,KAAK00B,0BACX10B,KAAKk1B,SAAWl1B,KAAKi1B,iBAEvBj1B,KAAK00B,wBAA0B3jB,EAC/B/Q,KAAK80B,mBAAqBpsB,KAAKkI,MAAM,IAAKG,K,yCAIvC/Q,KAAK60B,UACN70B,KAAK20B,iB,+BASP30B,KAAK+0B,kBAAoBrsB,KAAK2sB,KAAKr1B,KAAK20B,cAAc,IAAK30B,KAAKm1B,iBAChEn1B,KAAK20B,aAAe,EACpB,IAAIpa,EAAQva,KAAK80B,mBAAqB90B,KAAK+0B,kBAAkB/0B,KAAK80B,mBAAqB,EACvF90B,KAAKg1B,kBAAoBh1B,KAAKg1B,iBAAmBza,GAAO,EACxDva,KAAKs1B,mB,uCAIL,IAAIC,EAAgB,IAAIv1B,KAAKg1B,iBAAmB,KAChDO,EAAgB7sB,KAAKoD,IAAI,EAAGpD,KAAKmD,IAAI,EAAG0pB,IACxC,IAAIC,GAAgB,GAAIx1B,KAAKg1B,iBAAmB,IAE7Ch1B,KAAKg1B,iBAAmB,EACzBh1B,KAAKi1B,iBAAmB,GAExBj1B,KAAKi1B,iBAAmBO,EAG1Bx1B,KAAKi1B,gBAAkBvsB,KAAKoD,IAAI,EAAGpD,KAAKmD,IAAI,EAAG7L,KAAKi1B,kBAEpD,IAAIQ,EAAgB/sB,KAAKoD,IAAIypB,EAAev1B,KAAKi1B,iBAEjDj1B,KAAKi1B,iBAAmBj1B,KAAKi1B,gBAAkBQ,GAAe,EAC3Dz1B,KAAKi1B,gBAAkBj1B,KAAKk1B,SAC7Bl1B,KAAKk1B,SAAWl1B,KAAKi1B,gBAErBj1B,KAAKk1B,UAAYl1B,KAAKi1B,gBAAkB,EAAEj1B,KAAKk1B,UAAU,K,8BAxE3D,OAAOl1B,KAAK60B,W,wCAIZ,OAAO70B,KAAK80B,qB,uCAIZ,OAAO90B,KAAK+0B,oB,mCAkCZ,OAAO/0B,KAAKk1B,c,4LC1DhB,IAAIQ,GAA8B,EAsLlC,Q,WAxKE,c,4FAAc,SACZ,IAAIC,GAAO,IAAItkB,MAAQ4X,UAAUxlB,WACjCkyB,EAAMA,EAAI1a,OAAO0a,EAAI5yB,OAAO,EAAG,GAAK,GAAK2F,KAAK+f,MAAM,IAAS/f,KAAKwL,UAElEyhB,GADAA,EAAMvqB,OAAOuqB,IACHlyB,SAAS,IACnBzD,KAAKgmB,MAAQ,GACbhmB,KAAKimB,MAAQ0P,EACb31B,KAAK41B,MAAQ,KACb51B,KAAK61B,UAAY,KACjB71B,KAAK81B,aAAc,EACnB91B,KAAK+1B,gBAAkB,I,sDAOvB,MAAO,CACL91B,KAAMD,KAAKgmB,MACX6C,KAAM7oB,KAAKimB,MACXpmB,KAAMG,KAAK41B,MACXnC,SAAUzzB,KAAK61B,UACfvB,WAAYt0B,KAAK81B,YACjBjD,eAAgB7yB,KAAK6yB,kB,+BAOhBhjB,GACP7P,KAAKgmB,MAAQnW,EAAK5P,KAClBD,KAAKimB,MAAQpW,EAAKgZ,KAClB7oB,KAAK41B,MAAQ/lB,EAAKhQ,KAAOgQ,EAAKhQ,KAAKgF,QAAQ,8BAA+B,IAAMgL,EAAKhQ,KACrFG,KAAK61B,UAAYhmB,EAAK4jB,SACtBzzB,KAAK81B,YAAcjmB,EAAKykB,WACxBt0B,KAAK+1B,gBAAkBlmB,EAAKgjB,iB,8BAO5B,IAAIjnB,EAAS,IAAIoqB,EAEjB,OADApqB,EAAOqqB,SAASj2B,KAAKk2B,UACdtqB,I,+BAuEA6mB,EAAUgB,GACjB,IAAIhB,EAAU,MAAM,IAAI5T,MAAM,wBAC9B7e,KAAKgmB,MAAQyM,EACbzyB,KAAK41B,MAAQ,KACb51B,KAAK61B,eAAyBphB,IAAbgf,EAAyBA,EAAW,O,+BAS9ChB,EAAU5yB,EAAM4zB,GACvB,IAAIhB,EAAU,MAAM,IAAI5T,MAAM,wBAC9B,IAAIhf,EAAM,MAAM,IAAIgf,MAAM,oBAC1B,GAAuB,iBAAb4T,EAAuB,MAAM,IAAI5T,MAAM,6BACjD,GAAmB,iBAAThf,EAAmB,MAAM,IAAIgf,MAAM,yBAC7Chf,EAAOA,EAAKgF,QAAQ,8BAA+B,IACnD7E,KAAKgmB,MAAQyM,EACbzyB,KAAK41B,MAAQ/1B,EACbG,KAAK61B,eAAyBphB,IAAbgf,EAAyBA,EAAW,O,mCAO1C0C,GACXn2B,KAAKimB,MAAQkQ,I,uCAWb,GAAkB,OAAfn2B,KAAK41B,MACN,MAAM,IAAI/W,MAAM,oEAAsE7e,KAAKgmB,MAAQ,MAEjG0P,IACFpD,QAAQa,KAAK,oDACbuC,GAA8B,GAEhC11B,KAAK81B,aAAc,I,2BA/GnB,OAAO91B,KAAKgmB,Q,+BAOZ,OAAOhmB,KAAKimB,Q,qCAOZ,OAAOjmB,KAAK+1B,iB,aAMKhlB,GACjB/Q,KAAK+1B,gBAAkBhlB,I,+BAOvB,OAAI/Q,KAAK81B,YACS,OAAf91B,KAAK41B,MACC,0BAEP,gBAAgB51B,KAAKgmB,MAArB,YAJ2B,O,2BAa7B,OAAOhmB,KAAK41B,Q,+BAOZ,OAAO51B,KAAK61B,Y,iCAOZ,OAAO71B,KAAK81B,iB,w4GCChB,Q,WApHE,c,4FAAc,SACZ91B,KAAKo2B,SAAW,EAChBp2B,KAAKq2B,QAAU,GACfr2B,KAAKs2B,UAAY,IAAIjlB,MAAQ4X,UAC7BjpB,KAAKu2B,WAAY,EACjBv2B,KAAKw2B,WAAa,E,6DAGJC,GACdz2B,KAAKq2B,QAAQhsB,KAAKosB,K,kCAGR1lB,GACV/Q,KAAKu2B,UAAYxlB,I,oCAIjB,OAAO/Q,KAAKu2B,Y,iCAGH9mB,GACTzP,KAAKs2B,SAAW7mB,I,mCAIhB,OAAOzP,KAAKo2B,W,kCAIZ,OAAOp2B,KAAKq2B,U,mCAGDnlB,GACXlR,KAAKw2B,WAAatlB,I,qCAIlB,OAAOlR,KAAKw2B,a,mCAIZ,OAAOx2B,KAAKs2B,W,+BAIZ,IAOI5iB,EARG,EACHgjB,EAAO,CACTC,QAAS32B,KAAKo2B,SACdQ,QAAS52B,KAAKs2B,SACdO,SAAU72B,KAAKu2B,UACfO,UAAW92B,KAAKw2B,WAChBO,OAAQ,IANH,IASO/2B,KAAKq2B,SATZ,IASP,2BAA4B,KAApBI,EAAoB,QAC1B/iB,EAAQ+iB,EAAG/iB,OAAS,EACpB,IAAI,IAAI5T,EAAE,EAAGA,EAAG4T,EAAO5T,IACrB42B,EAAKK,OAAO1sB,KAAKosB,EAAGP,WAZjB,8BAgBP,OADU/B,KAAKC,UAAUsC,K,6BAIpB7mB,EAAMmnB,GACX,IAAIN,EAcAD,EAbJ,IACEC,EAAOvC,KAAK7U,MAAMzP,GAClB,MAAMmiB,GACJ,MAAM,IAAInT,MAAJ,iCAAoCmT,IAE9C,GAAGhyB,KAAKo2B,UAAWM,EAAKC,QACtB,MAAM,IAAI9X,MAAJ,iDAAoD6X,EAAKC,QAAzD,wDAAgH32B,KAAKo2B,WAE7Hp2B,KAAKi3B,iBAAiBP,GACtB12B,KAAKs2B,SAAWI,EAAKE,QACrB52B,KAAKu2B,UAAYG,EAAKG,SACtB72B,KAAKw2B,WAAaE,EAAKI,UAbE,UAgBPJ,EAAKK,QAhBE,IAgBzB,2BAA+B,KAAvBG,EAAuB,QAC7BT,EAAK,IAAIT,EACLgB,IACFE,EAAO5C,YAAa,EACpB4C,EAAOrE,eAAiB,IACxBqE,EAAOzD,SAAW,MAEpBgD,EAAGR,SAASiB,GACZl3B,KAAKq2B,QAAQhsB,KAAKosB,IAxBK,iC,uCA4BVC,GACf,IACIS,GADM,IAAIC,MACKC,QAAQ92B,GAE3B,IADY42B,EAAST,GAEnB,MAAM,IAAI7X,MAAM,2BAA6BsY,EAASlf,OAAO,GAAGjX,W,8BAKlE,IAAI4K,EAAS,IAAI0rB,EACjB1rB,EAAO2rB,WAAWv3B,KAAKw3B,cACvB5rB,EAAO6rB,YAAYz3B,KAAK03B,eACxB9rB,EAAO+rB,aAAa33B,KAAK43B,gBACzB,IACIC,EANE,MAKO73B,KAAK83B,aALZ,IAON,2BACED,EADoB,QACPvvB,QACbsD,EAAOmsB,gBAAgBF,GATnB,8BAWN,OAAOjsB,O,sBC5GX,EATA,SAAyBosB,GACvB,IAAIC,EAAY,EAChB,IAAI,IAAIn4B,KAAKk4B,EAAWE,SAClBF,EAAWE,SAASp4B,GAAGq4B,SAC3BF,IAEF,OAAQA,GAAa,G,2YCgmBvB,Q,WA9kBE,WAAYG,EAAUC,I,4FAAO,SAC3Br4B,KAAKs4B,OAASD,EACdr4B,KAAKq2B,QAAU,GACfr2B,KAAKu4B,aAAe,GACpBv4B,KAAKw4B,UAAY,GACjBx4B,KAAKy4B,YAAc,GACnBz4B,KAAK04B,kBAAoB,GACzB14B,KAAK24B,oBAAsB,GAC3B34B,KAAK8tB,aAAe,KACpB9tB,KAAK44B,mBAAqB,KAC1B54B,KAAK64B,gBAAkB,KACvB74B,KAAK00B,wBAA0B,GAC/B10B,KAAK84B,oBAAsB,GAC3B94B,KAAK+4B,UAAYX,EACjBp4B,KAAKg5B,YAAa,EAClBh5B,KAAKi5B,mBAAqB,IAAIxL,EAC9BztB,KAAKs2B,UAAY,IAAIjlB,MAAQ4X,UAAYvgB,KAAK+f,MAAoB,IAAd/f,KAAKwL,UACzDlU,KAAKk5B,KAAOnnB,IAAW/R,KAAKs2B,UAC5Bt2B,KAAKm5B,iBAAmB,EACxBn5B,KAAKo5B,0BAA4B,GACjCp5B,KAAKq5B,sBAAwB,GAC7Br5B,KAAKs5B,kBAAoB,GACzBt5B,KAAKu5B,iBAAmB,GACxBv5B,KAAKw5B,iBAAmB,GACxBx5B,KAAKy5B,aAAe,EACpBz5B,KAAKw2B,WAAa,IAClBx2B,KAAK05B,iBAAmBC,EACxB35B,KAAK45B,wBAAyB,EAC9B55B,KAAK65B,YAAc,IAAIvM,EACvBttB,KAAK85B,YAAc,EACnB95B,KAAK+5B,cAAgB,EACrB/5B,KAAKg6B,iBAAmB,OACxBh6B,KAAKi6B,SAAW,IAAIxF,EACpBz0B,KAAKi6B,SAASC,0BAA0Bl6B,KAAK00B,wBAAwB10B,KAAKm5B,kBAC1En5B,KAAKmjB,gBAAkB/X,OAAOC,UAC9BrL,KAAKojB,gBAAkB,EACvBpjB,KAAKk4B,SAAW,GAChBl4B,KAAKm6B,UAAY,GACjBn6B,KAAKo6B,0BAA4B,IAAI9C,EACrCt3B,KAAKq6B,IAAI,0B,wDAaA5qB,GACTzP,KAAKq6B,IAAL,oCAAsC5qB,EAAtC,MACAzP,KAAKs2B,SAAW7mB,EAChBzP,KAAKo6B,0BAA0B7C,WAAW9nB,GAC1CzP,KAAKk5B,KAAOnnB,IAAW/R,KAAKs2B,Y,mCAO5B,OAAOt2B,KAAKs2B,W,kCAOZ,OAAOt2B,KAAKk5B,S,0BAOVhW,GACCljB,KAAKs4B,QACNhG,QAAQ+H,IAAI,SAAWnX,K,yCAQRjR,GACjBjS,KAAKq6B,IAAL,qCACAr6B,KAAK45B,wBAAyB,EAC9B55B,KAAK05B,iBAAmBznB,I,2BASrBR,EAAO8a,GACVvsB,KAAKq6B,IAAL,4CAA8C5oB,EAA9C,oBAA+D8a,EAA/D,MACAvsB,KAAK8tB,aAAe,IAAIxB,EACxBtsB,KAAK8tB,aAAawM,QAAQ7oB,EAAO8a,GACjCvsB,KAAK8tB,aAAayM,UAAUv6B,KAAKk5B,QACjCl5B,KAAK+4B,UAAUyB,eAAex6B,KAAK8tB,cACnC9tB,KAAKi5B,mBAAmBwB,kBAAkBz6B,KAAK8tB,cAC/C9tB,KAAKq6B,IAAL,yC,8BAwDA,GADAr6B,KAAKq6B,IAAL,2BAC4B,GAAzBr6B,KAAKw4B,UAAUz1B,OAChB,MAAM,IAAI8b,MAAM,uDAGlB,IAAI/e,EADJE,KAAKg5B,YAAa,EAElB,IAAI5kB,EAAOpU,KAERA,KAAK64B,kBACN74B,KAAKq6B,IAAL,qCACA1H,cAAc3yB,KAAK64B,iBACnB74B,KAAK64B,gBAAkB,MAGzB74B,KAAKq6B,IAAL,qBACAr6B,KAAK06B,aACH,WAUE,IATAtmB,EAAKykB,gBAAkBjG,aAAY,WACjCxe,EAAKumB,gBACJvmB,EAAK0kB,qBAEL1kB,EAAKwkB,oBACNgC,aAAaxmB,EAAKwkB,oBAEpBxkB,EAAK6lB,SAASY,QACdzmB,EAAKimB,IAAL,0BACIv6B,EAAE,EAAGA,EAAIsU,EAAKolB,iBAAiBz2B,OAAQjD,IAAKsU,EAAKolB,iBAAiB15B,KACtEsU,EAAKimB,IAAL,6BACAjmB,EAAK0mB,qBAEP,SAAC9I,GAEC,IADAM,QAAQpU,MAAM8T,GACVlyB,EAAE,EAAGA,EAAIsU,EAAKmlB,iBAAiBx2B,OAAQjD,IAAKsU,EAAKmlB,iBAAiBz5B,GAAGkyB,EAAIhxB,QAAUgxB,EAAIhxB,QAAU,gC,wCAMzGhB,KAAKi6B,SAASc,mBACd,IAEIj7B,EAFAk7B,GAAa,IAAI3pB,MAAQ4X,UACzB7U,EAAOpU,KAEXA,KAAKi7B,eACLj7B,KAAKk7B,WACH,WAKE,GAJG9mB,EAAKwkB,qBACNgC,aAAaxmB,EAAKwkB,oBAClBxkB,EAAKwkB,mBAAqB,MAExBxkB,EAAKoiB,WAAa,GAAKpiB,EAAKqlB,cAAgBrlB,EAAKoiB,YAAepiB,EAAKslB,iBAAiBtlB,GAIxF,IAHAA,EAAK+mB,OACL/mB,EAAK6mB,eACL7mB,EAAKumB,cACD76B,EAAE,EAAGA,EAAIsU,EAAKklB,kBAAkBv2B,OAAQjD,IAAKsU,EAAKklB,kBAAkBx5B,KAE1E,GAAGsU,EAAK4kB,WAAY,CAClB,IAAIoC,GAAkB,IAAI/pB,MAAQ4X,UAAY+R,EAC1C9H,EAAK9e,EAAKsgB,wBAAwBtgB,EAAK+kB,iBAAmBiC,EAE9D,IADAlI,EAAKxqB,KAAK+f,MAAMyK,GACZpzB,EAAE,EAAGA,EAAIsU,EAAKglB,0BAA0Br2B,OAAQjD,IAAKsU,EAAKglB,0BAA0Bt5B,KACxFsU,EAAKqlB,cAAgBrlB,EAAKsgB,wBACvBtgB,EAAKoiB,WAAa,IACnBpiB,EAAKqlB,aAAe/wB,KAAKmD,IAAIuI,EAAKqlB,aAAcrlB,EAAKoiB,aAEpDtD,EAAK,GACN9e,EAAKgP,gBAAgB,EACrBhP,EAAKwkB,mBAAqB/U,WAAWzP,EAAK0mB,gBAAgB9H,KAAK5e,GAAO8e,IAC9D9e,EAAKgP,iBAAmBhP,EAAK+O,gBACrC/O,EAAKwkB,mBAAqB/U,WAAWzP,EAAK0mB,gBAAgB9H,KAAK5e,GAAO,IAEtEA,EAAKgP,kBACLhP,EAAK0mB,uBAIX,SAAC9I,GAEC,IADAM,QAAQpU,MAAM8T,GACVlyB,EAAE,EAAGA,EAAIsU,EAAKmlB,iBAAiBx2B,OAAQjD,IAAKsU,EAAKmlB,iBAAiBz5B,GAAGkyB,EAAIhxB,QAAUgxB,EAAIhxB,QAAU,gC,8BAWnG8kB,GAEN,GADA9lB,KAAKq6B,IAAL,kBAC0B,UAAvB,EAAOvU,GACR,KAAM,kCAER,IAAI9lB,KAAK8tB,aACP,KAAM,6BAER,IAAIhI,EAAaqQ,SACf,KAAM,6BAER,IAAIkF,EAAYr7B,KAAK8tB,aAAawN,eAClC,IAAID,EACF,KAAM,mCAERr7B,KAAKo6B,0BAA0BrC,gBAAgBjS,GAC/C9lB,KAAKo6B,0BAA0B3C,YAAYz3B,KAAKu7B,YAChD,IAAI7X,EAAO1jB,KAAKw7B,YAAY1V,GAC5BpC,EAAK6W,UAAUv6B,KAAKy7B,aACpB/X,EAAKgY,OAAOL,EAAU9zB,EAAG8zB,EAAU7zB,GACnCxH,KAAKw4B,UAAUnuB,KAAKqZ,GACpB1jB,KAAKu4B,aAAaluB,KAAKqZ,GACpB1jB,KAAKw2B,WAAa,GAAKx2B,KAAKu4B,aAAax1B,OAAS,IACnD/C,KAAKw2B,YAAc,KAGjBx2B,KAAKk4B,SAASpS,EAAaqQ,YAC7Bn2B,KAAKk4B,SAASpS,EAAaqQ,UAAY,IAAIwF,EAAK7V,EAAaqQ,UAC7Dn2B,KAAKm6B,UAAU9vB,KAAKrK,KAAKk4B,SAASpS,EAAaqQ,YAEjDn2B,KAAKk4B,SAASpS,EAAaqQ,UAAUyF,QAAQlY,GAE7C,IAAI+S,EAAKz2B,KAAK67B,iBAAiBnY,EAAMoC,GAGrC,OAFA9lB,KAAKq2B,QAAQhsB,KAAKosB,GAEXA,I,+BASA1lB,GACP/Q,KAAKq6B,IAAL,wBAA0BtpB,EAA1B,MACA/Q,KAAKm5B,iBAAmBzwB,KAAKoD,IAAI,IAAMV,OAAO2F,IAC9C/Q,KAAKi6B,SAASC,0BAA0Bl6B,KAAK00B,wBAAwB10B,KAAKm5B,kBAC1En5B,KAAK+4B,UAAU+C,SAAS/qB,K,yCAYPA,GACjB/Q,KAAKq6B,IAAL,kCAAoCtpB,EAApC,MACG+M,MAAM/M,IAAW,QAALA,IACX+M,MAAM/M,KACRA,EAAIrI,KAAKmD,IAAI,EAAGnD,KAAKoD,IAAI,EAAGiF,KAE9B/Q,KAAKg6B,iBAAmBjpB,K,6BAsBxB,IAAI0lB,EAAI32B,EACR,IAbAE,KAAKq6B,IAAL,2BACAr6B,KAAKg5B,YAAa,EAClBh5B,KAAKi6B,SAASkB,OACdn7B,KAAK+4B,UAAUoC,OACZn7B,KAAK44B,qBACNgC,aAAa56B,KAAK44B,oBAClB54B,KAAK44B,mBAAqB,MAEzB54B,KAAK64B,kBACNlG,cAAc3yB,KAAK64B,iBACnB74B,KAAK64B,gBAAkB,MAGrB/4B,EAAE,EAAGA,EAAIE,KAAKq2B,QAAQtzB,OAAQjD,KAChC22B,EAAKz2B,KAAKq2B,QAAQv2B,KAElB22B,EAAGsF,aAEL/7B,KAAKq2B,QAAU,K,6BAWVpkB,GACLjS,KAAKo5B,0BAA0B/uB,KAAK4H,K,+BAa7BA,GACPjS,KAAKq5B,sBAAsBhvB,KAAK4H,K,8BAS1BA,GACNjS,KAAKw5B,iBAAiBnvB,KAAK4H,K,+BAQpBA,GACPjS,KAAKs5B,kBAAkBjvB,KAAK4H,K,8BAQtBA,GACNjS,KAAKu5B,iBAAiBlvB,KAAK4H,K,uDAS3B,GAAGjS,KAAK45B,uBACN,MAAM,IAAI/a,MAAM,sEAElB,OAAO7e,KAAKo6B,0BAA0B9xB,U,iCAOtC,OAAOtI,KAAKm6B,UAAUp3B,QAAU/C,KAAKw4B,UAAUz1B,S,kCAGrCi5B,EAAM9d,GAChBle,KAAKi8B,eAAej8B,KAAKq2B,QAAS,WAAYr2B,KAAKk5B,OAAQ8C,EAAM9d,K,gCAGzD8d,EAAM9d,GACdle,KAAKi8B,eAAej8B,KAAKq2B,QAAS,iBAAkB,KAAM2F,EAAM9d,K,qCAGnDge,EAAYC,EAAYC,EAAUJ,EAAM9d,GACrD,GAAwB,GAArBge,EAAWn5B,OACZ,OAAOi5B,IAET,SAASK,IAIP,IAHA,IAAIC,EAAO,GACPrqB,EAAWsqB,UAAU,GACrBnoB,EAAOmoB,UAAU,GACbz8B,EAAE,EAAGA,EAAIy8B,UAAUx5B,OAAQjD,IACjCw8B,EAAKjyB,KAAKkyB,UAAUz8B,IAEtB,OAAO,SAAC08B,GACNvqB,EAASgC,MAAMG,EAAMkoB,EAAK9Q,OAAOgR,KAIrC,IAIIjuB,EAHAkuB,EAAcJ,EADP,KAC0BL,GACjCU,EAAeL,EAFR,KAE2Bne,GAIpC3P,EADC6tB,EACGC,EAAaH,EAAWA,EAAWn5B,OAAO,GAAIm5B,EAAWA,EAAWn5B,OAAO,GAAGo5B,GAAaC,EAAUK,EAAaC,GAElHL,EAAaH,EAAWA,EAAWn5B,OAAO,GAAIm5B,EAAWA,EAAWn5B,OAAO,GAAGo5B,GAAaM,EAAaC,GAE9G,IAAI,IAAI58B,EAAEo8B,EAAWn5B,OAAO,EAAGjD,GAAI,EAAGA,IAElCyO,EADC6tB,EACGC,EAAaH,EAAWp8B,GAAIo8B,EAAWp8B,GAAGq8B,GAAaC,EAAU7tB,EAAGmuB,GAEpEL,EAAaH,EAAWp8B,GAAIo8B,EAAWp8B,GAAGq8B,GAAa5tB,EAAGmuB,GAGlEnuB,M,qCAIA,IAAIzO,EAAG4jB,EAAMkF,EAAQ6N,EAErB,IAAI32B,EAAE,EAAGA,EAAIE,KAAKw4B,UAAUz1B,OAAQjD,KAClC4jB,EAAO1jB,KAAKw4B,UAAU14B,KAEtB4jB,EAAKiZ,eAAe38B,KAAKi5B,oBAG3B,IAAI2D,EAAY,EAChB,IAAI98B,EAAE,EAAGA,EAAIE,KAAKw4B,UAAUz1B,OAAQjD,KAClC4jB,EAAO1jB,KAAKw4B,UAAU14B,KAEnB4jB,EAAK0G,QAAU,IAChBwS,IACA58B,KAAKw4B,UAAU14B,GAAK,KACpBE,KAAK04B,kBAAkBruB,KAAKqZ,GAC5B1jB,KAAKi5B,mBAAmB4D,WAAWnZ,GACnC1jB,KAAK65B,YAAYl5B,IAAI,QAAU+iB,EAAKqB,GAAI,CACtC9iB,KAAM,UACNyhB,KAAMA,KAIZ,IAAIoZ,EAAY,GAChB,IAAIh9B,EAAE,EAAGA,EAAIE,KAAKq2B,QAAQtzB,OAAQjD,KAChC22B,EAAKz2B,KAAKq2B,QAAQv2B,MAEf22B,EAAG/S,KAAK0G,QAAU,GACnBpqB,KAAKq2B,QAAQv2B,GAAK,KAClB22B,EAAGsF,cAGLe,EAAUzyB,KAAKosB,IAIjB,IAFAz2B,KAAKq2B,QAAUyG,EAEXh9B,EAAE,EAAGA,EAAIE,KAAKw4B,UAAUz1B,OAAQjD,IAElC,IADA4jB,EAAO1jB,KAAKw4B,UAAU14B,KAEnB4jB,EAAKqZ,WAAY,CAClB,IAAIhR,EAAQrI,EAAKsZ,cACjBpU,EAAS5oB,KAAKi9B,cAAcvZ,EAAMqI,GAClC/rB,KAAKy4B,YAAYpuB,KAAKue,GACtB5oB,KAAK65B,YAAYl5B,IAAI,QAAU+iB,EAAKqB,GAAI,CACtC9iB,KAAM,QACNyhB,KAAMA,EACNkF,OAAQA,IAId,IAAI9oB,EAAE,EAAGA,EAAIE,KAAKw4B,UAAUz1B,OAAQjD,IAElC,GADA4jB,EAAO1jB,KAAKw4B,UAAU14B,GAEtB,IAAI,IAAImR,EAAE,EAAGA,EAAI2rB,EAAW3rB,IAC1ByS,EAAKwZ,iBAIT,IAAIp9B,EAAE,EAAGA,EAAIE,KAAKy4B,YAAY11B,OAAQjD,KACpC8oB,EAAS5oB,KAAKy4B,YAAY34B,MAE1B8oB,EAAO+T,iBACG38B,KAAKi5B,mBAAmBkE,cAAcvU,KAE9C5oB,KAAKy4B,YAAY34B,GAAK,KACtBE,KAAK24B,oBAAoBtuB,KAAKue,GAC9B5oB,KAAKi5B,mBAAmBmE,aAAaxU,GACrC5oB,KAAK65B,YAAYl5B,IAAI,UAAYioB,EAAO7D,GAAI,CAC1C9iB,KAAM,UACN2mB,OAAQA,MAId,IAAI9oB,KAAKE,KAAKk4B,SACZl4B,KAAKk4B,SAASp4B,GAAGu9B,oB,oCAUnB,IAAIv9B,EAAG4jB,EAAMkF,EAGb,IAR4B,QAAzB5oB,KAAKg6B,iBACNh6B,KAAK+4B,UAAUuE,QAAUt9B,KAAKi6B,SAASsD,aAEvCv9B,KAAK+4B,UAAUuE,QAAUt9B,KAAKg6B,iBAGhCh6B,KAAK+4B,UAAUyE,YACfx9B,KAAK+4B,UAAU0E,YAAYz9B,KAAKy5B,aAAcz5B,KAAKw2B,YAC/C12B,EAAE,EAAGA,EAAIE,KAAKw4B,UAAUz1B,OAAQjD,KAClC4jB,EAAO1jB,KAAKw4B,UAAU14B,KAEtBE,KAAK+4B,UAAU2E,WAAWha,EAAM1jB,KAAK65B,YAAYpU,IAAI,QAAU/B,EAAKqB,KAEtE,IAAIjlB,EAAE,EAAGA,EAAIE,KAAKy4B,YAAY11B,OAAQjD,KACpC8oB,EAAS5oB,KAAKy4B,YAAY34B,KAE1BE,KAAK+4B,UAAU4E,aAAa/U,EAAQ5oB,KAAK65B,YAAYpU,IAAI,UAAYmD,EAAO7D,KAE9E,KAAM/kB,KAAK04B,kBAAkB31B,QAC3B2gB,EAAO1jB,KAAK04B,kBAAkBpsB,MAC9BtM,KAAK+4B,UAAU2E,WAAWha,EAAM1jB,KAAK65B,YAAYpU,IAAI,QAAU/B,EAAKqB,KAEtE,KAAM/kB,KAAK24B,oBAAoB51B,QAC7B6lB,EAAS5oB,KAAK24B,oBAAoBrsB,MAClCtM,KAAK+4B,UAAU4E,aAAa/U,EAAQ5oB,KAAK65B,YAAYpU,IAAI,UAAYmD,EAAO7D,KAI9E,IAFA/kB,KAAK+4B,UAAU6E,gBAAgB59B,KAAKu4B,cACpCv4B,KAAK+4B,UAAU8E,aACX/9B,EAAE,EAAGA,EAAIE,KAAKq5B,sBAAsBt2B,OAAQjD,IAAKE,KAAKq5B,sBAAsBv5B,KAChFE,KAAK65B,YAAY1xB,U,uCAGFub,EAAMoC,GACrB,OAAO,IAAI2K,EAAU/M,EAAMoC,K,kCAGjBA,GAEV,OADW,IAAIgY,EAAKhY,EAAc9lB,KAAK85B,iB,oCAI3BhO,EAAOC,GAEnB,OADa,IAAIF,EAAOC,EAAO9rB,KAAK+5B,gBAAiBhO,K,+BAxdrD,OAAO/rB,KAAKu4B,e,+BAOZ,OAAOv4B,KAAKm6B,Y,+BAOZ,OAAOn6B,KAAK+4B,Y,kCAIZ,OAAO/4B,KAAK8tB,e,kCAOZ,OAAO9tB,KAAKy5B,e,gCAOZ,OAAOz5B,KAAKw2B,Y,aAGAzlB,GACZ/Q,KAAKq6B,IAAL,6BAA+BtpB,EAA/B,MACA/Q,KAAKo6B,0BAA0BzC,aAAa5mB,GAC5C/Q,KAAKw2B,WAAazlB,O,4LC1EtB,Q,WA/FE,c,4FAAc,S,4DASCgd,M,4GAmCJrK,EAAMqa,M,kCASLC,EAAWC,M,sCAQPC,M,mCASHtV,EAAQmV,M,+BAOZhtB,M,iGA3DP,OAAO,G,aAGGA,S,sBC7BR,EAA+BotB,K,0KCEhBC,E,WAEnB,WAAYC,I,4FAAO,SACjBr+B,KAAKs+B,OAASD,EACdr+B,KAAKu+B,MAAQ,KACbv+B,KAAKw+B,UAAW,E,uDAQhBx+B,KAAKw+B,UAAW,I,6BAWXT,M,8BAfL,OAAO/9B,KAAKw+B,W,4BAQZ,OAAOx+B,KAAKs+B,S,2BAIZ,OAAOt+B,KAAKu+B,W,i0BClBKE,E,kpBAEnB,WAAYpG,GAAO,a,4FAAA,UACjB,gBACKC,OAASD,EACd,EAAK1K,SAAW,GAChB,EAAKC,WAAa,GAClB,EAAKjB,SAAW,EAChB,EAAKC,SAAW,EAChB,EAAKuM,iBAAmB,EAPP,E,yCAUfjW,GACCljB,KAAKs4B,QACNhG,QAAQ+H,IAAI,cAAgBnX,K,qCAgBjB6K,GACb/tB,KAAK2sB,SAAWoB,EAAY2Q,QAC5B1+B,KAAK4sB,SAAWmB,EAAY4Q,U,iCAGnBjb,EAAMqa,GACf/9B,KAAK4+B,aAAalb,EAAMqa,EAAQ/9B,KAAK2tB,SAAU3tB,KAAK6+B,mB,mCAGzCjW,EAAQmV,GACnB/9B,KAAK4+B,aAAahW,EAAQmV,EAAQ/9B,KAAK4tB,WAAY5tB,KAAK8+B,qB,oCAG5C/Z,GACZ,OAAO/kB,KAAK4tB,WAAW7I,K,kCAGbA,GACV,OAAO/kB,KAAK2tB,SAAS5I,K,+BAGdhU,GACP/Q,KAAKm5B,iBAAmBpoB,I,mCAGbstB,EAAON,EAAQtlB,EAAKtR,GAC/B,IAAI43B,EAAO,KAQX,OAPGtmB,EAAI4lB,EAAMtZ,IACXga,EAAOtmB,EAAI4lB,EAAMtZ,KAEjBga,EAAO53B,EAAQk3B,GACf5lB,EAAI4lB,EAAMtZ,IAAMga,GAElBA,EAAKC,OAAOjB,GACLgB,I,sCAGOrb,GACd,OAAO,IAAI0a,EAAa1a,K,wCAGRkF,GAChB,OAAO,IAAIwV,EAAaxV,K,iEArDxB,OAAO5oB,KAAK2sB,W,8BAIZ,OAAO3sB,KAAK4sB,W,sCAIZ,OAAO5sB,KAAKm5B,sB,oBA3B8B8F,G,klCCDzBC,G,kpBAEnB,WAAYb,GAAO,a,4FAAA,UACjB,cAAMA,IACDC,OAASD,EACd,EAAKE,MAAQ,IAAIY,YACjB,EAAKC,QAAQ,EAAKb,OAJD,E,4CAOZR,GACL,0CAAaA,QACQtpB,IAAlBzU,KAAKs+B,OAAO/2B,IACbvH,KAAKu+B,MAAMh3B,EAAIvH,KAAKs+B,OAAO/2B,QAERkN,IAAlBzU,KAAKs+B,OAAO92B,IACbxH,KAAKu+B,MAAM/2B,EAAIxH,KAAKs+B,OAAO92B,QAEJiN,IAAtBzU,KAAKs+B,OAAO71B,QACbzI,KAAKu+B,MAAM7U,SAAW1pB,KAAKs+B,OAAO71B,OAASC,KAAKsb,GAAK,Q,gCAKvD,4CACGhkB,KAAK++B,KAAKM,QACXr/B,KAAK++B,KAAKM,OAAOC,YAAYt/B,KAAK++B,Q,8BAI9BQ,S,oBA7BoCnB,G,8lCCEzBoB,G,spBAEnB,WAAYnB,GAAO,a,4FAAA,UACjB,cAAMA,IACDoB,SAAW,IAAIN,YACpB,EAAKO,WAAW,EAAKD,UAHJ,E,4CA8BZ1B,GACL,4CAAaA,GACb/9B,KAAK++B,KAAKrV,SAAW,EACrB1pB,KAAK2/B,KAAKjW,SAAW1pB,KAAKq+B,MAAM51B,OAASC,KAAKsb,GAAG,KACjDhkB,KAAK4qB,IAAIlB,UAAY1pB,KAAKq+B,MAAM51B,MAAQzI,KAAKq+B,MAAMpS,WAAavjB,KAAKsb,GAAG,KACxEhkB,KAAKwqB,MAAMd,UAAY1pB,KAAKq+B,MAAM51B,MAAQzI,KAAKq+B,MAAMpP,aAAevmB,KAAKsb,GAAG,KAC5EhkB,KAAK4/B,UAAU12B,MAAM3B,EAAIvH,KAAKq+B,MAAMjU,OAASpqB,KAAKq+B,MAAM1S,UACxD3rB,KAAK6/B,MAAMC,KAAO9/B,KAAKq+B,MAAMjT,SAE7BprB,KAAK+/B,QAAQx4B,EAAIvH,KAAK++B,KAAKx3B,EAC3BvH,KAAK+/B,QAAQv4B,EAAIxH,KAAK++B,KAAKv3B,EAE3B,IAAI,IAAI1H,EAAE,EAAGA,EAAIi+B,EAAOh7B,OAAQjD,IAC9BE,KAAKggC,SAASjC,EAAOj+B,M,+BAIhB0tB,GACP,OAAQA,EAAMvrB,MACZ,IAAK,QACHjC,KAAKigC,SAASzS,GACd,MACF,IAAK,UACHxtB,KAAKkgC,WAAW1S,M,+BAKbA,M,iCAKEA,GACTxtB,KAAKmgC,Y,8BAGCZ,GACN,6CAAcA,GACdv/B,KAAKogC,MAAQpgC,KAAKqgC,cAClBrgC,KAAKsgC,KAAOtgC,KAAKugC,aACjBvgC,KAAKwgC,OAASxgC,KAAKygC,eACnBlB,EAAUmB,SAAS1gC,KAAKogC,OACxBb,EAAUmB,SAAS1gC,KAAKsgC,MACxBf,EAAUmB,SAAS1gC,KAAKwgC,U,iCAGfjB,GACTv/B,KAAK2gC,OAAS3gC,KAAK4gC,eACnB5gC,KAAK6gC,WAAa7gC,KAAK8gC,mBACvBvB,EAAUmB,SAAS1gC,KAAK+gC,wBACxBxB,EAAUmB,SAAS1gC,KAAK6gC,YACxBtB,EAAUmB,SAAS1gC,KAAK2gC,U,oCAIxB,OAAO,IAAIK,W,mCAIX,OAAO,IAAIA,W,qCAIX,OAAO,IAAIA,W,6CAIX,OAAO,IAAIA,W,yCAIX,OAAO,IAAIA,W,qCAIX,OAAO,IAAIC,S,gCAGX,8CACGjhC,KAAK+/B,QAAQV,QACdr/B,KAAK+/B,QAAQV,OAAOC,YAAYt/B,KAAK+/B,W,2BAxGvC,OAAO//B,KAAKogC,Q,8BAIZ,OAAOpgC,KAAKy/B,W,0BAIZ,OAAOz/B,KAAKsgC,O,4BAIZ,OAAOtgC,KAAKwgC,S,4BAIZ,OAAOxgC,KAAK2gC,S,gCAIZ,OAAO3gC,KAAK6gC,gB,qBA7BkC3B,I,2KCN7BgC,G,uLAGjBlhC,KAAKmhC,WAAa,EAClBnhC,KAAKohC,SAAW,I,6BAGXpD,EAAWC,GAChBj+B,KAAKmhC,WAAanD,EAClBh+B,KAAKohC,SAAWnD,I,gCAIhB,OAAOj+B,KAAKmhC,a,8BAIZ,OAAOnhC,KAAKohC,W,2BAIZ,IAAIC,EAAU34B,KAAKoD,IAAI,EAAG9L,KAAKohC,SAAWphC,KAAKmhC,YAC3C1tB,EAAI/K,KAAKkI,MAAMywB,EAAQ,KACvBC,EAAKD,EAAU,IAEnB,IADA5tB,EAAIA,EAAEhQ,WACAgQ,EAAE1Q,OAAS,GAAG0Q,EAAI,IAAMA,EAE9B,IADA6tB,EAAKA,EAAG79B,WACF69B,EAAGv+B,OAAS,GAAGu+B,EAAK,IAAMA,EAEhC,MAAO,KAAO7tB,EAAI,IAAM6tB,O,qnCCjBPC,G,spBAEnB,WAAYthC,EAAMo4B,GAAO,a,4FAAA,UACvB,cAAMA,IACDrS,MAAQ/lB,EACb,EAAKuhC,aAAc,EACnBhe,6CAA4C,EAE5C,EAAKie,iBAAmB,IAAItC,YAC5B,EAAKuC,eAAiB,IAAIvC,YAC1B,EAAKwC,iBAAmB,IAAIxC,YAC5B,EAAKyC,cAAgB,IAAIzC,YACzB,EAAKsC,iBAAiBf,SAAS,EAAKgB,gBACpC,EAAKD,iBAAiBf,SAAS,EAAKiB,kBACpC,EAAKF,iBAAiBf,SAAS,EAAKkB,eACpC,EAAK7I,UAAY,KACjB,EAAK8I,OAAS,KACd,EAAKC,YAAc,IAAIZ,GACvB,EAAKa,WAAa,KAClB,EAAKC,iBAAmB,KACrBC,OAAOC,kBAAoB,EAC5B,EAAKC,eAAiB,EAEtB,EAAKA,eAAiB,EAExB,EAAK9H,IAAI,wBAvBc,E,oDAsCVtM,GACb/tB,KAAKq6B,IAAI,gCACT,oDAAqBtM,GACrB/tB,KAAKyhC,iBAAiBl6B,GAAKvH,KAAK0+B,QAChC1+B,KAAKyhC,iBAAiBj6B,GAAKxH,KAAK2+B,QAChC3+B,KAAKq6B,IAAL,gCAAkCr6B,KAAKyhC,iBAAiBl6B,EAAxD,eAAgEvH,KAAKyhC,iBAAiBj6B,IAEtF,IAAI46B,EAAmB,CACrBrD,KAAM/+B,KAAKqiC,QACXC,WAAW,EACXC,gBAAiB,SACjBC,WAAYxiC,KAAKmiC,eACjB1wB,MAAOsc,EAAYtc,MAAQ,EAAIsc,EAAYlB,OAC3CN,OAAQwB,EAAYxB,OAAS,EAAIwB,EAAYlB,QAG/C7sB,KAAKq6B,IAAL,mCAAqC+H,EAAiB3wB,MAAtD,oBAAuE2wB,EAAiB3wB,QAExFzR,KAAK+4B,UAAY,IAAI0J,qBACnBL,GAEFpiC,KAAK6hC,OAAS,IAAI1C,YAElBn/B,KAAKgiC,iBAAmBhiC,KAAK0iC,uBAAuB3U,GACpD/tB,KAAK+hC,WAAa/hC,KAAK2iC,iBAAiB3iC,KAAK8hC,aAE7C9hC,KAAK6hC,OAAOnB,SAAS1gC,KAAKgiC,iBAAiBjD,MAC3C/+B,KAAK6hC,OAAOnB,SAAS1gC,KAAKyhC,kBAC1BzhC,KAAK6hC,OAAOnB,SAAS1gC,KAAK+hC,WAAWhD,MAErC/+B,KAAK+4B,UAAU6J,OAAO5iC,KAAK6hC,QAC3B7hC,KAAKq6B,IAAL,6B,2BAGGwI,GACH7iC,KAAKqiC,QAAUQ,I,iCAGN7G,EAAM8G,GAAW,WAG1B,GAFA9iC,KAAKq6B,IAAL,sCAAwCyI,EAAxC,MACAA,EAAYA,GAAa,IACrB9iC,KAAKgmB,MAGP,OAFAhmB,KAAKq6B,IAAI,mDACT2B,IAGF,IAAI+G,EAAS,IAAIC,SACbC,EAAkB,GACtB,IAAI,IAAIC,KAAOH,EAAOI,UACpBnjC,KAAKq6B,IAAL,mCAAqC6I,EAArC,MACAD,EAAgB54B,KAAK64B,GAGvBljC,KAAKojC,oBAAoBpjC,KAAKgmB,MAAOhmB,KAAKmiC,gBACvCkB,QAAO,SAACC,GACP,OAAwC,GAAjCL,EAAgBllB,QAAQulB,MAEhCC,SAAQ,SAACD,GACRP,EAAOpiC,IAAImiC,EAAYQ,MAE3BtjC,KAAKq6B,IAAL,qBACA0I,EAAOS,MAAK,SAACC,EAAWN,GACtB,GAAG,EAAK3B,YAIN,OAHA,EAAKnH,IAAL,6CACAqJ,iCACA,EAAKrJ,IAAL,sDAGF,EAAKA,IAAL,oBACA,EAAKsJ,iBACL,EAAKtJ,IAAL,iBACA2B,S,4EAUFh8B,KAAKgiC,iBAAiBhD,W,iCAGbtb,EAAMqa,GACf,gDAAiBra,EAAMqa,GACvB,IAAIgB,EAAO/+B,KAAK4jC,YAAYlgB,EAAKqB,KAC7Bga,EAAKM,QAAUN,EAAK5G,UACtBn4B,KAAK0hC,eAAehB,SAAS3B,EAAKA,MAClC/+B,KAAK4hC,cAAclB,SAAS3B,EAAKgB,Y,mCAIxBnX,EAAQmV,GACnB,kDAAmBnV,EAAQmV,GAC3B,IAAIgB,EAAO/+B,KAAK6jC,cAAcjb,EAAO7D,KACjCga,EAAKM,QAAUN,EAAK5G,SACtBn4B,KAAK2hC,iBAAiBjB,SAAS3B,EAAKA,Q,kCAI5Bf,EAAWC,GACrBj+B,KAAK8hC,YAAY9C,OAAOhB,EAAWC,GACnCj+B,KAAK+hC,WAAW/C,W,mCAIhB,iDACAh/B,KAAK+4B,UAAU6J,OAAO5iC,KAAK6hC,U,0CAGTiC,EAAcC,GAChC,IAAIvB,EAA+B,GAAjBuB,EAAsB,YAAc,MACtD,MAAO,CAAC,oBAAD,OACeD,EADf,YAC+BtB,EAD/B,qB,sCAKO9e,GACd,OAAO,IAAI8b,GAAqB9b,K,wCAGhBkF,GAChB,OAAO,IAAIsW,GAAiBtW,K,6CAGPmF,GACrB,OAAO,IAAImR,GAAiBnR,K,uCAGbiW,GACf,OAAO,IAAI9E,GAAiB8E,K,gCAI5BhkC,KAAKq6B,IAAL,gBACAr6B,KAAKwhC,aAAc,EAChBxhC,KAAK+4B,WACN/4B,KAAK+4B,UAAUkL,QAAQC,GAAGC,aAAa,sBAAsBC,cAC7DpkC,KAAK+4B,UAAUoH,UACfngC,KAAK+4B,UAAY,MAEjB/4B,KAAKq6B,IAAL,oBAEFr6B,KAAKqiC,QAAU,KACfriC,KAAK6hC,OAAS,KAEd7hC,KAAKq6B,IAAL,0BACAqJ,8B,4BA/JA,OAAO1jC,KAAK6hC,S,sCAIZ,OAAO7hC,KAAKgiC,mB,sCAIZ,OAAOhiC,KAAKyhC,sB,qBArCkChD,G,m5BCR7B4F,G,0vBAEX9E,GACN,IAAI+E,EAAa,IAAIC,WACrBD,EAAWE,UAAU,GACrBF,EAAWG,UAAU,EAAG,SAAU,IAClCH,EAAWI,SAAS,EAAG,EAAG1kC,KAAKq+B,MAAM5sB,MAAM,EAAEzR,KAAKq+B,MAAMxR,OAAQ7sB,KAAKq+B,MAAM9R,OAAO,EAAEvsB,KAAKq+B,MAAMxR,QAC/FyX,EAAWK,UACXpF,EAAUmB,SAAS4D,IACnBA,EAAa,IAAIC,YACNC,UAAU,GACrBF,EAAWG,UAAU,EAAG,SAAU,IAClCH,EAAWI,SAAS1kC,KAAKq+B,MAAMxR,OAAQ7sB,KAAKq+B,MAAMxR,OAAQ7sB,KAAKq+B,MAAM5sB,MAAOzR,KAAKq+B,MAAM9R,QACvF+X,EAAWK,UACXpF,EAAUmB,SAAS4D,K,6BAGdvG,S,qBAjByCmB,I,ozBCI7B0F,G,spBAEnB,WAAYvG,GAAO,O,4FAAA,qBACXA,G,6CAGAkB,GACN,IAAIsF,EAAa,IAAIC,YAAU,CAC3BC,WAAY,QACZC,SAAU,GACVC,KAAM,YAGVjlC,KAAK2gC,OAAS,IAAIM,OAAK,QAAS4D,GAChC7kC,KAAK2gC,OAAOp5B,EAAI,EAChBvH,KAAK2gC,OAAOn5B,EAAI,EAChB+3B,EAAUmB,SAAS1gC,KAAK2gC,U,6BAGnB5C,GACL/9B,KAAK2gC,OAAOb,KAAO9/B,KAAKq+B,MAAMyB,U,qBApBUZ,I,8lCCJvBgG,G,spBAEnB,WAAY7G,GAAO,O,4FAAA,qBACXA,G,4CAGDN,GACL,4CAAaA,GACb/9B,KAAK++B,KAAK71B,MAAM3B,EAAIvH,KAAK++B,KAAK71B,MAAM1B,EAAuB,GAAnBxH,KAAKq+B,MAAMtS,MAAc,GAC9D/rB,KAAKq+B,MAAM/N,UACZtwB,KAAKmgC,e,qBAVyCjB,I,ozBCA/BiG,G,spBAEnB,WAAY9G,GAAO,O,4FAAA,qBACXA,G,6CAGAkB,GACN,IAAI3W,EAAS,IAAI2b,WACjB3b,EAAO4b,UAAU,MAAU,IAC3B5b,EAAOwc,WAAW,EAAG,EAAG,GACxBxc,EAAO+b,UACPpF,EAAUmB,SAAS9X,Q,qBAXsBsc,I,ozBCIxBG,G,spBAEnB,WAAYhH,GAAO,O,4FAAA,qBACXA,G,mDAIN,IAAIsB,EAAO,IAAI4E,WAKf,OAJA5E,EAAK8E,UAAU,EAAG,SAAU,IAC5B9E,EAAK6E,UAAU,MAAU,IACzB7E,EAAK+E,UAAU,IAAK,GAAI,GAAI,IAC5B/E,EAAKgF,UACEhF,I,mCAIP,IAAIA,EAAO,IAAI4E,WAMf,OALA5E,EAAK6E,UAAU,MAAU,IACzB7E,EAAK8E,UAAU,EAAG,SAAU,IAC5B9E,EAAKyF,WAAW,EAAG,EAAG,IACtBzF,EAAK+E,SAAS,GAAI,EAAG,GAAI,GACzB/E,EAAKgF,UACEhF,I,qCAIP,IAAIA,EAAO,IAAI4E,WACf5E,EAAK6E,UAAU,MAAU,IACzB7E,EAAK8E,UAAU,EAAG,SAAU,IAC5B9E,EAAK+E,UAAU,GAAI,GAAI,EAAG,IAC1B/E,EAAKgF,UACLhF,EAAK8E,YACL9E,EAAK6E,UAAU,SAAU,IACzB7E,EAAKjE,OAAO,GAAI,GAChB,IAEIjqB,EAFa,IAEQ/I,KAAK6nB,IAAgB7nB,KAAKsb,GAAG,IADrC,GAC2C,EAI5D,OAHA2b,EAAK2F,OAHY,KAGQ7zB,GACzBkuB,EAAK2F,OAJY,IAIO7zB,GACxBkuB,EAAK2F,OAAO,EAAG,GACR3F,I,qCAIP,IAAIkF,EAAa,IAAIC,YAAU,CAC3BC,WAAY,QACZC,SAAU,GACVC,KAAM,QAENpF,EAAQ,IAAIoB,OAAK,GAAI4D,GAIzB,OAHAhF,EAAM0F,OAAOC,IAAI,GAAK,IACtB3F,EAAMt4B,EAAI,EACVs4B,EAAMr4B,GAAK,GACJq4B,I,6CAIP,IAAI4F,EAAe,IAAIlB,WAKvB,OAJAkB,EAAYjB,UAAU,EAAU,GAChCiB,EAAYhB,UAAU,EAAG,SAAU,IACnCgB,EAAYf,UAAU,IAAK,EAAG,GAAI,GAClCe,EAAYj+B,GAAK,GACVi+B,I,yCAIP,IAAI7F,EAAa,IAAI2E,WAKrB,OAJA3E,EAAU4E,UAAU,MAAU,GAC9B5E,EAAU8E,SAAS,GAAI,EAAG,GAAI,GAC9B9E,EAAUr4B,GAAK,GACfq4B,EAAUp4B,GAAK,GACRo4B,O,qBAvEgCJ,I,8lCCGtBkG,G,spBAEnB,WAAYrN,GAAO,a,4FAAA,UACjB,mBAAM5jB,EAAW4jB,IACZsN,cAAgB,EACrB,EAAKC,UAAY,KACjB,EAAKC,YAAc,KAJF,E,oDAOJ9X,GACb,oDAAqBA,GAErB,IAAI8W,EAAa,IAAIC,YAAU,CAC7BC,WAAY,QACZC,SAAU,GACVC,KAAM,YAGRjlC,KAAK4lC,UAAY,IAAI3E,OAAK,MAAO4D,GACjC7kC,KAAK4lC,UAAUr+B,EAAI,IACnBvH,KAAK4lC,UAAUp+B,EAAI,EACnBxH,KAAK8lC,MAAMpF,SAAS1gC,KAAK4lC,WAEzB,IAAIxxB,EAAOpU,KACX4yB,aAAY,WACVxe,EAAKwxB,UAAU9F,KAAO,QAAU1rB,EAAKuxB,cACrCvxB,EAAKuxB,cAAgB,IACpB,KAEHd,EAAa,IAAIC,YAAU,CACzBC,WAAY,QACZC,SAAU,GACVC,KAAM,YAGRjlC,KAAK6lC,YAAc,IAAI5E,OAAK,SAAU4D,GACtC7kC,KAAK6lC,YAAYt+B,EAAIwmB,EAAYlB,OAAO,EACxC7sB,KAAK6lC,YAAYr+B,EAAIumB,EAAYlB,OAAO,EACxC7sB,KAAK6lC,YAAYE,MAAQ,GACzB/lC,KAAK8lC,MAAMpF,SAAS1gC,KAAK6lC,e,sCAGX3H,GACd,qDAAsBA,GACtB,IACIp+B,EADAkmC,EAAS,GAEb,IAAIlmC,EAAE,EAAGA,EAAIo+B,EAASn7B,OAAQjD,IAC5BkmC,EAAO37B,KAAK,CACVpK,KAAMi+B,EAASp+B,GAAGsrB,SAClBhB,OAAQ8T,EAASp+B,GAAGsqB,OACpB5Q,MAAO0kB,EAASp+B,GAAG4rB,QAGvBsa,EAAO5oB,MAAK,SAACxa,EAAEC,GACb,OAAID,EAAE4W,MAAQ3W,EAAE2W,MAAc,EAC1B5W,EAAE4W,MAAQ3W,EAAE2W,OAAe,EACxB,KAET,IAAI0J,EAAM,GACV,IAAIpjB,EAAE,EAAGA,EAAIkmC,EAAOjjC,OAAQjD,IAC1BojB,GAAO8iB,EAAOlmC,GAAG0Z,MAAMysB,QAAQ,GAAK,MAAQD,EAAOlmC,GAAGG,MAA4B,GAApB+lC,EAAOlmC,GAAGsqB,OAAc,OAAS,IAAO,KAExGpqB,KAAK6lC,YAAY/F,KAAO5c,I,mCAIxB,iDACAljB,KAAK2lC,kB,6CAGgB5X,GACrB,OAAO,IAAIsW,GAAqBtW,K,uCAGjBiW,GACf,OAAO,IAAIY,GAAeZ,K,wCAGVpb,GAChB,OAAO,IAAIuc,GAAgBvc,K,sCAGblF,GACd,OAAO,IAAI2hB,GAAc3hB,Q,qBAnFc6d,I,m5BCPtB2E,G,0vBAEX3G,GACN,IAAI+E,EAAatD,cAAY,eAC7BzB,EAAUmB,SAAS4D,K,6BAGdvG,S,qBAPsCmB,I,ozBCI1BiH,G,spBAEnB,WAAY9H,GAAO,O,4FAAA,qBACXA,G,6CAGAkB,GACN,IAAIsF,EAAa,IAAIC,YAAU,CAC3BC,WAAY,QACZC,SAAU,GACVC,KAAM,YAGVjlC,KAAK2gC,OAAS,IAAIM,OAAK,QAAS4D,GAChC7kC,KAAK2gC,OAAOp5B,EAAI,GAChBvH,KAAK2gC,OAAOn5B,EAAI,IAChB+3B,EAAUmB,SAAS1gC,KAAK2gC,U,6BAGnB5C,GACL/9B,KAAK2gC,OAAOb,KAAO9/B,KAAKq+B,MAAMyB,U,qBApBOZ,I,ozBCHpBkH,G,spBAEnB,WAAY/H,GAAO,O,4FAAA,qBACXA,G,6CAGAkB,GACN,IAAI3W,EAASoY,cAAY,UACzBpY,EAAO2c,OAAOC,IAAI,IAClBjG,EAAUmB,SAAS9X,Q,qBATmBsc,I,8lCCMrBmB,G,spBAEnB,WAAYhI,GAAO,O,4FAAA,qBACXA,G,4CAGDN,GACL,4CAAaA,GACb/9B,KAAKsmC,OAAOP,MAAQ/lC,KAAKq+B,MAAMtB,WAAa,EAAsB,GAAlB/8B,KAAKsmC,OAAOP,Q,oCAI5D,IAAIpG,EAAOqB,cAAY,aAEvB,OADArB,EAAK4F,OAAOC,IAAI,IACT7F,I,mCAIP,IAAI4G,EAAe,IAAIpH,YAEnBqH,EAAUxF,cAAY,YAS1B,OARAwF,EAAQjB,OAAOC,IAAI,GAAK,IACxBe,EAAa7F,SAAS8F,GAEtBxmC,KAAKsmC,OAAStF,cAAY,cAC1BhhC,KAAKsmC,OAAOf,OAAOC,KAAK,IAAK,IAC7BxlC,KAAKsmC,OAAOP,MAAQ,EACpBQ,EAAa7F,SAAS1gC,KAAKsmC,QAEpBC,I,qCAIP,IAAIE,EAAYzF,cAAY,cAE5B,OADAyF,EAAUlB,OAAOC,IAAI,IACdiB,I,qCAIP,IAAI5B,EAAa,IAAIC,YAAU,CAC3BC,WAAY,QACZC,SAAU,GACVC,KAAM,IAENpF,EAAQ,IAAIoB,OAAK,GAAI4D,GAIzB,OAHAhF,EAAM0F,OAAOC,IAAI,GAAK,IACtB3F,EAAMt4B,EAAI,EACVs4B,EAAMr4B,GAAK,GACJq4B,I,6CAIP,IAAI4F,EAAe,IAAIlB,WAIvB,OAHAkB,EAAYjB,UAAU,EAAU,GAChCiB,EAAYf,UAAU,IAAK,EAAG,GAAI,GAClCe,EAAYj+B,GAAK,GACVi+B,I,yCAIP,IAAI7F,EAAa,IAAI2E,WAKrB,OAJA3E,EAAU4E,UAAU,SAAU,GAC9B5E,EAAU8E,SAAS,GAAI,EAAG,GAAI,GAC9B9E,EAAUr4B,GAAK,GACfq4B,EAAUp4B,GAAK,GACRo4B,O,qBAjE6BJ,I,8lCCFnBkH,G,spBAEnB,WAAYrO,GAAO,a,4FAAA,UACjB,cAAM,KAAMA,IACPsO,aAAe,GACpB,EAAKC,eAAiB,GACtB,EAAKC,YAAc,EAJF,E,sDAQjB,IAAI,IAAI/mC,EAAE,EAAGA,GAAK,EAAGA,IACnBE,KAAK2mC,aAAat8B,KAAKy8B,eAAa,cAAgBhnC,IACpDE,KAAK4mC,eAAev8B,KAAKy8B,eAAa,gBAAkBhnC,M,qCAI7CiuB,GACb,oDAAqBA,K,iCAGZrK,EAAMqa,GACf,gDAAiBra,EAAMqa,GACL,GAAfra,EAAK0G,SACNpqB,KAAK6mC,YAAc,GACnB7mC,KAAK+mC,cAAcrjB,EAAKnc,EAAGmc,EAAKlc,EAAGxH,KAAK2mC,iB,mCAI/B/d,EAAQmV,GACnB,kDAAmBnV,EAAQmV,GACxBnV,EAAO0H,UACRtwB,KAAK+mC,cAAcne,EAAOrhB,EAAGqhB,EAAOphB,EAAGxH,KAAK4mC,kB,mCAK9C,iDACG5mC,KAAK6mC,YAAc,GACpB7mC,KAAK6mC,cACL7mC,KAAKgnC,gBAAgBz/B,EAAkB,GAAdmB,KAAKwL,SAAY,EAAElU,KAAK0+B,QACjD1+B,KAAKgnC,gBAAgBx/B,EAAkB,GAAdkB,KAAKwL,SAAY,EAAElU,KAAK2+B,UAEjD3+B,KAAKgnC,gBAAgBz/B,GAAKvH,KAAK0+B,QAC/B1+B,KAAKgnC,gBAAgBx/B,GAAKxH,KAAK2+B,W,6CAIZ5Q,GACrB,OAAO,IAAImY,GAAkBnY,K,uCAGdiW,GACf,OAAO,IAAImC,GAAYnC,K,wCAGPpb,GAChB,OAAO,IAAIwd,GAAaxd,K,sCAGVlF,GACd,OAAO,IAAI2iB,GAAW3iB,K,oCAGVnc,EAAGC,EAAGvF,GAClB,IAAIglC,EAAO,IAAIC,iBAAejlC,GAC9BglC,EAAK1B,OAAOC,IAAI,IAChBxlC,KAAKgnC,gBAAgBtG,SAASuG,GAC9BA,EAAK1/B,EAAIA,EACT0/B,EAAKz/B,EAAIA,EACTy/B,EAAKE,MAAO,EACZF,EAAKG,WAAa,WAChBpnC,KAAKm7B,OACLn7B,KAAKq/B,OAAOC,YAAYt/B,OAE1BinC,EAAKI,Y,qBA1E+B9F,I,8lCCFnB+F,G,spBAEnB,WAAYjJ,GAAO,a,4FAAA,UACjB,cAAMA,IACDkJ,UAAY,GACjB,EAAKC,UAAY,KAHA,E,+CAMThkB,GACRxjB,KAAKwnC,UAAYhkB,I,8BAGX+b,GACN,IAAI+E,EAAatD,cAAY,eAC7BzB,EAAUmB,SAAS4D,GAEnB,IAAImD,EAAa,IAAIlD,WACrBkD,EAAWjD,UAAU,IAAU,GAC/BiD,EAAW/L,OAAO,GAAI,IACtB+L,EAAWnC,OAAO,IAAQ,IAC1BmC,EAAWnC,OAAO,IAAQ,KAC1BmC,EAAWnC,OAAO,GAAI,KACtBmC,EAAWnC,OAAO,GAAI,KACtBmC,EAAWnC,OAAO,GAAI,KACtBmC,EAAWnC,OAAO,GAAI,IACtBmC,EAAW9C,UAEX3kC,KAAK0nC,iBAAmB,IAAIvI,YAC5Bn/B,KAAK0nC,iBAAiB51B,KAAO21B,EAC7BlI,EAAUmB,SAAS1gC,KAAK0nC,kBACxBnI,EAAUmB,SAAS+G,GAEnB,IAAIE,EAAW,IAAIpD,WACnBoD,EAASnD,UAAU,IAAU,IAC7BmD,EAASjM,OAAO,GAAI,IACpBiM,EAASrC,OAAO,IAAQ,IACxBqC,EAASrC,OAAO,IAAQ,KACxBqC,EAASrC,OAAO,GAAI,KACpBqC,EAASrC,OAAO,GAAI,KACpBqC,EAASrC,OAAO,GAAI,KACpBqC,EAASrC,OAAO,GAAI,IACpBqC,EAASrC,OAAO,GAAI,IACpBqC,EAASrC,OAAO,GAAI,KACpBqC,EAASrC,OAAO,GAAI,KACpBqC,EAASrC,OAAO,GAAI,KACpBqC,EAASrC,OAAO,IAAQ,KACxBqC,EAASrC,OAAO,IAAQ,IACxBqC,EAASrC,OAAO,GAAI,IACpBqC,EAAShD,UACT3kC,KAAK4nC,gBAAkB,IAAIzI,YAC3Bn/B,KAAK4nC,gBAAgB91B,KAAO61B,EAC5BpI,EAAUmB,SAAS1gC,KAAK4nC,iBACxBrI,EAAUmB,SAASiH,K,gCAGXpgC,EAAGC,GACX,IAAIqgC,EAAS7G,cAAY,UACzB6G,EAAOtC,OAAOC,IAAI,IAClBqC,EAAOtgC,EAAIA,EAAIvH,KAAKq+B,MAAMK,QAC1BmJ,EAAOrgC,EAAIA,EAAIxH,KAAKq+B,MAAMM,QAC1BkJ,EAAOC,UAAYC,uBACnBF,EAAO9B,MAAQ,GACf/lC,KAAK0nC,iBAAiBhH,SAASmH,K,+BAI/B,6CACA7nC,KAAK4nC,gBAAgBI,QAAWhoC,KAAKwnC,UAAUS,aAAe,EAC9DjoC,KAAK0nC,iBAAiBM,QAAUhoC,KAAKwnC,UAAUU,c,oCAGnC3gC,EAAGC,EAAGukB,GAClB,IAAIrC,EAAW,EACf,GAAGhhB,KAAKoE,IAAItF,EAAIxH,KAAKq+B,MAAMnR,MAAQ,GACjC1lB,EAAIxH,KAAKq+B,MAAMnR,KAAO,EAAmB,EAAdxkB,KAAKwL,cAC3B,GAAGxL,KAAKoE,IAAItF,EAAIxH,KAAKq+B,MAAMpR,MAAQ,GACxCzlB,EAAIxH,KAAKq+B,MAAMpR,KAAO,EAAmB,EAAdvkB,KAAKwL,cAC3B,GAAGxL,KAAKoE,IAAIvF,EAAIvH,KAAKq+B,MAAMrR,MAAQ,GACxCzlB,EAAIvH,KAAKq+B,MAAMrR,KAAO,EAAmB,EAAdtkB,KAAKwL,SAChCwV,EAAWhhB,KAAKsb,GAAG,MACd,MAAGtb,KAAKoE,IAAIvF,EAAIvH,KAAKq+B,MAAMtR,MAAQ,IAIxC,OAHAxlB,EAAIvH,KAAKq+B,MAAMtR,KAAO,EAAmB,EAAdrkB,KAAKwL,SAChCwV,EAAWhhB,KAAKsb,GAAG,EAKrB,IAAImkB,EAAOnH,cAAY,QACvBmH,EAAK5C,OAAOC,IAAI,IAChB2C,EAAK5gC,EAAIA,EAAIvH,KAAKq+B,MAAMK,QACxByJ,EAAK3gC,EAAIA,EAAIxH,KAAKq+B,MAAMM,QACxBwJ,EAAKze,SAAWA,EAChBye,EAAKj/B,MAAM3B,EAAI4gC,EAAKj/B,MAAM1B,EAAI,GAAM,GAAIukB,EACxC/rB,KAAK4nC,gBAAgBlH,SAASyH,GAC9BnoC,KAAKunC,UAAUl9B,KAAK89B,GAEpB,IADA,IAAIj3B,EAAQlR,KAAKwnC,UAAYxnC,KAAKwnC,UAAUS,aAAe,GACrDjoC,KAAKunC,UAAUxkC,OAASmO,IAC5Bi3B,EAAOnoC,KAAKunC,UAAU5yB,SACjB0qB,OAAOC,YAAY6I,Q,qBAlGoBjJ,I,ozBCA7BkJ,G,spBAEnB,WAAY/J,GAAO,O,4FAAA,qBACXA,G,6CAGAkB,GACN,IAAIsF,EAAa,IAAIC,YAAU,CAC3BC,WAAY,QACZC,SAAU,GACVC,KAAM,YAGVjlC,KAAK2gC,OAAS,IAAIM,OAAK,QAAS4D,GAChC7kC,KAAK2gC,OAAOp5B,EAAI,GAChBvH,KAAK2gC,OAAOn5B,EAAI,IAChB+3B,EAAUmB,SAAS1gC,KAAK2gC,U,6BAGnB5C,GACL/9B,KAAK2gC,OAAOb,KAAO9/B,KAAKq+B,MAAMyB,U,qBApBUZ,I,8lCCFvBmJ,G,spBAEnB,WAAYhK,EAAO7a,GAAU,O,4FAAA,qBACrB6a,G,+CAGE7a,GACRxjB,KAAKwnC,UAAYhkB,I,6BAGZua,GACL,4CAAaA,GACb/9B,KAAKsoC,MAAMN,QAAUhoC,KAAKwnC,WAAaxnC,KAAKwnC,UAAUe,W,8BAGhDhJ,GACN,IAAI3W,EAASoY,cAAY,UACzBpY,EAAO2c,OAAOC,IAAI,IAClB,IAAIgD,EAAOxH,cAAY,QACvBwH,EAAKjD,OAAOC,IAAI,IAChBgD,EAAKV,UAAYC,kBACjBS,EAAKzC,MAAQ,GACb/lC,KAAKsoC,MAAQE,EACbjJ,EAAUmB,SAAS8H,GACnBjJ,EAAUmB,SAAS9X,Q,qBAxBsBsc,I,8lCCKxBuD,G,spBAEnB,WAAYpK,GAAO,a,4FAAA,UACjB,cAAMA,IACDqK,YAAc,EAFF,E,4CAKZ3K,GACL,4CAAaA,GACb/9B,KAAKsmC,OAAOP,MAA2B,GAAlB/lC,KAAKsmC,OAAOP,MACjC/lC,KAAK2oC,SAASphC,EAAoB,GAAhBvH,KAAK2oC,SAASphC,EAChCvH,KAAKwqB,MAAMd,WAAc1pB,KAAKq+B,MAAMpS,SAAWjsB,KAAKs+B,OAAOrP,aAAevmB,KAAKsb,GAAG,KAElFhkB,KAAK0oC,YAAc1oC,KAAKq+B,MAAMuK,UAAY5oC,KAAK0oC,YAAY,EAAI,EAE/D1oC,KAAK6oC,OAAO9C,MAA6C,IAApCr9B,KAAKC,IAAuB,IAAnB3I,KAAK0oC,aAA4B,K,+BAGxDlb,GACP,8CAAeA,GACfxtB,KAAK2oC,SAASphC,GAAK,EAAE,EAAEimB,EAAM5E,OAAOmD,MACpC/rB,KAAKsmC,OAAOP,MAAQ,I,8BAGdxG,GACN,6CAAcA,GACdv/B,KAAK2oC,SAASjI,SAAS1gC,KAAKwqB,S,oCAI5B,IAAImV,EAAOqB,cAAY,aAAehhC,KAAKq+B,MAAMyK,MAEjD,OADAnJ,EAAK4F,OAAOC,IAAI,GAAK,IACd7F,I,mCAIP,IAAI4G,EAAe,IAAIpH,YAEnBqH,EAAUxF,cAAY,YAAchhC,KAAKq+B,MAAMyK,MAgBnD,OAfAtC,EAAQjB,OAAOC,IAAI,GAAK,IACxBe,EAAa7F,SAAS8F,GACtBxmC,KAAK2oC,SAAWnC,EAEhBxmC,KAAKsmC,OAAStF,cAAY,cAC1BhhC,KAAKsmC,OAAOf,OAAOC,IAAI,GAAK,IAC5BxlC,KAAKsmC,OAAOP,MAAQ,EAEpB/lC,KAAK6oC,OAAS7H,cAAY,cAC1BhhC,KAAK6oC,OAAOtD,OAAOC,IAAI,GAAK,IAC5BxlC,KAAK6oC,OAAO9C,MAAQ,EAEpBQ,EAAa7F,SAAS1gC,KAAKsmC,QAC3BC,EAAa7F,SAAS1gC,KAAK6oC,QAEpBtC,I,qCAIP,IAAIE,EAAYzF,cAAY,cAAgBhhC,KAAKq+B,MAAMyK,MAGvD,OAFArC,EAAUlB,OAAOC,IAAI,GAAK,IAC1BiB,EAAUl/B,GAAG,EACNk/B,I,qCAIP,IAAI5B,EAAa,IAAIC,YAAU,CAC3BC,WAAY,QACZC,SAAU,GACV+D,OAAQ,EACRC,gBAAiB,EACjB/D,KAAM,WAENpF,EAAQ,IAAIoB,OAAK,GAAI4D,GAIzB,OAHAhF,EAAM0F,OAAOC,IAAI,GAAK,IACtB3F,EAAMt4B,EAAI,EACVs4B,EAAMr4B,GAAK,GACJq4B,I,6CAIP,IAAI4F,EAAe,IAAIlB,WAIvB,OAHAkB,EAAYjB,UAAU,EAAU,GAChCiB,EAAYf,UAAU,IAAK,EAAG,GAAI,GAClCe,EAAYj+B,GAAK,GACVi+B,I,yCAIP,IAAI7F,EAAa,IAAI2E,WAKrB,OAJA3E,EAAU4E,UAAU,SAAU,GAC9B5E,EAAU8E,SAAS,GAAI,EAAG,GAAI,GAC9B9E,EAAUr4B,GAAK,GACfq4B,EAAUp4B,GAAK,GACRo4B,O,qBA7FgCJ,I,2KCRtByJ,G,WAEnB,WAAY5K,I,4FAAO,SACjBr+B,KAAKkpC,eAAiB,IACtBlpC,KAAKmpC,cAAgB,IACrBnpC,KAAKopC,WAAY,EACjBppC,KAAKqpC,WAAY,EACjBrpC,KAAKspC,cAAe,EACpBtpC,KAAKupC,YAAc,EACnBvpC,KAAKk1B,SAAW,EAChBl1B,KAAKs9B,QAAUt9B,KAAKk1B,S,wDAGpB,OAAOl1B,KAAKupC,c,oCAGZ,OAAOvpC,KAAKkpC,iB,mCAGZ,OAAOlpC,KAAKmpC,gB,+BAGZ,OAAOnpC,KAAKopC,Y,+BAGZ,OAAOppC,KAAKqpC,Y,kCAGZ,OAAOrpC,KAAKspC,e,8BAGZ,OAAOtpC,KAAKk1B,U,aAEFnkB,GACVA,EAAIrI,KAAKmD,IAAI,EAAGnD,KAAKoD,IAAI,EAAGiF,IAC5B/Q,KAAKk1B,SAAWnkB,EAChB/Q,KAAKkpC,eAAiBxgC,KAAK+f,MAAM,IAAK1X,EAAEA,GACxC/Q,KAAKmpC,cAAgBzgC,KAAK+f,MAAM,IAAI1X,GACpC/Q,KAAKopC,UAAar4B,EAAI,GACtB/Q,KAAKqpC,UAAat4B,EAAI,GACtB/Q,KAAKspC,aAAgBv4B,EAAI,GAEvB/Q,KAAKupC,YADJx4B,EAAI,GACc,EACXA,EAAI,GACO,EACXA,EAAI,GACO,EAEA,EAErB/Q,KAAKk1B,SAAWnkB,O,qnCCvCCy4B,G,spBAEnB,WAAYnR,GAAO,a,4FAAA,UACjB,cAAM,QAASA,IACVsO,aAAe,GACpB,EAAKE,YAAc,EACnB,EAAK4C,mBAAqB,KAC1B,EAAKC,cAAgB,GACrB,EAAKC,eAAiB,GACtB,EAAKnC,UAAY,IAAIyB,GACrB,EAAKxH,iBAAiBf,SAAS,EAAKiB,kBACpC,EAAKiI,YAAc,EACnB,EAAKjE,cAAgB,EACrB,EAAKkE,aAAe,KACpB,EAAKC,KAAO,GAZK,E,sDAgBjB,IAAIhqC,EACJ,IAAIA,EAAE,EAAGA,GAAK,GAAIA,IAChBE,KAAK2mC,aAAat8B,KAAKy8B,eAAa,cAAgBhnC,EAAI,GAAK,IAAMA,EAAIA,O,qCAY5DiuB,GACb,oDAAqBA,GACrB/tB,KAAK+pC,gBAAgBC,UAAUhqC,KAAKwnC,WACpCxnC,KAAKypC,mBAAqB,IAAIQ,oBAAkB,IAAM,CACpDC,UAAU,EACVxgB,UAAU,EACVqc,OAAO,IAET/lC,KAAKyhC,iBAAiBf,SAAS1gC,KAAKypC,oBACpCzpC,KAAKyhC,iBAAiBf,SAAS1gC,KAAK4hC,eAEpC,IAAIxtB,EAAOpU,KACXA,KAAK6pC,aAAejX,aAAY,WAC9Bxe,EAAK01B,KAAO11B,EAAKuxB,cACjBvxB,EAAKuxB,cAAgB,IACpB,O,iCAGMjiB,EAAMqa,GAGf,IAAIj+B,EACJ,IAAIA,KAHJ,gDAAiB4jB,EAAMqa,GAGdA,EACP,GAAqB,WAAlBA,EAAOj+B,GAAGmC,KAAmB,CAC9BjC,KAAK6mC,YAAc,GACnB7mC,KAAKmqC,kBAAkBzmB,GACvB,MAIJ,IAAI0mB,EAAsB1mB,EAAKyG,SAAW,EAAI,IAAM,EAChDkgB,GAAa3mB,EAAKjb,MAAM2hC,IAAsB1hC,KAAKsb,GAAG,KAC1D,GAAGN,EAAK8E,MAAQ,EAAG,CACjB,IAAI8hB,EAAW5mB,EAAKnc,EAAI,GAAGmB,KAAKC,IAAI0hC,EAAU3hC,KAAKsb,GAAG,GAAK,EAAEtb,KAAKC,IAAI0hC,GAClEE,EAAW7mB,EAAKlc,EAAI,GAAGkB,KAAKE,IAAIyhC,EAAU3hC,KAAKsb,GAAG,GAAK,EAAEtb,KAAKE,IAAIyhC,GAClEG,EAAW9mB,EAAKnc,EAAI,GAAGmB,KAAKC,IAAI0hC,EAAU3hC,KAAKsb,GAAG,GAAK,EAAEtb,KAAKC,IAAI0hC,GAClEI,EAAW/mB,EAAKlc,EAAI,GAAGkB,KAAKE,IAAIyhC,EAAU3hC,KAAKsb,GAAG,GAAK,EAAEtb,KAAKE,IAAIyhC,GAEnE3hC,KAAKwL,SAAWlU,KAAK0qC,kBACtB1qC,KAAK2qC,SACHL,EACAC,GAEFvqC,KAAK2qC,SACHH,EACAC,O,mCAMK7hB,EAAQmV,GACnB,kDAAmBnV,EAAQmV,GAChB/9B,KAAK6jC,cAAcjb,EAAO7D,IAChCilB,UAAUhqC,KAAKwnC,WACjB5e,EAAO0H,WACRtwB,KAAK4qC,oBAAoBhiB,GACzB5oB,KAAK+pC,gBAAgBc,cAAcjiB,EAAOrhB,EAAGqhB,EAAOphB,EAAGohB,EAAOmD,U,kCAMhE,IAAI+e,EADJ,gDAEA,IACIhrC,EADAirC,EAAgB,EAEpB,IAAIjrC,EAAIE,KAAK0pC,cAAc3mC,OAAO,EAAGjD,GAAK,EAAGA,KAC3CgrC,EAAW9qC,KAAK0pC,cAAc5pC,MAK9BgrC,EAASvjC,GAAKvH,KAAK0qC,gBAAkBI,EAAStiB,MAAQsiB,EAASphB,SAAWhhB,KAAKC,IAAImiC,EAASphB,UAC5FohB,EAAStjC,GAAKxH,KAAK0qC,gBAAkBI,EAAStiB,MAAQsiB,EAASphB,SAAWhhB,KAAKE,IAAIkiC,EAASphB,UAC5FohB,EAAS/E,MAAQr9B,KAAKoD,IAAI,EAAGg/B,EAAS/E,MAAQ/lC,KAAK0qC,gBAAkBI,EAASE,YAE9EF,EAASG,UAAYjrC,KAAK0qC,gBACvBI,EAASG,UAAY,GAAKF,EAAgB/qC,KAAKwnC,UAAU0D,eAC1DJ,EAASzL,OAAOC,YAAYwL,GAC5B9qC,KAAK0pC,cAAc5pC,GAAK,MAExBirC,KAGJ,IAAIjrC,EAAE,EAAGA,EAAIE,KAAK2pC,eAAe5mC,OAAQjD,IACnCE,KAAK2pC,eAAe7pC,KACxBE,KAAK2pC,eAAe7pC,GAAGimC,MAAS/lC,KAAK2pC,eAAe7pC,GAAGimC,MAAQ,IAAO/lC,KAAK0qC,gBACxE1qC,KAAK2pC,eAAe7pC,GAAGimC,MAAQ,MAChC/lC,KAAK2pC,eAAe7pC,GAAGu/B,OAAOC,YAAYt/B,KAAK2pC,eAAe7pC,IAC9DE,KAAK2pC,eAAe7pC,GAAK,S,mCAO7BE,KAAK4pC,cACL5pC,KAAK2lC,gBACF3lC,KAAK4pC,YAAc5pC,KAAKwnC,UAAU2D,YAAc,GACjD,iDAECnrC,KAAK6mC,YAAc,GACpB7mC,KAAK6mC,cACL7mC,KAAKgnC,gBAAgBz/B,EAAkB,GAAdmB,KAAKwL,SAAY,EAAElU,KAAK0+B,QACjD1+B,KAAKgnC,gBAAgBx/B,EAAkB,GAAdkB,KAAKwL,SAAY,EAAElU,KAAK2+B,QACjD3+B,KAAKgiC,iBAAiBjD,KAAKx3B,EAAkB,GAAdmB,KAAKwL,SAAY,EAChDlU,KAAKgiC,iBAAiBjD,KAAKv3B,EAAkB,GAAdkB,KAAKwL,SAAY,IAEhDlU,KAAKgnC,gBAAgBz/B,GAAKvH,KAAK0+B,QAC/B1+B,KAAKgnC,gBAAgBx/B,GAAKxH,KAAK2+B,QAC/B3+B,KAAKgiC,iBAAiBjD,KAAKx3B,EAAI,EAC/BvH,KAAKgiC,iBAAiBjD,KAAKv3B,EAAI,K,6BAK9BxH,KAAK6pC,cACNlX,cAAc3yB,KAAK6pC,gB,0CAIH/F,EAAcC,GAChC,OAAGA,GAAiB,EACX,CAAC,oBAAD,OACeD,EADf,yDAEeA,EAFf,+BAKA,CAAC,oBAAD,OACeA,EADf,yB,wCAOOpgB,GAChB1jB,KAAK+mC,cAAcrjB,EAAKnc,EAAGmc,EAAKlc,EAAGxH,KAAK2mC,cACxC3mC,KAAK+pC,gBAAgBqB,UAAU1nB,EAAKnc,EAAGmc,EAAKlc,GAC5CxH,KAAKqrC,WACH3nB,EAAKnc,EACLmc,EAAKlc,EACL,O,0CAIgBohB,GAClB5oB,KAAKsrC,SAAS1iB,EAAOrhB,EAAGqhB,EAAOphB,EAAG,GAAM,GAAIohB,EAAOmD,OACnD,IAAIwf,EAAS,EAAI,GAAK3iB,EAAOmD,MAC7B/rB,KAAKqrC,WACHziB,EAAOrhB,EACPqhB,EAAOphB,EACP+jC,K,6CAImBxd,GACrB,OAAO,IAAIuZ,GAAqBvZ,K,uCAGjBiW,GACf,OAAO,IAAIoE,GAAepE,K,wCAGVpb,GAChB,OAAO,IAAIyf,GAAgBzf,K,sCAGblF,GACd,OAAO,IAAI+kB,GAAc/kB,K,oCAGbnc,EAAGC,EAAGvF,GAClBjC,KAAKsrC,SAAS/jC,EAAGC,EAAG,GAEpB,IAAIy/B,EAAO,IAAIC,iBAAejlC,GAC9BglC,EAAKuE,eAAiBxrC,KAAK0qC,gBAC3BzD,EAAK1B,OAAOC,IAAI,IAChBxlC,KAAKgnC,gBAAgBtG,SAASuG,GAC9BA,EAAK1/B,EAAIA,EACT0/B,EAAKz/B,EAAIA,EACTy/B,EAAKE,MAAO,EACZF,EAAKa,UAAYC,kBACjBd,EAAKG,WAAa,WAChBpnC,KAAKm7B,OACLn7B,KAAKq/B,OAAOC,YAAYt/B,OAE1BinC,EAAKI,S,+BAGE9/B,EAAGC,EAAG0B,GACb,GAAIlJ,KAAKwnC,UAAUe,SAAnB,CACA,IAAIC,EAAOxH,cAAY,QACvBwH,EAAKjD,OAAOC,IAAI,IAChBgD,EAAKt/B,MAAM3B,EAAIihC,EAAKt/B,MAAM1B,EAAI0B,EAC9Bs/B,EAAKzC,MAAQ,GACbyC,EAAKV,UAAYC,kBACjBS,EAAKjhC,EAAIA,EACTihC,EAAKhhC,EAAIA,EACTxH,KAAKgnC,gBAAgBtG,SAAS8H,GAC9BxoC,KAAK2pC,eAAet/B,KAAKm+B,M,iCAGhBjhC,EAAGC,EAAGikC,GACfA,EAAS/iC,KAAK2sB,KAAKoW,EAAOzrC,KAAKwnC,UAAUlK,SACzC,IAAI,IAAIx9B,EAAE,EAAGA,EAAI2rC,EAAQ3rC,IAAK,CAC5B,IAAIgrC,EAAW9J,cAAY,SAC3B8J,EAASvjC,EAAIA,EACbujC,EAAStjC,EAAIA,EACbsjC,EAASE,WAAa,EACtBF,EAASvF,OAAOC,IAAI,IACpBsF,EAAStiB,MAAQ,EAAgB,EAAd9f,KAAKwL,SACxB42B,EAASphB,SAAyB,EAAdhhB,KAAKwL,SAAWxL,KAAKsb,GACzC8mB,EAASG,SAAW,EAAgB,EAAdviC,KAAKwL,SAC3BlU,KAAKypC,mBAAmB/I,SAASoK,GACjC9qC,KAAK0pC,cAAcr/B,KAAKygC,M,+BAInBvjC,EAAGC,GACV,GAAIxH,KAAKwnC,UAAUkE,SACnB,IAAI,IAAI5rC,EAAE,EAAGA,EAAI,EAAGA,IAAK,CACvB,IAAIya,EAAQ7R,KAAKkI,MAAoB,EAAdlI,KAAKwL,UACxB42B,EAAW9J,cAAY,QAAUzmB,GACrCuwB,EAASvjC,EAAIA,EAAgB,EAAdmB,KAAKwL,SAAW,EAC/B42B,EAAStjC,EAAIA,EAAgB,EAAdkB,KAAKwL,SAAW,EAC/B42B,EAASvF,OAAOC,IAAI,IACpBsF,EAAStiB,MAAQ,EACjBsiB,EAASE,WAAa,IAAqB,IAAdtiC,KAAKwL,SAClC42B,EAASphB,SAAW,EACpBohB,EAAS/E,MAAQ,GAAI,GAAIr9B,KAAKwL,SAC9B42B,EAASG,SAAW,GACpBH,EAAS5hC,MAAM3B,EAAIujC,EAAS5hC,MAAM1B,EAAI,GAAM,EAAEkB,KAAKwL,SACnDlU,KAAKypC,mBAAmB/I,SAASoK,GACjC9qC,KAAK0pC,cAAcr/B,KAAKygC,M,8BAhP1B,OAAO9qC,KAAKwnC,UAAUlK,S,aAGZvsB,GACV/Q,KAAKwnC,UAAUlK,QAAUvsB,O,qBA7BcwwB,I,m5BCTtBoK,G,6vBAERjoB,EAAMqa,M,mCAIJnV,EAAQmV,M,iCAIV/B,GACTA,M,wDAXsCiD,GC+B1C,SA1BoB,CAClB2M,iBAAkB,SAACxT,EAAUC,GAG3B,OAFAD,EAAWA,GAAsB,IAAI6G,EAAS5G,GACpC,IAAIwT,EAAWzT,EAAUC,IAIrCyT,mBAAoB,WAClB,OAAO,IAAI9V,GAGb+V,UAAW,WACT,OAAO,IAAIzU,GAGb0U,eAAgB,SAAC/rC,EAAMo4B,GACrB,OAAOp4B,GACL,IAAK,QAAW,OAAO,IAAIylC,GAAcrN,GACzC,IAAK,KAAW,OAAO,IAAIqO,GAAWrO,GACtC,IAAK,QAAW,OAAO,IAAImR,GAAcnR,GACzC,IAAK,OAAW,OAAO,IAAIsT,GAAatT,GACxC,QAAgB,KAAM,mBAAqBp4B,MC1BjD,SAAUmU,GACJA,EAIJA,EAAK63B,SAAWC,GAHd5Z,QAAQa,KAAK,uBAFjB,CAMG8O,S","file":"jsbattle.min.js","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CodeGen = exports.Name = exports.nil = exports.stringify = exports.str = exports._ = exports.KeywordCxt = void 0;\nconst context_1 = require(\"./compile/context\");\nexports.KeywordCxt = context_1.default;\nvar codegen_1 = require(\"./compile/codegen\");\nObject.defineProperty(exports, \"_\", { enumerable: true, get: function () { return codegen_1._; } });\nObject.defineProperty(exports, \"str\", { enumerable: true, get: function () { return codegen_1.str; } });\nObject.defineProperty(exports, \"stringify\", { enumerable: true, get: function () { return codegen_1.stringify; } });\nObject.defineProperty(exports, \"nil\", { enumerable: true, get: function () { return codegen_1.nil; } });\nObject.defineProperty(exports, \"Name\", { enumerable: true, get: function () { return codegen_1.Name; } });\nObject.defineProperty(exports, \"CodeGen\", { enumerable: true, get: function () { return codegen_1.CodeGen; } });\nconst core_1 = require(\"./core\");\nconst draft7_1 = require(\"./vocabularies/draft7\");\nconst draft7MetaSchema = require(\"./refs/json-schema-draft-07.json\");\nconst META_SUPPORT_DATA = [\"/properties\"];\nconst META_SCHEMA_ID = \"http://json-schema.org/draft-07/schema\";\nclass Ajv extends core_1.default {\n    _addVocabularies() {\n        super._addVocabularies();\n        draft7_1.default.forEach((v) => this.addVocabulary(v));\n    }\n    _addDefaultMetaSchema() {\n        super._addDefaultMetaSchema();\n        const { $data, meta } = this.opts;\n        if (!meta)\n            return;\n        const metaSchema = $data\n            ? this.$dataMetaSchema(draft7MetaSchema, META_SUPPORT_DATA)\n            : draft7MetaSchema;\n        this.addMetaSchema(metaSchema, META_SCHEMA_ID, false);\n        this.refs[\"http://json-schema.org/schema\"] = META_SCHEMA_ID;\n    }\n    defaultMeta() {\n        return (this.opts.defaultMeta =\n            super.defaultMeta() || (this.getSchema(META_SCHEMA_ID) ? META_SCHEMA_ID : undefined));\n    }\n}\nexports.default = Ajv;\n//# sourceMappingURL=ajv.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getProperty = exports.safeStringify = exports.stringify = exports.strConcat = exports.addCodeArg = exports.str = exports._ = exports.nil = exports._Code = exports.Name = exports.IDENTIFIER = exports._CodeOrName = void 0;\nclass _CodeOrName {\n}\nexports._CodeOrName = _CodeOrName;\nexports.IDENTIFIER = /^[a-z$_][a-z$_0-9]*$/i;\nclass Name extends _CodeOrName {\n    constructor(s) {\n        super();\n        if (!exports.IDENTIFIER.test(s))\n            throw new Error(\"CodeGen: name must be a valid identifier\");\n        this.str = s;\n    }\n    toString() {\n        return this.str;\n    }\n    emptyStr() {\n        return false;\n    }\n    get names() {\n        return { [this.str]: 1 };\n    }\n}\nexports.Name = Name;\nclass _Code extends _CodeOrName {\n    constructor(code) {\n        super();\n        this._items = typeof code === \"string\" ? [code] : code;\n    }\n    toString() {\n        return this.str;\n    }\n    emptyStr() {\n        if (this._items.length > 1)\n            return false;\n        const item = this._items[0];\n        return item === \"\" || item === '\"\"';\n    }\n    get str() {\n        var _a;\n        return ((_a = this._str) !== null && _a !== void 0 ? _a : (this._str = this._items.reduce((s, c) => `${s}${c}`, \"\")));\n    }\n    get names() {\n        var _a;\n        return ((_a = this._names) !== null && _a !== void 0 ? _a : (this._names = this._items.reduce((names, c) => {\n            if (c instanceof Name)\n                names[c.str] = (names[c.str] || 0) + 1;\n            return names;\n        }, {})));\n    }\n}\nexports._Code = _Code;\nexports.nil = new _Code(\"\");\nfunction _(strs, ...args) {\n    const code = [strs[0]];\n    let i = 0;\n    while (i < args.length) {\n        addCodeArg(code, args[i]);\n        code.push(strs[++i]);\n    }\n    return new _Code(code);\n}\nexports._ = _;\nconst plus = new _Code(\"+\");\nfunction str(strs, ...args) {\n    const expr = [safeStringify(strs[0])];\n    let i = 0;\n    while (i < args.length) {\n        expr.push(plus);\n        addCodeArg(expr, args[i]);\n        expr.push(plus, safeStringify(strs[++i]));\n    }\n    optimize(expr);\n    return new _Code(expr);\n}\nexports.str = str;\nfunction addCodeArg(code, arg) {\n    if (arg instanceof _Code)\n        code.push(...arg._items);\n    else if (arg instanceof Name)\n        code.push(arg);\n    else\n        code.push(interpolate(arg));\n}\nexports.addCodeArg = addCodeArg;\nfunction optimize(expr) {\n    let i = 1;\n    while (i < expr.length - 1) {\n        if (expr[i] === plus) {\n            const res = mergeExprItems(expr[i - 1], expr[i + 1]);\n            if (res !== undefined) {\n                expr.splice(i - 1, 3, res);\n                continue;\n            }\n            expr[i++] = \"+\";\n        }\n        i++;\n    }\n}\nfunction mergeExprItems(a, b) {\n    if (b === '\"\"')\n        return a;\n    if (a === '\"\"')\n        return b;\n    if (typeof a == \"string\") {\n        if (b instanceof Name || a[a.length - 1] !== '\"')\n            return;\n        if (typeof b != \"string\")\n            return `${a.slice(0, -1)}${b}\"`;\n        if (b[0] === '\"')\n            return a.slice(0, -1) + b.slice(1);\n        return;\n    }\n    if (typeof b == \"string\" && b[0] === '\"' && !(a instanceof Name))\n        return `\"${a}${b.slice(1)}`;\n    return;\n}\nfunction strConcat(c1, c2) {\n    return c2.emptyStr() ? c1 : c1.emptyStr() ? c2 : str `${c1}${c2}`;\n}\nexports.strConcat = strConcat;\n// TODO do not allow arrays here\nfunction interpolate(x) {\n    return typeof x == \"number\" || typeof x == \"boolean\" || x === null\n        ? x\n        : safeStringify(Array.isArray(x) ? x.join(\",\") : x);\n}\nfunction stringify(x) {\n    return new _Code(safeStringify(x));\n}\nexports.stringify = stringify;\nfunction safeStringify(x) {\n    return JSON.stringify(x)\n        .replace(/\\u2028/g, \"\\\\u2028\")\n        .replace(/\\u2029/g, \"\\\\u2029\");\n}\nexports.safeStringify = safeStringify;\nfunction getProperty(key) {\n    return typeof key == \"string\" && exports.IDENTIFIER.test(key) ? new _Code(`.${key}`) : _ `[${key}]`;\n}\nexports.getProperty = getProperty;\n//# sourceMappingURL=code.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.or = exports.and = exports.not = exports.CodeGen = exports.operators = exports.varKinds = exports.ValueScopeName = exports.ValueScope = exports.Scope = exports.Name = exports.stringify = exports.getProperty = exports.nil = exports.strConcat = exports.str = exports._ = void 0;\nconst code_1 = require(\"./code\");\nconst scope_1 = require(\"./scope\");\nvar code_2 = require(\"./code\");\nObject.defineProperty(exports, \"_\", { enumerable: true, get: function () { return code_2._; } });\nObject.defineProperty(exports, \"str\", { enumerable: true, get: function () { return code_2.str; } });\nObject.defineProperty(exports, \"strConcat\", { enumerable: true, get: function () { return code_2.strConcat; } });\nObject.defineProperty(exports, \"nil\", { enumerable: true, get: function () { return code_2.nil; } });\nObject.defineProperty(exports, \"getProperty\", { enumerable: true, get: function () { return code_2.getProperty; } });\nObject.defineProperty(exports, \"stringify\", { enumerable: true, get: function () { return code_2.stringify; } });\nObject.defineProperty(exports, \"Name\", { enumerable: true, get: function () { return code_2.Name; } });\nvar scope_2 = require(\"./scope\");\nObject.defineProperty(exports, \"Scope\", { enumerable: true, get: function () { return scope_2.Scope; } });\nObject.defineProperty(exports, \"ValueScope\", { enumerable: true, get: function () { return scope_2.ValueScope; } });\nObject.defineProperty(exports, \"ValueScopeName\", { enumerable: true, get: function () { return scope_2.ValueScopeName; } });\nObject.defineProperty(exports, \"varKinds\", { enumerable: true, get: function () { return scope_2.varKinds; } });\nexports.operators = {\n    GT: new code_1._Code(\">\"),\n    GTE: new code_1._Code(\">=\"),\n    LT: new code_1._Code(\"<\"),\n    LTE: new code_1._Code(\"<=\"),\n    EQ: new code_1._Code(\"===\"),\n    NEQ: new code_1._Code(\"!==\"),\n    NOT: new code_1._Code(\"!\"),\n    OR: new code_1._Code(\"||\"),\n    AND: new code_1._Code(\"&&\"),\n};\nclass Node {\n    optimizeNodes() {\n        return this;\n    }\n    optimizeNames(_names, _constants) {\n        return this;\n    }\n}\nclass Def extends Node {\n    constructor(varKind, name, rhs) {\n        super();\n        this.varKind = varKind;\n        this.name = name;\n        this.rhs = rhs;\n    }\n    render({ es5, _n }) {\n        const varKind = es5 ? scope_1.varKinds.var : this.varKind;\n        const rhs = this.rhs === undefined ? \"\" : ` = ${this.rhs}`;\n        return `${varKind} ${this.name}${rhs};` + _n;\n    }\n    optimizeNames(names, constants) {\n        if (!names[this.name.str])\n            return;\n        if (this.rhs)\n            this.rhs = optimizeExpr(this.rhs, names, constants);\n        return this;\n    }\n    get names() {\n        return this.rhs instanceof code_1._CodeOrName ? this.rhs.names : {};\n    }\n}\nclass Assign extends Node {\n    constructor(lhs, rhs, sideEffects) {\n        super();\n        this.lhs = lhs;\n        this.rhs = rhs;\n        this.sideEffects = sideEffects;\n    }\n    render({ _n }) {\n        return `${this.lhs} = ${this.rhs};` + _n;\n    }\n    optimizeNames(names, constants) {\n        if (this.lhs instanceof code_1.Name && !names[this.lhs.str] && !this.sideEffects)\n            return;\n        this.rhs = optimizeExpr(this.rhs, names, constants);\n        return this;\n    }\n    get names() {\n        const names = this.lhs instanceof code_1.Name ? {} : { ...this.lhs.names };\n        return addExprNames(names, this.rhs);\n    }\n}\nclass Label extends Node {\n    constructor(label) {\n        super();\n        this.label = label;\n        this.names = {};\n    }\n    render({ _n }) {\n        return `${this.label}:` + _n;\n    }\n}\nclass Break extends Node {\n    constructor(label) {\n        super();\n        this.label = label;\n        this.names = {};\n    }\n    render({ _n }) {\n        const label = this.label ? ` ${this.label}` : \"\";\n        return `break${label};` + _n;\n    }\n}\nclass Throw extends Node {\n    constructor(error) {\n        super();\n        this.error = error;\n    }\n    render({ _n }) {\n        return `throw ${this.error};` + _n;\n    }\n    get names() {\n        return this.error.names;\n    }\n}\nclass AnyCode extends Node {\n    constructor(code) {\n        super();\n        this.code = code;\n    }\n    render({ _n }) {\n        return `${this.code};` + _n;\n    }\n    optimizeNodes() {\n        return `${this.code}` ? this : undefined;\n    }\n    optimizeNames(names, constants) {\n        this.code = optimizeExpr(this.code, names, constants);\n        return this;\n    }\n    get names() {\n        return this.code instanceof code_1._CodeOrName ? this.code.names : {};\n    }\n}\nclass ParentNode extends Node {\n    constructor(nodes = []) {\n        super();\n        this.nodes = nodes;\n    }\n    render(opts) {\n        return this.nodes.reduce((code, n) => code + n.render(opts), \"\");\n    }\n    optimizeNodes() {\n        const { nodes } = this;\n        let i = nodes.length;\n        while (i--) {\n            const n = nodes[i].optimizeNodes();\n            if (Array.isArray(n))\n                nodes.splice(i, 1, ...n);\n            else if (n)\n                nodes[i] = n;\n            else\n                nodes.splice(i, 1);\n        }\n        return nodes.length > 0 ? this : undefined;\n    }\n    optimizeNames(names, constants) {\n        const { nodes } = this;\n        let i = nodes.length;\n        while (i--) {\n            // iterating backwards improves 1-pass optimization\n            const n = nodes[i];\n            if (n.optimizeNames(names, constants))\n                continue;\n            subtractNames(names, n.names);\n            nodes.splice(i, 1);\n        }\n        return nodes.length > 0 ? this : undefined;\n    }\n    get names() {\n        return this.nodes.reduce((names, n) => addNames(names, n.names), {});\n    }\n}\nclass BlockNode extends ParentNode {\n    render(opts) {\n        return \"{\" + opts._n + super.render(opts) + \"}\" + opts._n;\n    }\n}\nclass Root extends ParentNode {\n}\nclass Else extends BlockNode {\n}\nElse.kind = \"else\";\nclass If extends BlockNode {\n    constructor(condition, nodes) {\n        super(nodes);\n        this.condition = condition;\n    }\n    render(opts) {\n        let code = `if(${this.condition})` + super.render(opts);\n        if (this.else)\n            code += \"else \" + this.else.render(opts);\n        return code;\n    }\n    optimizeNodes() {\n        super.optimizeNodes();\n        const cond = this.condition;\n        if (cond === true)\n            return this.nodes; // else is ignored here\n        let e = this.else;\n        if (e) {\n            const ns = e.optimizeNodes();\n            e = this.else = Array.isArray(ns) ? new Else(ns) : ns;\n        }\n        if (e) {\n            if (cond === false)\n                return e instanceof If ? e : e.nodes;\n            if (this.nodes.length)\n                return this;\n            return new If(not(cond), e instanceof If ? [e] : e.nodes);\n        }\n        if (cond === false || !this.nodes.length)\n            return undefined;\n        return this;\n    }\n    optimizeNames(names, constants) {\n        var _a;\n        this.else = (_a = this.else) === null || _a === void 0 ? void 0 : _a.optimizeNames(names, constants);\n        if (!(super.optimizeNames(names, constants) || this.else))\n            return;\n        this.condition = optimizeExpr(this.condition, names, constants);\n        return this;\n    }\n    get names() {\n        const names = super.names;\n        addExprNames(names, this.condition);\n        if (this.else)\n            addNames(names, this.else.names);\n        return names;\n    }\n}\nIf.kind = \"if\";\nclass For extends BlockNode {\n}\nFor.kind = \"for\";\nclass ForLoop extends For {\n    constructor(iteration) {\n        super();\n        this.iteration = iteration;\n    }\n    render(opts) {\n        return `for(${this.iteration})` + super.render(opts);\n    }\n    optimizeNames(names, constants) {\n        if (!super.optimizeNames(names, constants))\n            return;\n        this.iteration = optimizeExpr(this.iteration, names, constants);\n        return this;\n    }\n    get names() {\n        return addNames(super.names, this.iteration.names);\n    }\n}\nclass ForRange extends For {\n    constructor(varKind, name, from, to) {\n        super();\n        this.varKind = varKind;\n        this.name = name;\n        this.from = from;\n        this.to = to;\n    }\n    render(opts) {\n        const varKind = opts.es5 ? scope_1.varKinds.var : this.varKind;\n        const { name, from, to } = this;\n        return `for(${varKind} ${name}=${from}; ${name}<${to}; ${name}++)` + super.render(opts);\n    }\n    get names() {\n        const names = addExprNames(super.names, this.from);\n        return addExprNames(names, this.to);\n    }\n}\nclass ForIter extends For {\n    constructor(loop, varKind, name, iterable) {\n        super();\n        this.loop = loop;\n        this.varKind = varKind;\n        this.name = name;\n        this.iterable = iterable;\n    }\n    render(opts) {\n        return `for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})` + super.render(opts);\n    }\n    optimizeNames(names, constants) {\n        if (!super.optimizeNames(names, constants))\n            return;\n        this.iterable = optimizeExpr(this.iterable, names, constants);\n        return this;\n    }\n    get names() {\n        return addNames(super.names, this.iterable.names);\n    }\n}\nclass Func extends BlockNode {\n    constructor(name, args, async) {\n        super();\n        this.name = name;\n        this.args = args;\n        this.async = async;\n    }\n    render(opts) {\n        const _async = this.async ? \"async \" : \"\";\n        return `${_async}function ${this.name}(${this.args})` + super.render(opts);\n    }\n}\nFunc.kind = \"func\";\nclass Return extends ParentNode {\n    render(opts) {\n        return \"return \" + super.render(opts);\n    }\n}\nReturn.kind = \"return\";\nclass Try extends BlockNode {\n    render(opts) {\n        let code = \"try\" + super.render(opts);\n        if (this.catch)\n            code += this.catch.render(opts);\n        if (this.finally)\n            code += this.finally.render(opts);\n        return code;\n    }\n    optimizeNodes() {\n        var _a, _b;\n        super.optimizeNodes();\n        (_a = this.catch) === null || _a === void 0 ? void 0 : _a.optimizeNodes();\n        (_b = this.finally) === null || _b === void 0 ? void 0 : _b.optimizeNodes();\n        return this;\n    }\n    optimizeNames(names, constants) {\n        var _a, _b;\n        super.optimizeNames(names, constants);\n        (_a = this.catch) === null || _a === void 0 ? void 0 : _a.optimizeNames(names, constants);\n        (_b = this.finally) === null || _b === void 0 ? void 0 : _b.optimizeNames(names, constants);\n        return this;\n    }\n    get names() {\n        const names = super.names;\n        if (this.catch)\n            addNames(names, this.catch.names);\n        if (this.finally)\n            addNames(names, this.finally.names);\n        return names;\n    }\n}\nclass Catch extends BlockNode {\n    constructor(error) {\n        super();\n        this.error = error;\n    }\n    render(opts) {\n        return `catch(${this.error})` + super.render(opts);\n    }\n}\nCatch.kind = \"catch\";\nclass Finally extends BlockNode {\n    render(opts) {\n        return \"finally\" + super.render(opts);\n    }\n}\nFinally.kind = \"finally\";\nclass CodeGen {\n    constructor(extScope, opts = {}) {\n        this._values = {};\n        this._blockStarts = [];\n        this._constants = {};\n        this.opts = { ...opts, _n: opts.lines ? \"\\n\" : \"\" };\n        this._extScope = extScope;\n        this._scope = new scope_1.Scope({ parent: extScope });\n        this._nodes = [new Root()];\n    }\n    toString() {\n        return this._root.render(this.opts);\n    }\n    // returns unique name in the internal scope\n    name(prefix) {\n        return this._scope.name(prefix);\n    }\n    // reserves unique name in the external scope\n    scopeName(prefix) {\n        return this._extScope.name(prefix);\n    }\n    // reserves unique name in the external scope and assigns value to it\n    scopeValue(prefixOrName, value) {\n        const name = this._extScope.value(prefixOrName, value);\n        const vs = this._values[name.prefix] || (this._values[name.prefix] = new Set());\n        vs.add(name);\n        return name;\n    }\n    getScopeValue(prefix, keyOrRef) {\n        return this._extScope.getValue(prefix, keyOrRef);\n    }\n    // return code that assigns values in the external scope to the names that are used internally\n    // (same names that were returned by gen.scopeName or gen.scopeValue)\n    scopeRefs(scopeName) {\n        return this._extScope.scopeRefs(scopeName, this._values);\n    }\n    scopeCode() {\n        return this._extScope.scopeCode(this._values);\n    }\n    _def(varKind, nameOrPrefix, rhs, constant) {\n        const name = this._scope.toName(nameOrPrefix);\n        if (rhs !== undefined && constant)\n            this._constants[name.str] = rhs;\n        this._leafNode(new Def(varKind, name, rhs));\n        return name;\n    }\n    // `const` declaration (`var` in es5 mode)\n    const(nameOrPrefix, rhs, _constant) {\n        return this._def(scope_1.varKinds.const, nameOrPrefix, rhs, _constant);\n    }\n    // `let` declaration with optional assignment (`var` in es5 mode)\n    let(nameOrPrefix, rhs, _constant) {\n        return this._def(scope_1.varKinds.let, nameOrPrefix, rhs, _constant);\n    }\n    // `var` declaration with optional assignment\n    var(nameOrPrefix, rhs, _constant) {\n        return this._def(scope_1.varKinds.var, nameOrPrefix, rhs, _constant);\n    }\n    // assignment code\n    assign(lhs, rhs, sideEffects) {\n        return this._leafNode(new Assign(lhs, rhs, sideEffects));\n    }\n    // appends passed SafeExpr to code or executes Block\n    code(c) {\n        if (typeof c == \"function\")\n            c();\n        else if (c !== code_1.nil)\n            this._leafNode(new AnyCode(c));\n        return this;\n    }\n    // returns code for object literal for the passed argument list of key-value pairs\n    object(...keyValues) {\n        const code = [\"{\"];\n        for (const [key, value] of keyValues) {\n            if (code.length > 1)\n                code.push(\",\");\n            code.push(key);\n            if (key !== value || this.opts.es5) {\n                code.push(\":\");\n                code_1.addCodeArg(code, value);\n            }\n        }\n        code.push(\"}\");\n        return new code_1._Code(code);\n    }\n    // `if` clause (or statement if `thenBody` and, optionally, `elseBody` are passed)\n    if(condition, thenBody, elseBody) {\n        this._blockNode(new If(condition));\n        if (thenBody && elseBody) {\n            this.code(thenBody).else().code(elseBody).endIf();\n        }\n        else if (thenBody) {\n            this.code(thenBody).endIf();\n        }\n        else if (elseBody) {\n            throw new Error('CodeGen: \"else\" body without \"then\" body');\n        }\n        return this;\n    }\n    // `else if` clause - invalid without `if` or after `else` clauses\n    elseIf(condition) {\n        return this._elseNode(new If(condition));\n    }\n    // `else` clause - only valid after `if` or `else if` clauses\n    else() {\n        return this._elseNode(new Else());\n    }\n    // end `if` statement (needed if gen.if was used only with condition)\n    endIf() {\n        return this._endBlockNode(If, Else);\n    }\n    _for(node, forBody) {\n        this._blockNode(node);\n        if (forBody)\n            this.code(forBody).endFor();\n        return this;\n    }\n    // a generic `for` clause (or statement if `forBody` is passed)\n    for(iteration, forBody) {\n        return this._for(new ForLoop(iteration), forBody);\n    }\n    // `for` statement for a range of values\n    forRange(nameOrPrefix, from, to, forBody, varKind = this.opts.es5 ? scope_1.varKinds.var : scope_1.varKinds.let) {\n        const name = this._scope.toName(nameOrPrefix);\n        return this._for(new ForRange(varKind, name, from, to), () => forBody(name));\n    }\n    // `for-of` statement (in es5 mode replace with a normal for loop)\n    forOf(nameOrPrefix, iterable, forBody, varKind = scope_1.varKinds.const) {\n        const name = this._scope.toName(nameOrPrefix);\n        if (this.opts.es5) {\n            const arr = iterable instanceof code_1.Name ? iterable : this.var(\"_arr\", iterable);\n            return this.forRange(\"_i\", 0, code_1._ `${arr}.length`, (i) => {\n                this.var(name, code_1._ `${arr}[${i}]`);\n                forBody(name);\n            });\n        }\n        return this._for(new ForIter(\"of\", varKind, name, iterable), () => forBody(name));\n    }\n    // `for-in` statement.\n    // With option `ownProperties` replaced with a `for-of` loop for object keys\n    forIn(nameOrPrefix, obj, forBody, varKind = this.opts.es5 ? scope_1.varKinds.var : scope_1.varKinds.const) {\n        if (this.opts.ownProperties) {\n            return this.forOf(nameOrPrefix, code_1._ `Object.keys(${obj})`, forBody);\n        }\n        const name = this._scope.toName(nameOrPrefix);\n        return this._for(new ForIter(\"in\", varKind, name, obj), () => forBody(name));\n    }\n    // end `for` loop\n    endFor() {\n        return this._endBlockNode(For);\n    }\n    // `label` statement\n    label(label) {\n        return this._leafNode(new Label(label));\n    }\n    // `break` statement\n    break(label) {\n        return this._leafNode(new Break(label));\n    }\n    // `return` statement\n    return(value) {\n        const node = new Return();\n        this._blockNode(node);\n        this.code(value);\n        if (node.nodes.length !== 1)\n            throw new Error('CodeGen: \"return\" should have one node');\n        return this._endBlockNode(Return);\n    }\n    // `try` statement\n    try(tryBody, catchCode, finallyCode) {\n        if (!catchCode && !finallyCode)\n            throw new Error('CodeGen: \"try\" without \"catch\" and \"finally\"');\n        const node = new Try();\n        this._blockNode(node);\n        this.code(tryBody);\n        if (catchCode) {\n            const error = this.name(\"e\");\n            this._currNode = node.catch = new Catch(error);\n            catchCode(error);\n        }\n        if (finallyCode) {\n            this._currNode = node.finally = new Finally();\n            this.code(finallyCode);\n        }\n        return this._endBlockNode(Catch, Finally);\n    }\n    // `throw` statement\n    throw(error) {\n        return this._leafNode(new Throw(error));\n    }\n    // start self-balancing block\n    block(body, nodeCount) {\n        this._blockStarts.push(this._nodes.length);\n        if (body)\n            this.code(body).endBlock(nodeCount);\n        return this;\n    }\n    // end the current self-balancing block\n    endBlock(nodeCount) {\n        const len = this._blockStarts.pop();\n        if (len === undefined)\n            throw new Error(\"CodeGen: not in self-balancing block\");\n        const toClose = this._nodes.length - len;\n        if (toClose < 0 || (nodeCount !== undefined && toClose !== nodeCount)) {\n            throw new Error(`CodeGen: wrong number of nodes: ${toClose} vs ${nodeCount} expected`);\n        }\n        this._nodes.length = len;\n        return this;\n    }\n    // `function` heading (or definition if funcBody is passed)\n    func(name, args = code_1.nil, async, funcBody) {\n        this._blockNode(new Func(name, args, async));\n        if (funcBody)\n            this.code(funcBody).endFunc();\n        return this;\n    }\n    // end function definition\n    endFunc() {\n        return this._endBlockNode(Func);\n    }\n    optimize(n = 1) {\n        while (n-- > 0) {\n            this._root.optimizeNodes();\n            this._root.optimizeNames(this._root.names, this._constants);\n        }\n    }\n    _leafNode(node) {\n        this._currNode.nodes.push(node);\n        return this;\n    }\n    _blockNode(node) {\n        this._currNode.nodes.push(node);\n        this._nodes.push(node);\n    }\n    _endBlockNode(N1, N2) {\n        const n = this._currNode;\n        if (n instanceof N1 || (N2 && n instanceof N2)) {\n            this._nodes.pop();\n            return this;\n        }\n        throw new Error(`CodeGen: not in block \"${N2 ? `${N1.kind}/${N2.kind}` : N1.kind}\"`);\n    }\n    _elseNode(node) {\n        const n = this._currNode;\n        if (!(n instanceof If)) {\n            throw new Error('CodeGen: \"else\" without \"if\"');\n        }\n        this._currNode = n.else = node;\n        return this;\n    }\n    get _root() {\n        return this._nodes[0];\n    }\n    get _currNode() {\n        const ns = this._nodes;\n        return ns[ns.length - 1];\n    }\n    set _currNode(node) {\n        const ns = this._nodes;\n        ns[ns.length - 1] = node;\n    }\n}\nexports.CodeGen = CodeGen;\nfunction addNames(names, from) {\n    for (const n in from)\n        names[n] = (names[n] || 0) + (from[n] || 0);\n    return names;\n}\nfunction addExprNames(names, from) {\n    return from instanceof code_1._CodeOrName ? addNames(names, from.names) : names;\n}\nfunction optimizeExpr(expr, names, constants) {\n    if (expr instanceof code_1.Name)\n        return replaceName(expr);\n    if (!canOptimize(expr))\n        return expr;\n    return new code_1._Code(expr._items.reduce((items, c) => {\n        if (c instanceof code_1.Name)\n            c = replaceName(c);\n        if (c instanceof code_1._Code)\n            items.push(...c._items);\n        else\n            items.push(c);\n        return items;\n    }, []));\n    function replaceName(n) {\n        const c = constants[n.str];\n        if (c === undefined || names[n.str] !== 1)\n            return n;\n        delete names[n.str];\n        return c;\n    }\n    function canOptimize(e) {\n        return (e instanceof code_1._Code &&\n            e._items.some((c) => c instanceof code_1.Name && names[c.str] === 1 && constants[c.str] !== undefined));\n    }\n}\nfunction subtractNames(names, from) {\n    for (const n in from)\n        names[n] = (names[n] || 0) - (from[n] || 0);\n}\nfunction not(x) {\n    return typeof x == \"boolean\" || typeof x == \"number\" || x === null ? !x : code_1._ `!${par(x)}`;\n}\nexports.not = not;\nconst andCode = mappend(exports.operators.AND);\n// boolean AND (&&) expression with the passed arguments\nfunction and(...args) {\n    return args.reduce(andCode);\n}\nexports.and = and;\nconst orCode = mappend(exports.operators.OR);\n// boolean OR (||) expression with the passed arguments\nfunction or(...args) {\n    return args.reduce(orCode);\n}\nexports.or = or;\nfunction mappend(op) {\n    return (x, y) => (x === code_1.nil ? y : y === code_1.nil ? x : code_1._ `${par(x)} ${op} ${par(y)}`);\n}\nfunction par(x) {\n    return x instanceof code_1.Name ? x : code_1._ `(${x})`;\n}\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ValueScope = exports.ValueScopeName = exports.Scope = exports.varKinds = void 0;\nconst code_1 = require(\"./code\");\nclass ValueError extends Error {\n    constructor(name) {\n        super(`CodeGen: \"code\" for ${name} not defined`);\n        this.value = name.value;\n    }\n}\nexports.varKinds = {\n    const: new code_1.Name(\"const\"),\n    let: new code_1.Name(\"let\"),\n    var: new code_1.Name(\"var\"),\n};\nclass Scope {\n    constructor({ prefixes, parent } = {}) {\n        this._names = {};\n        this._prefixes = prefixes;\n        this._parent = parent;\n    }\n    toName(nameOrPrefix) {\n        return nameOrPrefix instanceof code_1.Name ? nameOrPrefix : this.name(nameOrPrefix);\n    }\n    name(prefix) {\n        return new code_1.Name(this._newName(prefix));\n    }\n    _newName(prefix) {\n        const ng = this._names[prefix] || this._nameGroup(prefix);\n        return `${prefix}${ng.index++}`;\n    }\n    _nameGroup(prefix) {\n        var _a, _b;\n        if (((_b = (_a = this._parent) === null || _a === void 0 ? void 0 : _a._prefixes) === null || _b === void 0 ? void 0 : _b.has(prefix)) || (this._prefixes && !this._prefixes.has(prefix))) {\n            throw new Error(`CodeGen: prefix \"${prefix}\" is not allowed in this scope`);\n        }\n        return (this._names[prefix] = { prefix, index: 0 });\n    }\n}\nexports.Scope = Scope;\nclass ValueScopeName extends code_1.Name {\n    constructor(prefix, nameStr) {\n        super(nameStr);\n        this.prefix = prefix;\n    }\n    setValue(value, { property, itemIndex }) {\n        this.value = value;\n        this.scopePath = code_1._ `.${new code_1.Name(property)}[${itemIndex}]`;\n    }\n}\nexports.ValueScopeName = ValueScopeName;\nconst line = code_1._ `\\n`;\nclass ValueScope extends Scope {\n    constructor(opts) {\n        super(opts);\n        this._values = {};\n        this._scope = opts.scope;\n        this.opts = { ...opts, _n: opts.lines ? line : code_1.nil };\n    }\n    get() {\n        return this._scope;\n    }\n    name(prefix) {\n        return new ValueScopeName(prefix, this._newName(prefix));\n    }\n    value(nameOrPrefix, value) {\n        var _a;\n        if (value.ref === undefined)\n            throw new Error(\"CodeGen: ref must be passed in value\");\n        const name = this.toName(nameOrPrefix);\n        const { prefix } = name;\n        const valueKey = (_a = value.key) !== null && _a !== void 0 ? _a : value.ref;\n        let vs = this._values[prefix];\n        if (vs) {\n            const _name = vs.get(valueKey);\n            if (_name)\n                return _name;\n        }\n        else {\n            vs = this._values[prefix] = new Map();\n        }\n        vs.set(valueKey, name);\n        const s = this._scope[prefix] || (this._scope[prefix] = []);\n        const itemIndex = s.length;\n        s[itemIndex] = value.ref;\n        name.setValue(value, { property: prefix, itemIndex });\n        return name;\n    }\n    getValue(prefix, keyOrRef) {\n        const vs = this._values[prefix];\n        if (!vs)\n            return;\n        return vs.get(keyOrRef);\n    }\n    scopeRefs(scopeName, values = this._values) {\n        return this._reduceValues(values, (name) => {\n            if (name.scopePath === undefined)\n                throw new Error(`CodeGen: name \"${name}\" has no value`);\n            return code_1._ `${scopeName}${name.scopePath}`;\n        });\n    }\n    scopeCode(values = this._values, usedValues, getCode) {\n        return this._reduceValues(values, (name) => {\n            if (name.value === undefined)\n                throw new Error(`CodeGen: name \"${name}\" has no value`);\n            return name.value.code;\n        }, usedValues, getCode);\n    }\n    _reduceValues(values, valueCode, usedValues = {}, getCode) {\n        let code = code_1.nil;\n        for (const prefix in values) {\n            const vs = values[prefix];\n            if (!vs)\n                continue;\n            const nameSet = (usedValues[prefix] = usedValues[prefix] || new Set());\n            vs.forEach((name) => {\n                if (nameSet.has(name))\n                    return;\n                nameSet.add(name);\n                let c = valueCode(name);\n                if (c) {\n                    const def = this.opts.es5 ? exports.varKinds.var : exports.varKinds.const;\n                    code = code_1._ `${code}${def} ${name} = ${c};${this.opts._n}`;\n                }\n                else if ((c = getCode === null || getCode === void 0 ? void 0 : getCode(name))) {\n                    code = code_1._ `${code}${c}${this.opts._n}`;\n                }\n                else {\n                    throw new ValueError(name);\n                }\n            });\n        }\n        return code;\n    }\n}\nexports.ValueScope = ValueScope;\n//# sourceMappingURL=scope.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getData = void 0;\nconst dataType_1 = require(\"./validate/dataType\");\nconst util_1 = require(\"./util\");\nconst errors_1 = require(\"./errors\");\nconst codegen_1 = require(\"./codegen\");\nconst names_1 = require(\"./names\");\nconst subschema_1 = require(\"./subschema\");\nclass KeywordCxt {\n    constructor(it, def, keyword) {\n        validateKeywordUsage(it, def, keyword);\n        this.gen = it.gen;\n        this.allErrors = it.allErrors;\n        this.keyword = keyword;\n        this.data = it.data;\n        this.schema = it.schema[keyword];\n        this.$data = def.$data && it.opts.$data && this.schema && this.schema.$data;\n        this.schemaValue = util_1.schemaRefOrVal(it, this.schema, keyword, this.$data);\n        this.schemaType = def.schemaType;\n        this.parentSchema = it.schema;\n        this.params = {};\n        this.it = it;\n        this.def = def;\n        if (this.$data) {\n            this.schemaCode = it.gen.const(\"vSchema\", getData(this.$data, it));\n        }\n        else {\n            this.schemaCode = this.schemaValue;\n            if (!validSchemaType(this.schema, def.schemaType, def.allowUndefined)) {\n                throw new Error(`${keyword} value must be ${JSON.stringify(def.schemaType)}`);\n            }\n        }\n        if (\"code\" in def ? def.trackErrors : def.errors !== false) {\n            this.errsCount = it.gen.const(\"_errs\", names_1.default.errors);\n        }\n    }\n    result(condition, successAction, failAction) {\n        this.gen.if(codegen_1.not(condition));\n        if (failAction)\n            failAction();\n        else\n            this.error();\n        if (successAction) {\n            this.gen.else();\n            successAction();\n            if (this.allErrors)\n                this.gen.endIf();\n        }\n        else {\n            if (this.allErrors)\n                this.gen.endIf();\n            else\n                this.gen.else();\n        }\n    }\n    pass(condition, failAction) {\n        this.result(condition, undefined, failAction);\n    }\n    fail(condition) {\n        if (condition === undefined) {\n            this.error();\n            if (!this.allErrors)\n                this.gen.if(false); // this branch will be removed by gen.optimize\n            return;\n        }\n        this.gen.if(condition);\n        this.error();\n        if (this.allErrors)\n            this.gen.endIf();\n        else\n            this.gen.else();\n    }\n    fail$data(condition) {\n        if (!this.$data)\n            return this.fail(condition);\n        const { schemaCode } = this;\n        this.fail(codegen_1._ `${schemaCode} !== undefined && (${codegen_1.or(this.invalid$data(), condition)})`);\n    }\n    error(append) {\n        ;\n        (append ? errors_1.reportExtraError : errors_1.reportError)(this, this.def.error || errors_1.keywordError);\n    }\n    $dataError() {\n        errors_1.reportError(this, this.def.$dataError || errors_1.keyword$DataError);\n    }\n    reset() {\n        if (this.errsCount === undefined)\n            throw new Error('add \"trackErrors\" to keyword definition');\n        errors_1.resetErrorsCount(this.gen, this.errsCount);\n    }\n    ok(cond) {\n        if (!this.allErrors)\n            this.gen.if(cond);\n    }\n    setParams(obj, assign) {\n        if (assign)\n            Object.assign(this.params, obj);\n        else\n            this.params = obj;\n    }\n    block$data(valid, codeBlock, $dataValid = codegen_1.nil) {\n        this.gen.block(() => {\n            this.check$data(valid, $dataValid);\n            codeBlock();\n        });\n    }\n    check$data(valid = codegen_1.nil, $dataValid = codegen_1.nil) {\n        if (!this.$data)\n            return;\n        const { gen, schemaCode, schemaType, def } = this;\n        gen.if(codegen_1.or(codegen_1._ `${schemaCode} === undefined`, $dataValid));\n        if (valid !== codegen_1.nil)\n            gen.assign(valid, true);\n        if (schemaType.length || def.validateSchema) {\n            gen.elseIf(this.invalid$data());\n            this.$dataError();\n            if (valid !== codegen_1.nil)\n                gen.assign(valid, false);\n        }\n        gen.else();\n    }\n    invalid$data() {\n        const { gen, schemaCode, schemaType, def, it } = this;\n        return codegen_1.or(wrong$DataType(), invalid$DataSchema());\n        function wrong$DataType() {\n            if (schemaType.length) {\n                /* istanbul ignore if */\n                if (!(schemaCode instanceof codegen_1.Name))\n                    throw new Error(\"ajv implementation error\");\n                const st = Array.isArray(schemaType) ? schemaType : [schemaType];\n                return codegen_1._ `${dataType_1.checkDataTypes(st, schemaCode, it.opts.strict, dataType_1.DataType.Wrong)}`;\n            }\n            return codegen_1.nil;\n        }\n        function invalid$DataSchema() {\n            if (def.validateSchema) {\n                const validateSchemaRef = gen.scopeValue(\"validate$data\", { ref: def.validateSchema }); // TODO value.code for standalone\n                return codegen_1._ `!${validateSchemaRef}(${schemaCode})`;\n            }\n            return codegen_1.nil;\n        }\n    }\n    subschema(appl, valid) {\n        return subschema_1.applySubschema(this.it, appl, valid);\n    }\n    mergeEvaluated(schemaCxt, toName) {\n        const { it, gen } = this;\n        if (!it.opts.unevaluated)\n            return;\n        if (it.props !== true && schemaCxt.props !== undefined) {\n            it.props = util_1.mergeEvaluated.props(gen, schemaCxt.props, it.props, toName);\n        }\n        if (it.items !== true && schemaCxt.items !== undefined) {\n            it.items = util_1.mergeEvaluated.items(gen, schemaCxt.items, it.items, toName);\n        }\n    }\n    mergeValidEvaluated(schemaCxt, valid) {\n        const { it, gen } = this;\n        if (it.opts.unevaluated && (it.props !== true || it.items !== true)) {\n            gen.if(valid, () => this.mergeEvaluated(schemaCxt, codegen_1.Name));\n            return true;\n        }\n    }\n}\nexports.default = KeywordCxt;\nfunction validSchemaType(schema, schemaType, allowUndefined = false) {\n    // TODO add tests\n    return (!schemaType.length ||\n        schemaType.some((st) => st === \"array\"\n            ? Array.isArray(schema)\n            : st === \"object\"\n                ? schema && typeof schema == \"object\" && !Array.isArray(schema)\n                : typeof schema == st || (allowUndefined && typeof schema == \"undefined\")));\n}\nfunction validateKeywordUsage({ schema, opts, self }, def, keyword) {\n    /* istanbul ignore if */\n    if (Array.isArray(def.keyword) ? !def.keyword.includes(keyword) : def.keyword !== keyword) {\n        throw new Error(\"ajv implementation error\");\n    }\n    const deps = def.dependencies;\n    if (deps === null || deps === void 0 ? void 0 : deps.some((kwd) => !Object.prototype.hasOwnProperty.call(schema, kwd))) {\n        throw new Error(`parent schema must have dependencies of ${keyword}: ${deps.join(\",\")}`);\n    }\n    if (def.validateSchema) {\n        const valid = def.validateSchema(schema[keyword]);\n        if (!valid) {\n            const msg = \"keyword value is invalid: \" + self.errorsText(def.validateSchema.errors);\n            if (opts.validateSchema === \"log\")\n                self.logger.error(msg);\n            else\n                throw new Error(msg);\n        }\n    }\n}\nconst JSON_POINTER = /^\\/(?:[^~]|~0|~1)*$/;\nconst RELATIVE_JSON_POINTER = /^([0-9]+)(#|\\/(?:[^~]|~0|~1)*)?$/;\nfunction getData($data, { dataLevel, dataNames, dataPathArr }) {\n    let jsonPointer;\n    let data;\n    if ($data === \"\")\n        return names_1.default.rootData;\n    if ($data[0] === \"/\") {\n        if (!JSON_POINTER.test($data))\n            throw new Error(`Invalid JSON-pointer: ${$data}`);\n        jsonPointer = $data;\n        data = names_1.default.rootData;\n    }\n    else {\n        const matches = RELATIVE_JSON_POINTER.exec($data);\n        if (!matches)\n            throw new Error(`Invalid JSON-pointer: ${$data}`);\n        const up = +matches[1];\n        jsonPointer = matches[2];\n        if (jsonPointer === \"#\") {\n            if (up >= dataLevel)\n                throw new Error(errorMsg(\"property/index\", up));\n            return dataPathArr[dataLevel - up];\n        }\n        if (up > dataLevel)\n            throw new Error(errorMsg(\"data\", up));\n        data = dataNames[dataLevel - up];\n        if (!jsonPointer)\n            return data;\n    }\n    let expr = data;\n    const segments = jsonPointer.split(\"/\");\n    for (const segment of segments) {\n        if (segment) {\n            data = codegen_1._ `${data}${codegen_1.getProperty(util_1.unescapeJsonPointer(segment))}`;\n            expr = codegen_1._ `${expr} && ${data}`;\n        }\n    }\n    return expr;\n    function errorMsg(pointerType, up) {\n        return `Cannot access ${pointerType} ${up} levels up, current level is ${dataLevel}`;\n    }\n}\nexports.getData = getData;\n//# sourceMappingURL=context.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.MissingRefError = exports.ValidationError = void 0;\nconst resolve_1 = require(\"./resolve\");\nclass ValidationError extends Error {\n    constructor(errors) {\n        super(\"validation failed\");\n        this.errors = errors;\n        this.ajv = this.validation = true;\n    }\n}\nexports.ValidationError = ValidationError;\nclass MissingRefError extends Error {\n    constructor(baseId, ref) {\n        super(`can't resolve reference ${ref} from id ${baseId}`);\n        this.missingRef = resolve_1.resolveUrl(baseId, ref);\n        this.missingSchema = resolve_1.normalizeId(resolve_1.getFullPath(this.missingRef));\n    }\n}\nexports.MissingRefError = MissingRefError;\nmodule.exports = {\n    ValidationError,\n    MissingRefError,\n};\n//# sourceMappingURL=error_classes.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.extendErrors = exports.resetErrorsCount = exports.reportExtraError = exports.reportError = exports.keyword$DataError = exports.keywordError = void 0;\nconst codegen_1 = require(\"./codegen\");\nconst names_1 = require(\"./names\");\nexports.keywordError = {\n    message: ({ keyword }) => codegen_1.str `should pass \"${keyword}\" keyword validation`,\n};\nexports.keyword$DataError = {\n    message: ({ keyword, schemaType }) => schemaType\n        ? codegen_1.str `\"${keyword}\" keyword must be ${schemaType} ($data)`\n        : codegen_1.str `\"${keyword}\" keyword is invalid ($data)`,\n};\nfunction reportError(cxt, error, overrideAllErrors) {\n    const { it } = cxt;\n    const { gen, compositeRule, allErrors } = it;\n    const errObj = errorObjectCode(cxt, error);\n    if (overrideAllErrors !== null && overrideAllErrors !== void 0 ? overrideAllErrors : (compositeRule || allErrors)) {\n        addError(gen, errObj);\n    }\n    else {\n        returnErrors(it, codegen_1._ `[${errObj}]`);\n    }\n}\nexports.reportError = reportError;\nfunction reportExtraError(cxt, error) {\n    const { it } = cxt;\n    const { gen, compositeRule, allErrors } = it;\n    const errObj = errorObjectCode(cxt, error);\n    addError(gen, errObj);\n    if (!(compositeRule || allErrors)) {\n        returnErrors(it, names_1.default.vErrors);\n    }\n}\nexports.reportExtraError = reportExtraError;\nfunction resetErrorsCount(gen, errsCount) {\n    gen.assign(names_1.default.errors, errsCount);\n    gen.if(codegen_1._ `${names_1.default.vErrors} !== null`, () => gen.if(errsCount, () => gen.assign(codegen_1._ `${names_1.default.vErrors}.length`, errsCount), () => gen.assign(names_1.default.vErrors, null)));\n}\nexports.resetErrorsCount = resetErrorsCount;\nfunction extendErrors({ gen, keyword, schemaValue, data, errsCount, it, }) {\n    /* istanbul ignore if */\n    if (errsCount === undefined)\n        throw new Error(\"ajv implementation error\");\n    const err = gen.name(\"err\");\n    gen.forRange(\"i\", errsCount, names_1.default.errors, (i) => {\n        gen.const(err, codegen_1._ `${names_1.default.vErrors}[${i}]`);\n        gen.if(codegen_1._ `${err}.dataPath === undefined`, () => gen.assign(codegen_1._ `${err}.dataPath`, codegen_1.strConcat(names_1.default.dataPath, it.errorPath)));\n        gen.assign(codegen_1._ `${err}.schemaPath`, codegen_1.str `${it.errSchemaPath}/${keyword}`);\n        if (it.opts.verbose) {\n            gen.assign(codegen_1._ `${err}.schema`, schemaValue);\n            gen.assign(codegen_1._ `${err}.data`, data);\n        }\n    });\n}\nexports.extendErrors = extendErrors;\nfunction addError(gen, errObj) {\n    const err = gen.const(\"err\", errObj);\n    gen.if(codegen_1._ `${names_1.default.vErrors} === null`, () => gen.assign(names_1.default.vErrors, codegen_1._ `[${err}]`), codegen_1._ `${names_1.default.vErrors}.push(${err})`);\n    gen.code(codegen_1._ `${names_1.default.errors}++`);\n}\nfunction returnErrors(it, errs) {\n    const { gen, validateName, schemaEnv } = it;\n    if (schemaEnv.$async) {\n        gen.throw(codegen_1._ `new ${it.ValidationError}(${errs})`);\n    }\n    else {\n        gen.assign(codegen_1._ `${validateName}.errors`, errs);\n        gen.return(false);\n    }\n}\nconst E = {\n    keyword: new codegen_1.Name(\"keyword\"),\n    schemaPath: new codegen_1.Name(\"schemaPath\"),\n    params: new codegen_1.Name(\"params\"),\n    propertyName: new codegen_1.Name(\"propertyName\"),\n    message: new codegen_1.Name(\"message\"),\n    schema: new codegen_1.Name(\"schema\"),\n    parentSchema: new codegen_1.Name(\"parentSchema\"),\n};\nfunction errorObjectCode(cxt, error) {\n    const { keyword, data, schemaValue, it: { gen, createErrors, topSchemaRef, schemaPath, errorPath, errSchemaPath, propertyName, opts }, } = cxt;\n    if (createErrors === false)\n        return codegen_1._ `{}`;\n    const { params, message } = error;\n    const keyValues = [\n        [E.keyword, keyword],\n        [names_1.default.dataPath, codegen_1.strConcat(names_1.default.dataPath, errorPath)],\n        [E.schemaPath, codegen_1.str `${errSchemaPath}/${keyword}`],\n        [E.params, typeof params == \"function\" ? params(cxt) : params || codegen_1._ `{}`],\n    ];\n    if (propertyName)\n        keyValues.push([E.propertyName, propertyName]);\n    if (opts.messages !== false) {\n        const msg = typeof message == \"function\" ? message(cxt) : message;\n        keyValues.push([E.message, msg]);\n    }\n    if (opts.verbose) {\n        keyValues.push([E.schema, schemaValue], [E.parentSchema, codegen_1._ `${topSchemaRef}${schemaPath}`], [names_1.default.data, data]);\n    }\n    return gen.object(...keyValues);\n}\n//# sourceMappingURL=errors.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.resolveSchema = exports.resolveRef = exports.compileSchema = exports.SchemaEnv = void 0;\nconst codegen_1 = require(\"./codegen\");\nconst error_classes_1 = require(\"./error_classes\");\nconst names_1 = require(\"./names\");\nconst resolve_1 = require(\"./resolve\");\nconst util_1 = require(\"./util\");\nconst validate_1 = require(\"./validate\");\nconst URI = require(\"uri-js\");\nclass SchemaEnv {\n    constructor(env) {\n        var _a;\n        this.refs = {};\n        this.dynamicAnchors = {};\n        let schema;\n        if (typeof env.schema == \"object\")\n            schema = env.schema;\n        this.schema = env.schema;\n        this.root = env.root || this;\n        this.baseId = (_a = env.baseId) !== null && _a !== void 0 ? _a : resolve_1.normalizeId(schema === null || schema === void 0 ? void 0 : schema.$id);\n        this.localRefs = env.localRefs;\n        this.meta = env.meta;\n        this.$async = schema === null || schema === void 0 ? void 0 : schema.$async;\n        this.refs = {};\n    }\n}\nexports.SchemaEnv = SchemaEnv;\n// let codeSize = 0\n// let nodeCount = 0\n// Compiles schema in SchemaEnv\nfunction compileSchema(sch) {\n    // TODO refactor - remove compilations\n    const _sch = getCompilingSchema.call(this, sch);\n    if (_sch)\n        return _sch;\n    const rootId = resolve_1.getFullPath(sch.root.baseId); // TODO if getFullPath removed 1 tests fails\n    const { es5, lines } = this.opts.code;\n    const { ownProperties } = this.opts;\n    const gen = new codegen_1.CodeGen(this.scope, { es5, lines, ownProperties });\n    let _ValidationError;\n    if (sch.$async) {\n        _ValidationError = gen.scopeValue(\"Error\", {\n            ref: error_classes_1.ValidationError,\n            code: codegen_1._ `require(\"ajv/dist/compile/error_classes\").ValidationError`,\n        });\n    }\n    const validateName = gen.scopeName(\"validate\");\n    sch.validateName = validateName;\n    const schemaCxt = {\n        gen,\n        allErrors: this.opts.allErrors,\n        data: names_1.default.data,\n        parentData: names_1.default.parentData,\n        parentDataProperty: names_1.default.parentDataProperty,\n        dataNames: [names_1.default.data],\n        dataPathArr: [codegen_1.nil],\n        dataLevel: 0,\n        dataTypes: [],\n        topSchemaRef: gen.scopeValue(\"schema\", this.opts.code.source === true\n            ? { ref: sch.schema, code: codegen_1.stringify(sch.schema) }\n            : { ref: sch.schema }),\n        validateName,\n        ValidationError: _ValidationError,\n        schema: sch.schema,\n        schemaEnv: sch,\n        strictSchema: true,\n        rootId,\n        baseId: sch.baseId || rootId,\n        schemaPath: codegen_1.nil,\n        errSchemaPath: \"#\",\n        errorPath: codegen_1._ `\"\"`,\n        opts: this.opts,\n        self: this,\n    };\n    let sourceCode;\n    try {\n        this._compilations.add(sch);\n        validate_1.validateFunctionCode(schemaCxt);\n        gen.optimize(this.opts.code.optimize);\n        // gen.optimize(1)\n        const validateCode = gen.toString();\n        sourceCode = `${gen.scopeRefs(names_1.default.scope)}return ${validateCode}`;\n        // console.log((codeSize += sourceCode.length), (nodeCount += gen.nodeCount))\n        if (this.opts.code.process)\n            sourceCode = this.opts.code.process(sourceCode, sch);\n        // console.log(\"\\n\\n\\n *** \\n\", sourceCode)\n        const makeValidate = new Function(`${names_1.default.self}`, `${names_1.default.scope}`, sourceCode);\n        const validate = makeValidate(this, this.scope.get());\n        this.scope.value(validateName, { ref: validate });\n        validate.errors = null;\n        validate.schema = sch.schema;\n        validate.schemaEnv = sch;\n        if (sch.$async)\n            validate.$async = true;\n        if (this.opts.code.source === true) {\n            validate.source = { validateName, validateCode, scopeValues: gen._values };\n        }\n        if (this.opts.unevaluated) {\n            const { props, items } = schemaCxt;\n            validate.evaluated = {\n                props: props instanceof codegen_1.Name ? undefined : props,\n                items: items instanceof codegen_1.Name ? undefined : items,\n                dynamicProps: props instanceof codegen_1.Name,\n                dynamicItems: items instanceof codegen_1.Name,\n            };\n            if (validate.source)\n                validate.source.evaluated = codegen_1.stringify(validate.evaluated);\n        }\n        sch.validate = validate;\n        return sch;\n    }\n    catch (e) {\n        delete sch.validate;\n        delete sch.validateName;\n        if (sourceCode)\n            this.logger.error(\"Error compiling schema, function code:\", sourceCode);\n        // console.log(\"\\n\\n\\n *** \\n\", sourceCode, this.opts)\n        throw e;\n    }\n    finally {\n        this._compilations.delete(sch);\n    }\n}\nexports.compileSchema = compileSchema;\nfunction resolveRef(root, baseId, ref) {\n    var _a;\n    ref = resolve_1.resolveUrl(baseId, ref);\n    const schOrFunc = root.refs[ref];\n    if (schOrFunc)\n        return schOrFunc;\n    let _sch = resolve.call(this, root, ref);\n    if (_sch === undefined) {\n        const schema = (_a = root.localRefs) === null || _a === void 0 ? void 0 : _a[ref]; // TODO maybe localRefs should hold SchemaEnv\n        if (schema)\n            _sch = new SchemaEnv({ schema, root, baseId });\n    }\n    if (_sch === undefined)\n        return;\n    return (root.refs[ref] = inlineOrCompile.call(this, _sch));\n}\nexports.resolveRef = resolveRef;\nfunction inlineOrCompile(sch) {\n    if (resolve_1.inlineRef(sch.schema, this.opts.inlineRefs))\n        return sch.schema;\n    return sch.validate ? sch : compileSchema.call(this, sch);\n}\n// Index of schema compilation in the currently compiled list\nfunction getCompilingSchema(schEnv) {\n    for (const sch of this._compilations) {\n        if (sameSchemaEnv(sch, schEnv))\n            return sch;\n    }\n}\nfunction sameSchemaEnv(s1, s2) {\n    return s1.schema === s2.schema && s1.root === s2.root && s1.baseId === s2.baseId;\n}\n// resolve and compile the references ($ref)\n// TODO returns AnySchemaObject (if the schema can be inlined) or validation function\nfunction resolve(root, // information about the root schema for the current schema\nref // reference to resolve\n) {\n    let sch;\n    while (typeof (sch = this.refs[ref]) == \"string\")\n        ref = sch;\n    return sch || this.schemas[ref] || resolveSchema.call(this, root, ref);\n}\n// Resolve schema, its root and baseId\nfunction resolveSchema(root, // root object with properties schema, refs TODO below SchemaEnv is assigned to it\nref // reference to resolve\n) {\n    const p = URI.parse(ref);\n    const refPath = resolve_1._getFullPath(p);\n    const baseId = resolve_1.getFullPath(root.baseId);\n    // TODO `Object.keys(root.schema).length > 0` should not be needed - but removing breaks 2 tests\n    if (Object.keys(root.schema).length > 0 && refPath === baseId) {\n        return getJsonPointer.call(this, p, root);\n    }\n    const id = resolve_1.normalizeId(refPath);\n    const schOrRef = this.refs[id] || this.schemas[id];\n    if (typeof schOrRef == \"string\") {\n        const sch = resolveSchema.call(this, root, schOrRef);\n        if (typeof (sch === null || sch === void 0 ? void 0 : sch.schema) !== \"object\")\n            return;\n        return getJsonPointer.call(this, p, sch);\n    }\n    if (typeof (schOrRef === null || schOrRef === void 0 ? void 0 : schOrRef.schema) !== \"object\")\n        return;\n    if (!schOrRef.validate)\n        compileSchema.call(this, schOrRef);\n    if (id === resolve_1.normalizeId(ref))\n        return new SchemaEnv({ schema: schOrRef.schema, root, baseId });\n    return getJsonPointer.call(this, p, schOrRef);\n}\nexports.resolveSchema = resolveSchema;\nconst PREVENT_SCOPE_CHANGE = new Set([\n    \"properties\",\n    \"patternProperties\",\n    \"enum\",\n    \"dependencies\",\n    \"definitions\",\n]);\nfunction getJsonPointer(parsedRef, { baseId, schema, root }) {\n    var _a;\n    if (((_a = parsedRef.fragment) === null || _a === void 0 ? void 0 : _a[0]) !== \"/\")\n        return;\n    for (const part of parsedRef.fragment.slice(1).split(\"/\")) {\n        if (typeof schema == \"boolean\")\n            return;\n        schema = schema[util_1.unescapeFragment(part)];\n        if (schema === undefined)\n            return;\n        // TODO PREVENT_SCOPE_CHANGE could be defined in keyword def?\n        if (!PREVENT_SCOPE_CHANGE.has(part) && typeof schema == \"object\" && schema.$id) {\n            baseId = resolve_1.resolveUrl(baseId, schema.$id);\n        }\n    }\n    let env;\n    if (typeof schema != \"boolean\" && schema.$ref && !util_1.schemaHasRulesButRef(schema, this.RULES)) {\n        const $ref = resolve_1.resolveUrl(baseId, schema.$ref);\n        env = resolveSchema.call(this, root, $ref);\n    }\n    // even though resolution failed we need to return SchemaEnv to throw exception\n    // so that compileAsync loads missing schema.\n    env = env || new SchemaEnv({ schema, root, baseId });\n    if (env.schema !== env.root.schema)\n        return env;\n    return undefined;\n}\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"./codegen\");\nconst names = {\n    // validation function arguments\n    data: new codegen_1.Name(\"data\"),\n    // args passed from referencing schema\n    valCxt: new codegen_1.Name(\"valCxt\"),\n    dataPath: new codegen_1.Name(\"dataPath\"),\n    parentData: new codegen_1.Name(\"parentData\"),\n    parentDataProperty: new codegen_1.Name(\"parentDataProperty\"),\n    rootData: new codegen_1.Name(\"rootData\"),\n    dynamicAnchors: new codegen_1.Name(\"dynamicAnchors\"),\n    // function scoped variables\n    vErrors: new codegen_1.Name(\"vErrors\"),\n    errors: new codegen_1.Name(\"errors\"),\n    this: new codegen_1.Name(\"this\"),\n    // \"globals\"\n    self: new codegen_1.Name(\"self\"),\n    scope: new codegen_1.Name(\"scope\"),\n};\nexports.default = names;\n//# sourceMappingURL=names.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getSchemaRefs = exports.resolveUrl = exports.normalizeId = exports._getFullPath = exports.getFullPath = exports.inlineRef = void 0;\nconst util_1 = require(\"./util\");\nconst equal = require(\"fast-deep-equal\");\nconst traverse = require(\"json-schema-traverse\");\nconst URI = require(\"uri-js\");\n// TODO refactor to use keyword definitions\nconst SIMPLE_INLINED = new Set([\n    \"type\",\n    \"format\",\n    \"pattern\",\n    \"maxLength\",\n    \"minLength\",\n    \"maxProperties\",\n    \"minProperties\",\n    \"maxItems\",\n    \"minItems\",\n    \"maximum\",\n    \"minimum\",\n    \"uniqueItems\",\n    \"multipleOf\",\n    \"required\",\n    \"enum\",\n    \"const\",\n]);\nfunction inlineRef(schema, limit = true) {\n    if (typeof schema == \"boolean\")\n        return true;\n    if (limit === true)\n        return !hasRef(schema);\n    if (!limit)\n        return false;\n    return countKeys(schema) <= limit;\n}\nexports.inlineRef = inlineRef;\nconst REF_KEYWORDS = new Set([\n    \"$ref\",\n    \"$recursiveRef\",\n    \"$recursiveAnchor\",\n    \"$dynamicRef\",\n    \"$dynamicAnchor\",\n]);\nfunction hasRef(schema) {\n    for (const key in schema) {\n        if (REF_KEYWORDS.has(key))\n            return true;\n        const sch = schema[key];\n        if (Array.isArray(sch) && sch.some(hasRef))\n            return true;\n        if (typeof sch == \"object\" && hasRef(sch))\n            return true;\n    }\n    return false;\n}\nfunction countKeys(schema) {\n    let count = 0;\n    for (const key in schema) {\n        if (key === \"$ref\")\n            return Infinity;\n        count++;\n        if (SIMPLE_INLINED.has(key))\n            continue;\n        if (typeof schema[key] == \"object\") {\n            util_1.eachItem(schema[key], (sch) => (count += countKeys(sch)));\n        }\n        if (count === Infinity)\n            return Infinity;\n    }\n    return count;\n}\nfunction getFullPath(id = \"\", normalize) {\n    if (normalize !== false)\n        id = normalizeId(id);\n    const p = URI.parse(id);\n    return _getFullPath(p);\n}\nexports.getFullPath = getFullPath;\nfunction _getFullPath(p) {\n    return URI.serialize(p).split(\"#\")[0] + \"#\";\n}\nexports._getFullPath = _getFullPath;\nconst TRAILING_SLASH_HASH = /#\\/?$/;\nfunction normalizeId(id) {\n    return id ? id.replace(TRAILING_SLASH_HASH, \"\") : \"\";\n}\nexports.normalizeId = normalizeId;\nfunction resolveUrl(baseId, id) {\n    id = normalizeId(id);\n    return URI.resolve(baseId, id);\n}\nexports.resolveUrl = resolveUrl;\nconst ANCHOR = /^[a-z_][-a-z0-9._]*$/i;\nfunction getSchemaRefs(schema) {\n    if (typeof schema == \"boolean\")\n        return {};\n    const schemaId = normalizeId(schema.$id);\n    const baseIds = { \"\": schemaId };\n    const pathPrefix = getFullPath(schemaId, false);\n    const localRefs = {};\n    const schemaRefs = new Set();\n    traverse(schema, { allKeys: true }, (sch, jsonPtr, _, parentJsonPtr) => {\n        if (parentJsonPtr === undefined)\n            return;\n        const fullPath = pathPrefix + jsonPtr;\n        let baseId = baseIds[parentJsonPtr];\n        if (typeof sch.$id == \"string\")\n            baseId = addRef.call(this, sch.$id);\n        addAnchor.call(this, sch.$anchor);\n        addAnchor.call(this, sch.$dynamicAnchor);\n        baseIds[jsonPtr] = baseId;\n        function addRef(ref) {\n            ref = normalizeId(baseId ? URI.resolve(baseId, ref) : ref);\n            if (schemaRefs.has(ref))\n                throw ambiguos(ref);\n            schemaRefs.add(ref);\n            let schOrRef = this.refs[ref];\n            if (typeof schOrRef == \"string\")\n                schOrRef = this.refs[schOrRef];\n            if (typeof schOrRef == \"object\") {\n                checkAmbiguosRef(sch, schOrRef.schema, ref);\n            }\n            else if (ref !== normalizeId(fullPath)) {\n                if (ref[0] === \"#\") {\n                    checkAmbiguosRef(sch, localRefs[ref], ref);\n                    localRefs[ref] = sch;\n                }\n                else {\n                    this.refs[ref] = fullPath;\n                }\n            }\n            return ref;\n        }\n        function addAnchor(anchor) {\n            if (typeof anchor == \"string\") {\n                if (!ANCHOR.test(anchor))\n                    throw new Error(`invalid anchor \"${anchor}\"`);\n                addRef.call(this, `#${anchor}`);\n            }\n        }\n    });\n    return localRefs;\n    function checkAmbiguosRef(sch1, sch2, ref) {\n        if (sch2 !== undefined && !equal(sch1, sch2))\n            throw ambiguos(ref);\n    }\n    function ambiguos(ref) {\n        return new Error(`reference \"${ref}\" resolves to more than one schema`);\n    }\n}\nexports.getSchemaRefs = getSchemaRefs;\n//# sourceMappingURL=resolve.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getRules = exports.isJSONType = void 0;\nconst _jsonTypes = [\"string\", \"number\", \"integer\", \"boolean\", \"null\", \"object\", \"array\"];\nconst jsonTypes = new Set(_jsonTypes);\nfunction isJSONType(x) {\n    return typeof x == \"string\" && jsonTypes.has(x);\n}\nexports.isJSONType = isJSONType;\nfunction getRules() {\n    const groups = {\n        number: { type: \"number\", rules: [] },\n        string: { type: \"string\", rules: [] },\n        array: { type: \"array\", rules: [] },\n        object: { type: \"object\", rules: [] },\n    };\n    return {\n        types: { ...groups, integer: true, boolean: true, null: true },\n        rules: [{ rules: [] }, groups.number, groups.string, groups.array, groups.object],\n        post: { rules: [] },\n        all: { type: true, $comment: true },\n        keywords: { type: true, $comment: true },\n    };\n}\nexports.getRules = getRules;\n//# sourceMappingURL=rules.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.applySubschema = exports.Type = void 0;\nconst validate_1 = require(\"./validate\");\nconst util_1 = require(\"./util\");\nconst codegen_1 = require(\"./codegen\");\nvar Type;\n(function (Type) {\n    Type[Type[\"Num\"] = 0] = \"Num\";\n    Type[Type[\"Str\"] = 1] = \"Str\";\n})(Type = exports.Type || (exports.Type = {}));\nfunction applySubschema(it, appl, valid) {\n    const subschema = getSubschema(it, appl);\n    extendSubschemaData(subschema, it, appl);\n    extendSubschemaMode(subschema, appl);\n    const nextContext = { ...it, ...subschema, items: undefined, props: undefined };\n    validate_1.subschemaCode(nextContext, valid);\n    return nextContext;\n}\nexports.applySubschema = applySubschema;\nfunction getSubschema(it, { keyword, schemaProp, schema, strictSchema, schemaPath, errSchemaPath, topSchemaRef, }) {\n    if (keyword !== undefined && schema !== undefined) {\n        throw new Error('both \"keyword\" and \"schema\" passed, only one allowed');\n    }\n    if (keyword !== undefined) {\n        const sch = it.schema[keyword];\n        return schemaProp === undefined\n            ? {\n                schema: sch,\n                schemaPath: codegen_1._ `${it.schemaPath}${codegen_1.getProperty(keyword)}`,\n                errSchemaPath: `${it.errSchemaPath}/${keyword}`,\n            }\n            : {\n                schema: sch[schemaProp],\n                schemaPath: codegen_1._ `${it.schemaPath}${codegen_1.getProperty(keyword)}${codegen_1.getProperty(schemaProp)}`,\n                errSchemaPath: `${it.errSchemaPath}/${keyword}/${util_1.escapeFragment(schemaProp)}`,\n            };\n    }\n    if (schema !== undefined) {\n        if (schemaPath === undefined || errSchemaPath === undefined || topSchemaRef === undefined) {\n            throw new Error('\"schemaPath\", \"errSchemaPath\" and \"topSchemaRef\" are required with \"schema\"');\n        }\n        return {\n            schema,\n            strictSchema,\n            schemaPath,\n            topSchemaRef,\n            errSchemaPath,\n        };\n    }\n    throw new Error('either \"keyword\" or \"schema\" must be passed');\n}\nfunction extendSubschemaData(subschema, it, { dataProp, dataPropType: dpType, data, dataTypes, propertyName }) {\n    if (data !== undefined && dataProp !== undefined) {\n        throw new Error('both \"data\" and \"dataProp\" passed, only one allowed');\n    }\n    const { gen } = it;\n    if (dataProp !== undefined) {\n        const { errorPath, dataPathArr, opts } = it;\n        const nextData = gen.let(\"data\", codegen_1._ `${it.data}${codegen_1.getProperty(dataProp)}`, true);\n        dataContextProps(nextData);\n        subschema.errorPath = codegen_1.str `${errorPath}${getErrorPath(dataProp, dpType, opts.jsPropertySyntax)}`;\n        subschema.parentDataProperty = codegen_1._ `${dataProp}`;\n        subschema.dataPathArr = [...dataPathArr, subschema.parentDataProperty];\n    }\n    if (data !== undefined) {\n        const nextData = data instanceof codegen_1.Name ? data : gen.let(\"data\", data, true); // replaceable if used once?\n        dataContextProps(nextData);\n        if (propertyName !== undefined)\n            subschema.propertyName = propertyName;\n        // TODO something is possibly wrong here with not changing parentDataProperty and not appending dataPathArr\n    }\n    if (dataTypes)\n        subschema.dataTypes = dataTypes;\n    function dataContextProps(_nextData) {\n        subschema.data = _nextData;\n        subschema.dataLevel = it.dataLevel + 1;\n        subschema.dataTypes = [];\n        subschema.parentData = it.data;\n        subschema.dataNames = [...it.dataNames, _nextData];\n    }\n}\nfunction extendSubschemaMode(subschema, { compositeRule, createErrors, allErrors, strictSchema }) {\n    if (compositeRule !== undefined)\n        subschema.compositeRule = compositeRule;\n    if (createErrors !== undefined)\n        subschema.createErrors = createErrors;\n    if (allErrors !== undefined)\n        subschema.allErrors = allErrors;\n    subschema.strictSchema = strictSchema; // not inherited\n}\nfunction getErrorPath(dataProp, dataPropType, jsPropertySyntax) {\n    // let path\n    if (dataProp instanceof codegen_1.Name) {\n        const isNumber = dataPropType === Type.Num;\n        return jsPropertySyntax\n            ? isNumber\n                ? codegen_1._ `\"[\" + ${dataProp} + \"]\"`\n                : codegen_1._ `\"['\" + ${dataProp} + \"']\"`\n            : isNumber\n                ? codegen_1._ `\"/\" + ${dataProp}`\n                : codegen_1._ `\"/\" + ${dataProp}.replace(/~/g, \"~0\").replace(/\\\\//g, \"~1\")`; // TODO maybe use global escapePointer\n    }\n    return jsPropertySyntax ? codegen_1.getProperty(dataProp).toString() : \"/\" + util_1.escapeJsonPointer(dataProp);\n}\n//# sourceMappingURL=subschema.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// https://mathiasbynens.be/notes/javascript-encoding\n// https://github.com/bestiejs/punycode.js - punycode.ucs2.decode\nfunction ucs2length(str) {\n    const len = str.length;\n    let length = 0;\n    let pos = 0;\n    let value;\n    while (pos < len) {\n        length++;\n        value = str.charCodeAt(pos++);\n        if (value >= 0xd800 && value <= 0xdbff && pos < len) {\n            // high surrogate, and there is a next character\n            value = str.charCodeAt(pos);\n            if ((value & 0xfc00) === 0xdc00)\n                pos++; // low surrogate\n        }\n    }\n    return length;\n}\nexports.default = ucs2length;\n//# sourceMappingURL=ucs2length.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.setEvaluated = exports.evaluatedPropsToName = exports.mergeEvaluated = exports.eachItem = exports.unescapeJsonPointer = exports.escapeJsonPointer = exports.escapeFragment = exports.unescapeFragment = exports.schemaRefOrVal = exports.schemaHasRulesButRef = exports.schemaHasRules = exports.checkUnknownRules = exports.alwaysValidSchema = exports.toHash = void 0;\nconst codegen_1 = require(\"./codegen\");\nconst validate_1 = require(\"./validate\");\n// TODO refactor to use Set\nfunction toHash(arr) {\n    const hash = {};\n    for (const item of arr)\n        hash[item] = true;\n    return hash;\n}\nexports.toHash = toHash;\nfunction alwaysValidSchema(it, schema) {\n    if (typeof schema == \"boolean\")\n        return schema;\n    if (Object.keys(schema).length === 0)\n        return true;\n    checkUnknownRules(it, schema);\n    return !schemaHasRules(schema, it.self.RULES.all);\n}\nexports.alwaysValidSchema = alwaysValidSchema;\nfunction checkUnknownRules(it, schema = it.schema) {\n    const { opts, self } = it;\n    if (!opts.strict)\n        return;\n    if (typeof schema === \"boolean\")\n        return;\n    const rules = self.RULES.keywords;\n    for (const key in schema) {\n        if (!rules[key])\n            validate_1.checkStrictMode(it, `unknown keyword: \"${key}\"`);\n    }\n}\nexports.checkUnknownRules = checkUnknownRules;\nfunction schemaHasRules(schema, rules) {\n    if (typeof schema == \"boolean\")\n        return !schema;\n    for (const key in schema)\n        if (rules[key])\n            return true;\n    return false;\n}\nexports.schemaHasRules = schemaHasRules;\nfunction schemaHasRulesButRef(schema, RULES) {\n    if (typeof schema == \"boolean\")\n        return !schema;\n    for (const key in schema)\n        if (key !== \"$ref\" && RULES.all[key])\n            return true;\n    return false;\n}\nexports.schemaHasRulesButRef = schemaHasRulesButRef;\nfunction schemaRefOrVal({ topSchemaRef, schemaPath }, schema, keyword, $data) {\n    if (!$data) {\n        if (typeof schema == \"number\" || typeof schema == \"boolean\")\n            return schema;\n        if (typeof schema == \"string\")\n            return codegen_1._ `${schema}`;\n    }\n    return codegen_1._ `${topSchemaRef}${schemaPath}${codegen_1.getProperty(keyword)}`;\n}\nexports.schemaRefOrVal = schemaRefOrVal;\nfunction unescapeFragment(str) {\n    return unescapeJsonPointer(decodeURIComponent(str));\n}\nexports.unescapeFragment = unescapeFragment;\nfunction escapeFragment(str) {\n    return encodeURIComponent(escapeJsonPointer(str));\n}\nexports.escapeFragment = escapeFragment;\nfunction escapeJsonPointer(str) {\n    if (typeof str == \"number\")\n        return `${str}`;\n    return str.replace(/~/g, \"~0\").replace(/\\//g, \"~1\");\n}\nexports.escapeJsonPointer = escapeJsonPointer;\nfunction unescapeJsonPointer(str) {\n    return str.replace(/~1/g, \"/\").replace(/~0/g, \"~\");\n}\nexports.unescapeJsonPointer = unescapeJsonPointer;\nfunction eachItem(xs, f) {\n    if (Array.isArray(xs)) {\n        for (const x of xs)\n            f(x);\n    }\n    else {\n        f(xs);\n    }\n}\nexports.eachItem = eachItem;\nfunction makeMergeEvaluated({ mergeNames, mergeToName, mergeValues, resultToName, }) {\n    return (gen, from, to, toName) => {\n        const res = to === undefined\n            ? from\n            : to instanceof codegen_1.Name\n                ? (from instanceof codegen_1.Name ? mergeNames(gen, from, to) : mergeToName(gen, from, to), to)\n                : from instanceof codegen_1.Name\n                    ? (mergeToName(gen, to, from), from)\n                    : mergeValues(from, to);\n        return toName === codegen_1.Name && !(res instanceof codegen_1.Name) ? resultToName(gen, res) : res;\n    };\n}\nexports.mergeEvaluated = {\n    props: makeMergeEvaluated({\n        mergeNames: (gen, from, to) => gen.if(codegen_1._ `${to} !== true && ${from} !== undefined`, () => {\n            gen.if(codegen_1._ `${from} === true`, () => gen.assign(to, true), () => gen.code(codegen_1._ `Object.assign(${to}, ${from})`));\n        }),\n        mergeToName: (gen, from, to) => gen.if(codegen_1._ `${to} !== true`, () => {\n            if (from === true) {\n                gen.assign(to, true);\n            }\n            else {\n                gen.assign(to, codegen_1._ `${to} || {}`);\n                setEvaluated(gen, to, from);\n            }\n        }),\n        mergeValues: (from, to) => (from === true ? true : { ...from, ...to }),\n        resultToName: evaluatedPropsToName,\n    }),\n    items: makeMergeEvaluated({\n        mergeNames: (gen, from, to) => gen.if(codegen_1._ `${to} !== true && ${from} !== undefined`, () => gen.assign(to, codegen_1._ `${from} === true ? true : ${to} > ${from} ? ${to} : ${from}`)),\n        mergeToName: (gen, from, to) => gen.if(codegen_1._ `${to} !== true`, () => gen.assign(to, from === true ? true : codegen_1._ `${to} > ${from} ? ${to} : ${from}`)),\n        mergeValues: (from, to) => (from === true ? true : Math.max(from, to)),\n        resultToName: (gen, items) => gen.var(\"items\", items),\n    }),\n};\nfunction evaluatedPropsToName(gen, ps) {\n    if (ps === true)\n        return gen.var(\"props\", true);\n    const props = gen.var(\"props\", codegen_1._ `{}`);\n    if (ps !== undefined)\n        setEvaluated(gen, props, ps);\n    return props;\n}\nexports.evaluatedPropsToName = evaluatedPropsToName;\nfunction setEvaluated(gen, props, ps) {\n    Object.keys(ps).forEach((p) => gen.assign(codegen_1._ `${props}${codegen_1.getProperty(p)}`, true));\n}\nexports.setEvaluated = setEvaluated;\n//# sourceMappingURL=util.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.shouldUseRule = exports.shouldUseGroup = exports.schemaHasRulesForType = void 0;\nfunction schemaHasRulesForType({ schema, self }, type) {\n    const group = self.RULES.types[type];\n    return group && group !== true && shouldUseGroup(schema, group);\n}\nexports.schemaHasRulesForType = schemaHasRulesForType;\nfunction shouldUseGroup(schema, group) {\n    return group.rules.some((rule) => shouldUseRule(schema, rule));\n}\nexports.shouldUseGroup = shouldUseGroup;\nfunction shouldUseRule(schema, rule) {\n    var _a;\n    return (schema[rule.keyword] !== undefined || ((_a = rule.definition.implements) === null || _a === void 0 ? void 0 : _a.some((kwd) => schema[kwd] !== undefined)));\n}\nexports.shouldUseRule = shouldUseRule;\n//# sourceMappingURL=applicability.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.boolOrEmptySchema = exports.topBoolOrEmptySchema = void 0;\nconst errors_1 = require(\"../errors\");\nconst codegen_1 = require(\"../codegen\");\nconst names_1 = require(\"../names\");\nconst boolError = {\n    message: \"boolean schema is false\",\n};\nfunction topBoolOrEmptySchema(it) {\n    const { gen, schema, validateName } = it;\n    if (schema === false) {\n        falseSchemaError(it, false);\n    }\n    else if (typeof schema == \"object\" && schema.$async === true) {\n        gen.return(names_1.default.data);\n    }\n    else {\n        gen.assign(codegen_1._ `${validateName}.errors`, null);\n        gen.return(true);\n    }\n}\nexports.topBoolOrEmptySchema = topBoolOrEmptySchema;\nfunction boolOrEmptySchema(it, valid) {\n    const { gen, schema } = it;\n    if (schema === false) {\n        gen.var(valid, false); // TODO var\n        falseSchemaError(it);\n    }\n    else {\n        gen.var(valid, true); // TODO var\n    }\n}\nexports.boolOrEmptySchema = boolOrEmptySchema;\nfunction falseSchemaError(it, overrideAllErrors) {\n    const { gen, data } = it;\n    // TODO maybe some other interface should be used for non-keyword validation errors...\n    const cxt = {\n        gen,\n        keyword: \"false schema\",\n        data,\n        schema: false,\n        schemaCode: false,\n        schemaValue: false,\n        params: {},\n        it,\n    };\n    errors_1.reportError(cxt, boolError, overrideAllErrors);\n}\n//# sourceMappingURL=boolSchema.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.reportTypeError = exports.checkDataTypes = exports.checkDataType = exports.coerceAndCheckDataType = exports.getJSONTypes = exports.getSchemaTypes = exports.DataType = void 0;\nconst rules_1 = require(\"../rules\");\nconst applicability_1 = require(\"./applicability\");\nconst errors_1 = require(\"../errors\");\nconst codegen_1 = require(\"../codegen\");\nconst util_1 = require(\"../util\");\nvar DataType;\n(function (DataType) {\n    DataType[DataType[\"Correct\"] = 0] = \"Correct\";\n    DataType[DataType[\"Wrong\"] = 1] = \"Wrong\";\n})(DataType = exports.DataType || (exports.DataType = {}));\nfunction getSchemaTypes(schema) {\n    const types = getJSONTypes(schema.type);\n    const hasNull = types.includes(\"null\");\n    if (hasNull) {\n        if (schema.nullable === false)\n            throw new Error(\"type: null contradicts nullable: false\");\n    }\n    else {\n        if (!types.length && schema.nullable !== undefined) {\n            throw new Error('\"nullable\" cannot be used without \"type\"');\n        }\n        if (schema.nullable === true)\n            types.push(\"null\");\n    }\n    return types;\n}\nexports.getSchemaTypes = getSchemaTypes;\nfunction getJSONTypes(ts) {\n    const types = Array.isArray(ts) ? ts : ts ? [ts] : [];\n    if (types.every(rules_1.isJSONType))\n        return types;\n    throw new Error(\"type must be JSONType or JSONType[]: \" + types.join(\",\"));\n}\nexports.getJSONTypes = getJSONTypes;\nfunction coerceAndCheckDataType(it, types) {\n    const { gen, data, opts } = it;\n    const coerceTo = coerceToTypes(types, opts.coerceTypes);\n    const checkTypes = types.length > 0 &&\n        !(coerceTo.length === 0 && types.length === 1 && applicability_1.schemaHasRulesForType(it, types[0]));\n    if (checkTypes) {\n        const wrongType = checkDataTypes(types, data, opts.strict, DataType.Wrong);\n        gen.if(wrongType, () => {\n            if (coerceTo.length)\n                coerceData(it, types, coerceTo);\n            else\n                reportTypeError(it);\n        });\n    }\n    return checkTypes;\n}\nexports.coerceAndCheckDataType = coerceAndCheckDataType;\nconst COERCIBLE = new Set([\"string\", \"number\", \"integer\", \"boolean\", \"null\"]);\nfunction coerceToTypes(types, coerceTypes) {\n    return coerceTypes\n        ? types.filter((t) => COERCIBLE.has(t) || (coerceTypes === \"array\" && t === \"array\"))\n        : [];\n}\nfunction coerceData(it, types, coerceTo) {\n    const { gen, data, opts } = it;\n    const dataType = gen.let(\"dataType\", codegen_1._ `typeof ${data}`);\n    const coerced = gen.let(\"coerced\", codegen_1._ `undefined`);\n    if (opts.coerceTypes === \"array\") {\n        gen.if(codegen_1._ `${dataType} == 'object' && Array.isArray(${data}) && ${data}.length == 1`, () => gen\n            .assign(data, codegen_1._ `${data}[0]`)\n            .assign(dataType, codegen_1._ `typeof ${data}`)\n            .if(checkDataTypes(types, data, opts.strict), () => gen.assign(coerced, data)));\n    }\n    gen.if(codegen_1._ `${coerced} !== undefined`);\n    for (const t of coerceTo) {\n        if (COERCIBLE.has(t) || (t === \"array\" && opts.coerceTypes === \"array\")) {\n            coerceSpecificType(t);\n        }\n    }\n    gen.else();\n    reportTypeError(it);\n    gen.endIf();\n    gen.if(codegen_1._ `${coerced} !== undefined`, () => {\n        gen.assign(data, coerced);\n        assignParentData(it, coerced);\n    });\n    function coerceSpecificType(t) {\n        switch (t) {\n            case \"string\":\n                gen\n                    .elseIf(codegen_1._ `${dataType} == \"number\" || ${dataType} == \"boolean\"`)\n                    .assign(coerced, codegen_1._ `\"\" + ${data}`)\n                    .elseIf(codegen_1._ `${data} === null`)\n                    .assign(coerced, codegen_1._ `\"\"`);\n                return;\n            case \"number\":\n                gen\n                    .elseIf(codegen_1._ `${dataType} == \"boolean\" || ${data} === null\n              || (${dataType} == \"string\" && ${data} && ${data} == +${data})`)\n                    .assign(coerced, codegen_1._ `+${data}`);\n                return;\n            case \"integer\":\n                gen\n                    .elseIf(codegen_1._ `${dataType} === \"boolean\" || ${data} === null\n              || (${dataType} === \"string\" && ${data} && ${data} == +${data} && !(${data} % 1))`)\n                    .assign(coerced, codegen_1._ `+${data}`);\n                return;\n            case \"boolean\":\n                gen\n                    .elseIf(codegen_1._ `${data} === \"false\" || ${data} === 0 || ${data} === null`)\n                    .assign(coerced, false)\n                    .elseIf(codegen_1._ `${data} === \"true\" || ${data} === 1`)\n                    .assign(coerced, true);\n                return;\n            case \"null\":\n                gen.elseIf(codegen_1._ `${data} === \"\" || ${data} === 0 || ${data} === false`);\n                gen.assign(coerced, null);\n                return;\n            case \"array\":\n                gen\n                    .elseIf(codegen_1._ `${dataType} === \"string\" || ${dataType} === \"number\"\n              || ${dataType} === \"boolean\" || ${data} === null`)\n                    .assign(coerced, codegen_1._ `[${data}]`);\n        }\n    }\n}\nfunction assignParentData({ gen, parentData, parentDataProperty }, expr) {\n    // TODO use gen.property\n    gen.if(codegen_1._ `${parentData} !== undefined`, () => gen.assign(codegen_1._ `${parentData}[${parentDataProperty}]`, expr));\n}\nfunction checkDataType(dataType, data, strictNums, correct = DataType.Correct) {\n    const EQ = correct === DataType.Correct ? codegen_1.operators.EQ : codegen_1.operators.NEQ;\n    let cond;\n    switch (dataType) {\n        case \"null\":\n            return codegen_1._ `${data} ${EQ} null`;\n        case \"array\":\n            cond = codegen_1._ `Array.isArray(${data})`;\n            break;\n        case \"object\":\n            cond = codegen_1._ `${data} && typeof ${data} == \"object\" && !Array.isArray(${data})`;\n            break;\n        case \"integer\":\n            cond = numCond(codegen_1._ `!(${data} % 1) && !isNaN(${data})`);\n            break;\n        case \"number\":\n            cond = numCond();\n            break;\n        default:\n            return codegen_1._ `typeof ${data} ${EQ} ${dataType}`;\n    }\n    return correct === DataType.Correct ? cond : codegen_1.not(cond);\n    function numCond(_cond = codegen_1.nil) {\n        return codegen_1.and(codegen_1._ `typeof ${data} == \"number\"`, _cond, strictNums ? codegen_1._ `isFinite(${data})` : codegen_1.nil);\n    }\n}\nexports.checkDataType = checkDataType;\nfunction checkDataTypes(dataTypes, data, strictNums, correct) {\n    if (dataTypes.length === 1) {\n        return checkDataType(dataTypes[0], data, strictNums, correct);\n    }\n    let cond;\n    const types = util_1.toHash(dataTypes);\n    if (types.array && types.object) {\n        const notObj = codegen_1._ `typeof ${data} != \"object\"`;\n        cond = types.null ? notObj : codegen_1._ `!${data} || ${notObj}`;\n        delete types.null;\n        delete types.array;\n        delete types.object;\n    }\n    else {\n        cond = codegen_1.nil;\n    }\n    if (types.number)\n        delete types.integer;\n    for (const t in types)\n        cond = codegen_1.and(cond, checkDataType(t, data, strictNums, correct));\n    return cond;\n}\nexports.checkDataTypes = checkDataTypes;\nconst typeError = {\n    message: ({ schema }) => codegen_1.str `should be ${schema}`,\n    params: ({ schema, schemaValue }) => typeof schema == \"string\" ? codegen_1._ `{type: ${schema}}` : codegen_1._ `{type: ${schemaValue}}`,\n};\nfunction reportTypeError(it) {\n    const cxt = getTypeErrorContext(it);\n    errors_1.reportError(cxt, typeError);\n}\nexports.reportTypeError = reportTypeError;\nfunction getTypeErrorContext(it) {\n    const { gen, data, schema } = it;\n    const schemaCode = util_1.schemaRefOrVal(it, schema, \"type\");\n    return {\n        gen,\n        keyword: \"type\",\n        data,\n        schema: schema.type,\n        schemaCode,\n        schemaValue: schemaCode,\n        parentSchema: schema,\n        params: {},\n        it,\n    };\n}\n//# sourceMappingURL=dataType.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.assignDefaults = void 0;\nconst codegen_1 = require(\"../codegen\");\nconst _1 = require(\".\");\nfunction assignDefaults(it, ty) {\n    const { properties, items } = it.schema;\n    if (ty === \"object\" && properties) {\n        for (const key in properties) {\n            assignDefault(it, key, properties[key].default);\n        }\n    }\n    else if (ty === \"array\" && Array.isArray(items)) {\n        items.forEach((sch, i) => assignDefault(it, i, sch.default));\n    }\n}\nexports.assignDefaults = assignDefaults;\nfunction assignDefault(it, prop, defaultValue) {\n    const { gen, compositeRule, data, opts } = it;\n    if (defaultValue === undefined)\n        return;\n    const childData = codegen_1._ `${data}${codegen_1.getProperty(prop)}`;\n    if (compositeRule) {\n        _1.checkStrictMode(it, `default is ignored for: ${childData}`);\n        return;\n    }\n    let condition = codegen_1._ `${childData} === undefined`;\n    if (opts.useDefaults === \"empty\") {\n        condition = codegen_1._ `${condition} || ${childData} === null || ${childData} === \"\"`;\n    }\n    // `${childData} === undefined` +\n    // (opts.useDefaults === \"empty\" ? ` || ${childData} === null || ${childData} === \"\"` : \"\")\n    gen.if(condition, codegen_1._ `${childData} = ${codegen_1.stringify(defaultValue)}`);\n}\n//# sourceMappingURL=defaults.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.checkStrictMode = exports.schemaCxtHasRules = exports.subschemaCode = exports.validateFunctionCode = void 0;\nconst boolSchema_1 = require(\"./boolSchema\");\nconst dataType_1 = require(\"./dataType\");\nconst iterate_1 = require(\"./iterate\");\nconst codegen_1 = require(\"../codegen\");\nconst names_1 = require(\"../names\");\nconst resolve_1 = require(\"../resolve\");\nconst util_1 = require(\"../util\");\n// schema compilation - generates validation function, subschemaCode (below) is used for subschemas\nfunction validateFunctionCode(it) {\n    if (isSchemaObj(it)) {\n        checkKeywords(it);\n        if (schemaCxtHasRules(it)) {\n            topSchemaObjCode(it);\n            return;\n        }\n    }\n    validateFunction(it, () => boolSchema_1.topBoolOrEmptySchema(it));\n}\nexports.validateFunctionCode = validateFunctionCode;\nfunction validateFunction({ gen, validateName, schema, schemaEnv, opts }, body) {\n    if (opts.code.es5) {\n        gen.func(validateName, codegen_1._ `${names_1.default.data}, ${names_1.default.valCxt}`, schemaEnv.$async, () => {\n            gen.code(codegen_1._ `\"use strict\"; ${funcSourceUrl(schema, opts)}`);\n            destructureValCxtES5(gen, opts);\n            gen.code(body);\n        });\n    }\n    else {\n        gen.func(validateName, codegen_1._ `${names_1.default.data}, ${destructureValCxt(opts)}`, schemaEnv.$async, () => gen.code(funcSourceUrl(schema, opts)).code(body));\n    }\n}\nfunction destructureValCxt(opts) {\n    return codegen_1._ `{${names_1.default.dataPath}=\"\", ${names_1.default.parentData}, ${names_1.default.parentDataProperty}, ${names_1.default.rootData}=${names_1.default.data}${opts.dynamicRef ? codegen_1._ `, ${names_1.default.dynamicAnchors}={}` : codegen_1.nil}}={}`;\n}\nfunction destructureValCxtES5(gen, opts) {\n    gen.if(names_1.default.valCxt, () => {\n        gen.var(names_1.default.dataPath, codegen_1._ `${names_1.default.valCxt}.${names_1.default.dataPath}`);\n        gen.var(names_1.default.parentData, codegen_1._ `${names_1.default.valCxt}.${names_1.default.parentData}`);\n        gen.var(names_1.default.parentDataProperty, codegen_1._ `${names_1.default.valCxt}.${names_1.default.parentDataProperty}`);\n        gen.var(names_1.default.rootData, codegen_1._ `${names_1.default.valCxt}.${names_1.default.rootData}`);\n        if (opts.dynamicRef)\n            gen.var(names_1.default.dynamicAnchors, codegen_1._ `${names_1.default.valCxt}.${names_1.default.dynamicAnchors}`);\n    }, () => {\n        gen.var(names_1.default.dataPath, codegen_1._ `\"\"`);\n        gen.var(names_1.default.parentData, codegen_1._ `undefined`);\n        gen.var(names_1.default.parentDataProperty, codegen_1._ `undefined`);\n        gen.var(names_1.default.rootData, names_1.default.data);\n        if (opts.dynamicRef)\n            gen.var(names_1.default.dynamicAnchors, codegen_1._ `{}`);\n    });\n}\nfunction topSchemaObjCode(it) {\n    const { schema, opts, gen } = it;\n    validateFunction(it, () => {\n        if (opts.$comment && schema.$comment)\n            commentKeyword(it);\n        checkNoDefault(it);\n        gen.let(names_1.default.vErrors, null);\n        gen.let(names_1.default.errors, 0);\n        if (opts.unevaluated)\n            resetEvaluated(it);\n        typeAndKeywords(it);\n        returnResults(it);\n    });\n    return;\n}\nfunction resetEvaluated(it) {\n    // TODO maybe some hook to execute it in the end to check whether props/items are Name, as in assignEvaluated\n    const { gen, validateName } = it;\n    it.evaluated = gen.const(\"evaluated\", codegen_1._ `${validateName}.evaluated`);\n    gen.if(codegen_1._ `${it.evaluated}.dynamicProps`, () => gen.assign(codegen_1._ `${it.evaluated}.props`, codegen_1._ `undefined`));\n    gen.if(codegen_1._ `${it.evaluated}.dynamicItems`, () => gen.assign(codegen_1._ `${it.evaluated}.items`, codegen_1._ `undefined`));\n}\nfunction funcSourceUrl(schema, opts) {\n    return typeof schema == \"object\" && schema.$id && (opts.code.source || opts.code.process)\n        ? codegen_1._ `/*# sourceURL=${schema.$id} */`\n        : codegen_1.nil;\n}\n// schema compilation - this function is used recursively to generate code for sub-schemas\nfunction subschemaCode(it, valid) {\n    if (isSchemaObj(it)) {\n        checkKeywords(it);\n        if (schemaCxtHasRules(it)) {\n            subSchemaObjCode(it, valid);\n            return;\n        }\n    }\n    boolSchema_1.boolOrEmptySchema(it, valid);\n}\nexports.subschemaCode = subschemaCode;\nfunction schemaCxtHasRules({ schema, self }) {\n    if (typeof schema == \"boolean\")\n        return !schema;\n    for (const key in schema)\n        if (self.RULES.all[key])\n            return true;\n    return false;\n}\nexports.schemaCxtHasRules = schemaCxtHasRules;\nfunction isSchemaObj(it) {\n    return typeof it.schema != \"boolean\";\n}\nfunction subSchemaObjCode(it, valid) {\n    const { schema, gen, opts } = it;\n    if (opts.$comment && schema.$comment)\n        commentKeyword(it);\n    updateContext(it);\n    checkAsync(it);\n    const errsCount = gen.const(\"_errs\", names_1.default.errors);\n    typeAndKeywords(it, errsCount);\n    // TODO var\n    gen.var(valid, codegen_1._ `${errsCount} === ${names_1.default.errors}`);\n}\nfunction checkKeywords(it) {\n    util_1.checkUnknownRules(it);\n    checkRefsAndKeywords(it);\n}\nfunction typeAndKeywords(it, errsCount) {\n    const types = dataType_1.getSchemaTypes(it.schema);\n    const checkedTypes = dataType_1.coerceAndCheckDataType(it, types);\n    iterate_1.schemaKeywords(it, types, !checkedTypes, errsCount);\n}\nfunction checkRefsAndKeywords(it) {\n    const { schema, errSchemaPath, opts, self } = it;\n    if (schema.$ref && opts.ignoreKeywordsWithRef && util_1.schemaHasRulesButRef(schema, self.RULES)) {\n        self.logger.warn(`$ref: keywords ignored in schema at path \"${errSchemaPath}\"`);\n    }\n}\nfunction checkNoDefault(it) {\n    const { schema, opts } = it;\n    if (schema.default !== undefined && opts.useDefaults && opts.strict) {\n        checkStrictMode(it, \"default is ignored in the schema root\");\n    }\n}\nfunction updateContext(it) {\n    if (it.schema.$id)\n        it.baseId = resolve_1.resolveUrl(it.baseId, it.schema.$id);\n}\nfunction checkAsync(it) {\n    if (it.schema.$async && !it.schemaEnv.$async)\n        throw new Error(\"async schema in sync schema\");\n}\nfunction commentKeyword({ gen, schemaEnv, schema, errSchemaPath, opts }) {\n    const msg = schema.$comment;\n    if (opts.$comment === true) {\n        gen.code(codegen_1._ `${names_1.default.self}.logger.log(${msg})`);\n    }\n    else if (typeof opts.$comment == \"function\") {\n        const schemaPath = codegen_1.str `${errSchemaPath}/$comment`;\n        const rootName = gen.scopeValue(\"root\", { ref: schemaEnv.root });\n        gen.code(codegen_1._ `${names_1.default.self}.opts.$comment(${msg}, ${schemaPath}, ${rootName}.schema)`);\n    }\n}\nfunction returnResults(it) {\n    const { gen, schemaEnv, validateName, ValidationError, opts } = it;\n    if (schemaEnv.$async) {\n        // TODO assign unevaluated\n        gen.if(codegen_1._ `${names_1.default.errors} === 0`, () => gen.return(names_1.default.data), () => gen.throw(codegen_1._ `new ${ValidationError}(${names_1.default.vErrors})`));\n    }\n    else {\n        gen.assign(codegen_1._ `${validateName}.errors`, names_1.default.vErrors);\n        if (opts.unevaluated)\n            assignEvaluated(it);\n        gen.return(codegen_1._ `${names_1.default.errors} === 0`);\n    }\n}\nfunction assignEvaluated({ gen, evaluated, props, items }) {\n    if (props instanceof codegen_1.Name)\n        gen.assign(codegen_1._ `${evaluated}.props`, props);\n    if (items instanceof codegen_1.Name)\n        gen.assign(codegen_1._ `${evaluated}.items`, items);\n}\nfunction checkStrictMode(it, msg, mode = it.opts.strict) {\n    if (!mode)\n        return;\n    msg = `strict mode: ${msg}`;\n    if (mode === true)\n        throw new Error(msg);\n    it.self.logger.warn(msg);\n}\nexports.checkStrictMode = checkStrictMode;\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.schemaKeywords = void 0;\nconst applicability_1 = require(\"./applicability\");\nconst dataType_1 = require(\"./dataType\");\nconst defaults_1 = require(\"./defaults\");\nconst dataType_2 = require(\"./dataType\");\nconst keyword_1 = require(\"./keyword\");\nconst util_1 = require(\"../util\");\nconst _1 = require(\".\");\nconst codegen_1 = require(\"../codegen\");\nconst names_1 = require(\"../names\");\nfunction schemaKeywords(it, types, typeErrors, errsCount) {\n    const { gen, schema, data, allErrors, opts, self } = it;\n    const { RULES } = self;\n    if (schema.$ref && (opts.ignoreKeywordsWithRef || !util_1.schemaHasRulesButRef(schema, RULES))) {\n        gen.block(() => keyword_1.keywordCode(it, \"$ref\", RULES.all.$ref.definition)); // TODO typecast\n        return;\n    }\n    checkStrictTypes(it, types);\n    gen.block(() => {\n        for (const group of RULES.rules)\n            groupKeywords(group);\n        groupKeywords(RULES.post);\n    });\n    function groupKeywords(group) {\n        if (!applicability_1.shouldUseGroup(schema, group))\n            return;\n        if (group.type) {\n            gen.if(dataType_1.checkDataType(group.type, data, opts.strict));\n            iterateKeywords(it, group);\n            if (types.length === 1 && types[0] === group.type && typeErrors) {\n                gen.else();\n                dataType_2.reportTypeError(it);\n            }\n            gen.endIf();\n        }\n        else {\n            iterateKeywords(it, group);\n        }\n        // TODO make it \"ok\" call?\n        if (!allErrors)\n            gen.if(codegen_1._ `${names_1.default.errors} === ${errsCount || 0}`);\n    }\n}\nexports.schemaKeywords = schemaKeywords;\nfunction iterateKeywords(it, group) {\n    const { gen, schema, opts: { useDefaults }, } = it;\n    if (useDefaults)\n        defaults_1.assignDefaults(it, group.type);\n    gen.block(() => {\n        for (const rule of group.rules) {\n            if (applicability_1.shouldUseRule(schema, rule)) {\n                keyword_1.keywordCode(it, rule.keyword, rule.definition, group.type);\n            }\n        }\n    });\n}\nfunction checkStrictTypes(it, types) {\n    if (it.schemaEnv.meta || !it.opts.strictTypes)\n        return;\n    checkContextTypes(it, types);\n    if (!it.opts.allowUnionTypes)\n        checkMultipleTypes(it, types);\n    checkKeywordTypes(it, it.dataTypes);\n}\nfunction checkContextTypes(it, types) {\n    if (!types.length)\n        return;\n    if (!it.dataTypes.length) {\n        it.dataTypes = types;\n        return;\n    }\n    types.forEach((t) => {\n        if (!includesType(it.dataTypes, t)) {\n            strictTypesError(it, `type \"${t}\" not allowed by context \"${it.dataTypes.join(\",\")}\"`);\n        }\n    });\n    it.dataTypes = it.dataTypes.filter((t) => includesType(types, t));\n}\nfunction checkMultipleTypes(it, ts) {\n    if (ts.length > 1 && !(ts.length === 2 && ts.includes(\"null\"))) {\n        strictTypesError(it, \"use allowUnionTypes to allow union type keyword\");\n    }\n}\nfunction checkKeywordTypes(it, ts) {\n    const rules = it.self.RULES.all;\n    for (const keyword in rules) {\n        const rule = rules[keyword];\n        if (typeof rule == \"object\" && applicability_1.shouldUseRule(it.schema, rule)) {\n            const { type } = rule.definition;\n            if (type.length && !type.some((t) => hasApplicableType(ts, t))) {\n                strictTypesError(it, `missing type \"${type.join(\",\")}\" for keyword \"${keyword}\"`);\n            }\n        }\n    }\n}\nfunction hasApplicableType(schTs, kwdT) {\n    return schTs.includes(kwdT) || (kwdT === \"number\" && schTs.includes(\"integer\"));\n}\nfunction includesType(ts, t) {\n    return ts.includes(t) || (t === \"integer\" && ts.includes(\"number\"));\n}\nfunction strictTypesError(it, msg) {\n    const schemaPath = it.schemaEnv.baseId + it.errSchemaPath;\n    msg += ` at \"${schemaPath}\" (strictTypes)`;\n    _1.checkStrictMode(it, msg, it.opts.strictTypes);\n}\n//# sourceMappingURL=iterate.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.keywordCode = void 0;\nconst context_1 = require(\"../context\");\nconst errors_1 = require(\"../errors\");\nconst code_1 = require(\"../../vocabularies/code\");\nconst codegen_1 = require(\"../codegen\");\nconst names_1 = require(\"../names\");\nfunction keywordCode(it, keyword, def, ruleType) {\n    const cxt = new context_1.default(it, def, keyword);\n    if (\"code\" in def) {\n        def.code(cxt, ruleType);\n    }\n    else if (cxt.$data && def.validate) {\n        funcKeywordCode(cxt, def);\n    }\n    else if (\"macro\" in def) {\n        macroKeywordCode(cxt, def);\n    }\n    else if (def.compile || def.validate) {\n        funcKeywordCode(cxt, def);\n    }\n}\nexports.keywordCode = keywordCode;\nfunction macroKeywordCode(cxt, def) {\n    const { gen, keyword, schema, parentSchema, it } = cxt;\n    const macroSchema = def.macro.call(it.self, schema, parentSchema, it);\n    const schemaRef = useKeyword(gen, keyword, macroSchema);\n    if (it.opts.validateSchema !== false)\n        it.self.validateSchema(macroSchema, true);\n    const valid = gen.name(\"valid\");\n    cxt.subschema({\n        schema: macroSchema,\n        schemaPath: codegen_1.nil,\n        errSchemaPath: `${it.errSchemaPath}/${keyword}`,\n        topSchemaRef: schemaRef,\n        compositeRule: true,\n    }, valid);\n    cxt.pass(valid, () => cxt.error(true));\n}\nfunction funcKeywordCode(cxt, def) {\n    var _a;\n    const { gen, keyword, schema, parentSchema, $data, it } = cxt;\n    checkAsync(it, def);\n    const validate = !$data && def.compile ? def.compile.call(it.self, schema, parentSchema, it) : def.validate;\n    const validateRef = useKeyword(gen, keyword, validate);\n    const valid = gen.let(\"valid\");\n    cxt.block$data(valid, validateKeyword);\n    cxt.ok((_a = def.valid) !== null && _a !== void 0 ? _a : valid);\n    function validateKeyword() {\n        if (def.errors === false) {\n            assignValid();\n            if (def.modifying)\n                modifyData(cxt);\n            reportErrs(() => cxt.error());\n        }\n        else {\n            const ruleErrs = def.async ? validateAsync() : validateSync();\n            if (def.modifying)\n                modifyData(cxt);\n            reportErrs(() => addErrs(cxt, ruleErrs));\n        }\n    }\n    function validateAsync() {\n        const ruleErrs = gen.let(\"ruleErrs\", null);\n        gen.try(() => assignValid(codegen_1._ `await `), (e) => gen.assign(valid, false).if(codegen_1._ `${e} instanceof ${it.ValidationError}`, () => gen.assign(ruleErrs, codegen_1._ `${e}.errors`), () => gen.throw(e)));\n        return ruleErrs;\n    }\n    function validateSync() {\n        const validateErrs = codegen_1._ `${validateRef}.errors`;\n        gen.assign(validateErrs, null);\n        assignValid(codegen_1.nil);\n        return validateErrs;\n    }\n    function assignValid(_await = def.async ? codegen_1._ `await ` : codegen_1.nil) {\n        const passCxt = it.opts.passContext ? names_1.default.this : names_1.default.self;\n        const passSchema = !((\"compile\" in def && !$data) || def.schema === false);\n        gen.assign(valid, codegen_1._ `${_await}${code_1.callValidateCode(cxt, validateRef, passCxt, passSchema)}`, def.modifying);\n    }\n    function reportErrs(errors) {\n        var _a;\n        gen.if(codegen_1.not((_a = def.valid) !== null && _a !== void 0 ? _a : valid), errors);\n    }\n}\nfunction modifyData(cxt) {\n    const { gen, data, it } = cxt;\n    gen.if(it.parentData, () => gen.assign(data, codegen_1._ `${it.parentData}[${it.parentDataProperty}]`));\n}\nfunction addErrs(cxt, errs) {\n    const { gen } = cxt;\n    gen.if(codegen_1._ `Array.isArray(${errs})`, () => {\n        gen\n            .assign(names_1.default.vErrors, codegen_1._ `${names_1.default.vErrors} === null ? ${errs} : ${names_1.default.vErrors}.concat(${errs})`)\n            .assign(names_1.default.errors, codegen_1._ `${names_1.default.vErrors}.length`);\n        errors_1.extendErrors(cxt);\n    }, () => cxt.error());\n}\nfunction checkAsync({ schemaEnv }, def) {\n    if (def.async && !schemaEnv.$async)\n        throw new Error(\"async keyword in sync schema\");\n}\nfunction useKeyword(gen, keyword, result) {\n    if (result === undefined)\n        throw new Error(`keyword \"${keyword}\" failed to compile`);\n    return gen.scopeValue(\"keyword\", typeof result == \"function\" ? { ref: result } : { ref: result, code: codegen_1.stringify(result) });\n}\n//# sourceMappingURL=keyword.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CodeGen = exports.Name = exports.nil = exports.stringify = exports.str = exports._ = exports.KeywordCxt = void 0;\nconst context_1 = require(\"./compile/context\");\nexports.KeywordCxt = context_1.default;\nvar codegen_1 = require(\"./compile/codegen\");\nObject.defineProperty(exports, \"_\", { enumerable: true, get: function () { return codegen_1._; } });\nObject.defineProperty(exports, \"str\", { enumerable: true, get: function () { return codegen_1.str; } });\nObject.defineProperty(exports, \"stringify\", { enumerable: true, get: function () { return codegen_1.stringify; } });\nObject.defineProperty(exports, \"nil\", { enumerable: true, get: function () { return codegen_1.nil; } });\nObject.defineProperty(exports, \"Name\", { enumerable: true, get: function () { return codegen_1.Name; } });\nObject.defineProperty(exports, \"CodeGen\", { enumerable: true, get: function () { return codegen_1.CodeGen; } });\nconst error_classes_1 = require(\"./compile/error_classes\");\nconst rules_1 = require(\"./compile/rules\");\nconst compile_1 = require(\"./compile\");\nconst codegen_2 = require(\"./compile/codegen\");\nconst resolve_1 = require(\"./compile/resolve\");\nconst dataType_1 = require(\"./compile/validate/dataType\");\nconst util_1 = require(\"./compile/util\");\nconst $dataRefSchema = require(\"./refs/data.json\");\nconst META_IGNORE_OPTIONS = [\"removeAdditional\", \"useDefaults\", \"coerceTypes\"];\nconst EXT_SCOPE_NAMES = new Set([\n    \"validate\",\n    \"wrapper\",\n    \"root\",\n    \"schema\",\n    \"keyword\",\n    \"pattern\",\n    \"formats\",\n    \"validate$data\",\n    \"func\",\n    \"obj\",\n    \"Error\",\n]);\nconst removedOptions = {\n    errorDataPath: \"\",\n    format: \"`validateFormats: false` can be used instead.\",\n    nullable: '\"nullable\" keyword is supported by default.',\n    jsonPointers: \"Deprecated jsPropertySyntax can be used instead.\",\n    extendRefs: \"Deprecated ignoreKeywordsWithRef can be used instead.\",\n    missingRefs: \"Pass empty schema with $id that should be ignored to ajv.addSchema.\",\n    processCode: \"Use option `code: {process: (code, schemaEnv: object) => string}`\",\n    sourceCode: \"Use option `code: {source: true}`\",\n    schemaId: \"JSON Schema draft-04 is not supported in Ajv v7.\",\n    strictDefaults: \"It is default now, see option `strict`.\",\n    strictKeywords: \"It is default now, see option `strict`.\",\n    strictNumbers: \"It is default now, see option `strict`.\",\n    uniqueItems: '\"uniqueItems\" keyword is always validated.',\n    unknownFormats: \"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).\",\n    cache: \"Map is used as cache, schema object as key.\",\n    serialize: \"Map is used as cache, schema object as key.\",\n};\nconst deprecatedOptions = {\n    ignoreKeywordsWithRef: \"\",\n    jsPropertySyntax: \"\",\n    unicode: '\"minLength\"/\"maxLength\" account for unicode characters by default.',\n};\nfunction requiredOptions(o) {\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m;\n    const strict = (_a = o.strict) !== null && _a !== void 0 ? _a : true;\n    const strictLog = strict ? \"log\" : false;\n    const _optz = (_b = o.code) === null || _b === void 0 ? void 0 : _b.optimize;\n    const optimize = _optz === true || _optz === undefined ? 1 : _optz || 0;\n    return {\n        strict,\n        strictTypes: (_c = o.strictTypes) !== null && _c !== void 0 ? _c : strictLog,\n        strictTuples: (_d = o.strictTuples) !== null && _d !== void 0 ? _d : strictLog,\n        code: o.code ? { ...o.code, optimize } : { optimize },\n        loopRequired: (_e = o.loopRequired) !== null && _e !== void 0 ? _e : Infinity,\n        loopEnum: (_f = o.loopEnum) !== null && _f !== void 0 ? _f : Infinity,\n        meta: (_g = o.meta) !== null && _g !== void 0 ? _g : true,\n        messages: (_h = o.messages) !== null && _h !== void 0 ? _h : true,\n        inlineRefs: (_j = o.inlineRefs) !== null && _j !== void 0 ? _j : true,\n        addUsedSchema: (_k = o.addUsedSchema) !== null && _k !== void 0 ? _k : true,\n        validateSchema: (_l = o.validateSchema) !== null && _l !== void 0 ? _l : true,\n        validateFormats: (_m = o.validateFormats) !== null && _m !== void 0 ? _m : true,\n    };\n}\nclass Ajv {\n    constructor(opts = {}) {\n        this.schemas = {};\n        this.refs = {};\n        this.formats = {};\n        this._compilations = new Set();\n        this._loading = {};\n        this._cache = new Map();\n        opts = this.opts = { ...opts, ...requiredOptions(opts) };\n        const { es5, lines } = this.opts.code;\n        this.scope = new codegen_2.ValueScope({ scope: {}, prefixes: EXT_SCOPE_NAMES, es5, lines });\n        this.logger = getLogger(opts.logger);\n        const formatOpt = opts.validateFormats;\n        opts.validateFormats = false;\n        this.RULES = rules_1.getRules();\n        checkOptions.call(this, removedOptions, opts, \"NOT SUPPORTED\");\n        checkOptions.call(this, deprecatedOptions, opts, \"DEPRECATED\", \"warn\");\n        this._metaOpts = getMetaSchemaOptions.call(this);\n        if (opts.formats)\n            addInitialFormats.call(this);\n        this._addVocabularies();\n        this._addDefaultMetaSchema();\n        if (opts.keywords)\n            addInitialKeywords.call(this, opts.keywords);\n        if (typeof opts.meta == \"object\")\n            this.addMetaSchema(opts.meta);\n        addInitialSchemas.call(this);\n        opts.validateFormats = formatOpt;\n    }\n    _addVocabularies() {\n        this.addKeyword(\"$async\");\n    }\n    _addDefaultMetaSchema() {\n        const { $data, meta } = this.opts;\n        if (meta && $data)\n            this.addMetaSchema($dataRefSchema, $dataRefSchema.$id, false);\n    }\n    defaultMeta() {\n        const { meta } = this.opts;\n        return (this.opts.defaultMeta = typeof meta == \"object\" ? meta.$id || meta : undefined);\n    }\n    validate(schemaKeyRef, // key, ref or schema object\n    data // to be validated\n    ) {\n        let v;\n        if (typeof schemaKeyRef == \"string\") {\n            v = this.getSchema(schemaKeyRef);\n            if (!v)\n                throw new Error(`no schema with key or ref \"${schemaKeyRef}\"`);\n        }\n        else {\n            v = this.compile(schemaKeyRef);\n        }\n        const valid = v(data);\n        if (!(\"$async\" in v))\n            this.errors = v.errors;\n        return valid;\n    }\n    compile(schema, _meta) {\n        const sch = this._addSchema(schema, _meta);\n        return (sch.validate || this._compileSchemaEnv(sch));\n    }\n    compileAsync(schema, meta) {\n        if (typeof this.opts.loadSchema != \"function\") {\n            throw new Error(\"options.loadSchema should be a function\");\n        }\n        const { loadSchema } = this.opts;\n        return runCompileAsync.call(this, schema, meta);\n        async function runCompileAsync(_schema, _meta) {\n            await loadMetaSchema.call(this, _schema.$schema);\n            const sch = this._addSchema(_schema, _meta);\n            return sch.validate || _compileAsync.call(this, sch);\n        }\n        async function loadMetaSchema($ref) {\n            if ($ref && !this.getSchema($ref)) {\n                await runCompileAsync.call(this, { $ref }, true);\n            }\n        }\n        async function _compileAsync(sch) {\n            try {\n                return this._compileSchemaEnv(sch);\n            }\n            catch (e) {\n                if (!(e instanceof error_classes_1.MissingRefError))\n                    throw e;\n                checkLoaded.call(this, e);\n                await loadMissingSchema.call(this, e.missingSchema);\n                return _compileAsync.call(this, sch);\n            }\n        }\n        function checkLoaded({ missingSchema: ref, missingRef }) {\n            if (this.refs[ref]) {\n                throw new Error(`AnySchema ${ref} is loaded but ${missingRef} cannot be resolved`);\n            }\n        }\n        async function loadMissingSchema(ref) {\n            const _schema = await _loadSchema.call(this, ref);\n            if (!this.refs[ref])\n                await loadMetaSchema.call(this, _schema.$schema);\n            if (!this.refs[ref])\n                this.addSchema(_schema, ref, meta);\n        }\n        async function _loadSchema(ref) {\n            const p = this._loading[ref];\n            if (p)\n                return p;\n            try {\n                return await (this._loading[ref] = loadSchema(ref));\n            }\n            finally {\n                delete this._loading[ref];\n            }\n        }\n    }\n    // Adds schema to the instance\n    addSchema(schema, // If array is passed, `key` will be ignored\n    key, // Optional schema key. Can be passed to `validate` method instead of schema object or id/ref. One schema per instance can have empty `id` and `key`.\n    _meta, // true if schema is a meta-schema. Used internally, addMetaSchema should be used instead.\n    _validateSchema = this.opts.validateSchema // false to skip schema validation. Used internally, option validateSchema should be used instead.\n    ) {\n        if (Array.isArray(schema)) {\n            for (const sch of schema)\n                this.addSchema(sch, undefined, _meta, _validateSchema);\n            return this;\n        }\n        let id;\n        if (typeof schema === \"object\") {\n            id = schema.$id;\n            if (id !== undefined && typeof id != \"string\")\n                throw new Error(\"schema id must be string\");\n        }\n        key = resolve_1.normalizeId(key || id);\n        this._checkUnique(key);\n        this.schemas[key] = this._addSchema(schema, _meta, _validateSchema, true);\n        return this;\n    }\n    // Add schema that will be used to validate other schemas\n    // options in META_IGNORE_OPTIONS are alway set to false\n    addMetaSchema(schema, key, // schema key\n    _validateSchema = this.opts.validateSchema // false to skip schema validation, can be used to override validateSchema option for meta-schema\n    ) {\n        this.addSchema(schema, key, true, _validateSchema);\n        return this;\n    }\n    //  Validate schema against its meta-schema\n    validateSchema(schema, throwOrLogError) {\n        if (typeof schema == \"boolean\")\n            return true;\n        let $schema;\n        $schema = schema.$schema;\n        if ($schema !== undefined && typeof $schema != \"string\") {\n            throw new Error(\"$schema must be a string\");\n        }\n        $schema = $schema || this.opts.defaultMeta || this.defaultMeta();\n        if (!$schema) {\n            this.logger.warn(\"meta-schema not available\");\n            this.errors = null;\n            return true;\n        }\n        const valid = this.validate($schema, schema);\n        if (!valid && throwOrLogError) {\n            const message = \"schema is invalid: \" + this.errorsText();\n            if (this.opts.validateSchema === \"log\")\n                this.logger.error(message);\n            else\n                throw new Error(message);\n        }\n        return valid;\n    }\n    // Get compiled schema by `key` or `ref`.\n    // (`key` that was passed to `addSchema` or full schema reference - `schema.$id` or resolved id)\n    getSchema(keyRef) {\n        let sch;\n        while (typeof (sch = getSchEnv.call(this, keyRef)) == \"string\")\n            keyRef = sch;\n        if (sch === undefined) {\n            const root = new compile_1.SchemaEnv({ schema: {} });\n            sch = compile_1.resolveSchema.call(this, root, keyRef);\n            if (!sch)\n                return;\n            this.refs[keyRef] = sch;\n        }\n        return (sch.validate || this._compileSchemaEnv(sch));\n    }\n    // Remove cached schema(s).\n    // If no parameter is passed all schemas but meta-schemas are removed.\n    // If RegExp is passed all schemas with key/id matching pattern but meta-schemas are removed.\n    // Even if schema is referenced by other schemas it still can be removed as other schemas have local references.\n    removeSchema(schemaKeyRef) {\n        if (schemaKeyRef instanceof RegExp) {\n            this._removeAllSchemas(this.schemas, schemaKeyRef);\n            this._removeAllSchemas(this.refs, schemaKeyRef);\n            return this;\n        }\n        switch (typeof schemaKeyRef) {\n            case \"undefined\":\n                this._removeAllSchemas(this.schemas);\n                this._removeAllSchemas(this.refs);\n                this._cache.clear();\n                return this;\n            case \"string\": {\n                const sch = getSchEnv.call(this, schemaKeyRef);\n                if (typeof sch == \"object\")\n                    this._cache.delete(sch.schema);\n                delete this.schemas[schemaKeyRef];\n                delete this.refs[schemaKeyRef];\n                return this;\n            }\n            case \"object\": {\n                const cacheKey = schemaKeyRef;\n                this._cache.delete(cacheKey);\n                let id = schemaKeyRef.$id;\n                if (id) {\n                    id = resolve_1.normalizeId(id);\n                    delete this.schemas[id];\n                    delete this.refs[id];\n                }\n                return this;\n            }\n            default:\n                throw new Error(\"ajv.removeSchema: invalid parameter\");\n        }\n    }\n    // add \"vocabulary\" - a collection of keywords\n    addVocabulary(definitions) {\n        for (const def of definitions)\n            this.addKeyword(def);\n        return this;\n    }\n    addKeyword(kwdOrDef, def // deprecated\n    ) {\n        let keyword;\n        if (typeof kwdOrDef == \"string\") {\n            keyword = kwdOrDef;\n            if (typeof def == \"object\") {\n                this.logger.warn(\"these parameters are deprecated, see docs for addKeyword\");\n                def.keyword = keyword;\n            }\n        }\n        else if (typeof kwdOrDef == \"object\" && def === undefined) {\n            def = kwdOrDef;\n            keyword = def.keyword;\n            if (Array.isArray(keyword) && !keyword.length) {\n                throw new Error(\"addKeywords: keyword must be string or non-empty array\");\n            }\n        }\n        else {\n            throw new Error(\"invalid addKeywords parameters\");\n        }\n        checkKeyword.call(this, keyword, def);\n        if (!def) {\n            util_1.eachItem(keyword, (kwd) => addRule.call(this, kwd));\n            return this;\n        }\n        keywordMetaschema.call(this, def);\n        const definition = {\n            ...def,\n            type: dataType_1.getJSONTypes(def.type),\n            schemaType: dataType_1.getJSONTypes(def.schemaType),\n        };\n        util_1.eachItem(keyword, definition.type.length === 0\n            ? (k) => addRule.call(this, k, definition)\n            : (k) => definition.type.forEach((t) => addRule.call(this, k, definition, t)));\n        return this;\n    }\n    getKeyword(keyword) {\n        const rule = this.RULES.all[keyword];\n        return typeof rule == \"object\" ? rule.definition : !!rule;\n    }\n    // Remove keyword\n    removeKeyword(keyword) {\n        // TODO return type should be Ajv\n        const { RULES } = this;\n        delete RULES.keywords[keyword];\n        delete RULES.all[keyword];\n        for (const group of RULES.rules) {\n            const i = group.rules.findIndex((rule) => rule.keyword === keyword);\n            if (i >= 0)\n                group.rules.splice(i, 1);\n        }\n        return this;\n    }\n    // Add format\n    addFormat(name, format) {\n        if (typeof format == \"string\")\n            format = new RegExp(format);\n        this.formats[name] = format;\n        return this;\n    }\n    errorsText(errors = this.errors, // optional array of validation errors\n    { separator = \", \", dataVar = \"data\" } = {} // optional options with properties `separator` and `dataVar`\n    ) {\n        if (!errors || errors.length === 0)\n            return \"No errors\";\n        return errors\n            .map((e) => `${dataVar}${e.dataPath} ${e.message}`)\n            .reduce((text, msg) => text + separator + msg);\n    }\n    $dataMetaSchema(metaSchema, keywordsJsonPointers) {\n        const rules = this.RULES.all;\n        metaSchema = JSON.parse(JSON.stringify(metaSchema));\n        for (const jsonPointer of keywordsJsonPointers) {\n            const segments = jsonPointer.split(\"/\").slice(1); // first segment is an empty string\n            let keywords = metaSchema;\n            for (const seg of segments)\n                keywords = keywords[seg];\n            for (const key in rules) {\n                const rule = rules[key];\n                if (typeof rule != \"object\")\n                    continue;\n                const { $data } = rule.definition;\n                const schema = keywords[key];\n                if ($data && schema)\n                    keywords[key] = schemaOrData(schema);\n            }\n        }\n        return metaSchema;\n    }\n    _removeAllSchemas(schemas, regex) {\n        for (const keyRef in schemas) {\n            const sch = schemas[keyRef];\n            if (!regex || regex.test(keyRef)) {\n                if (typeof sch == \"string\") {\n                    delete schemas[keyRef];\n                }\n                else if (sch && !sch.meta) {\n                    this._cache.delete(sch.schema);\n                    delete schemas[keyRef];\n                }\n            }\n        }\n    }\n    _addSchema(schema, meta, validateSchema = this.opts.validateSchema, addSchema = this.opts.addUsedSchema) {\n        if (typeof schema != \"object\" && typeof schema != \"boolean\") {\n            throw new Error(\"schema must be object or boolean\");\n        }\n        let sch = this._cache.get(schema);\n        if (sch !== undefined)\n            return sch;\n        const localRefs = resolve_1.getSchemaRefs.call(this, schema);\n        sch = new compile_1.SchemaEnv({ schema, meta, localRefs });\n        this._cache.set(sch.schema, sch);\n        const id = sch.baseId;\n        if (addSchema && !id.startsWith(\"#\")) {\n            // TODO atm it is allowed to overwrite schemas without id (instead of not adding them)\n            if (id)\n                this._checkUnique(id);\n            this.refs[id] = sch;\n        }\n        if (validateSchema)\n            this.validateSchema(schema, true);\n        return sch;\n    }\n    _checkUnique(id) {\n        if (this.schemas[id] || this.refs[id]) {\n            throw new Error(`schema with key or id \"${id}\" already exists`);\n        }\n    }\n    _compileSchemaEnv(sch) {\n        if (sch.meta)\n            this._compileMetaSchema(sch);\n        else\n            compile_1.compileSchema.call(this, sch);\n        /* istanbul ignore if */\n        if (!sch.validate)\n            throw new Error(\"ajv implementation error\");\n        return sch.validate;\n    }\n    _compileMetaSchema(sch) {\n        const currentOpts = this.opts;\n        this.opts = this._metaOpts;\n        try {\n            compile_1.compileSchema.call(this, sch);\n        }\n        finally {\n            this.opts = currentOpts;\n        }\n    }\n}\nexports.default = Ajv;\nAjv.ValidationError = error_classes_1.ValidationError;\nAjv.MissingRefError = error_classes_1.MissingRefError;\nfunction checkOptions(checkOpts, options, msg, log = \"error\") {\n    for (const key in checkOpts) {\n        const opt = key;\n        if (opt in options)\n            this.logger[log](`${msg}: option ${key}. ${checkOpts[opt]}`);\n    }\n}\nfunction getSchEnv(keyRef) {\n    keyRef = resolve_1.normalizeId(keyRef); // TODO tests fail without this line\n    return this.schemas[keyRef] || this.refs[keyRef];\n}\nfunction addInitialSchemas() {\n    const optsSchemas = this.opts.schemas;\n    if (!optsSchemas)\n        return;\n    if (Array.isArray(optsSchemas))\n        this.addSchema(optsSchemas);\n    else\n        for (const key in optsSchemas)\n            this.addSchema(optsSchemas[key], key);\n}\nfunction addInitialFormats() {\n    for (const name in this.opts.formats) {\n        const format = this.opts.formats[name];\n        if (format)\n            this.addFormat(name, format);\n    }\n}\nfunction addInitialKeywords(defs) {\n    if (Array.isArray(defs)) {\n        this.addVocabulary(defs);\n        return;\n    }\n    this.logger.warn(\"keywords option as map is deprecated, pass array\");\n    for (const keyword in defs) {\n        const def = defs[keyword];\n        if (!def.keyword)\n            def.keyword = keyword;\n        this.addKeyword(def);\n    }\n}\nfunction getMetaSchemaOptions() {\n    const metaOpts = { ...this.opts };\n    for (const opt of META_IGNORE_OPTIONS)\n        delete metaOpts[opt];\n    return metaOpts;\n}\nconst noLogs = { log() { }, warn() { }, error() { } };\nfunction getLogger(logger) {\n    if (logger === false)\n        return noLogs;\n    if (logger === undefined)\n        return console;\n    if (logger.log && logger.warn && logger.error)\n        return logger;\n    throw new Error(\"logger must implement log, warn and error methods\");\n}\nconst KEYWORD_NAME = /^[a-z_$][a-z0-9_$-]*$/i;\nfunction checkKeyword(keyword, def) {\n    const { RULES } = this;\n    util_1.eachItem(keyword, (kwd) => {\n        if (RULES.keywords[kwd])\n            throw new Error(`Keyword ${kwd} is already defined`);\n        if (!KEYWORD_NAME.test(kwd))\n            throw new Error(`Keyword ${kwd} has invalid name`);\n    });\n    if (!def)\n        return;\n    if (def.$data && !(\"code\" in def || \"validate\" in def)) {\n        throw new Error('$data keyword must have \"code\" or \"validate\" function');\n    }\n}\nfunction addRule(keyword, definition, dataType) {\n    var _a;\n    const post = definition === null || definition === void 0 ? void 0 : definition.post;\n    if (dataType && post)\n        throw new Error('keyword with \"post\" flag cannot have \"type\"');\n    const { RULES } = this;\n    let ruleGroup = post ? RULES.post : RULES.rules.find(({ type: t }) => t === dataType);\n    if (!ruleGroup) {\n        ruleGroup = { type: dataType, rules: [] };\n        RULES.rules.push(ruleGroup);\n    }\n    RULES.keywords[keyword] = true;\n    if (!definition)\n        return;\n    const rule = {\n        keyword,\n        definition: {\n            ...definition,\n            type: dataType_1.getJSONTypes(definition.type),\n            schemaType: dataType_1.getJSONTypes(definition.schemaType),\n        },\n    };\n    if (definition.before)\n        addBeforeRule.call(this, ruleGroup, rule, definition.before);\n    else\n        ruleGroup.rules.push(rule);\n    RULES.all[keyword] = rule;\n    (_a = definition.implements) === null || _a === void 0 ? void 0 : _a.forEach((kwd) => this.addKeyword(kwd));\n}\nfunction addBeforeRule(ruleGroup, rule, before) {\n    const i = ruleGroup.rules.findIndex((_rule) => _rule.keyword === before);\n    if (i >= 0) {\n        ruleGroup.rules.splice(i, 0, rule);\n    }\n    else {\n        ruleGroup.rules.push(rule);\n        this.logger.warn(`rule ${before} is not defined`);\n    }\n}\nfunction keywordMetaschema(def) {\n    let { metaSchema } = def;\n    if (metaSchema === undefined)\n        return;\n    if (def.$data && this.opts.$data)\n        metaSchema = schemaOrData(metaSchema);\n    def.validateSchema = this.compile(metaSchema, true);\n}\nconst $dataRef = {\n    $ref: \"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#\",\n};\nfunction schemaOrData(schema) {\n    return { anyOf: [schema, $dataRef] };\n}\n//# sourceMappingURL=core.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst subschema_1 = require(\"../../compile/subschema\");\nconst util_1 = require(\"../../compile/util\");\nconst validate_1 = require(\"../../compile/validate\");\nconst error = {\n    message: ({ params: { len } }) => codegen_1.str `should NOT have more than ${len} items`,\n    params: ({ params: { len } }) => codegen_1._ `{limit: ${len}}`,\n};\nconst def = {\n    keyword: \"additionalItems\",\n    type: \"array\",\n    schemaType: [\"boolean\", \"object\"],\n    before: \"uniqueItems\",\n    error,\n    code(cxt) {\n        const { gen, schema, parentSchema, data, it } = cxt;\n        const { items } = parentSchema;\n        if (!Array.isArray(items)) {\n            validate_1.checkStrictMode(it, '\"additionalItems\" is ignored when \"items\" is not an array of schemas');\n            return;\n        }\n        it.items = true;\n        const len = gen.const(\"len\", codegen_1._ `${data}.length`);\n        if (schema === false) {\n            cxt.setParams({ len: items.length });\n            cxt.pass(codegen_1._ `${len} <= ${items.length}`);\n        }\n        else if (typeof schema == \"object\" && !util_1.alwaysValidSchema(it, schema)) {\n            const valid = gen.var(\"valid\", codegen_1._ `${len} <= ${items.length}`); // TODO var\n            gen.if(codegen_1.not(valid), () => validateItems(valid));\n            cxt.ok(valid);\n        }\n        function validateItems(valid) {\n            gen.forRange(\"i\", items.length, len, (i) => {\n                cxt.subschema({ keyword: \"additionalItems\", dataProp: i, dataPropType: subschema_1.Type.Num }, valid);\n                if (!it.allErrors)\n                    gen.if(codegen_1.not(valid), () => gen.break());\n            });\n        }\n    },\n};\nexports.default = def;\n//# sourceMappingURL=additionalItems.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst code_1 = require(\"../code\");\nconst codegen_1 = require(\"../../compile/codegen\");\nconst names_1 = require(\"../../compile/names\");\nconst subschema_1 = require(\"../../compile/subschema\");\nconst util_1 = require(\"../../compile/util\");\nconst error = {\n    message: \"should NOT have additional properties\",\n    params: ({ params }) => codegen_1._ `{additionalProperty: ${params.additionalProperty}}`,\n};\nconst def = {\n    keyword: \"additionalProperties\",\n    type: [\"object\"],\n    schemaType: [\"boolean\", \"object\"],\n    allowUndefined: true,\n    trackErrors: true,\n    error,\n    code(cxt) {\n        const { gen, schema, parentSchema, data, errsCount, it } = cxt;\n        /* istanbul ignore if */\n        if (!errsCount)\n            throw new Error(\"ajv implementation error\");\n        const { allErrors, opts } = it;\n        it.props = true;\n        if (opts.removeAdditional !== \"all\" && util_1.alwaysValidSchema(it, schema))\n            return;\n        const props = code_1.allSchemaProperties(parentSchema.properties);\n        const patProps = code_1.allSchemaProperties(parentSchema.patternProperties);\n        checkAdditionalProperties();\n        cxt.ok(codegen_1._ `${errsCount} === ${names_1.default.errors}`);\n        function checkAdditionalProperties() {\n            gen.forIn(\"key\", data, (key) => {\n                if (!props.length && !patProps.length)\n                    additionalPropertyCode(key);\n                else\n                    gen.if(isAdditional(key), () => additionalPropertyCode(key));\n            });\n        }\n        function isAdditional(key) {\n            let definedProp;\n            if (props.length > 8) {\n                // TODO maybe an option instead of hard-coded 8?\n                const propsSchema = util_1.schemaRefOrVal(it, parentSchema.properties, \"properties\");\n                definedProp = codegen_1._ `${propsSchema}.hasOwnProperty(${key})`;\n            }\n            else if (props.length) {\n                definedProp = codegen_1.or(...props.map((p) => codegen_1._ `${key} === ${p}`));\n            }\n            else {\n                definedProp = codegen_1.nil;\n            }\n            if (patProps.length) {\n                definedProp = codegen_1.or(definedProp, ...patProps.map((p) => codegen_1._ `${code_1.usePattern(gen, p)}.test(${key})`));\n            }\n            return codegen_1._ `!(${definedProp})`;\n        }\n        function deleteAdditional(key) {\n            gen.code(codegen_1._ `delete ${data}[${key}]`);\n        }\n        function additionalPropertyCode(key) {\n            if (opts.removeAdditional === \"all\" || (opts.removeAdditional && schema === false)) {\n                deleteAdditional(key);\n                return;\n            }\n            if (schema === false) {\n                cxt.setParams({ additionalProperty: key });\n                cxt.error();\n                if (!allErrors)\n                    gen.break();\n                return;\n            }\n            if (typeof schema == \"object\" && !util_1.alwaysValidSchema(it, schema)) {\n                const valid = gen.name(\"valid\");\n                if (opts.removeAdditional === \"failing\") {\n                    applyAdditionalSchema(key, valid, false);\n                    gen.if(codegen_1.not(valid), () => {\n                        cxt.reset();\n                        deleteAdditional(key);\n                    });\n                }\n                else {\n                    applyAdditionalSchema(key, valid);\n                    if (!allErrors)\n                        gen.if(codegen_1.not(valid), () => gen.break());\n                }\n            }\n        }\n        function applyAdditionalSchema(key, valid, errors) {\n            const subschema = {\n                keyword: \"additionalProperties\",\n                dataProp: key,\n                dataPropType: subschema_1.Type.Str,\n                strictSchema: it.strictSchema,\n            };\n            if (errors === false) {\n                Object.assign(subschema, {\n                    compositeRule: true,\n                    createErrors: false,\n                    allErrors: false,\n                });\n            }\n            cxt.subschema(subschema, valid);\n        }\n    },\n};\nexports.default = def;\n//# sourceMappingURL=additionalProperties.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst util_1 = require(\"../../compile/util\");\nconst def = {\n    keyword: \"allOf\",\n    schemaType: \"array\",\n    code(cxt) {\n        const { gen, schema, it } = cxt;\n        /* istanbul ignore if */\n        if (!Array.isArray(schema))\n            throw new Error(\"ajv implementation error\");\n        const valid = gen.name(\"valid\");\n        schema.forEach((sch, i) => {\n            if (util_1.alwaysValidSchema(it, sch))\n                return;\n            const schCxt = cxt.subschema({ keyword: \"allOf\", schemaProp: i }, valid);\n            cxt.ok(valid);\n            cxt.mergeEvaluated(schCxt);\n        });\n    },\n};\nexports.default = def;\n//# sourceMappingURL=allOf.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst util_1 = require(\"../../compile/util\");\nconst def = {\n    keyword: \"anyOf\",\n    schemaType: \"array\",\n    trackErrors: true,\n    code(cxt) {\n        const { gen, schema, it } = cxt;\n        /* istanbul ignore if */\n        if (!Array.isArray(schema))\n            throw new Error(\"ajv implementation error\");\n        const alwaysValid = schema.some((sch) => util_1.alwaysValidSchema(it, sch));\n        if (alwaysValid && !it.opts.unevaluated)\n            return;\n        const valid = gen.let(\"valid\", false);\n        const schValid = gen.name(\"_valid\");\n        gen.block(() => schema.forEach((_sch, i) => {\n            const schCxt = cxt.subschema({\n                keyword: \"anyOf\",\n                schemaProp: i,\n                compositeRule: true,\n            }, schValid);\n            gen.assign(valid, codegen_1._ `${valid} || ${schValid}`);\n            const merged = cxt.mergeValidEvaluated(schCxt, schValid);\n            // can short-circuit if `unevaluatedProperties/Items` not supported (opts.unevaluated !== true)\n            // or if all properties and items were evaluated (it.props === true && it.items === true)\n            if (!merged)\n                gen.if(codegen_1.not(valid));\n        }));\n        cxt.result(valid, () => cxt.reset(), () => cxt.error(true));\n    },\n    error: {\n        message: \"should match some schema in anyOf\",\n    },\n};\nexports.default = def;\n//# sourceMappingURL=anyOf.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst subschema_1 = require(\"../../compile/subschema\");\nconst util_1 = require(\"../../compile/util\");\nconst validate_1 = require(\"../../compile/validate\");\nconst error = {\n    message: ({ params: { min, max } }) => max === undefined\n        ? codegen_1.str `should contain at least ${min} valid item(s)`\n        : codegen_1.str `should contain at least ${min} and no more than ${max} valid item(s)`,\n    params: ({ params: { min, max } }) => max === undefined ? codegen_1._ `{minContains: ${min}}` : codegen_1._ `{minContains: ${min}, maxContains: ${max}}`,\n};\nconst def = {\n    keyword: \"contains\",\n    type: \"array\",\n    schemaType: [\"object\", \"boolean\"],\n    before: \"uniqueItems\",\n    trackErrors: true,\n    error,\n    code(cxt) {\n        const { gen, schema, parentSchema, data, it } = cxt;\n        let min;\n        let max;\n        const { minContains, maxContains } = parentSchema;\n        if (it.opts.next) {\n            min = minContains === undefined ? 1 : minContains;\n            max = maxContains;\n        }\n        else {\n            min = 1;\n        }\n        const len = gen.const(\"len\", codegen_1._ `${data}.length`);\n        cxt.setParams({ min, max });\n        if (max === undefined && min === 0) {\n            validate_1.checkStrictMode(it, `\"minContains\" == 0 without \"maxContains\": \"contains\" keyword ignored`);\n            return;\n        }\n        if (max !== undefined && min > max) {\n            validate_1.checkStrictMode(it, `\"minContains\" > \"maxContains\" is always invalid`);\n            cxt.fail();\n            return;\n        }\n        if (util_1.alwaysValidSchema(it, schema)) {\n            let cond = codegen_1._ `${len} >= ${min}`;\n            if (max !== undefined)\n                cond = codegen_1._ `${cond} && ${len} <= ${max}`;\n            cxt.pass(cond);\n            return;\n        }\n        it.items = true;\n        const valid = gen.name(\"valid\");\n        if (max === undefined && min === 1) {\n            validateItems(valid, () => gen.if(valid, () => gen.break()));\n        }\n        else {\n            gen.let(valid, false);\n            const schValid = gen.name(\"_valid\");\n            const count = gen.let(\"count\", 0);\n            validateItems(schValid, () => gen.if(schValid, () => checkLimits(count)));\n        }\n        cxt.result(valid, () => cxt.reset());\n        function validateItems(_valid, block) {\n            gen.forRange(\"i\", 0, len, (i) => {\n                cxt.subschema({\n                    keyword: \"contains\",\n                    dataProp: i,\n                    dataPropType: subschema_1.Type.Num,\n                    compositeRule: true,\n                }, _valid);\n                block();\n            });\n        }\n        function checkLimits(count) {\n            gen.code(codegen_1._ `${count}++`);\n            if (max === undefined) {\n                gen.if(codegen_1._ `${count} >= ${min}`, () => gen.assign(valid, true).break());\n            }\n            else {\n                gen.if(codegen_1._ `${count} > ${max}`, () => gen.assign(valid, false).break());\n                if (min === 1)\n                    gen.assign(valid, true);\n                else\n                    gen.if(codegen_1._ `${count} >= ${min}`, () => gen.assign(valid, true));\n            }\n        }\n    },\n};\nexports.default = def;\n//# sourceMappingURL=contains.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.validateSchemaDeps = exports.validatePropertyDeps = exports.error = void 0;\nconst codegen_1 = require(\"../../compile/codegen\");\nconst util_1 = require(\"../../compile/util\");\nconst code_1 = require(\"../code\");\nexports.error = {\n    message: ({ params: { property, depsCount, deps } }) => {\n        const property_ies = depsCount === 1 ? \"property\" : \"properties\";\n        return codegen_1.str `should have ${property_ies} ${deps} when property ${property} is present`;\n    },\n    params: ({ params: { property, depsCount, deps, missingProperty } }) => codegen_1._ `{property: ${property},\n    missingProperty: ${missingProperty},\n    depsCount: ${depsCount},\n    deps: ${deps}}`,\n};\nconst def = {\n    keyword: \"dependencies\",\n    type: \"object\",\n    schemaType: \"object\",\n    error: exports.error,\n    code(cxt) {\n        const [propDeps, schDeps] = splitDependencies(cxt);\n        validatePropertyDeps(cxt, propDeps);\n        validateSchemaDeps(cxt, schDeps);\n    },\n};\nfunction splitDependencies({ schema }) {\n    const propertyDeps = {};\n    const schemaDeps = {};\n    for (const key in schema) {\n        if (key === \"__proto__\")\n            continue;\n        const deps = Array.isArray(schema[key]) ? propertyDeps : schemaDeps;\n        deps[key] = schema[key];\n    }\n    return [propertyDeps, schemaDeps];\n}\nfunction validatePropertyDeps(cxt, propertyDeps = cxt.schema) {\n    const { gen, data, it } = cxt;\n    if (Object.keys(propertyDeps).length === 0)\n        return;\n    const missing = gen.let(\"missing\");\n    for (const prop in propertyDeps) {\n        const deps = propertyDeps[prop];\n        if (deps.length === 0)\n            continue;\n        const hasProperty = code_1.propertyInData(data, prop, it.opts.ownProperties);\n        cxt.setParams({\n            property: prop,\n            depsCount: deps.length,\n            deps: deps.join(\", \"),\n        });\n        if (it.allErrors) {\n            gen.if(hasProperty, () => {\n                for (const depProp of deps) {\n                    code_1.checkReportMissingProp(cxt, depProp);\n                }\n            });\n        }\n        else {\n            gen.if(codegen_1._ `${hasProperty} && (${code_1.checkMissingProp(cxt, deps, missing)})`);\n            code_1.reportMissingProp(cxt, missing);\n            gen.else();\n        }\n    }\n}\nexports.validatePropertyDeps = validatePropertyDeps;\nfunction validateSchemaDeps(cxt, schemaDeps = cxt.schema) {\n    const { gen, data, keyword, it } = cxt;\n    const valid = gen.name(\"valid\");\n    for (const prop in schemaDeps) {\n        if (util_1.alwaysValidSchema(it, schemaDeps[prop]))\n            continue;\n        gen.if(code_1.propertyInData(data, prop, it.opts.ownProperties), () => {\n            const schCxt = cxt.subschema({ keyword, schemaProp: prop }, valid);\n            cxt.mergeValidEvaluated(schCxt, valid);\n        }, () => gen.var(valid, true) // TODO var\n        );\n        cxt.ok(valid);\n    }\n}\nexports.validateSchemaDeps = validateSchemaDeps;\nexports.default = def;\n//# sourceMappingURL=dependencies.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst util_1 = require(\"../../compile/util\");\nconst validate_1 = require(\"../../compile/validate\");\nconst error = {\n    message: ({ params }) => codegen_1.str `should match \"${params.ifClause}\" schema`,\n    params: ({ params }) => codegen_1._ `{failingKeyword: ${params.ifClause}}`,\n};\nconst def = {\n    keyword: \"if\",\n    schemaType: [\"object\", \"boolean\"],\n    trackErrors: true,\n    error,\n    code(cxt) {\n        const { gen, parentSchema, it } = cxt;\n        if (parentSchema.then === undefined && parentSchema.else === undefined) {\n            validate_1.checkStrictMode(it, '\"if\" without \"then\" and \"else\" is ignored');\n        }\n        const hasThen = hasSchema(it, \"then\");\n        const hasElse = hasSchema(it, \"else\");\n        if (!hasThen && !hasElse)\n            return;\n        const valid = gen.let(\"valid\", true);\n        const schValid = gen.name(\"_valid\");\n        validateIf();\n        cxt.reset();\n        if (hasThen && hasElse) {\n            const ifClause = gen.let(\"ifClause\");\n            cxt.setParams({ ifClause });\n            gen.if(schValid, validateClause(\"then\", ifClause), validateClause(\"else\", ifClause));\n        }\n        else if (hasThen) {\n            gen.if(schValid, validateClause(\"then\"));\n        }\n        else {\n            gen.if(codegen_1.not(schValid), validateClause(\"else\"));\n        }\n        cxt.pass(valid, () => cxt.error(true));\n        function validateIf() {\n            const schCxt = cxt.subschema({\n                keyword: \"if\",\n                compositeRule: true,\n                createErrors: false,\n                allErrors: false,\n            }, schValid);\n            cxt.mergeEvaluated(schCxt);\n        }\n        function validateClause(keyword, ifClause) {\n            return () => {\n                const schCxt = cxt.subschema({ keyword }, schValid);\n                gen.assign(valid, schValid);\n                cxt.mergeValidEvaluated(schCxt, valid);\n                if (ifClause)\n                    gen.assign(ifClause, codegen_1._ `${keyword}`);\n                else\n                    cxt.setParams({ ifClause: keyword });\n            };\n        }\n    },\n};\nfunction hasSchema(it, keyword) {\n    const schema = it.schema[keyword];\n    return schema !== undefined && !util_1.alwaysValidSchema(it, schema);\n}\nexports.default = def;\n//# sourceMappingURL=if.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst additionalItems_1 = require(\"./additionalItems\");\nconst items_1 = require(\"./items\");\nconst contains_1 = require(\"./contains\");\nconst dependencies_1 = require(\"./dependencies\");\nconst propertyNames_1 = require(\"./propertyNames\");\nconst additionalProperties_1 = require(\"./additionalProperties\");\nconst properties_1 = require(\"./properties\");\nconst patternProperties_1 = require(\"./patternProperties\");\nconst not_1 = require(\"./not\");\nconst anyOf_1 = require(\"./anyOf\");\nconst oneOf_1 = require(\"./oneOf\");\nconst allOf_1 = require(\"./allOf\");\nconst if_1 = require(\"./if\");\nconst thenElse_1 = require(\"./thenElse\");\nconst applicator = [\n    // any\n    not_1.default,\n    anyOf_1.default,\n    oneOf_1.default,\n    allOf_1.default,\n    if_1.default,\n    thenElse_1.default,\n    // array\n    additionalItems_1.default,\n    items_1.default,\n    contains_1.default,\n    // object\n    propertyNames_1.default,\n    additionalProperties_1.default,\n    dependencies_1.default,\n    properties_1.default,\n    patternProperties_1.default,\n];\nexports.default = applicator;\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst subschema_1 = require(\"../../compile/subschema\");\nconst util_1 = require(\"../../compile/util\");\nconst validate_1 = require(\"../../compile/validate\");\nconst def = {\n    keyword: \"items\",\n    type: \"array\",\n    schemaType: [\"object\", \"array\", \"boolean\"],\n    before: \"uniqueItems\",\n    code(cxt) {\n        const { gen, schema, parentSchema, data, it } = cxt;\n        const len = gen.const(\"len\", codegen_1._ `${data}.length`);\n        if (Array.isArray(schema)) {\n            if (it.opts.unevaluated && schema.length && it.items !== true) {\n                it.items = util_1.mergeEvaluated.items(gen, schema.length, it.items);\n            }\n            validateTuple(schema);\n        }\n        else {\n            it.items = true;\n            if (!util_1.alwaysValidSchema(it, schema))\n                validateArray();\n        }\n        function validateTuple(schArr) {\n            if (it.opts.strictTuples && !fullTupleSchema(schema.length, parentSchema)) {\n                const msg = `\"items\" is ${schArr.length}-tuple, but minItems or maxItems/additionalItems are not specified or different`;\n                validate_1.checkStrictMode(it, msg, it.opts.strictTuples);\n            }\n            const valid = gen.name(\"valid\");\n            schArr.forEach((sch, i) => {\n                if (util_1.alwaysValidSchema(it, sch))\n                    return;\n                gen.if(codegen_1._ `${len} > ${i}`, () => cxt.subschema({\n                    keyword: \"items\",\n                    schemaProp: i,\n                    dataProp: i,\n                    strictSchema: it.strictSchema,\n                }, valid));\n                cxt.ok(valid);\n            });\n        }\n        function validateArray() {\n            const valid = gen.name(\"valid\");\n            gen.forRange(\"i\", 0, len, (i) => {\n                cxt.subschema({\n                    keyword: \"items\",\n                    dataProp: i,\n                    dataPropType: subschema_1.Type.Num,\n                    strictSchema: it.strictSchema,\n                }, valid);\n                if (!it.allErrors)\n                    gen.if(codegen_1.not(valid), () => gen.break());\n            });\n            cxt.ok(valid);\n        }\n    },\n};\nfunction fullTupleSchema(len, sch) {\n    return len === sch.minItems && (len === sch.maxItems || sch.additionalItems === false);\n}\nexports.default = def;\n//# sourceMappingURL=items.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst util_1 = require(\"../../compile/util\");\nconst def = {\n    keyword: \"not\",\n    schemaType: [\"object\", \"boolean\"],\n    trackErrors: true,\n    code(cxt) {\n        const { gen, schema, it } = cxt;\n        if (util_1.alwaysValidSchema(it, schema)) {\n            cxt.fail();\n            return;\n        }\n        const valid = gen.name(\"valid\");\n        cxt.subschema({\n            keyword: \"not\",\n            compositeRule: true,\n            createErrors: false,\n            allErrors: false,\n        }, valid);\n        cxt.result(valid, () => cxt.error(), () => cxt.reset());\n    },\n    error: {\n        message: \"should NOT be valid\",\n    },\n};\nexports.default = def;\n//# sourceMappingURL=not.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst util_1 = require(\"../../compile/util\");\nconst error = {\n    message: \"should match exactly one schema in oneOf\",\n    params: ({ params }) => codegen_1._ `{passingSchemas: ${params.passing}}`,\n};\nconst def = {\n    keyword: \"oneOf\",\n    schemaType: \"array\",\n    trackErrors: true,\n    error,\n    code(cxt) {\n        const { gen, schema, it } = cxt;\n        /* istanbul ignore if */\n        if (!Array.isArray(schema))\n            throw new Error(\"ajv implementation error\");\n        const schArr = schema;\n        const valid = gen.let(\"valid\", false);\n        const passing = gen.let(\"passing\", null);\n        const schValid = gen.name(\"_valid\");\n        cxt.setParams({ passing });\n        // TODO possibly fail straight away (with warning or exception) if there are two empty always valid schemas\n        gen.block(validateOneOf);\n        cxt.result(valid, () => cxt.reset(), () => cxt.error(true));\n        function validateOneOf() {\n            schArr.forEach((sch, i) => {\n                let schCxt;\n                if (util_1.alwaysValidSchema(it, sch)) {\n                    gen.var(schValid, true);\n                }\n                else {\n                    schCxt = cxt.subschema({\n                        keyword: \"oneOf\",\n                        schemaProp: i,\n                        compositeRule: true,\n                    }, schValid);\n                }\n                if (i > 0) {\n                    gen\n                        .if(codegen_1._ `${schValid} && ${valid}`)\n                        .assign(valid, false)\n                        .assign(passing, codegen_1._ `[${passing}, ${i}]`)\n                        .else();\n                }\n                gen.if(schValid, () => {\n                    gen.assign(valid, true);\n                    gen.assign(passing, i);\n                    if (schCxt)\n                        cxt.mergeEvaluated(schCxt, codegen_1.Name);\n                });\n            });\n        }\n    },\n};\nexports.default = def;\n//# sourceMappingURL=oneOf.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst code_1 = require(\"../code\");\nconst codegen_1 = require(\"../../compile/codegen\");\nconst subschema_1 = require(\"../../compile/subschema\");\nconst validate_1 = require(\"../../compile/validate\");\nconst util_1 = require(\"../../compile/util\");\nconst def = {\n    keyword: \"patternProperties\",\n    type: \"object\",\n    schemaType: \"object\",\n    code(cxt) {\n        const { gen, schema, data, parentSchema, it } = cxt;\n        const { opts } = it;\n        const patterns = code_1.schemaProperties(it, schema);\n        // TODO mark properties matching patterns with always valid schemas as evaluated\n        if (patterns.length === 0)\n            return;\n        const checkProperties = opts.strict && !opts.allowMatchingProperties && parentSchema.properties;\n        const valid = gen.name(\"valid\");\n        if (it.props !== true && !(it.props instanceof codegen_1.Name)) {\n            it.props = util_1.evaluatedPropsToName(gen, it.props);\n        }\n        const { props } = it;\n        validatePatternProperties();\n        function validatePatternProperties() {\n            for (const pat of patterns) {\n                if (checkProperties)\n                    checkMatchingProperties(pat);\n                if (it.allErrors) {\n                    validateProperties(pat);\n                }\n                else {\n                    gen.var(valid, true); // TODO var\n                    validateProperties(pat);\n                    gen.if(valid);\n                }\n            }\n        }\n        function checkMatchingProperties(pat) {\n            for (const prop in checkProperties) {\n                if (new RegExp(pat).test(prop)) {\n                    validate_1.checkStrictMode(it, `property ${prop} matches pattern ${pat} (use allowMatchingProperties)`);\n                }\n            }\n        }\n        function validateProperties(pat) {\n            gen.forIn(\"key\", data, (key) => {\n                gen.if(codegen_1._ `${code_1.usePattern(gen, pat)}.test(${key})`, () => {\n                    cxt.subschema({\n                        keyword: \"patternProperties\",\n                        schemaProp: pat,\n                        dataProp: key,\n                        dataPropType: subschema_1.Type.Str,\n                        strictSchema: it.strictSchema,\n                    }, valid);\n                    if (it.opts.unevaluated && props !== true) {\n                        gen.assign(codegen_1._ `${props}[${key}]`, true);\n                    }\n                    else if (!it.allErrors) {\n                        // can short-circuit if `unevaluatedProperties` is not supported (opts.next === false)\n                        // or if all properties were evaluated (props === true)\n                        gen.if(codegen_1.not(valid), () => gen.break());\n                    }\n                });\n            });\n        }\n    },\n};\nexports.default = def;\n//# sourceMappingURL=patternProperties.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst context_1 = require(\"../../compile/context\");\nconst code_1 = require(\"../code\");\nconst util_1 = require(\"../../compile/util\");\nconst additionalProperties_1 = require(\"./additionalProperties\");\nconst def = {\n    keyword: \"properties\",\n    type: \"object\",\n    schemaType: \"object\",\n    code(cxt) {\n        const { gen, schema, parentSchema, data, it } = cxt;\n        if (it.opts.removeAdditional === \"all\" && parentSchema.additionalProperties === undefined) {\n            additionalProperties_1.default.code(new context_1.default(it, additionalProperties_1.default, \"additionalProperties\"));\n        }\n        const allProps = code_1.allSchemaProperties(schema);\n        if (it.opts.unevaluated && allProps.length && it.props !== true) {\n            it.props = util_1.mergeEvaluated.props(gen, util_1.toHash(allProps), it.props);\n        }\n        const properties = allProps.filter((p) => !util_1.alwaysValidSchema(it, schema[p]));\n        if (properties.length === 0)\n            return;\n        const valid = gen.name(\"valid\");\n        for (const prop of properties) {\n            if (hasDefault(prop)) {\n                applyPropertySchema(prop);\n            }\n            else {\n                gen.if(code_1.propertyInData(data, prop, it.opts.ownProperties));\n                applyPropertySchema(prop);\n                if (!it.allErrors)\n                    gen.else().var(valid, true);\n                gen.endIf();\n            }\n            cxt.ok(valid);\n        }\n        function hasDefault(prop) {\n            return it.opts.useDefaults && !it.compositeRule && schema[prop].default !== undefined;\n        }\n        function applyPropertySchema(prop) {\n            cxt.subschema({\n                keyword: \"properties\",\n                schemaProp: prop,\n                dataProp: prop,\n                strictSchema: it.strictSchema,\n            }, valid);\n        }\n    },\n};\nexports.default = def;\n//# sourceMappingURL=properties.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst util_1 = require(\"../../compile/util\");\nconst error = {\n    message: ({ params }) => codegen_1.str `property name '${params.propertyName}' is invalid`,\n    params: ({ params }) => codegen_1._ `{propertyName: ${params.propertyName}}`,\n};\nconst def = {\n    keyword: \"propertyNames\",\n    type: \"object\",\n    schemaType: [\"object\", \"boolean\"],\n    error,\n    code(cxt) {\n        const { gen, schema, data, it } = cxt;\n        if (util_1.alwaysValidSchema(it, schema))\n            return;\n        const valid = gen.name(\"valid\");\n        gen.forIn(\"key\", data, (key) => {\n            cxt.setParams({ propertyName: key });\n            cxt.subschema({\n                keyword: \"propertyNames\",\n                data: key,\n                dataTypes: [\"string\"],\n                propertyName: key,\n                compositeRule: true,\n                strictSchema: it.strictSchema,\n            }, valid);\n            gen.if(codegen_1.not(valid), () => {\n                cxt.error(true);\n                if (!it.allErrors)\n                    gen.break();\n            });\n        });\n        cxt.ok(valid);\n    },\n};\nexports.default = def;\n//# sourceMappingURL=propertyNames.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst validate_1 = require(\"../../compile/validate\");\nconst def = {\n    keyword: [\"then\", \"else\"],\n    schemaType: [\"object\", \"boolean\"],\n    code({ keyword, parentSchema, it }) {\n        if (parentSchema.if === undefined)\n            validate_1.checkStrictMode(it, `\"${keyword}\" without \"if\" is ignored`);\n    },\n};\nexports.default = def;\n//# sourceMappingURL=thenElse.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.usePattern = exports.callValidateCode = exports.schemaProperties = exports.allSchemaProperties = exports.noPropertyInData = exports.propertyInData = exports.reportMissingProp = exports.checkMissingProp = exports.checkReportMissingProp = void 0;\nconst codegen_1 = require(\"../compile/codegen\");\nconst util_1 = require(\"../compile/util\");\nconst names_1 = require(\"../compile/names\");\nfunction checkReportMissingProp(cxt, prop) {\n    const { gen, data, it } = cxt;\n    gen.if(noPropertyInData(data, prop, it.opts.ownProperties), () => {\n        cxt.setParams({ missingProperty: codegen_1._ `${prop}` }, true);\n        cxt.error();\n    });\n}\nexports.checkReportMissingProp = checkReportMissingProp;\nfunction checkMissingProp({ data, it: { opts } }, properties, missing) {\n    return codegen_1.or(...properties.map((prop) => codegen_1._ `${noPropertyInData(data, prop, opts.ownProperties)} && (${missing} = ${prop})`));\n}\nexports.checkMissingProp = checkMissingProp;\nfunction reportMissingProp(cxt, missing) {\n    cxt.setParams({ missingProperty: missing }, true);\n    cxt.error();\n}\nexports.reportMissingProp = reportMissingProp;\nfunction isOwnProperty(data, property) {\n    return codegen_1._ `Object.prototype.hasOwnProperty.call(${data}, ${property})`;\n}\nfunction propertyInData(data, property, ownProperties) {\n    const cond = codegen_1._ `${data}${codegen_1.getProperty(property)} !== undefined`;\n    return ownProperties ? codegen_1._ `${cond} && ${isOwnProperty(data, property)}` : cond;\n}\nexports.propertyInData = propertyInData;\nfunction noPropertyInData(data, property, ownProperties) {\n    const cond = codegen_1._ `${data}${codegen_1.getProperty(property)} === undefined`;\n    return ownProperties ? codegen_1._ `${cond} || !${isOwnProperty(data, property)}` : cond;\n}\nexports.noPropertyInData = noPropertyInData;\nfunction allSchemaProperties(schemaMap) {\n    return schemaMap ? Object.keys(schemaMap).filter((p) => p !== \"__proto__\") : [];\n}\nexports.allSchemaProperties = allSchemaProperties;\nfunction schemaProperties(it, schemaMap) {\n    return allSchemaProperties(schemaMap).filter((p) => !util_1.alwaysValidSchema(it, schemaMap[p]));\n}\nexports.schemaProperties = schemaProperties;\nfunction callValidateCode({ schemaCode, data, it: { gen, topSchemaRef, schemaPath, errorPath }, it }, func, context, passSchema) {\n    const dataAndSchema = passSchema ? codegen_1._ `${schemaCode}, ${data}, ${topSchemaRef}${schemaPath}` : data;\n    const valCxt = [\n        [names_1.default.dataPath, codegen_1.strConcat(names_1.default.dataPath, errorPath)],\n        [names_1.default.parentData, it.parentData],\n        [names_1.default.parentDataProperty, it.parentDataProperty],\n        [names_1.default.rootData, names_1.default.rootData],\n    ];\n    if (it.opts.dynamicRef)\n        valCxt.push([names_1.default.dynamicAnchors, names_1.default.dynamicAnchors]);\n    const args = codegen_1._ `${dataAndSchema}, ${gen.object(...valCxt)}`;\n    return context !== codegen_1.nil ? codegen_1._ `${func}.call(${context}, ${args})` : codegen_1._ `${func}(${args})`;\n}\nexports.callValidateCode = callValidateCode;\nfunction usePattern(gen, pattern) {\n    return gen.scopeValue(\"pattern\", {\n        key: pattern,\n        ref: new RegExp(pattern, \"u\"),\n        code: codegen_1._ `new RegExp(${pattern}, \"u\")`,\n    });\n}\nexports.usePattern = usePattern;\n//# sourceMappingURL=code.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst def = {\n    keyword: \"id\",\n    code() {\n        throw new Error('NOT SUPPORTED: keyword \"id\", use \"$id\" for schema ID');\n    },\n};\nexports.default = def;\n//# sourceMappingURL=id.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst id_1 = require(\"./id\");\nconst ref_1 = require(\"./ref\");\nconst core = [\n    \"$schema\",\n    \"$id\",\n    \"$defs\",\n    \"$vocabulary\",\n    \"definitions\",\n    id_1.default,\n    ref_1.default,\n];\nexports.default = core;\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.callRef = exports.getValidate = void 0;\nconst error_classes_1 = require(\"../../compile/error_classes\");\nconst code_1 = require(\"../code\");\nconst codegen_1 = require(\"../../compile/codegen\");\nconst names_1 = require(\"../../compile/names\");\nconst compile_1 = require(\"../../compile\");\nconst util_1 = require(\"../../compile/util\");\nconst def = {\n    keyword: \"$ref\",\n    schemaType: \"string\",\n    code(cxt) {\n        const { gen, schema, it } = cxt;\n        const { baseId, schemaEnv: env, validateName, opts, self } = it;\n        // TODO See comment in dynamicRef.ts\n        // This has to be improved to resolve #815.\n        if (schema === \"#\" || schema === \"#/\")\n            return callRootRef();\n        const schOrEnv = compile_1.resolveRef.call(self, env.root, baseId, schema);\n        if (schOrEnv === undefined)\n            throw new error_classes_1.MissingRefError(baseId, schema);\n        if (schOrEnv instanceof compile_1.SchemaEnv)\n            return callValidate(schOrEnv);\n        return inlineRefSchema(schOrEnv);\n        function callRootRef() {\n            if (env === env.root)\n                return callRef(cxt, validateName, env, env.$async);\n            const rootName = gen.scopeValue(\"root\", { ref: env.root });\n            return callRef(cxt, codegen_1._ `${rootName}.validate`, env.root, env.root.$async);\n        }\n        function callValidate(sch) {\n            const v = getValidate(cxt, sch);\n            callRef(cxt, v, sch, sch.$async);\n        }\n        function inlineRefSchema(sch) {\n            const schName = gen.scopeValue(\"schema\", opts.code.source === true ? { ref: sch, code: codegen_1.stringify(sch) } : { ref: sch });\n            const valid = gen.name(\"valid\");\n            const schCxt = cxt.subschema({\n                schema: sch,\n                strictSchema: true,\n                dataTypes: [],\n                schemaPath: codegen_1.nil,\n                topSchemaRef: schName,\n                errSchemaPath: schema,\n            }, valid);\n            cxt.mergeEvaluated(schCxt);\n            cxt.ok(valid);\n        }\n    },\n};\nfunction getValidate(cxt, sch) {\n    const { gen } = cxt;\n    return sch.validate\n        ? gen.scopeValue(\"validate\", { ref: sch.validate })\n        : codegen_1._ `${gen.scopeValue(\"wrapper\", { ref: sch })}.validate`;\n}\nexports.getValidate = getValidate;\nfunction callRef(cxt, v, sch, $async) {\n    const { gen, it } = cxt;\n    const { allErrors, schemaEnv: env, opts } = it;\n    const passCxt = opts.passContext ? names_1.default.this : codegen_1.nil;\n    if ($async)\n        callAsyncRef();\n    else\n        callSyncRef();\n    function callAsyncRef() {\n        if (!env.$async)\n            throw new Error(\"async schema referenced by sync schema\");\n        const valid = gen.let(\"valid\");\n        gen.try(() => {\n            gen.code(codegen_1._ `await ${code_1.callValidateCode(cxt, v, passCxt)}`);\n            addEvaluatedFrom(v); // TODO will not work with async, it has to be returned with the result\n            if (!allErrors)\n                gen.assign(valid, true);\n        }, (e) => {\n            gen.if(codegen_1._ `!(${e} instanceof ${it.ValidationError})`, () => gen.throw(e));\n            addErrorsFrom(e);\n            if (!allErrors)\n                gen.assign(valid, false);\n        });\n        cxt.ok(valid);\n    }\n    function callSyncRef() {\n        cxt.result(code_1.callValidateCode(cxt, v, passCxt), () => addEvaluatedFrom(v), () => addErrorsFrom(v));\n    }\n    function addErrorsFrom(source) {\n        const errs = codegen_1._ `${source}.errors`;\n        gen.assign(names_1.default.vErrors, codegen_1._ `${names_1.default.vErrors} === null ? ${errs} : ${names_1.default.vErrors}.concat(${errs})`); // TODO tagged\n        gen.assign(names_1.default.errors, codegen_1._ `${names_1.default.vErrors}.length`);\n    }\n    function addEvaluatedFrom(source) {\n        var _a;\n        if (!it.opts.unevaluated)\n            return;\n        const schEvaluated = (_a = sch === null || sch === void 0 ? void 0 : sch.validate) === null || _a === void 0 ? void 0 : _a.evaluated;\n        // TODO refactor\n        if (it.props !== true) {\n            if (schEvaluated && !schEvaluated.dynamicProps) {\n                if (schEvaluated.props !== undefined) {\n                    it.props = util_1.mergeEvaluated.props(gen, schEvaluated.props, it.props);\n                }\n            }\n            else {\n                const props = gen.var(\"props\", codegen_1._ `${source}.evaluated.props`);\n                it.props = util_1.mergeEvaluated.props(gen, props, it.props, codegen_1.Name);\n            }\n        }\n        if (it.items !== true) {\n            if (schEvaluated && !schEvaluated.dynamicItems) {\n                if (schEvaluated.items !== undefined) {\n                    it.items = util_1.mergeEvaluated.items(gen, schEvaluated.items, it.items);\n                }\n            }\n            else {\n                const items = gen.var(\"items\", codegen_1._ `${source}.evaluated.items`);\n                it.items = util_1.mergeEvaluated.items(gen, items, it.items, codegen_1.Name);\n            }\n        }\n    }\n}\nexports.callRef = callRef;\nexports.default = def;\n//# sourceMappingURL=ref.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst core_1 = require(\"./core\");\nconst validation_1 = require(\"./validation\");\nconst applicator_1 = require(\"./applicator\");\nconst format_1 = require(\"./format\");\nconst metadata_1 = require(\"./metadata\");\nconst draft7Vocabularies = [\n    core_1.default,\n    validation_1.default,\n    applicator_1.default,\n    format_1.default,\n    metadata_1.metadataVocabulary,\n    metadata_1.contentVocabulary,\n];\nexports.default = draft7Vocabularies;\n//# sourceMappingURL=draft7.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst error = {\n    message: ({ schemaCode }) => codegen_1.str `should match format \"${schemaCode}\"`,\n    params: ({ schemaCode }) => codegen_1._ `{format: ${schemaCode}}`,\n};\nconst def = {\n    keyword: \"format\",\n    type: [\"number\", \"string\"],\n    schemaType: \"string\",\n    $data: true,\n    error,\n    code(cxt, ruleType) {\n        const { gen, data, $data, schema, schemaCode, it } = cxt;\n        const { opts, errSchemaPath, schemaEnv, self } = it;\n        if (!opts.validateFormats)\n            return;\n        if ($data)\n            validate$DataFormat();\n        else\n            validateFormat();\n        function validate$DataFormat() {\n            const fmts = gen.scopeValue(\"formats\", {\n                ref: self.formats,\n                code: opts.code.formats,\n            });\n            const fDef = gen.const(\"fDef\", codegen_1._ `${fmts}[${schemaCode}]`);\n            const fType = gen.let(\"fType\");\n            const format = gen.let(\"format\");\n            // TODO simplify\n            gen.if(codegen_1._ `typeof ${fDef} == \"object\" && !(${fDef} instanceof RegExp)`, () => gen.assign(fType, codegen_1._ `${fDef}.type || \"string\"`).assign(format, codegen_1._ `${fDef}.validate`), () => gen.assign(fType, codegen_1._ `\"string\"`).assign(format, fDef));\n            cxt.fail$data(codegen_1.or(unknownFmt(), invalidFmt()));\n            function unknownFmt() {\n                if (opts.strict === false)\n                    return codegen_1.nil;\n                return codegen_1._ `${schemaCode} && !${format}`;\n            }\n            function invalidFmt() {\n                const callFormat = schemaEnv.$async\n                    ? codegen_1._ `(${fDef}.async ? await ${format}(${data}) : ${format}(${data}))`\n                    : codegen_1._ `${format}(${data})`;\n                const validData = codegen_1._ `(typeof ${format} == \"function\" ? ${callFormat} : ${format}.test(${data}))`;\n                return codegen_1._ `${format} && ${format} !== true && ${fType} === ${ruleType} && !${validData}`;\n            }\n        }\n        function validateFormat() {\n            const formatDef = self.formats[schema];\n            if (!formatDef) {\n                unknownFormat();\n                return;\n            }\n            if (formatDef === true)\n                return;\n            const [fmtType, format, fmtRef] = getFormat(formatDef);\n            if (fmtType === ruleType)\n                cxt.pass(validCondition());\n            function unknownFormat() {\n                if (opts.strict === false) {\n                    self.logger.warn(unknownMsg());\n                    return;\n                }\n                throw new Error(unknownMsg());\n                function unknownMsg() {\n                    return `unknown format \"${schema}\" ignored in schema at path \"${errSchemaPath}\"`;\n                }\n            }\n            function getFormat(fmtDef) {\n                const fmt = gen.scopeValue(\"formats\", {\n                    key: schema,\n                    ref: fmtDef,\n                    code: opts.code.formats ? codegen_1._ `${opts.code.formats}${codegen_1.getProperty(schema)}` : undefined,\n                });\n                if (typeof fmtDef == \"object\" && !(fmtDef instanceof RegExp)) {\n                    return [fmtDef.type || \"string\", fmtDef.validate, codegen_1._ `${fmt}.validate`];\n                }\n                return [\"string\", fmtDef, fmt];\n            }\n            function validCondition() {\n                if (typeof formatDef == \"object\" && !(formatDef instanceof RegExp) && formatDef.async) {\n                    if (!schemaEnv.$async)\n                        throw new Error(\"async format in sync schema\");\n                    return codegen_1._ `await ${fmtRef}(${data})`;\n                }\n                return typeof format == \"function\" ? codegen_1._ `${fmtRef}(${data})` : codegen_1._ `${fmtRef}.test(${data})`;\n            }\n        }\n    },\n};\nexports.default = def;\n//# sourceMappingURL=format.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst format_1 = require(\"./format\");\nconst format = [format_1.default];\nexports.default = format;\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.contentVocabulary = exports.metadataVocabulary = void 0;\nexports.metadataVocabulary = [\n    \"title\",\n    \"description\",\n    \"default\",\n    \"deprecated\",\n    \"readOnly\",\n    \"writeOnly\",\n    \"examples\",\n];\nexports.contentVocabulary = [\n    \"contentMediaType\",\n    \"contentEncoding\",\n    \"contentSchema\",\n];\n//# sourceMappingURL=metadata.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst equal = require(\"fast-deep-equal\");\nconst error = {\n    message: \"should be equal to constant\",\n    params: ({ schemaCode }) => codegen_1._ `{allowedValue: ${schemaCode}}`,\n};\nconst def = {\n    keyword: \"const\",\n    $data: true,\n    error,\n    code(cxt) {\n        const eql = cxt.gen.scopeValue(\"func\", {\n            ref: equal,\n            code: codegen_1._ `require(\"ajv/dist/compile/equal\")`,\n        });\n        // TODO optimize for scalar values in schema\n        cxt.fail$data(codegen_1._ `!${eql}(${cxt.data}, ${cxt.schemaCode})`);\n    },\n};\nexports.default = def;\n//# sourceMappingURL=const.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst equal = require(\"fast-deep-equal\");\nconst error = {\n    message: \"should be equal to one of the allowed values\",\n    params: ({ schemaCode }) => codegen_1._ `{allowedValues: ${schemaCode}}`,\n};\nconst def = {\n    keyword: \"enum\",\n    schemaType: \"array\",\n    $data: true,\n    error,\n    code(cxt) {\n        const { gen, data, $data, schema, schemaCode, it } = cxt;\n        if (!$data && schema.length === 0)\n            throw new Error(\"enum must have non-empty array\");\n        const useLoop = schema.length >= it.opts.loopEnum;\n        const eql = cxt.gen.scopeValue(\"func\", {\n            ref: equal,\n            code: codegen_1._ `require(\"ajv/dist/compile/equal\")`,\n        });\n        let valid;\n        if (useLoop || $data) {\n            valid = gen.let(\"valid\");\n            cxt.block$data(valid, loopEnum);\n        }\n        else {\n            /* istanbul ignore if */\n            if (!Array.isArray(schema))\n                throw new Error(\"ajv implementation error\");\n            const vSchema = gen.const(\"vSchema\", schemaCode);\n            valid = codegen_1.or(...schema.map((_x, i) => equalCode(vSchema, i)));\n        }\n        cxt.pass(valid);\n        function loopEnum() {\n            gen.assign(valid, false);\n            gen.forOf(\"v\", schemaCode, (v) => gen.if(codegen_1._ `${eql}(${data}, ${v})`, () => gen.assign(valid, true).break()));\n        }\n        function equalCode(vSchema, i) {\n            const sch = schema[i];\n            return sch && typeof sch === \"object\"\n                ? codegen_1._ `${eql}(${data}, ${vSchema}[${i}])`\n                : codegen_1._ `${data} === ${sch}`;\n        }\n    },\n};\nexports.default = def;\n//# sourceMappingURL=enum.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst limitNumber_1 = require(\"./limitNumber\");\nconst multipleOf_1 = require(\"./multipleOf\");\nconst limitLength_1 = require(\"./limitLength\");\nconst pattern_1 = require(\"./pattern\");\nconst limitProperties_1 = require(\"./limitProperties\");\nconst required_1 = require(\"./required\");\nconst limitItems_1 = require(\"./limitItems\");\nconst uniqueItems_1 = require(\"./uniqueItems\");\nconst const_1 = require(\"./const\");\nconst enum_1 = require(\"./enum\");\nconst validation = [\n    // number\n    limitNumber_1.default,\n    multipleOf_1.default,\n    // string\n    limitLength_1.default,\n    pattern_1.default,\n    // object\n    limitProperties_1.default,\n    required_1.default,\n    // array\n    limitItems_1.default,\n    uniqueItems_1.default,\n    // any\n    { keyword: \"nullable\", schemaType: \"boolean\" },\n    const_1.default,\n    enum_1.default,\n];\nexports.default = validation;\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst error = {\n    message({ keyword, schemaCode }) {\n        const comp = keyword === \"maxItems\" ? \"more\" : \"fewer\";\n        return codegen_1.str `should NOT have ${comp} than ${schemaCode} items`;\n    },\n    params: ({ schemaCode }) => codegen_1._ `{limit: ${schemaCode}}`,\n};\nconst def = {\n    keyword: [\"maxItems\", \"minItems\"],\n    type: \"array\",\n    schemaType: \"number\",\n    $data: true,\n    error,\n    code(cxt) {\n        const { keyword, data, schemaCode } = cxt;\n        const op = keyword === \"maxItems\" ? codegen_1.operators.GT : codegen_1.operators.LT;\n        cxt.fail$data(codegen_1._ `${data}.length ${op} ${schemaCode}`);\n    },\n};\nexports.default = def;\n//# sourceMappingURL=limitItems.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst ucs2length_1 = require(\"../../compile/ucs2length\");\nconst error = {\n    message({ keyword, schemaCode }) {\n        const comp = keyword === \"maxLength\" ? \"more\" : \"fewer\";\n        return codegen_1.str `should NOT have ${comp} than ${schemaCode} characters`;\n    },\n    params: ({ schemaCode }) => codegen_1._ `{limit: ${schemaCode}}`,\n};\nconst def = {\n    keyword: [\"maxLength\", \"minLength\"],\n    type: \"string\",\n    schemaType: \"number\",\n    $data: true,\n    error,\n    code(cxt) {\n        const { keyword, data, schemaCode, it } = cxt;\n        const op = keyword === \"maxLength\" ? codegen_1.operators.GT : codegen_1.operators.LT;\n        let len;\n        if (it.opts.unicode === false) {\n            len = codegen_1._ `${data}.length`;\n        }\n        else {\n            const u2l = cxt.gen.scopeValue(\"func\", {\n                ref: ucs2length_1.default,\n                code: codegen_1._ `require(\"ajv/dist/compile/ucs2length\").default`,\n            });\n            len = codegen_1._ `${u2l}(${data})`;\n        }\n        cxt.fail$data(codegen_1._ `${len} ${op} ${schemaCode}`);\n    },\n};\nexports.default = def;\n//# sourceMappingURL=limitLength.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst ops = codegen_1.operators;\nconst KWDs = {\n    maximum: { okStr: \"<=\", ok: ops.LTE, fail: ops.GT },\n    minimum: { okStr: \">=\", ok: ops.GTE, fail: ops.LT },\n    exclusiveMaximum: { okStr: \"<\", ok: ops.LT, fail: ops.GTE },\n    exclusiveMinimum: { okStr: \">\", ok: ops.GT, fail: ops.LTE },\n};\nconst error = {\n    message: ({ keyword, schemaCode }) => codegen_1.str `should be ${KWDs[keyword].okStr} ${schemaCode}`,\n    params: ({ keyword, schemaCode }) => codegen_1._ `{comparison: ${KWDs[keyword].okStr}, limit: ${schemaCode}}`,\n};\nconst def = {\n    keyword: Object.keys(KWDs),\n    type: \"number\",\n    schemaType: \"number\",\n    $data: true,\n    error,\n    code(cxt) {\n        const { keyword, data, schemaCode } = cxt;\n        cxt.fail$data(codegen_1._ `${data} ${KWDs[keyword].fail} ${schemaCode} || isNaN(${data})`);\n    },\n};\nexports.default = def;\n//# sourceMappingURL=limitNumber.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst error = {\n    message({ keyword, schemaCode }) {\n        const comp = keyword === \"maxProperties\" ? \"more\" : \"fewer\";\n        return codegen_1.str `should NOT have ${comp} than ${schemaCode} items`;\n    },\n    params: ({ schemaCode }) => codegen_1._ `{limit: ${schemaCode}}`,\n};\nconst def = {\n    keyword: [\"maxProperties\", \"minProperties\"],\n    type: \"object\",\n    schemaType: \"number\",\n    $data: true,\n    error,\n    code(cxt) {\n        const { keyword, data, schemaCode } = cxt;\n        const op = keyword === \"maxProperties\" ? codegen_1.operators.GT : codegen_1.operators.LT;\n        cxt.fail$data(codegen_1._ `Object.keys(${data}).length ${op} ${schemaCode}`);\n    },\n};\nexports.default = def;\n//# sourceMappingURL=limitProperties.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst error = {\n    message: ({ schemaCode }) => codegen_1.str `should be multiple of ${schemaCode}`,\n    params: ({ schemaCode }) => codegen_1._ `{multipleOf: ${schemaCode}}`,\n};\nconst def = {\n    keyword: \"multipleOf\",\n    type: \"number\",\n    schemaType: \"number\",\n    $data: true,\n    error,\n    code(cxt) {\n        const { gen, data, schemaCode, it } = cxt;\n        // const bdt = bad$DataType(schemaCode, <string>def.schemaType, $data)\n        const prec = it.opts.multipleOfPrecision;\n        const res = gen.let(\"res\");\n        const invalid = prec\n            ? codegen_1._ `Math.abs(Math.round(${res}) - ${res}) > 1e-${prec}`\n            : codegen_1._ `${res} !== parseInt(${res})`;\n        cxt.fail$data(codegen_1._ `(${schemaCode} === 0 || (${res} = ${data}/${schemaCode}, ${invalid}))`);\n    },\n};\nexports.default = def;\n//# sourceMappingURL=multipleOf.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst code_1 = require(\"../code\");\nconst codegen_1 = require(\"../../compile/codegen\");\nconst error = {\n    message: ({ schemaCode }) => codegen_1.str `should match pattern \"${schemaCode}\"`,\n    params: ({ schemaCode }) => codegen_1._ `{pattern: ${schemaCode}}`,\n};\nconst def = {\n    keyword: \"pattern\",\n    type: \"string\",\n    schemaType: \"string\",\n    $data: true,\n    error,\n    code(cxt) {\n        const { gen, data, $data, schema, schemaCode } = cxt;\n        const regExp = $data ? codegen_1._ `(new RegExp(${schemaCode}, \"u\"))` : code_1.usePattern(gen, schema); // TODO regexp should be wrapped in try/catch\n        cxt.fail$data(codegen_1._ `!${regExp}.test(${data})`);\n    },\n};\nexports.default = def;\n//# sourceMappingURL=pattern.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst code_1 = require(\"../code\");\nconst codegen_1 = require(\"../../compile/codegen\");\nconst error = {\n    message: ({ params: { missingProperty } }) => codegen_1.str `should have required property '${missingProperty}'`,\n    params: ({ params: { missingProperty } }) => codegen_1._ `{missingProperty: ${missingProperty}}`,\n};\nconst def = {\n    keyword: \"required\",\n    type: \"object\",\n    schemaType: \"array\",\n    $data: true,\n    error,\n    code(cxt) {\n        const { gen, schema, schemaCode, data, $data, it } = cxt;\n        const { opts } = it;\n        if (!$data && schema.length === 0)\n            return;\n        const useLoop = schema.length >= opts.loopRequired;\n        if (it.allErrors)\n            allErrorsMode();\n        else\n            exitOnErrorMode();\n        function allErrorsMode() {\n            if (useLoop || $data) {\n                cxt.block$data(codegen_1.nil, loopAllRequired);\n            }\n            else {\n                for (const prop of schema) {\n                    code_1.checkReportMissingProp(cxt, prop);\n                }\n            }\n        }\n        function exitOnErrorMode() {\n            const missing = gen.let(\"missing\");\n            if (useLoop || $data) {\n                const valid = gen.let(\"valid\", true);\n                cxt.block$data(valid, () => loopUntilMissing(missing, valid));\n                cxt.ok(valid);\n            }\n            else {\n                gen.if(code_1.checkMissingProp(cxt, schema, missing));\n                code_1.reportMissingProp(cxt, missing);\n                gen.else();\n            }\n        }\n        function loopAllRequired() {\n            gen.forOf(\"prop\", schemaCode, (prop) => {\n                cxt.setParams({ missingProperty: prop });\n                gen.if(code_1.noPropertyInData(data, prop, opts.ownProperties), () => cxt.error());\n            });\n        }\n        function loopUntilMissing(missing, valid) {\n            cxt.setParams({ missingProperty: missing });\n            gen.forOf(missing, schemaCode, () => {\n                gen.assign(valid, code_1.propertyInData(data, missing, opts.ownProperties));\n                gen.if(codegen_1.not(valid), () => {\n                    cxt.error();\n                    gen.break();\n                });\n            }, codegen_1.nil);\n        }\n    },\n};\nexports.default = def;\n//# sourceMappingURL=required.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst dataType_1 = require(\"../../compile/validate/dataType\");\nconst codegen_1 = require(\"../../compile/codegen\");\nconst equal = require(\"fast-deep-equal\");\nconst error = {\n    message: ({ params: { i, j } }) => codegen_1.str `should NOT have duplicate items (items ## ${j} and ${i} are identical)`,\n    params: ({ params: { i, j } }) => codegen_1._ `{i: ${i}, j: ${j}}`,\n};\nconst def = {\n    keyword: \"uniqueItems\",\n    type: \"array\",\n    schemaType: \"boolean\",\n    $data: true,\n    error,\n    code(cxt) {\n        const { gen, data, $data, schema, parentSchema, schemaCode, it } = cxt;\n        if (!$data && !schema)\n            return;\n        const valid = gen.let(\"valid\");\n        const itemTypes = parentSchema.items ? dataType_1.getSchemaTypes(parentSchema.items) : [];\n        cxt.block$data(valid, validateUniqueItems, codegen_1._ `${schemaCode} === false`);\n        cxt.ok(valid);\n        function validateUniqueItems() {\n            const i = gen.let(\"i\", codegen_1._ `${data}.length`);\n            const j = gen.let(\"j\");\n            cxt.setParams({ i, j });\n            gen.assign(valid, true);\n            gen.if(codegen_1._ `${i} > 1`, () => (canOptimize() ? loopN : loopN2)(i, j));\n        }\n        function canOptimize() {\n            return itemTypes.length > 0 && !itemTypes.some((t) => t === \"object\" || t === \"array\");\n        }\n        function loopN(i, j) {\n            const item = gen.name(\"item\");\n            const wrongType = dataType_1.checkDataTypes(itemTypes, item, it.opts.strict, dataType_1.DataType.Wrong);\n            const indices = gen.const(\"indices\", codegen_1._ `{}`);\n            gen.for(codegen_1._ `;${i}--;`, () => {\n                gen.let(item, codegen_1._ `${data}[${i}]`);\n                gen.if(wrongType, codegen_1._ `continue`);\n                if (itemTypes.length > 1)\n                    gen.if(codegen_1._ `typeof ${item} == \"string\"`, codegen_1._ `${item} += \"_\"`);\n                gen\n                    .if(codegen_1._ `typeof ${indices}[${item}] == \"number\"`, () => {\n                    gen.assign(j, codegen_1._ `${indices}[${item}]`);\n                    cxt.error();\n                    gen.assign(valid, false).break();\n                })\n                    .code(codegen_1._ `${indices}[${item}] = ${i}`);\n            });\n        }\n        function loopN2(i, j) {\n            const eql = cxt.gen.scopeValue(\"func\", {\n                ref: equal,\n                code: codegen_1._ `require(\"ajv/dist/compile/equal\")`,\n            });\n            const outer = gen.name(\"outer\");\n            gen.label(outer).for(codegen_1._ `;${i}--;`, () => gen.for(codegen_1._ `${j} = ${i}; ${j}--;`, () => gen.if(codegen_1._ `${eql}(${data}[${i}], ${data}[${j}])`, () => {\n                cxt.error();\n                gen.assign(valid, false).break(outer);\n            })));\n        }\n    },\n};\nexports.default = def;\n//# sourceMappingURL=uniqueItems.js.map","'use strict';\n\n// do not edit .js files directly - edit src/index.jst\n\n\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n\n    var length, i, keys;\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n\n\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n\n    for (i = length; i-- !== 0;)\n      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      var key = keys[i];\n\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  // true if both NaN, false otherwise\n  return a!==a && b!==b;\n};\n","'use strict';\n\nvar traverse = module.exports = function (schema, opts, cb) {\n  // Legacy support for v0.3.1 and earlier.\n  if (typeof opts == 'function') {\n    cb = opts;\n    opts = {};\n  }\n\n  cb = opts.cb || cb;\n  var pre = (typeof cb == 'function') ? cb : cb.pre || function() {};\n  var post = cb.post || function() {};\n\n  _traverse(opts, pre, post, schema, '', schema);\n};\n\n\ntraverse.keywords = {\n  additionalItems: true,\n  items: true,\n  contains: true,\n  additionalProperties: true,\n  propertyNames: true,\n  not: true,\n  if: true,\n  then: true,\n  else: true\n};\n\ntraverse.arrayKeywords = {\n  items: true,\n  allOf: true,\n  anyOf: true,\n  oneOf: true\n};\n\ntraverse.propsKeywords = {\n  $defs: true,\n  definitions: true,\n  properties: true,\n  patternProperties: true,\n  dependencies: true\n};\n\ntraverse.skipKeywords = {\n  default: true,\n  enum: true,\n  const: true,\n  required: true,\n  maximum: true,\n  minimum: true,\n  exclusiveMaximum: true,\n  exclusiveMinimum: true,\n  multipleOf: true,\n  maxLength: true,\n  minLength: true,\n  pattern: true,\n  format: true,\n  maxItems: true,\n  minItems: true,\n  uniqueItems: true,\n  maxProperties: true,\n  minProperties: true\n};\n\n\nfunction _traverse(opts, pre, post, schema, jsonPtr, rootSchema, parentJsonPtr, parentKeyword, parentSchema, keyIndex) {\n  if (schema && typeof schema == 'object' && !Array.isArray(schema)) {\n    pre(schema, jsonPtr, rootSchema, parentJsonPtr, parentKeyword, parentSchema, keyIndex);\n    for (var key in schema) {\n      var sch = schema[key];\n      if (Array.isArray(sch)) {\n        if (key in traverse.arrayKeywords) {\n          for (var i=0; i<sch.length; i++)\n            _traverse(opts, pre, post, sch[i], jsonPtr + '/' + key + '/' + i, rootSchema, jsonPtr, key, schema, i);\n        }\n      } else if (key in traverse.propsKeywords) {\n        if (sch && typeof sch == 'object') {\n          for (var prop in sch)\n            _traverse(opts, pre, post, sch[prop], jsonPtr + '/' + key + '/' + escapeJsonPtr(prop), rootSchema, jsonPtr, key, schema, prop);\n        }\n      } else if (key in traverse.keywords || (opts.allKeys && !(key in traverse.skipKeywords))) {\n        _traverse(opts, pre, post, sch, jsonPtr + '/' + key, rootSchema, jsonPtr, key, schema);\n      }\n    }\n    post(schema, jsonPtr, rootSchema, parentJsonPtr, parentKeyword, parentSchema, keyIndex);\n  }\n}\n\n\nfunction escapeJsonPtr(str) {\n  return str.replace(/~/g, '~0').replace(/\\//g, '~1');\n}\n","// Version 0.8.0 - Copyright 2012 - 2018 -  Jim Riecken <jimr@jimr.ca>\n//\n// Released under the MIT License - https://github.com/jriecken/sat-js\n//\n// A simple library for determining intersections of circles and\n// polygons using the Separating Axis Theorem.\n/** @preserve SAT.js - Version 0.8.0 - Copyright 2012 - 2018 - Jim Riecken <jimr@jimr.ca> - released under the MIT License. https://github.com/jriecken/sat-js */\n\n/*global define: false, module: false*/\n/*jshint shadow:true, sub:true, forin:true, noarg:true, noempty:true,\n  eqeqeq:true, bitwise:true, strict:true, undef:true,\n  curly:true, browser:true */\n\n// Create a UMD wrapper for SAT. Works in:\n//\n//  - Plain browser via global SAT variable\n//  - AMD loader (like require.js)\n//  - Node.js\n//\n// The quoted properties all over the place are used so that the Closure Compiler\n// does not mangle the exposed API in advanced mode.\n/**\n * @param {*} root - The global scope\n * @param {Function} factory - Factory that creates SAT module\n */\n(function (root, factory) {\n  \"use strict\";\n  if (typeof define === 'function' && define['amd']) {\n    define(factory);\n  } else if (typeof exports === 'object') {\n    module['exports'] = factory();\n  } else {\n    root['SAT'] = factory();\n  }\n}(this, function () {\n  \"use strict\";\n\n  var SAT = {};\n\n  //\n  // ## Vector\n  //\n  // Represents a vector in two dimensions with `x` and `y` properties.\n\n\n  // Create a new Vector, optionally passing in the `x` and `y` coordinates. If\n  // a coordinate is not specified, it will be set to `0`\n  /**\n   * @param {?number=} x The x position.\n   * @param {?number=} y The y position.\n   * @constructor\n   */\n  function Vector(x, y) {\n    this['x'] = x || 0;\n    this['y'] = y || 0;\n  }\n  SAT['Vector'] = Vector;\n  // Alias `Vector` as `V`\n  SAT['V'] = Vector;\n\n\n  // Copy the values of another Vector into this one.\n  /**\n   * @param {Vector} other The other Vector.\n   * @return {Vector} This for chaining.\n   */\n  Vector.prototype['copy'] = Vector.prototype.copy = function(other) {\n    this['x'] = other['x'];\n    this['y'] = other['y'];\n    return this;\n  };\n\n  // Create a new vector with the same coordinates as this on.\n  /**\n   * @return {Vector} The new cloned vector\n   */\n  Vector.prototype['clone'] = Vector.prototype.clone = function() {\n    return new Vector(this['x'], this['y']);\n  };\n\n  // Change this vector to be perpendicular to what it was before. (Effectively\n  // roatates it 90 degrees in a clockwise direction)\n  /**\n   * @return {Vector} This for chaining.\n   */\n  Vector.prototype['perp'] = Vector.prototype.perp = function() {\n    var x = this['x'];\n    this['x'] = this['y'];\n    this['y'] = -x;\n    return this;\n  };\n\n  // Rotate this vector (counter-clockwise) by the specified angle (in radians).\n  /**\n   * @param {number} angle The angle to rotate (in radians)\n   * @return {Vector} This for chaining.\n   */\n  Vector.prototype['rotate'] = Vector.prototype.rotate = function (angle) {\n    var x = this['x'];\n    var y = this['y'];\n    this['x'] = x * Math.cos(angle) - y * Math.sin(angle);\n    this['y'] = x * Math.sin(angle) + y * Math.cos(angle);\n    return this;\n  };\n\n  // Reverse this vector.\n  /**\n   * @return {Vector} This for chaining.\n   */\n  Vector.prototype['reverse'] = Vector.prototype.reverse = function() {\n    this['x'] = -this['x'];\n    this['y'] = -this['y'];\n    return this;\n  };\n\n\n  // Normalize this vector.  (make it have length of `1`)\n  /**\n   * @return {Vector} This for chaining.\n   */\n  Vector.prototype['normalize'] = Vector.prototype.normalize = function() {\n    var d = this.len();\n    if(d > 0) {\n      this['x'] = this['x'] / d;\n      this['y'] = this['y'] / d;\n    }\n    return this;\n  };\n\n  // Add another vector to this one.\n  /**\n   * @param {Vector} other The other Vector.\n   * @return {Vector} This for chaining.\n   */\n  Vector.prototype['add'] = Vector.prototype.add = function(other) {\n    this['x'] += other['x'];\n    this['y'] += other['y'];\n    return this;\n  };\n\n  // Subtract another vector from this one.\n  /**\n   * @param {Vector} other The other Vector.\n   * @return {Vector} This for chaiing.\n   */\n  Vector.prototype['sub'] = Vector.prototype.sub = function(other) {\n    this['x'] -= other['x'];\n    this['y'] -= other['y'];\n    return this;\n  };\n\n  // Scale this vector. An independent scaling factor can be provided\n  // for each axis, or a single scaling factor that will scale both `x` and `y`.\n  /**\n   * @param {number} x The scaling factor in the x direction.\n   * @param {?number=} y The scaling factor in the y direction.  If this\n   *   is not specified, the x scaling factor will be used.\n   * @return {Vector} This for chaining.\n   */\n  Vector.prototype['scale'] = Vector.prototype.scale = function(x,y) {\n    this['x'] *= x;\n    this['y'] *= typeof y != 'undefined' ? y : x;\n    return this;\n  };\n\n  // Project this vector on to another vector.\n  /**\n   * @param {Vector} other The vector to project onto.\n   * @return {Vector} This for chaining.\n   */\n  Vector.prototype['project'] = Vector.prototype.project = function(other) {\n    var amt = this.dot(other) / other.len2();\n    this['x'] = amt * other['x'];\n    this['y'] = amt * other['y'];\n    return this;\n  };\n\n  // Project this vector onto a vector of unit length. This is slightly more efficient\n  // than `project` when dealing with unit vectors.\n  /**\n   * @param {Vector} other The unit vector to project onto.\n   * @return {Vector} This for chaining.\n   */\n  Vector.prototype['projectN'] = Vector.prototype.projectN = function(other) {\n    var amt = this.dot(other);\n    this['x'] = amt * other['x'];\n    this['y'] = amt * other['y'];\n    return this;\n  };\n\n  // Reflect this vector on an arbitrary axis.\n  /**\n   * @param {Vector} axis The vector representing the axis.\n   * @return {Vector} This for chaining.\n   */\n  Vector.prototype['reflect'] = Vector.prototype.reflect = function(axis) {\n    var x = this['x'];\n    var y = this['y'];\n    this.project(axis).scale(2);\n    this['x'] -= x;\n    this['y'] -= y;\n    return this;\n  };\n\n  // Reflect this vector on an arbitrary axis (represented by a unit vector). This is\n  // slightly more efficient than `reflect` when dealing with an axis that is a unit vector.\n  /**\n   * @param {Vector} axis The unit vector representing the axis.\n   * @return {Vector} This for chaining.\n   */\n  Vector.prototype['reflectN'] = Vector.prototype.reflectN = function(axis) {\n    var x = this['x'];\n    var y = this['y'];\n    this.projectN(axis).scale(2);\n    this['x'] -= x;\n    this['y'] -= y;\n    return this;\n  };\n\n  // Get the dot product of this vector and another.\n  /**\n   * @param {Vector}  other The vector to dot this one against.\n   * @return {number} The dot product.\n   */\n  Vector.prototype['dot'] = Vector.prototype.dot = function(other) {\n    return this['x'] * other['x'] + this['y'] * other['y'];\n  };\n\n  // Get the squared length of this vector.\n  /**\n   * @return {number} The length^2 of this vector.\n   */\n  Vector.prototype['len2'] = Vector.prototype.len2 = function() {\n    return this.dot(this);\n  };\n\n  // Get the length of this vector.\n  /**\n   * @return {number} The length of this vector.\n   */\n  Vector.prototype['len'] = Vector.prototype.len = function() {\n    return Math.sqrt(this.len2());\n  };\n\n  // ## Circle\n  //\n  // Represents a circle with a position and a radius.\n\n  // Create a new circle, optionally passing in a position and/or radius. If no position\n  // is given, the circle will be at `(0,0)`. If no radius is provided, the circle will\n  // have a radius of `0`.\n  /**\n   * @param {Vector=} pos A vector representing the position of the center of the circle\n   * @param {?number=} r The radius of the circle\n   * @constructor\n   */\n  function Circle(pos, r) {\n    this['pos'] = pos || new Vector();\n    this['r'] = r || 0;\n    this['offset'] = new Vector();\n  }\n  SAT['Circle'] = Circle;\n\n  // Compute the axis-aligned bounding box (AABB) of this Circle.\n  //\n  // Note: Returns a _new_ `Polygon` each time you call this.\n  /**\n   * @return {Polygon} The AABB\n   */\n  Circle.prototype['getAABB'] = Circle.prototype.getAABB = function() {\n    var r = this['r'];\n    var corner = this['pos'].clone().add(this['offset']).sub(new Vector(r, r));\n    return new Box(corner, r*2, r*2).toPolygon();\n  };\n\n  // Set the current offset to apply to the radius.\n  /**\n   * @param {Vector} offset The new offset vector.\n   * @return {Circle} This for chaining.\n   */\n  Circle.prototype['setOffset'] = Circle.prototype.setOffset = function(offset) {\n    this['offset'] = offset;\n    return this;\n  };\n\n  // ## Polygon\n  //\n  // Represents a *convex* polygon with any number of points (specified in counter-clockwise order)\n  //\n  // Note: Do _not_ manually change the `points`, `angle`, or `offset` properties. Use the\n  // provided setters. Otherwise the calculated properties will not be updated correctly.\n  //\n  // `pos` can be changed directly.\n\n  // Create a new polygon, passing in a position vector, and an array of points (represented\n  // by vectors relative to the position vector). If no position is passed in, the position\n  // of the polygon will be `(0,0)`.\n  /**\n   * @param {Vector=} pos A vector representing the origin of the polygon. (all other\n   *   points are relative to this one)\n   * @param {Array<Vector>=} points An array of vectors representing the points in the polygon,\n   *   in counter-clockwise order.\n   * @constructor\n   */\n  function Polygon(pos, points) {\n    this['pos'] = pos || new Vector();\n    this['angle'] = 0;\n    this['offset'] = new Vector();\n    this.setPoints(points || []);\n  }\n  SAT['Polygon'] = Polygon;\n\n  // Set the points of the polygon. Any consecutive duplicate points will be combined.\n  //\n  // Note: The points are counter-clockwise *with respect to the coordinate system*.\n  // If you directly draw the points on a screen that has the origin at the top-left corner\n  // it will _appear_ visually that the points are being specified clockwise. This is just\n  // because of the inversion of the Y-axis when being displayed.\n  /**\n   * @param {Array<Vector>=} points An array of vectors representing the points in the polygon,\n   *   in counter-clockwise order.\n   * @return {Polygon} This for chaining.\n   */\n  Polygon.prototype['setPoints'] = Polygon.prototype.setPoints = function(points) {\n    // Only re-allocate if this is a new polygon or the number of points has changed.\n    var lengthChanged = !this['points'] || this['points'].length !== points.length;\n    if (lengthChanged) {\n      var i;\n      var calcPoints = this['calcPoints'] = [];\n      var edges = this['edges'] = [];\n      var normals = this['normals'] = [];\n      // Allocate the vector arrays for the calculated properties\n      for (i = 0; i < points.length; i++) {\n        // Remove consecutive duplicate points\n        var p1 = points[i];\n        var p2 = i < points.length - 1 ? points[i + 1] : points[0];\n        if (p1 !== p2 && p1.x === p2.x && p1.y === p2.y) {\n          points.splice(i, 1);\n          i -= 1;\n          continue;\n        }\n        calcPoints.push(new Vector());\n        edges.push(new Vector());\n        normals.push(new Vector());\n      }\n    }\n    this['points'] = points;\n    this._recalc();\n    return this;\n  };\n\n  // Set the current rotation angle of the polygon.\n  /**\n   * @param {number} angle The current rotation angle (in radians).\n   * @return {Polygon} This for chaining.\n   */\n  Polygon.prototype['setAngle'] = Polygon.prototype.setAngle = function(angle) {\n    this['angle'] = angle;\n    this._recalc();\n    return this;\n  };\n\n  // Set the current offset to apply to the `points` before applying the `angle` rotation.\n  /**\n   * @param {Vector} offset The new offset vector.\n   * @return {Polygon} This for chaining.\n   */\n  Polygon.prototype['setOffset'] = Polygon.prototype.setOffset = function(offset) {\n    this['offset'] = offset;\n    this._recalc();\n    return this;\n  };\n\n  // Rotates this polygon counter-clockwise around the origin of *its local coordinate system* (i.e. `pos`).\n  //\n  // Note: This changes the **original** points (so any `angle` will be applied on top of this rotation).\n  /**\n   * @param {number} angle The angle to rotate (in radians)\n   * @return {Polygon} This for chaining.\n   */\n  Polygon.prototype['rotate'] = Polygon.prototype.rotate = function(angle) {\n    var points = this['points'];\n    var len = points.length;\n    for (var i = 0; i < len; i++) {\n      points[i].rotate(angle);\n    }\n    this._recalc();\n    return this;\n  };\n\n  // Translates the points of this polygon by a specified amount relative to the origin of *its own coordinate\n  // system* (i.e. `pos`).\n  //\n  // This is most useful to change the \"center point\" of a polygon. If you just want to move the whole polygon, change\n  // the coordinates of `pos`.\n  //\n  // Note: This changes the **original** points (so any `offset` will be applied on top of this translation)\n  /**\n   * @param {number} x The horizontal amount to translate.\n   * @param {number} y The vertical amount to translate.\n   * @return {Polygon} This for chaining.\n   */\n  Polygon.prototype['translate'] = Polygon.prototype.translate = function (x, y) {\n    var points = this['points'];\n    var len = points.length;\n    for (var i = 0; i < len; i++) {\n      points[i][\"x\"] += x;\n      points[i][\"y\"] += y;\n    }\n    this._recalc();\n    return this;\n  };\n\n\n  // Computes the calculated collision polygon. Applies the `angle` and `offset` to the original points then recalculates the\n  // edges and normals of the collision polygon.\n  /**\n   * @return {Polygon} This for chaining.\n   */\n  Polygon.prototype._recalc = function() {\n    // Calculated points - this is what is used for underlying collisions and takes into account\n    // the angle/offset set on the polygon.\n    var calcPoints = this['calcPoints'];\n    // The edges here are the direction of the `n`th edge of the polygon, relative to\n    // the `n`th point. If you want to draw a given edge from the edge value, you must\n    // first translate to the position of the starting point.\n    var edges = this['edges'];\n    // The normals here are the direction of the normal for the `n`th edge of the polygon, relative\n    // to the position of the `n`th point. If you want to draw an edge normal, you must first\n    // translate to the position of the starting point.\n    var normals = this['normals'];\n    // Copy the original points array and apply the offset/angle\n    var points = this['points'];\n    var offset = this['offset'];\n    var angle = this['angle'];\n    var len = points.length;\n    var i;\n    for (i = 0; i < len; i++) {\n      var calcPoint = calcPoints[i].copy(points[i]);\n      calcPoint[\"x\"] += offset[\"x\"];\n      calcPoint[\"y\"] += offset[\"y\"];\n      if (angle !== 0) {\n        calcPoint.rotate(angle);\n      }\n    }\n    // Calculate the edges/normals\n    for (i = 0; i < len; i++) {\n      var p1 = calcPoints[i];\n      var p2 = i < len - 1 ? calcPoints[i + 1] : calcPoints[0];\n      var e = edges[i].copy(p2).sub(p1);\n      normals[i].copy(e).perp().normalize();\n    }\n    return this;\n  };\n\n\n  // Compute the axis-aligned bounding box. Any current state\n  // (translations/rotations) will be applied before constructing the AABB.\n  //\n  // Note: Returns a _new_ `Polygon` each time you call this.\n  /**\n   * @return {Polygon} The AABB\n   */\n  Polygon.prototype[\"getAABB\"] = Polygon.prototype.getAABB = function() {\n    var points = this[\"calcPoints\"];\n    var len = points.length;\n    var xMin = points[0][\"x\"];\n    var yMin = points[0][\"y\"];\n    var xMax = points[0][\"x\"];\n    var yMax = points[0][\"y\"];\n    for (var i = 1; i < len; i++) {\n      var point = points[i];\n      if (point[\"x\"] < xMin) {\n        xMin = point[\"x\"];\n      }\n      else if (point[\"x\"] > xMax) {\n        xMax = point[\"x\"];\n      }\n      if (point[\"y\"] < yMin) {\n        yMin = point[\"y\"];\n      }\n      else if (point[\"y\"] > yMax) {\n        yMax = point[\"y\"];\n      }\n    }\n    return new Box(this['pos'].clone().add(new Vector(xMin, yMin)), xMax - xMin, yMax - yMin).toPolygon();\n  };\n\n  // Compute the centroid (geometric center) of the polygon. Any current state\n  // (translations/rotations) will be applied before computing the centroid.\n  //\n  // See https://en.wikipedia.org/wiki/Centroid#Centroid_of_a_polygon\n  //\n  // Note: Returns a _new_ `Vector` each time you call this.\n  /**\n   * @return {Vector} A Vector that contains the coordinates of the Centroid.\n   */\n  Polygon.prototype[\"getCentroid\"] = Polygon.prototype.getCentroid = function() {\n    var points = this[\"calcPoints\"];\n    var len = points.length;\n    var cx = 0;\n    var cy = 0;\n    var ar = 0;\n    for (var i = 0; i < len; i++) {\n      var p1 = points[i];\n      var p2 = i === len - 1 ? points[0] : points[i+1]; // Loop around if last point\n      var a = p1[\"x\"] * p2[\"y\"] - p2[\"x\"] * p1[\"y\"];\n      cx += (p1[\"x\"] + p2[\"x\"]) * a;\n      cy += (p1[\"y\"] + p2[\"y\"]) * a;\n      ar += a;\n    }\n    ar = ar * 3; // we want 1 / 6 the area and we currently have 2*area\n    cx = cx / ar;\n    cy = cy / ar;\n    return new Vector(cx, cy);\n  };\n\n\n  // ## Box\n  //\n  // Represents an axis-aligned box, with a width and height.\n\n\n  // Create a new box, with the specified position, width, and height. If no position\n  // is given, the position will be `(0,0)`. If no width or height are given, they will\n  // be set to `0`.\n  /**\n   * @param {Vector=} pos A vector representing the bottom-left of the box (i.e. the smallest x and smallest y value).\n   * @param {?number=} w The width of the box.\n   * @param {?number=} h The height of the box.\n   * @constructor\n   */\n  function Box(pos, w, h) {\n    this['pos'] = pos || new Vector();\n    this['w'] = w || 0;\n    this['h'] = h || 0;\n  }\n  SAT['Box'] = Box;\n\n  // Returns a polygon whose edges are the same as this box.\n  /**\n   * @return {Polygon} A new Polygon that represents this box.\n   */\n  Box.prototype['toPolygon'] = Box.prototype.toPolygon = function() {\n    var pos = this['pos'];\n    var w = this['w'];\n    var h = this['h'];\n    return new Polygon(new Vector(pos['x'], pos['y']), [\n     new Vector(), new Vector(w, 0),\n     new Vector(w,h), new Vector(0,h)\n    ]);\n  };\n\n  // ## Response\n  //\n  // An object representing the result of an intersection. Contains:\n  //  - The two objects participating in the intersection\n  //  - The vector representing the minimum change necessary to extract the first object\n  //    from the second one (as well as a unit vector in that direction and the magnitude\n  //    of the overlap)\n  //  - Whether the first object is entirely inside the second, and vice versa.\n  /**\n   * @constructor\n   */\n  function Response() {\n    this['a'] = null;\n    this['b'] = null;\n    this['overlapN'] = new Vector();\n    this['overlapV'] = new Vector();\n    this.clear();\n  }\n  SAT['Response'] = Response;\n\n  // Set some values of the response back to their defaults.  Call this between tests if\n  // you are going to reuse a single Response object for multiple intersection tests (recommented\n  // as it will avoid allcating extra memory)\n  /**\n   * @return {Response} This for chaining\n   */\n  Response.prototype['clear'] = Response.prototype.clear = function() {\n    this['aInB'] = true;\n    this['bInA'] = true;\n    this['overlap'] = Number.MAX_VALUE;\n    return this;\n  };\n\n  // ## Object Pools\n\n  // A pool of `Vector` objects that are used in calculations to avoid\n  // allocating memory.\n  /**\n   * @type {Array<Vector>}\n   */\n  var T_VECTORS = [];\n  for (var i = 0; i < 10; i++) { T_VECTORS.push(new Vector()); }\n\n  // A pool of arrays of numbers used in calculations to avoid allocating\n  // memory.\n  /**\n   * @type {Array<Array<number>>}\n   */\n  var T_ARRAYS = [];\n  for (var i = 0; i < 5; i++) { T_ARRAYS.push([]); }\n\n  // Temporary response used for polygon hit detection.\n  /**\n   * @type {Response}\n   */\n  var T_RESPONSE = new Response();\n\n  // Tiny \"point\" polygon used for polygon hit detection.\n  /**\n   * @type {Polygon}\n   */\n  var TEST_POINT = new Box(new Vector(), 0.000001, 0.000001).toPolygon();\n\n  // ## Helper Functions\n\n  // Flattens the specified array of points onto a unit vector axis,\n  // resulting in a one dimensional range of the minimum and\n  // maximum value on that axis.\n  /**\n   * @param {Array<Vector>} points The points to flatten.\n   * @param {Vector} normal The unit vector axis to flatten on.\n   * @param {Array<number>} result An array.  After calling this function,\n   *   result[0] will be the minimum value,\n   *   result[1] will be the maximum value.\n   */\n  function flattenPointsOn(points, normal, result) {\n    var min = Number.MAX_VALUE;\n    var max = -Number.MAX_VALUE;\n    var len = points.length;\n    for (var i = 0; i < len; i++ ) {\n      // The magnitude of the projection of the point onto the normal\n      var dot = points[i].dot(normal);\n      if (dot < min) { min = dot; }\n      if (dot > max) { max = dot; }\n    }\n    result[0] = min; result[1] = max;\n  }\n\n  // Check whether two convex polygons are separated by the specified\n  // axis (must be a unit vector).\n  /**\n   * @param {Vector} aPos The position of the first polygon.\n   * @param {Vector} bPos The position of the second polygon.\n   * @param {Array<Vector>} aPoints The points in the first polygon.\n   * @param {Array<Vector>} bPoints The points in the second polygon.\n   * @param {Vector} axis The axis (unit sized) to test against.  The points of both polygons\n   *   will be projected onto this axis.\n   * @param {Response=} response A Response object (optional) which will be populated\n   *   if the axis is not a separating axis.\n   * @return {boolean} true if it is a separating axis, false otherwise.  If false,\n   *   and a response is passed in, information about how much overlap and\n   *   the direction of the overlap will be populated.\n   */\n  function isSeparatingAxis(aPos, bPos, aPoints, bPoints, axis, response) {\n    var rangeA = T_ARRAYS.pop();\n    var rangeB = T_ARRAYS.pop();\n    // The magnitude of the offset between the two polygons\n    var offsetV = T_VECTORS.pop().copy(bPos).sub(aPos);\n    var projectedOffset = offsetV.dot(axis);\n    // Project the polygons onto the axis.\n    flattenPointsOn(aPoints, axis, rangeA);\n    flattenPointsOn(bPoints, axis, rangeB);\n    // Move B's range to its position relative to A.\n    rangeB[0] += projectedOffset;\n    rangeB[1] += projectedOffset;\n    // Check if there is a gap. If there is, this is a separating axis and we can stop\n    if (rangeA[0] > rangeB[1] || rangeB[0] > rangeA[1]) {\n      T_VECTORS.push(offsetV);\n      T_ARRAYS.push(rangeA);\n      T_ARRAYS.push(rangeB);\n      return true;\n    }\n    // This is not a separating axis. If we're calculating a response, calculate the overlap.\n    if (response) {\n      var overlap = 0;\n      // A starts further left than B\n      if (rangeA[0] < rangeB[0]) {\n        response['aInB'] = false;\n        // A ends before B does. We have to pull A out of B\n        if (rangeA[1] < rangeB[1]) {\n          overlap = rangeA[1] - rangeB[0];\n          response['bInA'] = false;\n        // B is fully inside A.  Pick the shortest way out.\n        } else {\n          var option1 = rangeA[1] - rangeB[0];\n          var option2 = rangeB[1] - rangeA[0];\n          overlap = option1 < option2 ? option1 : -option2;\n        }\n      // B starts further left than A\n      } else {\n        response['bInA'] = false;\n        // B ends before A ends. We have to push A out of B\n        if (rangeA[1] > rangeB[1]) {\n          overlap = rangeA[0] - rangeB[1];\n          response['aInB'] = false;\n        // A is fully inside B.  Pick the shortest way out.\n        } else {\n          var option1 = rangeA[1] - rangeB[0];\n          var option2 = rangeB[1] - rangeA[0];\n          overlap = option1 < option2 ? option1 : -option2;\n        }\n      }\n      // If this is the smallest amount of overlap we've seen so far, set it as the minimum overlap.\n      var absOverlap = Math.abs(overlap);\n      if (absOverlap < response['overlap']) {\n        response['overlap'] = absOverlap;\n        response['overlapN'].copy(axis);\n        if (overlap < 0) {\n          response['overlapN'].reverse();\n        }\n      }\n    }\n    T_VECTORS.push(offsetV);\n    T_ARRAYS.push(rangeA);\n    T_ARRAYS.push(rangeB);\n    return false;\n  }\n  SAT['isSeparatingAxis'] = isSeparatingAxis;\n\n  // Calculates which Voronoi region a point is on a line segment.\n  // It is assumed that both the line and the point are relative to `(0,0)`\n  //\n  //            |       (0)      |\n  //     (-1)  [S]--------------[E]  (1)\n  //            |       (0)      |\n  /**\n   * @param {Vector} line The line segment.\n   * @param {Vector} point The point.\n   * @return  {number} LEFT_VORONOI_REGION (-1) if it is the left region,\n   *          MIDDLE_VORONOI_REGION (0) if it is the middle region,\n   *          RIGHT_VORONOI_REGION (1) if it is the right region.\n   */\n  function voronoiRegion(line, point) {\n    var len2 = line.len2();\n    var dp = point.dot(line);\n    // If the point is beyond the start of the line, it is in the\n    // left voronoi region.\n    if (dp < 0) { return LEFT_VORONOI_REGION; }\n    // If the point is beyond the end of the line, it is in the\n    // right voronoi region.\n    else if (dp > len2) { return RIGHT_VORONOI_REGION; }\n    // Otherwise, it's in the middle one.\n    else { return MIDDLE_VORONOI_REGION; }\n  }\n  // Constants for Voronoi regions\n  /**\n   * @const\n   */\n  var LEFT_VORONOI_REGION = -1;\n  /**\n   * @const\n   */\n  var MIDDLE_VORONOI_REGION = 0;\n  /**\n   * @const\n   */\n  var RIGHT_VORONOI_REGION = 1;\n\n  // ## Collision Tests\n\n  // Check if a point is inside a circle.\n  /**\n   * @param {Vector} p The point to test.\n   * @param {Circle} c The circle to test.\n   * @return {boolean} true if the point is inside the circle, false if it is not.\n   */\n  function pointInCircle(p, c) {\n    var differenceV = T_VECTORS.pop().copy(p).sub(c['pos']).sub(c['offset']);\n    var radiusSq = c['r'] * c['r'];\n    var distanceSq = differenceV.len2();\n    T_VECTORS.push(differenceV);\n    // If the distance between is smaller than the radius then the point is inside the circle.\n    return distanceSq <= radiusSq;\n  }\n  SAT['pointInCircle'] = pointInCircle;\n\n  // Check if a point is inside a convex polygon.\n  /**\n   * @param {Vector} p The point to test.\n   * @param {Polygon} poly The polygon to test.\n   * @return {boolean} true if the point is inside the polygon, false if it is not.\n   */\n  function pointInPolygon(p, poly) {\n    TEST_POINT['pos'].copy(p);\n    T_RESPONSE.clear();\n    var result = testPolygonPolygon(TEST_POINT, poly, T_RESPONSE);\n    if (result) {\n      result = T_RESPONSE['aInB'];\n    }\n    return result;\n  }\n  SAT['pointInPolygon'] = pointInPolygon;\n\n  // Check if two circles collide.\n  /**\n   * @param {Circle} a The first circle.\n   * @param {Circle} b The second circle.\n   * @param {Response=} response Response object (optional) that will be populated if\n   *   the circles intersect.\n   * @return {boolean} true if the circles intersect, false if they don't.\n   */\n  function testCircleCircle(a, b, response) {\n    // Check if the distance between the centers of the two\n    // circles is greater than their combined radius.\n    var differenceV = T_VECTORS.pop().copy(b['pos']).add(b['offset']).sub(a['pos']).sub(a['offset']);\n    var totalRadius = a['r'] + b['r'];\n    var totalRadiusSq = totalRadius * totalRadius;\n    var distanceSq = differenceV.len2();\n    // If the distance is bigger than the combined radius, they don't intersect.\n    if (distanceSq > totalRadiusSq) {\n      T_VECTORS.push(differenceV);\n      return false;\n    }\n    // They intersect.  If we're calculating a response, calculate the overlap.\n    if (response) {\n      var dist = Math.sqrt(distanceSq);\n      response['a'] = a;\n      response['b'] = b;\n      response['overlap'] = totalRadius - dist;\n      response['overlapN'].copy(differenceV.normalize());\n      response['overlapV'].copy(differenceV).scale(response['overlap']);\n      response['aInB']= a['r'] <= b['r'] && dist <= b['r'] - a['r'];\n      response['bInA'] = b['r'] <= a['r'] && dist <= a['r'] - b['r'];\n    }\n    T_VECTORS.push(differenceV);\n    return true;\n  }\n  SAT['testCircleCircle'] = testCircleCircle;\n\n  // Check if a polygon and a circle collide.\n  /**\n   * @param {Polygon} polygon The polygon.\n   * @param {Circle} circle The circle.\n   * @param {Response=} response Response object (optional) that will be populated if\n   *   they interset.\n   * @return {boolean} true if they intersect, false if they don't.\n   */\n  function testPolygonCircle(polygon, circle, response) {\n    // Get the position of the circle relative to the polygon.\n    var circlePos = T_VECTORS.pop().copy(circle['pos']).add(circle['offset']).sub(polygon['pos']);\n    var radius = circle['r'];\n    var radius2 = radius * radius;\n    var points = polygon['calcPoints'];\n    var len = points.length;\n    var edge = T_VECTORS.pop();\n    var point = T_VECTORS.pop();\n\n    // For each edge in the polygon:\n    for (var i = 0; i < len; i++) {\n      var next = i === len - 1 ? 0 : i + 1;\n      var prev = i === 0 ? len - 1 : i - 1;\n      var overlap = 0;\n      var overlapN = null;\n\n      // Get the edge.\n      edge.copy(polygon['edges'][i]);\n      // Calculate the center of the circle relative to the starting point of the edge.\n      point.copy(circlePos).sub(points[i]);\n\n      // If the distance between the center of the circle and the point\n      // is bigger than the radius, the polygon is definitely not fully in\n      // the circle.\n      if (response && point.len2() > radius2) {\n        response['aInB'] = false;\n      }\n\n      // Calculate which Voronoi region the center of the circle is in.\n      var region = voronoiRegion(edge, point);\n      // If it's the left region:\n      if (region === LEFT_VORONOI_REGION) {\n        // We need to make sure we're in the RIGHT_VORONOI_REGION of the previous edge.\n        edge.copy(polygon['edges'][prev]);\n        // Calculate the center of the circle relative the starting point of the previous edge\n        var point2 = T_VECTORS.pop().copy(circlePos).sub(points[prev]);\n        region = voronoiRegion(edge, point2);\n        if (region === RIGHT_VORONOI_REGION) {\n          // It's in the region we want.  Check if the circle intersects the point.\n          var dist = point.len();\n          if (dist > radius) {\n            // No intersection\n            T_VECTORS.push(circlePos);\n            T_VECTORS.push(edge);\n            T_VECTORS.push(point);\n            T_VECTORS.push(point2);\n            return false;\n          } else if (response) {\n            // It intersects, calculate the overlap.\n            response['bInA'] = false;\n            overlapN = point.normalize();\n            overlap = radius - dist;\n          }\n        }\n        T_VECTORS.push(point2);\n      // If it's the right region:\n      } else if (region === RIGHT_VORONOI_REGION) {\n        // We need to make sure we're in the left region on the next edge\n        edge.copy(polygon['edges'][next]);\n        // Calculate the center of the circle relative to the starting point of the next edge.\n        point.copy(circlePos).sub(points[next]);\n        region = voronoiRegion(edge, point);\n        if (region === LEFT_VORONOI_REGION) {\n          // It's in the region we want.  Check if the circle intersects the point.\n          var dist = point.len();\n          if (dist > radius) {\n            // No intersection\n            T_VECTORS.push(circlePos);\n            T_VECTORS.push(edge);\n            T_VECTORS.push(point);\n            return false;\n          } else if (response) {\n            // It intersects, calculate the overlap.\n            response['bInA'] = false;\n            overlapN = point.normalize();\n            overlap = radius - dist;\n          }\n        }\n      // Otherwise, it's the middle region:\n      } else {\n        // Need to check if the circle is intersecting the edge,\n        // Change the edge into its \"edge normal\".\n        var normal = edge.perp().normalize();\n        // Find the perpendicular distance between the center of the\n        // circle and the edge.\n        var dist = point.dot(normal);\n        var distAbs = Math.abs(dist);\n        // If the circle is on the outside of the edge, there is no intersection.\n        if (dist > 0 && distAbs > radius) {\n          // No intersection\n          T_VECTORS.push(circlePos);\n          T_VECTORS.push(normal);\n          T_VECTORS.push(point);\n          return false;\n        } else if (response) {\n          // It intersects, calculate the overlap.\n          overlapN = normal;\n          overlap = radius - dist;\n          // If the center of the circle is on the outside of the edge, or part of the\n          // circle is on the outside, the circle is not fully inside the polygon.\n          if (dist >= 0 || overlap < 2 * radius) {\n            response['bInA'] = false;\n          }\n        }\n      }\n\n      // If this is the smallest overlap we've seen, keep it.\n      // (overlapN may be null if the circle was in the wrong Voronoi region).\n      if (overlapN && response && Math.abs(overlap) < Math.abs(response['overlap'])) {\n        response['overlap'] = overlap;\n        response['overlapN'].copy(overlapN);\n      }\n    }\n\n    // Calculate the final overlap vector - based on the smallest overlap.\n    if (response) {\n      response['a'] = polygon;\n      response['b'] = circle;\n      response['overlapV'].copy(response['overlapN']).scale(response['overlap']);\n    }\n    T_VECTORS.push(circlePos);\n    T_VECTORS.push(edge);\n    T_VECTORS.push(point);\n    return true;\n  }\n  SAT['testPolygonCircle'] = testPolygonCircle;\n\n  // Check if a circle and a polygon collide.\n  //\n  // **NOTE:** This is slightly less efficient than polygonCircle as it just\n  // runs polygonCircle and reverses everything at the end.\n  /**\n   * @param {Circle} circle The circle.\n   * @param {Polygon} polygon The polygon.\n   * @param {Response=} response Response object (optional) that will be populated if\n   *   they interset.\n   * @return {boolean} true if they intersect, false if they don't.\n   */\n  function testCirclePolygon(circle, polygon, response) {\n    // Test the polygon against the circle.\n    var result = testPolygonCircle(polygon, circle, response);\n    if (result && response) {\n      // Swap A and B in the response.\n      var a = response['a'];\n      var aInB = response['aInB'];\n      response['overlapN'].reverse();\n      response['overlapV'].reverse();\n      response['a'] = response['b'];\n      response['b'] = a;\n      response['aInB'] = response['bInA'];\n      response['bInA'] = aInB;\n    }\n    return result;\n  }\n  SAT['testCirclePolygon'] = testCirclePolygon;\n\n  // Checks whether polygons collide.\n  /**\n   * @param {Polygon} a The first polygon.\n   * @param {Polygon} b The second polygon.\n   * @param {Response=} response Response object (optional) that will be populated if\n   *   they interset.\n   * @return {boolean} true if they intersect, false if they don't.\n   */\n  function testPolygonPolygon(a, b, response) {\n    var aPoints = a['calcPoints'];\n    var aLen = aPoints.length;\n    var bPoints = b['calcPoints'];\n    var bLen = bPoints.length;\n    // If any of the edge normals of A is a separating axis, no intersection.\n    for (var i = 0; i < aLen; i++) {\n      if (isSeparatingAxis(a['pos'], b['pos'], aPoints, bPoints, a['normals'][i], response)) {\n        return false;\n      }\n    }\n    // If any of the edge normals of B is a separating axis, no intersection.\n    for (var i = 0;i < bLen; i++) {\n      if (isSeparatingAxis(a['pos'], b['pos'], aPoints, bPoints, b['normals'][i], response)) {\n        return false;\n      }\n    }\n    // Since none of the edge normals of A or B are a separating axis, there is an intersection\n    // and we've already calculated the smallest overlap (in isSeparatingAxis).  Calculate the\n    // final overlap vector.\n    if (response) {\n      response['a'] = a;\n      response['b'] = b;\n      response['overlapV'].copy(response['overlapN']).scale(response['overlap']);\n    }\n    return true;\n  }\n  SAT['testPolygonPolygon'] = testPolygonPolygon;\n\n  return SAT;\n}));\n","// A library of seedable RNGs implemented in Javascript.\n//\n// Usage:\n//\n// var seedrandom = require('seedrandom');\n// var random = seedrandom(1); // or any seed.\n// var x = random();       // 0 <= x < 1.  Every bit is random.\n// var x = random.quick(); // 0 <= x < 1.  32 bits of randomness.\n\n// alea, a 53-bit multiply-with-carry generator by Johannes Baage.\n// Period: ~2^116\n// Reported to pass all BigCrush tests.\nvar alea = require('./lib/alea');\n\n// xor128, a pure xor-shift generator by George Marsaglia.\n// Period: 2^128-1.\n// Reported to fail: MatrixRank and LinearComp.\nvar xor128 = require('./lib/xor128');\n\n// xorwow, George Marsaglia's 160-bit xor-shift combined plus weyl.\n// Period: 2^192-2^32\n// Reported to fail: CollisionOver, SimpPoker, and LinearComp.\nvar xorwow = require('./lib/xorwow');\n\n// xorshift7, by Franois Panneton and Pierre L'ecuyer, takes\n// a different approach: it adds robustness by allowing more shifts\n// than Marsaglia's original three.  It is a 7-shift generator\n// with 256 bits, that passes BigCrush with no systmatic failures.\n// Period 2^256-1.\n// No systematic BigCrush failures reported.\nvar xorshift7 = require('./lib/xorshift7');\n\n// xor4096, by Richard Brent, is a 4096-bit xor-shift with a\n// very long period that also adds a Weyl generator. It also passes\n// BigCrush with no systematic failures.  Its long period may\n// be useful if you have many generators and need to avoid\n// collisions.\n// Period: 2^4128-2^32.\n// No systematic BigCrush failures reported.\nvar xor4096 = require('./lib/xor4096');\n\n// Tyche-i, by Samuel Neves and Filipe Araujo, is a bit-shifting random\n// number generator derived from ChaCha, a modern stream cipher.\n// https://eden.dei.uc.pt/~sneves/pubs/2011-snfa2.pdf\n// Period: ~2^127\n// No systematic BigCrush failures reported.\nvar tychei = require('./lib/tychei');\n\n// The original ARC4-based prng included in this library.\n// Period: ~2^1600\nvar sr = require('./seedrandom');\n\nsr.alea = alea;\nsr.xor128 = xor128;\nsr.xorwow = xorwow;\nsr.xorshift7 = xorshift7;\nsr.xor4096 = xor4096;\nsr.tychei = tychei;\n\nmodule.exports = sr;\n","// A port of an algorithm by Johannes Baage <baagoe@baagoe.com>, 2010\n// http://baagoe.com/en/RandomMusings/javascript/\n// https://github.com/nquinlan/better-random-numbers-for-javascript-mirror\n// Original work is under MIT license -\n\n// Copyright (C) 2010 by Johannes Baage <baagoe@baagoe.org>\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n\n\n(function(global, module, define) {\n\nfunction Alea(seed) {\n  var me = this, mash = Mash();\n\n  me.next = function() {\n    var t = 2091639 * me.s0 + me.c * 2.3283064365386963e-10; // 2^-32\n    me.s0 = me.s1;\n    me.s1 = me.s2;\n    return me.s2 = t - (me.c = t | 0);\n  };\n\n  // Apply the seeding algorithm from Baagoe.\n  me.c = 1;\n  me.s0 = mash(' ');\n  me.s1 = mash(' ');\n  me.s2 = mash(' ');\n  me.s0 -= mash(seed);\n  if (me.s0 < 0) { me.s0 += 1; }\n  me.s1 -= mash(seed);\n  if (me.s1 < 0) { me.s1 += 1; }\n  me.s2 -= mash(seed);\n  if (me.s2 < 0) { me.s2 += 1; }\n  mash = null;\n}\n\nfunction copy(f, t) {\n  t.c = f.c;\n  t.s0 = f.s0;\n  t.s1 = f.s1;\n  t.s2 = f.s2;\n  return t;\n}\n\nfunction impl(seed, opts) {\n  var xg = new Alea(seed),\n      state = opts && opts.state,\n      prng = xg.next;\n  prng.int32 = function() { return (xg.next() * 0x100000000) | 0; }\n  prng.double = function() {\n    return prng() + (prng() * 0x200000 | 0) * 1.1102230246251565e-16; // 2^-53\n  };\n  prng.quick = prng;\n  if (state) {\n    if (typeof(state) == 'object') copy(state, xg);\n    prng.state = function() { return copy(xg, {}); }\n  }\n  return prng;\n}\n\nfunction Mash() {\n  var n = 0xefc8249d;\n\n  var mash = function(data) {\n    data = String(data);\n    for (var i = 0; i < data.length; i++) {\n      n += data.charCodeAt(i);\n      var h = 0.02519603282416938 * n;\n      n = h >>> 0;\n      h -= n;\n      h *= n;\n      n = h >>> 0;\n      h -= n;\n      n += h * 0x100000000; // 2^32\n    }\n    return (n >>> 0) * 2.3283064365386963e-10; // 2^-32\n  };\n\n  return mash;\n}\n\n\nif (module && module.exports) {\n  module.exports = impl;\n} else if (define && define.amd) {\n  define(function() { return impl; });\n} else {\n  this.alea = impl;\n}\n\n})(\n  this,\n  (typeof module) == 'object' && module,    // present in node.js\n  (typeof define) == 'function' && define   // present with an AMD loader\n);\n\n\n","// A Javascript implementaion of the \"Tyche-i\" prng algorithm by\n// Samuel Neves and Filipe Araujo.\n// See https://eden.dei.uc.pt/~sneves/pubs/2011-snfa2.pdf\n\n(function(global, module, define) {\n\nfunction XorGen(seed) {\n  var me = this, strseed = '';\n\n  // Set up generator function.\n  me.next = function() {\n    var b = me.b, c = me.c, d = me.d, a = me.a;\n    b = (b << 25) ^ (b >>> 7) ^ c;\n    c = (c - d) | 0;\n    d = (d << 24) ^ (d >>> 8) ^ a;\n    a = (a - b) | 0;\n    me.b = b = (b << 20) ^ (b >>> 12) ^ c;\n    me.c = c = (c - d) | 0;\n    me.d = (d << 16) ^ (c >>> 16) ^ a;\n    return me.a = (a - b) | 0;\n  };\n\n  /* The following is non-inverted tyche, which has better internal\n   * bit diffusion, but which is about 25% slower than tyche-i in JS.\n  me.next = function() {\n    var a = me.a, b = me.b, c = me.c, d = me.d;\n    a = (me.a + me.b | 0) >>> 0;\n    d = me.d ^ a; d = d << 16 ^ d >>> 16;\n    c = me.c + d | 0;\n    b = me.b ^ c; b = b << 12 ^ d >>> 20;\n    me.a = a = a + b | 0;\n    d = d ^ a; me.d = d = d << 8 ^ d >>> 24;\n    me.c = c = c + d | 0;\n    b = b ^ c;\n    return me.b = (b << 7 ^ b >>> 25);\n  }\n  */\n\n  me.a = 0;\n  me.b = 0;\n  me.c = 2654435769 | 0;\n  me.d = 1367130551;\n\n  if (seed === Math.floor(seed)) {\n    // Integer seed.\n    me.a = (seed / 0x100000000) | 0;\n    me.b = seed | 0;\n  } else {\n    // String seed.\n    strseed += seed;\n  }\n\n  // Mix in string seed, then discard an initial batch of 64 values.\n  for (var k = 0; k < strseed.length + 20; k++) {\n    me.b ^= strseed.charCodeAt(k) | 0;\n    me.next();\n  }\n}\n\nfunction copy(f, t) {\n  t.a = f.a;\n  t.b = f.b;\n  t.c = f.c;\n  t.d = f.d;\n  return t;\n};\n\nfunction impl(seed, opts) {\n  var xg = new XorGen(seed),\n      state = opts && opts.state,\n      prng = function() { return (xg.next() >>> 0) / 0x100000000; };\n  prng.double = function() {\n    do {\n      var top = xg.next() >>> 11,\n          bot = (xg.next() >>> 0) / 0x100000000,\n          result = (top + bot) / (1 << 21);\n    } while (result === 0);\n    return result;\n  };\n  prng.int32 = xg.next;\n  prng.quick = prng;\n  if (state) {\n    if (typeof(state) == 'object') copy(state, xg);\n    prng.state = function() { return copy(xg, {}); }\n  }\n  return prng;\n}\n\nif (module && module.exports) {\n  module.exports = impl;\n} else if (define && define.amd) {\n  define(function() { return impl; });\n} else {\n  this.tychei = impl;\n}\n\n})(\n  this,\n  (typeof module) == 'object' && module,    // present in node.js\n  (typeof define) == 'function' && define   // present with an AMD loader\n);\n\n\n","// A Javascript implementaion of the \"xor128\" prng algorithm by\n// George Marsaglia.  See http://www.jstatsoft.org/v08/i14/paper\n\n(function(global, module, define) {\n\nfunction XorGen(seed) {\n  var me = this, strseed = '';\n\n  me.x = 0;\n  me.y = 0;\n  me.z = 0;\n  me.w = 0;\n\n  // Set up generator function.\n  me.next = function() {\n    var t = me.x ^ (me.x << 11);\n    me.x = me.y;\n    me.y = me.z;\n    me.z = me.w;\n    return me.w ^= (me.w >>> 19) ^ t ^ (t >>> 8);\n  };\n\n  if (seed === (seed | 0)) {\n    // Integer seed.\n    me.x = seed;\n  } else {\n    // String seed.\n    strseed += seed;\n  }\n\n  // Mix in string seed, then discard an initial batch of 64 values.\n  for (var k = 0; k < strseed.length + 64; k++) {\n    me.x ^= strseed.charCodeAt(k) | 0;\n    me.next();\n  }\n}\n\nfunction copy(f, t) {\n  t.x = f.x;\n  t.y = f.y;\n  t.z = f.z;\n  t.w = f.w;\n  return t;\n}\n\nfunction impl(seed, opts) {\n  var xg = new XorGen(seed),\n      state = opts && opts.state,\n      prng = function() { return (xg.next() >>> 0) / 0x100000000; };\n  prng.double = function() {\n    do {\n      var top = xg.next() >>> 11,\n          bot = (xg.next() >>> 0) / 0x100000000,\n          result = (top + bot) / (1 << 21);\n    } while (result === 0);\n    return result;\n  };\n  prng.int32 = xg.next;\n  prng.quick = prng;\n  if (state) {\n    if (typeof(state) == 'object') copy(state, xg);\n    prng.state = function() { return copy(xg, {}); }\n  }\n  return prng;\n}\n\nif (module && module.exports) {\n  module.exports = impl;\n} else if (define && define.amd) {\n  define(function() { return impl; });\n} else {\n  this.xor128 = impl;\n}\n\n})(\n  this,\n  (typeof module) == 'object' && module,    // present in node.js\n  (typeof define) == 'function' && define   // present with an AMD loader\n);\n\n\n","// A Javascript implementaion of Richard Brent's Xorgens xor4096 algorithm.\n//\n// This fast non-cryptographic random number generator is designed for\n// use in Monte-Carlo algorithms. It combines a long-period xorshift\n// generator with a Weyl generator, and it passes all common batteries\n// of stasticial tests for randomness while consuming only a few nanoseconds\n// for each prng generated.  For background on the generator, see Brent's\n// paper: \"Some long-period random number generators using shifts and xors.\"\n// http://arxiv.org/pdf/1004.3115v1.pdf\n//\n// Usage:\n//\n// var xor4096 = require('xor4096');\n// random = xor4096(1);                        // Seed with int32 or string.\n// assert.equal(random(), 0.1520436450538547); // (0, 1) range, 53 bits.\n// assert.equal(random.int32(), 1806534897);   // signed int32, 32 bits.\n//\n// For nonzero numeric keys, this impelementation provides a sequence\n// identical to that by Brent's xorgens 3 implementaion in C.  This\n// implementation also provides for initalizing the generator with\n// string seeds, or for saving and restoring the state of the generator.\n//\n// On Chrome, this prng benchmarks about 2.1 times slower than\n// Javascript's built-in Math.random().\n\n(function(global, module, define) {\n\nfunction XorGen(seed) {\n  var me = this;\n\n  // Set up generator function.\n  me.next = function() {\n    var w = me.w,\n        X = me.X, i = me.i, t, v;\n    // Update Weyl generator.\n    me.w = w = (w + 0x61c88647) | 0;\n    // Update xor generator.\n    v = X[(i + 34) & 127];\n    t = X[i = ((i + 1) & 127)];\n    v ^= v << 13;\n    t ^= t << 17;\n    v ^= v >>> 15;\n    t ^= t >>> 12;\n    // Update Xor generator array state.\n    v = X[i] = v ^ t;\n    me.i = i;\n    // Result is the combination.\n    return (v + (w ^ (w >>> 16))) | 0;\n  };\n\n  function init(me, seed) {\n    var t, v, i, j, w, X = [], limit = 128;\n    if (seed === (seed | 0)) {\n      // Numeric seeds initialize v, which is used to generates X.\n      v = seed;\n      seed = null;\n    } else {\n      // String seeds are mixed into v and X one character at a time.\n      seed = seed + '\\0';\n      v = 0;\n      limit = Math.max(limit, seed.length);\n    }\n    // Initialize circular array and weyl value.\n    for (i = 0, j = -32; j < limit; ++j) {\n      // Put the unicode characters into the array, and shuffle them.\n      if (seed) v ^= seed.charCodeAt((j + 32) % seed.length);\n      // After 32 shuffles, take v as the starting w value.\n      if (j === 0) w = v;\n      v ^= v << 10;\n      v ^= v >>> 15;\n      v ^= v << 4;\n      v ^= v >>> 13;\n      if (j >= 0) {\n        w = (w + 0x61c88647) | 0;     // Weyl.\n        t = (X[j & 127] ^= (v + w));  // Combine xor and weyl to init array.\n        i = (0 == t) ? i + 1 : 0;     // Count zeroes.\n      }\n    }\n    // We have detected all zeroes; make the key nonzero.\n    if (i >= 128) {\n      X[(seed && seed.length || 0) & 127] = -1;\n    }\n    // Run the generator 512 times to further mix the state before using it.\n    // Factoring this as a function slows the main generator, so it is just\n    // unrolled here.  The weyl generator is not advanced while warming up.\n    i = 127;\n    for (j = 4 * 128; j > 0; --j) {\n      v = X[(i + 34) & 127];\n      t = X[i = ((i + 1) & 127)];\n      v ^= v << 13;\n      t ^= t << 17;\n      v ^= v >>> 15;\n      t ^= t >>> 12;\n      X[i] = v ^ t;\n    }\n    // Storing state as object members is faster than using closure variables.\n    me.w = w;\n    me.X = X;\n    me.i = i;\n  }\n\n  init(me, seed);\n}\n\nfunction copy(f, t) {\n  t.i = f.i;\n  t.w = f.w;\n  t.X = f.X.slice();\n  return t;\n};\n\nfunction impl(seed, opts) {\n  if (seed == null) seed = +(new Date);\n  var xg = new XorGen(seed),\n      state = opts && opts.state,\n      prng = function() { return (xg.next() >>> 0) / 0x100000000; };\n  prng.double = function() {\n    do {\n      var top = xg.next() >>> 11,\n          bot = (xg.next() >>> 0) / 0x100000000,\n          result = (top + bot) / (1 << 21);\n    } while (result === 0);\n    return result;\n  };\n  prng.int32 = xg.next;\n  prng.quick = prng;\n  if (state) {\n    if (state.X) copy(state, xg);\n    prng.state = function() { return copy(xg, {}); }\n  }\n  return prng;\n}\n\nif (module && module.exports) {\n  module.exports = impl;\n} else if (define && define.amd) {\n  define(function() { return impl; });\n} else {\n  this.xor4096 = impl;\n}\n\n})(\n  this,                                     // window object or global\n  (typeof module) == 'object' && module,    // present in node.js\n  (typeof define) == 'function' && define   // present with an AMD loader\n);\n","// A Javascript implementaion of the \"xorshift7\" algorithm by\n// Franois Panneton and Pierre L'ecuyer:\n// \"On the Xorgshift Random Number Generators\"\n// http://saluc.engr.uconn.edu/refs/crypto/rng/panneton05onthexorshift.pdf\n\n(function(global, module, define) {\n\nfunction XorGen(seed) {\n  var me = this;\n\n  // Set up generator function.\n  me.next = function() {\n    // Update xor generator.\n    var X = me.x, i = me.i, t, v, w;\n    t = X[i]; t ^= (t >>> 7); v = t ^ (t << 24);\n    t = X[(i + 1) & 7]; v ^= t ^ (t >>> 10);\n    t = X[(i + 3) & 7]; v ^= t ^ (t >>> 3);\n    t = X[(i + 4) & 7]; v ^= t ^ (t << 7);\n    t = X[(i + 7) & 7]; t = t ^ (t << 13); v ^= t ^ (t << 9);\n    X[i] = v;\n    me.i = (i + 1) & 7;\n    return v;\n  };\n\n  function init(me, seed) {\n    var j, w, X = [];\n\n    if (seed === (seed | 0)) {\n      // Seed state array using a 32-bit integer.\n      w = X[0] = seed;\n    } else {\n      // Seed state using a string.\n      seed = '' + seed;\n      for (j = 0; j < seed.length; ++j) {\n        X[j & 7] = (X[j & 7] << 15) ^\n            (seed.charCodeAt(j) + X[(j + 1) & 7] << 13);\n      }\n    }\n    // Enforce an array length of 8, not all zeroes.\n    while (X.length < 8) X.push(0);\n    for (j = 0; j < 8 && X[j] === 0; ++j);\n    if (j == 8) w = X[7] = -1; else w = X[j];\n\n    me.x = X;\n    me.i = 0;\n\n    // Discard an initial 256 values.\n    for (j = 256; j > 0; --j) {\n      me.next();\n    }\n  }\n\n  init(me, seed);\n}\n\nfunction copy(f, t) {\n  t.x = f.x.slice();\n  t.i = f.i;\n  return t;\n}\n\nfunction impl(seed, opts) {\n  if (seed == null) seed = +(new Date);\n  var xg = new XorGen(seed),\n      state = opts && opts.state,\n      prng = function() { return (xg.next() >>> 0) / 0x100000000; };\n  prng.double = function() {\n    do {\n      var top = xg.next() >>> 11,\n          bot = (xg.next() >>> 0) / 0x100000000,\n          result = (top + bot) / (1 << 21);\n    } while (result === 0);\n    return result;\n  };\n  prng.int32 = xg.next;\n  prng.quick = prng;\n  if (state) {\n    if (state.x) copy(state, xg);\n    prng.state = function() { return copy(xg, {}); }\n  }\n  return prng;\n}\n\nif (module && module.exports) {\n  module.exports = impl;\n} else if (define && define.amd) {\n  define(function() { return impl; });\n} else {\n  this.xorshift7 = impl;\n}\n\n})(\n  this,\n  (typeof module) == 'object' && module,    // present in node.js\n  (typeof define) == 'function' && define   // present with an AMD loader\n);\n\n","// A Javascript implementaion of the \"xorwow\" prng algorithm by\n// George Marsaglia.  See http://www.jstatsoft.org/v08/i14/paper\n\n(function(global, module, define) {\n\nfunction XorGen(seed) {\n  var me = this, strseed = '';\n\n  // Set up generator function.\n  me.next = function() {\n    var t = (me.x ^ (me.x >>> 2));\n    me.x = me.y; me.y = me.z; me.z = me.w; me.w = me.v;\n    return (me.d = (me.d + 362437 | 0)) +\n       (me.v = (me.v ^ (me.v << 4)) ^ (t ^ (t << 1))) | 0;\n  };\n\n  me.x = 0;\n  me.y = 0;\n  me.z = 0;\n  me.w = 0;\n  me.v = 0;\n\n  if (seed === (seed | 0)) {\n    // Integer seed.\n    me.x = seed;\n  } else {\n    // String seed.\n    strseed += seed;\n  }\n\n  // Mix in string seed, then discard an initial batch of 64 values.\n  for (var k = 0; k < strseed.length + 64; k++) {\n    me.x ^= strseed.charCodeAt(k) | 0;\n    if (k == strseed.length) {\n      me.d = me.x << 10 ^ me.x >>> 4;\n    }\n    me.next();\n  }\n}\n\nfunction copy(f, t) {\n  t.x = f.x;\n  t.y = f.y;\n  t.z = f.z;\n  t.w = f.w;\n  t.v = f.v;\n  t.d = f.d;\n  return t;\n}\n\nfunction impl(seed, opts) {\n  var xg = new XorGen(seed),\n      state = opts && opts.state,\n      prng = function() { return (xg.next() >>> 0) / 0x100000000; };\n  prng.double = function() {\n    do {\n      var top = xg.next() >>> 11,\n          bot = (xg.next() >>> 0) / 0x100000000,\n          result = (top + bot) / (1 << 21);\n    } while (result === 0);\n    return result;\n  };\n  prng.int32 = xg.next;\n  prng.quick = prng;\n  if (state) {\n    if (typeof(state) == 'object') copy(state, xg);\n    prng.state = function() { return copy(xg, {}); }\n  }\n  return prng;\n}\n\nif (module && module.exports) {\n  module.exports = impl;\n} else if (define && define.amd) {\n  define(function() { return impl; });\n} else {\n  this.xorwow = impl;\n}\n\n})(\n  this,\n  (typeof module) == 'object' && module,    // present in node.js\n  (typeof define) == 'function' && define   // present with an AMD loader\n);\n\n\n","/*\nCopyright 2019 David Bau.\n\nPermission is hereby granted, free of charge, to any person obtaining\na copy of this software and associated documentation files (the\n\"Software\"), to deal in the Software without restriction, including\nwithout limitation the rights to use, copy, modify, merge, publish,\ndistribute, sublicense, and/or sell copies of the Software, and to\npermit persons to whom the Software is furnished to do so, subject to\nthe following conditions:\n\nThe above copyright notice and this permission notice shall be\nincluded in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\nIN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\nCLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\nTORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\nSOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n*/\n\n(function (global, pool, math) {\n//\n// The following constants are related to IEEE 754 limits.\n//\n\nvar width = 256,        // each RC4 output is 0 <= x < 256\n    chunks = 6,         // at least six RC4 outputs for each double\n    digits = 52,        // there are 52 significant digits in a double\n    rngname = 'random', // rngname: name for Math.random and Math.seedrandom\n    startdenom = math.pow(width, chunks),\n    significance = math.pow(2, digits),\n    overflow = significance * 2,\n    mask = width - 1,\n    nodecrypto;         // node.js crypto module, initialized at the bottom.\n\n//\n// seedrandom()\n// This is the seedrandom function described above.\n//\nfunction seedrandom(seed, options, callback) {\n  var key = [];\n  options = (options == true) ? { entropy: true } : (options || {});\n\n  // Flatten the seed string or build one from local entropy if needed.\n  var shortseed = mixkey(flatten(\n    options.entropy ? [seed, tostring(pool)] :\n    (seed == null) ? autoseed() : seed, 3), key);\n\n  // Use the seed to initialize an ARC4 generator.\n  var arc4 = new ARC4(key);\n\n  // This function returns a random double in [0, 1) that contains\n  // randomness in every bit of the mantissa of the IEEE 754 value.\n  var prng = function() {\n    var n = arc4.g(chunks),             // Start with a numerator n < 2 ^ 48\n        d = startdenom,                 //   and denominator d = 2 ^ 48.\n        x = 0;                          //   and no 'extra last byte'.\n    while (n < significance) {          // Fill up all significant digits by\n      n = (n + x) * width;              //   shifting numerator and\n      d *= width;                       //   denominator and generating a\n      x = arc4.g(1);                    //   new least-significant-byte.\n    }\n    while (n >= overflow) {             // To avoid rounding up, before adding\n      n /= 2;                           //   last byte, shift everything\n      d /= 2;                           //   right using integer math until\n      x >>>= 1;                         //   we have exactly the desired bits.\n    }\n    return (n + x) / d;                 // Form the number within [0, 1).\n  };\n\n  prng.int32 = function() { return arc4.g(4) | 0; }\n  prng.quick = function() { return arc4.g(4) / 0x100000000; }\n  prng.double = prng;\n\n  // Mix the randomness into accumulated entropy.\n  mixkey(tostring(arc4.S), pool);\n\n  // Calling convention: what to return as a function of prng, seed, is_math.\n  return (options.pass || callback ||\n      function(prng, seed, is_math_call, state) {\n        if (state) {\n          // Load the arc4 state from the given state if it has an S array.\n          if (state.S) { copy(state, arc4); }\n          // Only provide the .state method if requested via options.state.\n          prng.state = function() { return copy(arc4, {}); }\n        }\n\n        // If called as a method of Math (Math.seedrandom()), mutate\n        // Math.random because that is how seedrandom.js has worked since v1.0.\n        if (is_math_call) { math[rngname] = prng; return seed; }\n\n        // Otherwise, it is a newer calling convention, so return the\n        // prng directly.\n        else return prng;\n      })(\n  prng,\n  shortseed,\n  'global' in options ? options.global : (this == math),\n  options.state);\n}\n\n//\n// ARC4\n//\n// An ARC4 implementation.  The constructor takes a key in the form of\n// an array of at most (width) integers that should be 0 <= x < (width).\n//\n// The g(count) method returns a pseudorandom integer that concatenates\n// the next (count) outputs from ARC4.  Its return value is a number x\n// that is in the range 0 <= x < (width ^ count).\n//\nfunction ARC4(key) {\n  var t, keylen = key.length,\n      me = this, i = 0, j = me.i = me.j = 0, s = me.S = [];\n\n  // The empty key [] is treated as [0].\n  if (!keylen) { key = [keylen++]; }\n\n  // Set up S using the standard key scheduling algorithm.\n  while (i < width) {\n    s[i] = i++;\n  }\n  for (i = 0; i < width; i++) {\n    s[i] = s[j = mask & (j + key[i % keylen] + (t = s[i]))];\n    s[j] = t;\n  }\n\n  // The \"g\" method returns the next (count) outputs as one number.\n  (me.g = function(count) {\n    // Using instance members instead of closure state nearly doubles speed.\n    var t, r = 0,\n        i = me.i, j = me.j, s = me.S;\n    while (count--) {\n      t = s[i = mask & (i + 1)];\n      r = r * width + s[mask & ((s[i] = s[j = mask & (j + t)]) + (s[j] = t))];\n    }\n    me.i = i; me.j = j;\n    return r;\n    // For robust unpredictability, the function call below automatically\n    // discards an initial batch of values.  This is called RC4-drop[256].\n    // See http://google.com/search?q=rsa+fluhrer+response&btnI\n  })(width);\n}\n\n//\n// copy()\n// Copies internal state of ARC4 to or from a plain object.\n//\nfunction copy(f, t) {\n  t.i = f.i;\n  t.j = f.j;\n  t.S = f.S.slice();\n  return t;\n};\n\n//\n// flatten()\n// Converts an object tree to nested arrays of strings.\n//\nfunction flatten(obj, depth) {\n  var result = [], typ = (typeof obj), prop;\n  if (depth && typ == 'object') {\n    for (prop in obj) {\n      try { result.push(flatten(obj[prop], depth - 1)); } catch (e) {}\n    }\n  }\n  return (result.length ? result : typ == 'string' ? obj : obj + '\\0');\n}\n\n//\n// mixkey()\n// Mixes a string seed into a key that is an array of integers, and\n// returns a shortened string seed that is equivalent to the result key.\n//\nfunction mixkey(seed, key) {\n  var stringseed = seed + '', smear, j = 0;\n  while (j < stringseed.length) {\n    key[mask & j] =\n      mask & ((smear ^= key[mask & j] * 19) + stringseed.charCodeAt(j++));\n  }\n  return tostring(key);\n}\n\n//\n// autoseed()\n// Returns an object for autoseeding, using window.crypto and Node crypto\n// module if available.\n//\nfunction autoseed() {\n  try {\n    var out;\n    if (nodecrypto && (out = nodecrypto.randomBytes)) {\n      // The use of 'out' to remember randomBytes makes tight minified code.\n      out = out(width);\n    } else {\n      out = new Uint8Array(width);\n      (global.crypto || global.msCrypto).getRandomValues(out);\n    }\n    return tostring(out);\n  } catch (e) {\n    var browser = global.navigator,\n        plugins = browser && browser.plugins;\n    return [+new Date, global, plugins, global.screen, tostring(pool)];\n  }\n}\n\n//\n// tostring()\n// Converts an array of charcodes to a string\n//\nfunction tostring(a) {\n  return String.fromCharCode.apply(0, a);\n}\n\n//\n// When seedrandom.js is loaded, we immediately mix a few bits\n// from the built-in RNG into the entropy pool.  Because we do\n// not want to interfere with deterministic PRNG state later,\n// seedrandom will not call math.random on its own again after\n// initialization.\n//\nmixkey(math.random(), pool);\n\n//\n// Nodejs and AMD support: export the implementation as a module using\n// either convention.\n//\nif ((typeof module) == 'object' && module.exports) {\n  module.exports = seedrandom;\n  // When in node.js, try using crypto package for autoseeding.\n  try {\n    nodecrypto = require('crypto');\n  } catch (ex) {}\n} else if ((typeof define) == 'function' && define.amd) {\n  define(function() { return seedrandom; });\n} else {\n  // When included as a plain script, set up Math.seedrandom global.\n  math['seed' + rngname] = seedrandom;\n}\n\n\n// End anonymous scope, and pass initial values.\n})(\n  // global: `self` in browsers (including strict mode and web workers),\n  // otherwise `this` in Node and other environments\n  (typeof self !== 'undefined') ? self : this,\n  [],     // pool: entropy pool starts empty\n  Math    // math: package containing random, pow, and seedrandom\n);\n","export function merge(...sets:Array<string>):string {\n\tif (sets.length > 1) {\n\t\tsets[0] = sets[0].slice(0, -1);\n\t\tconst xl = sets.length - 1;\n\t\tfor (let x = 1; x < xl; ++x) {\n\t\t\tsets[x] = sets[x].slice(1, -1);\n\t\t}\n\t\tsets[xl] = sets[xl].slice(1);\n\t\treturn sets.join('');\n\t} else {\n\t\treturn sets[0];\n\t}\n}\n\nexport function subexp(str:string):string {\n\treturn \"(?:\" + str + \")\";\n}\n\nexport function typeOf(o:any):string {\n\treturn o === undefined ? \"undefined\" : (o === null ? \"null\" : Object.prototype.toString.call(o).split(\" \").pop().split(\"]\").shift().toLowerCase());\n}\n\nexport function toUpperCase(str:string):string {\n\treturn str.toUpperCase();\n}\n\nexport function toArray(obj:any):Array<any> {\n\treturn obj !== undefined && obj !== null ? (obj instanceof Array ? obj : (typeof obj.length !== \"number\" || obj.split || obj.setInterval || obj.call ? [obj] : Array.prototype.slice.call(obj))) : [];\n}\n\n\nexport function assign(target: object, source: any): any {\n\tconst obj = target as any;\n\tif (source) {\n\t\tfor (const key in source) {\n\t\t\tobj[key] = source[key];\n\t\t}\n\t}\n\treturn obj;\n}","import { URIRegExps } from \"./uri\";\nimport { merge, subexp } from \"./util\";\n\nexport function buildExps(isIRI:boolean):URIRegExps {\n\tconst\n\t\tALPHA$$ = \"[A-Za-z]\",\n\t\tCR$ = \"[\\\\x0D]\",\n\t\tDIGIT$$ = \"[0-9]\",\n\t\tDQUOTE$$ = \"[\\\\x22]\",\n\t\tHEXDIG$$ = merge(DIGIT$$, \"[A-Fa-f]\"),  //case-insensitive\n\t\tLF$$ = \"[\\\\x0A]\",\n\t\tSP$$ = \"[\\\\x20]\",\n\t\tPCT_ENCODED$ = subexp(subexp(\"%[EFef]\" + HEXDIG$$ + \"%\" + HEXDIG$$ + HEXDIG$$ + \"%\" + HEXDIG$$ + HEXDIG$$) + \"|\" + subexp(\"%[89A-Fa-f]\" + HEXDIG$$ + \"%\" + HEXDIG$$ + HEXDIG$$) + \"|\" + subexp(\"%\" + HEXDIG$$ + HEXDIG$$)),  //expanded\n\t\tGEN_DELIMS$$ = \"[\\\\:\\\\/\\\\?\\\\#\\\\[\\\\]\\\\@]\",\n\t\tSUB_DELIMS$$ = \"[\\\\!\\\\$\\\\&\\\\'\\\\(\\\\)\\\\*\\\\+\\\\,\\\\;\\\\=]\",\n\t\tRESERVED$$ = merge(GEN_DELIMS$$, SUB_DELIMS$$),\n\t\tUCSCHAR$$ = isIRI ? \"[\\\\xA0-\\\\u200D\\\\u2010-\\\\u2029\\\\u202F-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFEF]\" : \"[]\",  //subset, excludes bidi control characters\n\t\tIPRIVATE$$ = isIRI ? \"[\\\\uE000-\\\\uF8FF]\" : \"[]\",  //subset\n\t\tUNRESERVED$$ = merge(ALPHA$$, DIGIT$$, \"[\\\\-\\\\.\\\\_\\\\~]\", UCSCHAR$$),\n\t\tSCHEME$ = subexp(ALPHA$$ + merge(ALPHA$$, DIGIT$$, \"[\\\\+\\\\-\\\\.]\") + \"*\"),\n\t\tUSERINFO$ = subexp(subexp(PCT_ENCODED$ + \"|\" + merge(UNRESERVED$$, SUB_DELIMS$$, \"[\\\\:]\")) + \"*\"),\n\t\tDEC_OCTET$ = subexp(subexp(\"25[0-5]\") + \"|\" + subexp(\"2[0-4]\" + DIGIT$$) + \"|\" + subexp(\"1\" + DIGIT$$ + DIGIT$$) + \"|\" + subexp(\"[1-9]\" + DIGIT$$) + \"|\" + DIGIT$$),\n\t\tDEC_OCTET_RELAXED$ = subexp(subexp(\"25[0-5]\") + \"|\" + subexp(\"2[0-4]\" + DIGIT$$) + \"|\" + subexp(\"1\" + DIGIT$$ + DIGIT$$) + \"|\" + subexp(\"0?[1-9]\" + DIGIT$$) + \"|0?0?\" + DIGIT$$),  //relaxed parsing rules\n\t\tIPV4ADDRESS$ = subexp(DEC_OCTET_RELAXED$ + \"\\\\.\" + DEC_OCTET_RELAXED$ + \"\\\\.\" + DEC_OCTET_RELAXED$ + \"\\\\.\" + DEC_OCTET_RELAXED$),\n\t\tH16$ = subexp(HEXDIG$$ + \"{1,4}\"),\n\t\tLS32$ = subexp(subexp(H16$ + \"\\\\:\" + H16$) + \"|\" + IPV4ADDRESS$),\n\t\tIPV6ADDRESS1$ = subexp(                                                            subexp(H16$ + \"\\\\:\") + \"{6}\" + LS32$), //                           6( h16 \":\" ) ls32\n\t\tIPV6ADDRESS2$ = subexp(                                                 \"\\\\:\\\\:\" + subexp(H16$ + \"\\\\:\") + \"{5}\" + LS32$), //                      \"::\" 5( h16 \":\" ) ls32\n\t\tIPV6ADDRESS3$ = subexp(subexp(                                 H16$) + \"?\\\\:\\\\:\" + subexp(H16$ + \"\\\\:\") + \"{4}\" + LS32$), //[               h16 ] \"::\" 4( h16 \":\" ) ls32\n\t\tIPV6ADDRESS4$ = subexp(subexp(subexp(H16$ + \"\\\\:\") + \"{0,1}\" + H16$) + \"?\\\\:\\\\:\" + subexp(H16$ + \"\\\\:\") + \"{3}\" + LS32$), //[ *1( h16 \":\" ) h16 ] \"::\" 3( h16 \":\" ) ls32\n\t\tIPV6ADDRESS5$ = subexp(subexp(subexp(H16$ + \"\\\\:\") + \"{0,2}\" + H16$) + \"?\\\\:\\\\:\" + subexp(H16$ + \"\\\\:\") + \"{2}\" + LS32$), //[ *2( h16 \":\" ) h16 ] \"::\" 2( h16 \":\" ) ls32\n\t\tIPV6ADDRESS6$ = subexp(subexp(subexp(H16$ + \"\\\\:\") + \"{0,3}\" + H16$) + \"?\\\\:\\\\:\" +        H16$ + \"\\\\:\"          + LS32$), //[ *3( h16 \":\" ) h16 ] \"::\"    h16 \":\"   ls32\n\t\tIPV6ADDRESS7$ = subexp(subexp(subexp(H16$ + \"\\\\:\") + \"{0,4}\" + H16$) + \"?\\\\:\\\\:\"                                + LS32$), //[ *4( h16 \":\" ) h16 ] \"::\"              ls32\n\t\tIPV6ADDRESS8$ = subexp(subexp(subexp(H16$ + \"\\\\:\") + \"{0,5}\" + H16$) + \"?\\\\:\\\\:\"                                + H16$ ), //[ *5( h16 \":\" ) h16 ] \"::\"              h16\n\t\tIPV6ADDRESS9$ = subexp(subexp(subexp(H16$ + \"\\\\:\") + \"{0,6}\" + H16$) + \"?\\\\:\\\\:\"                                       ), //[ *6( h16 \":\" ) h16 ] \"::\"\n\t\tIPV6ADDRESS$ = subexp([IPV6ADDRESS1$, IPV6ADDRESS2$, IPV6ADDRESS3$, IPV6ADDRESS4$, IPV6ADDRESS5$, IPV6ADDRESS6$, IPV6ADDRESS7$, IPV6ADDRESS8$, IPV6ADDRESS9$].join(\"|\")),\n\t\tZONEID$ = subexp(subexp(UNRESERVED$$ + \"|\" + PCT_ENCODED$) + \"+\"),  //RFC 6874\n\t\tIPV6ADDRZ$ = subexp(IPV6ADDRESS$ + \"\\\\%25\" + ZONEID$),  //RFC 6874\n\t\tIPV6ADDRZ_RELAXED$ = subexp(IPV6ADDRESS$ + subexp(\"\\\\%25|\\\\%(?!\" + HEXDIG$$ + \"{2})\") + ZONEID$),  //RFC 6874, with relaxed parsing rules\n\t\tIPVFUTURE$ = subexp(\"[vV]\" + HEXDIG$$ + \"+\\\\.\" + merge(UNRESERVED$$, SUB_DELIMS$$, \"[\\\\:]\") + \"+\"),\n\t\tIP_LITERAL$ = subexp(\"\\\\[\" + subexp(IPV6ADDRZ_RELAXED$ + \"|\" + IPV6ADDRESS$ + \"|\" + IPVFUTURE$) + \"\\\\]\"),  //RFC 6874\n\t\tREG_NAME$ = subexp(subexp(PCT_ENCODED$ + \"|\" + merge(UNRESERVED$$, SUB_DELIMS$$)) + \"*\"),\n\t\tHOST$ = subexp(IP_LITERAL$ + \"|\" + IPV4ADDRESS$ + \"(?!\" + REG_NAME$ + \")\" + \"|\" + REG_NAME$),\n\t\tPORT$ = subexp(DIGIT$$ + \"*\"),\n\t\tAUTHORITY$ = subexp(subexp(USERINFO$ + \"@\") + \"?\" + HOST$ + subexp(\"\\\\:\" + PORT$) + \"?\"),\n\t\tPCHAR$ = subexp(PCT_ENCODED$ + \"|\" + merge(UNRESERVED$$, SUB_DELIMS$$, \"[\\\\:\\\\@]\")),\n\t\tSEGMENT$ = subexp(PCHAR$ + \"*\"),\n\t\tSEGMENT_NZ$ = subexp(PCHAR$ + \"+\"),\n\t\tSEGMENT_NZ_NC$ = subexp(subexp(PCT_ENCODED$ + \"|\" + merge(UNRESERVED$$, SUB_DELIMS$$, \"[\\\\@]\")) + \"+\"),\n\t\tPATH_ABEMPTY$ = subexp(subexp(\"\\\\/\" + SEGMENT$) + \"*\"),\n\t\tPATH_ABSOLUTE$ = subexp(\"\\\\/\" + subexp(SEGMENT_NZ$ + PATH_ABEMPTY$) + \"?\"),  //simplified\n\t\tPATH_NOSCHEME$ = subexp(SEGMENT_NZ_NC$ + PATH_ABEMPTY$),  //simplified\n\t\tPATH_ROOTLESS$ = subexp(SEGMENT_NZ$ + PATH_ABEMPTY$),  //simplified\n\t\tPATH_EMPTY$ = \"(?!\" + PCHAR$ + \")\",\n\t\tPATH$ = subexp(PATH_ABEMPTY$ + \"|\" + PATH_ABSOLUTE$ + \"|\" + PATH_NOSCHEME$ + \"|\" + PATH_ROOTLESS$ + \"|\" + PATH_EMPTY$),\n\t\tQUERY$ = subexp(subexp(PCHAR$ + \"|\" + merge(\"[\\\\/\\\\?]\", IPRIVATE$$)) + \"*\"),\n\t\tFRAGMENT$ = subexp(subexp(PCHAR$ + \"|[\\\\/\\\\?]\") + \"*\"),\n\t\tHIER_PART$ = subexp(subexp(\"\\\\/\\\\/\" + AUTHORITY$ + PATH_ABEMPTY$) + \"|\" + PATH_ABSOLUTE$ + \"|\" + PATH_ROOTLESS$ + \"|\" + PATH_EMPTY$),\n\t\tURI$ = subexp(SCHEME$ + \"\\\\:\" + HIER_PART$ + subexp(\"\\\\?\" + QUERY$) + \"?\" + subexp(\"\\\\#\" + FRAGMENT$) + \"?\"),\n\t\tRELATIVE_PART$ = subexp(subexp(\"\\\\/\\\\/\" + AUTHORITY$ + PATH_ABEMPTY$) + \"|\" + PATH_ABSOLUTE$ + \"|\" + PATH_NOSCHEME$ + \"|\" + PATH_EMPTY$),\n\t\tRELATIVE$ = subexp(RELATIVE_PART$ + subexp(\"\\\\?\" + QUERY$) + \"?\" + subexp(\"\\\\#\" + FRAGMENT$) + \"?\"),\n\t\tURI_REFERENCE$ = subexp(URI$ + \"|\" + RELATIVE$),\n\t\tABSOLUTE_URI$ = subexp(SCHEME$ + \"\\\\:\" + HIER_PART$ + subexp(\"\\\\?\" + QUERY$) + \"?\"),\n\n\t\tGENERIC_REF$ = \"^(\" + SCHEME$ + \")\\\\:\" + subexp(subexp(\"\\\\/\\\\/(\" + subexp(\"(\" + USERINFO$ + \")@\") + \"?(\" + HOST$ + \")\" + subexp(\"\\\\:(\" + PORT$ + \")\") + \"?)\") + \"?(\" + PATH_ABEMPTY$ + \"|\" + PATH_ABSOLUTE$ + \"|\" + PATH_ROOTLESS$ + \"|\" + PATH_EMPTY$ + \")\") + subexp(\"\\\\?(\" + QUERY$ + \")\") + \"?\" + subexp(\"\\\\#(\" + FRAGMENT$ + \")\") + \"?$\",\n\t\tRELATIVE_REF$ = \"^(){0}\" + subexp(subexp(\"\\\\/\\\\/(\" + subexp(\"(\" + USERINFO$ + \")@\") + \"?(\" + HOST$ + \")\" + subexp(\"\\\\:(\" + PORT$ + \")\") + \"?)\") + \"?(\" + PATH_ABEMPTY$ + \"|\" + PATH_ABSOLUTE$ + \"|\" + PATH_NOSCHEME$ + \"|\" + PATH_EMPTY$ + \")\") + subexp(\"\\\\?(\" + QUERY$ + \")\") + \"?\" + subexp(\"\\\\#(\" + FRAGMENT$ + \")\") + \"?$\",\n\t\tABSOLUTE_REF$ = \"^(\" + SCHEME$ + \")\\\\:\" + subexp(subexp(\"\\\\/\\\\/(\" + subexp(\"(\" + USERINFO$ + \")@\") + \"?(\" + HOST$ + \")\" + subexp(\"\\\\:(\" + PORT$ + \")\") + \"?)\") + \"?(\" + PATH_ABEMPTY$ + \"|\" + PATH_ABSOLUTE$ + \"|\" + PATH_ROOTLESS$ + \"|\" + PATH_EMPTY$ + \")\") + subexp(\"\\\\?(\" + QUERY$ + \")\") + \"?$\",\n\t\tSAMEDOC_REF$ = \"^\" + subexp(\"\\\\#(\" + FRAGMENT$ + \")\") + \"?$\",\n\t\tAUTHORITY_REF$ = \"^\" + subexp(\"(\" + USERINFO$ + \")@\") + \"?(\" + HOST$ + \")\" + subexp(\"\\\\:(\" + PORT$ + \")\") + \"?$\"\n\t;\n\n\treturn {\n\t\tNOT_SCHEME : new RegExp(merge(\"[^]\", ALPHA$$, DIGIT$$, \"[\\\\+\\\\-\\\\.]\"), \"g\"),\n\t\tNOT_USERINFO : new RegExp(merge(\"[^\\\\%\\\\:]\", UNRESERVED$$, SUB_DELIMS$$), \"g\"),\n\t\tNOT_HOST : new RegExp(merge(\"[^\\\\%\\\\[\\\\]\\\\:]\", UNRESERVED$$, SUB_DELIMS$$), \"g\"),\n\t\tNOT_PATH : new RegExp(merge(\"[^\\\\%\\\\/\\\\:\\\\@]\", UNRESERVED$$, SUB_DELIMS$$), \"g\"),\n\t\tNOT_PATH_NOSCHEME : new RegExp(merge(\"[^\\\\%\\\\/\\\\@]\", UNRESERVED$$, SUB_DELIMS$$), \"g\"),\n\t\tNOT_QUERY : new RegExp(merge(\"[^\\\\%]\", UNRESERVED$$, SUB_DELIMS$$, \"[\\\\:\\\\@\\\\/\\\\?]\", IPRIVATE$$), \"g\"),\n\t\tNOT_FRAGMENT : new RegExp(merge(\"[^\\\\%]\", UNRESERVED$$, SUB_DELIMS$$, \"[\\\\:\\\\@\\\\/\\\\?]\"), \"g\"),\n\t\tESCAPE : new RegExp(merge(\"[^]\", UNRESERVED$$, SUB_DELIMS$$), \"g\"),\n\t\tUNRESERVED : new RegExp(UNRESERVED$$, \"g\"),\n\t\tOTHER_CHARS : new RegExp(merge(\"[^\\\\%]\", UNRESERVED$$, RESERVED$$), \"g\"),\n\t\tPCT_ENCODED : new RegExp(PCT_ENCODED$, \"g\"),\n\t\tIPV4ADDRESS : new RegExp(\"^(\" + IPV4ADDRESS$ + \")$\"),\n\t\tIPV6ADDRESS : new RegExp(\"^\\\\[?(\" + IPV6ADDRESS$ + \")\" + subexp(subexp(\"\\\\%25|\\\\%(?!\" + HEXDIG$$ + \"{2})\") + \"(\" + ZONEID$ + \")\") + \"?\\\\]?$\")  //RFC 6874, with relaxed parsing rules\n\t};\n}\n\nexport default buildExps(false);\n","import { URIRegExps } from \"./uri\";\nimport { buildExps } from \"./regexps-uri\";\n\nexport default buildExps(true);\n","'use strict';\n\n/** Highest positive signed 32-bit float value */\nconst maxInt = 2147483647; // aka. 0x7FFFFFFF or 2^31-1\n\n/** Bootstring parameters */\nconst base = 36;\nconst tMin = 1;\nconst tMax = 26;\nconst skew = 38;\nconst damp = 700;\nconst initialBias = 72;\nconst initialN = 128; // 0x80\nconst delimiter = '-'; // '\\x2D'\n\n/** Regular expressions */\nconst regexPunycode = /^xn--/;\nconst regexNonASCII = /[^\\0-\\x7E]/; // non-ASCII chars\nconst regexSeparators = /[\\x2E\\u3002\\uFF0E\\uFF61]/g; // RFC 3490 separators\n\n/** Error messages */\nconst errors = {\n\t'overflow': 'Overflow: input needs wider integers to process',\n\t'not-basic': 'Illegal input >= 0x80 (not a basic code point)',\n\t'invalid-input': 'Invalid input'\n};\n\n/** Convenience shortcuts */\nconst baseMinusTMin = base - tMin;\nconst floor = Math.floor;\nconst stringFromCharCode = String.fromCharCode;\n\n/*--------------------------------------------------------------------------*/\n\n/**\n * A generic error utility function.\n * @private\n * @param {String} type The error type.\n * @returns {Error} Throws a `RangeError` with the applicable error message.\n */\nfunction error(type) {\n\tthrow new RangeError(errors[type]);\n}\n\n/**\n * A generic `Array#map` utility function.\n * @private\n * @param {Array} array The array to iterate over.\n * @param {Function} callback The function that gets called for every array\n * item.\n * @returns {Array} A new array of values returned by the callback function.\n */\nfunction map(array, fn) {\n\tconst result = [];\n\tlet length = array.length;\n\twhile (length--) {\n\t\tresult[length] = fn(array[length]);\n\t}\n\treturn result;\n}\n\n/**\n * A simple `Array#map`-like wrapper to work with domain name strings or email\n * addresses.\n * @private\n * @param {String} domain The domain name or email address.\n * @param {Function} callback The function that gets called for every\n * character.\n * @returns {Array} A new string of characters returned by the callback\n * function.\n */\nfunction mapDomain(string, fn) {\n\tconst parts = string.split('@');\n\tlet result = '';\n\tif (parts.length > 1) {\n\t\t// In email addresses, only the domain name should be punycoded. Leave\n\t\t// the local part (i.e. everything up to `@`) intact.\n\t\tresult = parts[0] + '@';\n\t\tstring = parts[1];\n\t}\n\t// Avoid `split(regex)` for IE8 compatibility. See #17.\n\tstring = string.replace(regexSeparators, '\\x2E');\n\tconst labels = string.split('.');\n\tconst encoded = map(labels, fn).join('.');\n\treturn result + encoded;\n}\n\n/**\n * Creates an array containing the numeric code points of each Unicode\n * character in the string. While JavaScript uses UCS-2 internally,\n * this function will convert a pair of surrogate halves (each of which\n * UCS-2 exposes as separate characters) into a single code point,\n * matching UTF-16.\n * @see `punycode.ucs2.encode`\n * @see <https://mathiasbynens.be/notes/javascript-encoding>\n * @memberOf punycode.ucs2\n * @name decode\n * @param {String} string The Unicode input string (UCS-2).\n * @returns {Array} The new array of code points.\n */\nfunction ucs2decode(string) {\n\tconst output = [];\n\tlet counter = 0;\n\tconst length = string.length;\n\twhile (counter < length) {\n\t\tconst value = string.charCodeAt(counter++);\n\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t// It's a high surrogate, and there is a next character.\n\t\t\tconst extra = string.charCodeAt(counter++);\n\t\t\tif ((extra & 0xFC00) == 0xDC00) { // Low surrogate.\n\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t} else {\n\t\t\t\t// It's an unmatched surrogate; only append this code unit, in case the\n\t\t\t\t// next code unit is the high surrogate of a surrogate pair.\n\t\t\t\toutput.push(value);\n\t\t\t\tcounter--;\n\t\t\t}\n\t\t} else {\n\t\t\toutput.push(value);\n\t\t}\n\t}\n\treturn output;\n}\n\n/**\n * Creates a string based on an array of numeric code points.\n * @see `punycode.ucs2.decode`\n * @memberOf punycode.ucs2\n * @name encode\n * @param {Array} codePoints The array of numeric code points.\n * @returns {String} The new Unicode string (UCS-2).\n */\nconst ucs2encode = array => String.fromCodePoint(...array);\n\n/**\n * Converts a basic code point into a digit/integer.\n * @see `digitToBasic()`\n * @private\n * @param {Number} codePoint The basic numeric code point value.\n * @returns {Number} The numeric value of a basic code point (for use in\n * representing integers) in the range `0` to `base - 1`, or `base` if\n * the code point does not represent a value.\n */\nconst basicToDigit = function(codePoint) {\n\tif (codePoint - 0x30 < 0x0A) {\n\t\treturn codePoint - 0x16;\n\t}\n\tif (codePoint - 0x41 < 0x1A) {\n\t\treturn codePoint - 0x41;\n\t}\n\tif (codePoint - 0x61 < 0x1A) {\n\t\treturn codePoint - 0x61;\n\t}\n\treturn base;\n};\n\n/**\n * Converts a digit/integer into a basic code point.\n * @see `basicToDigit()`\n * @private\n * @param {Number} digit The numeric value of a basic code point.\n * @returns {Number} The basic code point whose value (when used for\n * representing integers) is `digit`, which needs to be in the range\n * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n * used; else, the lowercase form is used. The behavior is undefined\n * if `flag` is non-zero and `digit` has no uppercase form.\n */\nconst digitToBasic = function(digit, flag) {\n\t//  0..25 map to ASCII a..z or A..Z\n\t// 26..35 map to ASCII 0..9\n\treturn digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);\n};\n\n/**\n * Bias adaptation function as per section 3.4 of RFC 3492.\n * https://tools.ietf.org/html/rfc3492#section-3.4\n * @private\n */\nconst adapt = function(delta, numPoints, firstTime) {\n\tlet k = 0;\n\tdelta = firstTime ? floor(delta / damp) : delta >> 1;\n\tdelta += floor(delta / numPoints);\n\tfor (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {\n\t\tdelta = floor(delta / baseMinusTMin);\n\t}\n\treturn floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n};\n\n/**\n * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n * symbols.\n * @memberOf punycode\n * @param {String} input The Punycode string of ASCII-only symbols.\n * @returns {String} The resulting string of Unicode symbols.\n */\nconst decode = function(input) {\n\t// Don't use UCS-2.\n\tconst output = [];\n\tconst inputLength = input.length;\n\tlet i = 0;\n\tlet n = initialN;\n\tlet bias = initialBias;\n\n\t// Handle the basic code points: let `basic` be the number of input code\n\t// points before the last delimiter, or `0` if there is none, then copy\n\t// the first basic code points to the output.\n\n\tlet basic = input.lastIndexOf(delimiter);\n\tif (basic < 0) {\n\t\tbasic = 0;\n\t}\n\n\tfor (let j = 0; j < basic; ++j) {\n\t\t// if it's not a basic code point\n\t\tif (input.charCodeAt(j) >= 0x80) {\n\t\t\terror('not-basic');\n\t\t}\n\t\toutput.push(input.charCodeAt(j));\n\t}\n\n\t// Main decoding loop: start just after the last delimiter if any basic code\n\t// points were copied; start at the beginning otherwise.\n\n\tfor (let index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {\n\n\t\t// `index` is the index of the next character to be consumed.\n\t\t// Decode a generalized variable-length integer into `delta`,\n\t\t// which gets added to `i`. The overflow checking is easier\n\t\t// if we increase `i` as we go, then subtract off its starting\n\t\t// value at the end to obtain `delta`.\n\t\tlet oldi = i;\n\t\tfor (let w = 1, k = base; /* no condition */; k += base) {\n\n\t\t\tif (index >= inputLength) {\n\t\t\t\terror('invalid-input');\n\t\t\t}\n\n\t\t\tconst digit = basicToDigit(input.charCodeAt(index++));\n\n\t\t\tif (digit >= base || digit > floor((maxInt - i) / w)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\ti += digit * w;\n\t\t\tconst t = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\n\t\t\tif (digit < t) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tconst baseMinusT = base - t;\n\t\t\tif (w > floor(maxInt / baseMinusT)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tw *= baseMinusT;\n\n\t\t}\n\n\t\tconst out = output.length + 1;\n\t\tbias = adapt(i - oldi, out, oldi == 0);\n\n\t\t// `i` was supposed to wrap around from `out` to `0`,\n\t\t// incrementing `n` each time, so we'll fix that now:\n\t\tif (floor(i / out) > maxInt - n) {\n\t\t\terror('overflow');\n\t\t}\n\n\t\tn += floor(i / out);\n\t\ti %= out;\n\n\t\t// Insert `n` at position `i` of the output.\n\t\toutput.splice(i++, 0, n);\n\n\t}\n\n\treturn String.fromCodePoint(...output);\n};\n\n/**\n * Converts a string of Unicode symbols (e.g. a domain name label) to a\n * Punycode string of ASCII-only symbols.\n * @memberOf punycode\n * @param {String} input The string of Unicode symbols.\n * @returns {String} The resulting Punycode string of ASCII-only symbols.\n */\nconst encode = function(input) {\n\tconst output = [];\n\n\t// Convert the input in UCS-2 to an array of Unicode code points.\n\tinput = ucs2decode(input);\n\n\t// Cache the length.\n\tlet inputLength = input.length;\n\n\t// Initialize the state.\n\tlet n = initialN;\n\tlet delta = 0;\n\tlet bias = initialBias;\n\n\t// Handle the basic code points.\n\tfor (const currentValue of input) {\n\t\tif (currentValue < 0x80) {\n\t\t\toutput.push(stringFromCharCode(currentValue));\n\t\t}\n\t}\n\n\tlet basicLength = output.length;\n\tlet handledCPCount = basicLength;\n\n\t// `handledCPCount` is the number of code points that have been handled;\n\t// `basicLength` is the number of basic code points.\n\n\t// Finish the basic string with a delimiter unless it's empty.\n\tif (basicLength) {\n\t\toutput.push(delimiter);\n\t}\n\n\t// Main encoding loop:\n\twhile (handledCPCount < inputLength) {\n\n\t\t// All non-basic code points < n have been handled already. Find the next\n\t\t// larger one:\n\t\tlet m = maxInt;\n\t\tfor (const currentValue of input) {\n\t\t\tif (currentValue >= n && currentValue < m) {\n\t\t\t\tm = currentValue;\n\t\t\t}\n\t\t}\n\n\t\t// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t\t// but guard against overflow.\n\t\tconst handledCPCountPlusOne = handledCPCount + 1;\n\t\tif (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n\t\t\terror('overflow');\n\t\t}\n\n\t\tdelta += (m - n) * handledCPCountPlusOne;\n\t\tn = m;\n\n\t\tfor (const currentValue of input) {\n\t\t\tif (currentValue < n && ++delta > maxInt) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\t\t\tif (currentValue == n) {\n\t\t\t\t// Represent delta as a generalized variable-length integer.\n\t\t\t\tlet q = delta;\n\t\t\t\tfor (let k = base; /* no condition */; k += base) {\n\t\t\t\t\tconst t = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\t\t\t\t\tif (q < t) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tconst qMinusT = q - t;\n\t\t\t\t\tconst baseMinusT = base - t;\n\t\t\t\t\toutput.push(\n\t\t\t\t\t\tstringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))\n\t\t\t\t\t);\n\t\t\t\t\tq = floor(qMinusT / baseMinusT);\n\t\t\t\t}\n\n\t\t\t\toutput.push(stringFromCharCode(digitToBasic(q, 0)));\n\t\t\t\tbias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n\t\t\t\tdelta = 0;\n\t\t\t\t++handledCPCount;\n\t\t\t}\n\t\t}\n\n\t\t++delta;\n\t\t++n;\n\n\t}\n\treturn output.join('');\n};\n\n/**\n * Converts a Punycode string representing a domain name or an email address\n * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\n * it doesn't matter if you call it on a string that has already been\n * converted to Unicode.\n * @memberOf punycode\n * @param {String} input The Punycoded domain name or email address to\n * convert to Unicode.\n * @returns {String} The Unicode representation of the given Punycode\n * string.\n */\nconst toUnicode = function(input) {\n\treturn mapDomain(input, function(string) {\n\t\treturn regexPunycode.test(string)\n\t\t\t? decode(string.slice(4).toLowerCase())\n\t\t\t: string;\n\t});\n};\n\n/**\n * Converts a Unicode string representing a domain name or an email address to\n * Punycode. Only the non-ASCII parts of the domain name will be converted,\n * i.e. it doesn't matter if you call it with a domain that's already in\n * ASCII.\n * @memberOf punycode\n * @param {String} input The domain name or email address to convert, as a\n * Unicode string.\n * @returns {String} The Punycode representation of the given domain name or\n * email address.\n */\nconst toASCII = function(input) {\n\treturn mapDomain(input, function(string) {\n\t\treturn regexNonASCII.test(string)\n\t\t\t? 'xn--' + encode(string)\n\t\t\t: string;\n\t});\n};\n\n/*--------------------------------------------------------------------------*/\n\n/** Define the public API */\nconst punycode = {\n\t/**\n\t * A string representing the current Punycode.js version number.\n\t * @memberOf punycode\n\t * @type String\n\t */\n\t'version': '2.1.0',\n\t/**\n\t * An object of methods to convert from JavaScript's internal character\n\t * representation (UCS-2) to Unicode code points, and back.\n\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t * @memberOf punycode\n\t * @type Object\n\t */\n\t'ucs2': {\n\t\t'decode': ucs2decode,\n\t\t'encode': ucs2encode\n\t},\n\t'decode': decode,\n\t'encode': encode,\n\t'toASCII': toASCII,\n\t'toUnicode': toUnicode\n};\n\nexport default punycode;\n","/**\n * URI.js\n *\n * @fileoverview An RFC 3986 compliant, scheme extendable URI parsing/validating/resolving library for JavaScript.\n * @author <a href=\"mailto:gary.court@gmail.com\">Gary Court</a>\n * @see http://github.com/garycourt/uri-js\n */\n\n/**\n * Copyright 2011 Gary Court. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification, are\n * permitted provided that the following conditions are met:\n *\n *    1. Redistributions of source code must retain the above copyright notice, this list of\n *       conditions and the following disclaimer.\n *\n *    2. Redistributions in binary form must reproduce the above copyright notice, this list\n *       of conditions and the following disclaimer in the documentation and/or other materials\n *       provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY GARY COURT ``AS IS'' AND ANY EXPRESS OR IMPLIED\n * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL GARY COURT OR\n * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n * ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * The views and conclusions contained in the software and documentation are those of the\n * authors and should not be interpreted as representing official policies, either expressed\n * or implied, of Gary Court.\n */\n\nimport URI_PROTOCOL from \"./regexps-uri\";\nimport IRI_PROTOCOL from \"./regexps-iri\";\nimport punycode from \"punycode\";\nimport { toUpperCase, typeOf, assign } from \"./util\";\n\nexport interface URIComponents {\n\tscheme?:string;\n\tuserinfo?:string;\n\thost?:string;\n\tport?:number|string;\n\tpath?:string;\n\tquery?:string;\n\tfragment?:string;\n\treference?:string;\n\terror?:string;\n}\n\nexport interface URIOptions {\n\tscheme?:string;\n\treference?:string;\n\ttolerant?:boolean;\n\tabsolutePath?:boolean;\n\tiri?:boolean;\n\tunicodeSupport?:boolean;\n\tdomainHost?:boolean;\n}\n\nexport interface URISchemeHandler<Components extends URIComponents = URIComponents, Options extends URIOptions = URIOptions, ParentComponents extends URIComponents = URIComponents> {\n\tscheme:string;\n\tparse(components:ParentComponents, options:Options):Components;\n\tserialize(components:Components, options:Options):ParentComponents;\n\tunicodeSupport?:boolean;\n\tdomainHost?:boolean;\n\tabsolutePath?:boolean;\n}\n\nexport interface URIRegExps {\n\tNOT_SCHEME : RegExp,\n\tNOT_USERINFO : RegExp,\n\tNOT_HOST : RegExp,\n\tNOT_PATH : RegExp,\n\tNOT_PATH_NOSCHEME : RegExp,\n\tNOT_QUERY : RegExp,\n\tNOT_FRAGMENT : RegExp,\n\tESCAPE : RegExp,\n\tUNRESERVED : RegExp,\n\tOTHER_CHARS : RegExp,\n\tPCT_ENCODED : RegExp,\n\tIPV4ADDRESS : RegExp,\n\tIPV6ADDRESS : RegExp,\n}\n\nexport const SCHEMES:{[scheme:string]:URISchemeHandler} = {};\n\nexport function pctEncChar(chr:string):string {\n\tconst c = chr.charCodeAt(0);\n\tlet e:string;\n\n\tif (c < 16) e = \"%0\" + c.toString(16).toUpperCase();\n\telse if (c < 128) e = \"%\" + c.toString(16).toUpperCase();\n\telse if (c < 2048) e = \"%\" + ((c >> 6) | 192).toString(16).toUpperCase() + \"%\" + ((c & 63) | 128).toString(16).toUpperCase();\n\telse e = \"%\" + ((c >> 12) | 224).toString(16).toUpperCase() + \"%\" + (((c >> 6) & 63) | 128).toString(16).toUpperCase() + \"%\" + ((c & 63) | 128).toString(16).toUpperCase();\n\n\treturn e;\n}\n\nexport function pctDecChars(str:string):string {\n\tlet newStr = \"\";\n\tlet i = 0;\n\tconst il = str.length;\n\n\twhile (i < il) {\n\t\tconst c = parseInt(str.substr(i + 1, 2), 16);\n\n\t\tif (c < 128) {\n\t\t\tnewStr += String.fromCharCode(c);\n\t\t\ti += 3;\n\t\t}\n\t\telse if (c >= 194 && c < 224) {\n\t\t\tif ((il - i) >= 6) {\n\t\t\t\tconst c2 = parseInt(str.substr(i + 4, 2), 16);\n\t\t\t\tnewStr += String.fromCharCode(((c & 31) << 6) | (c2 & 63));\n\t\t\t} else {\n\t\t\t\tnewStr += str.substr(i, 6);\n\t\t\t}\n\t\t\ti += 6;\n\t\t}\n\t\telse if (c >= 224) {\n\t\t\tif ((il - i) >= 9) {\n\t\t\t\tconst c2 = parseInt(str.substr(i + 4, 2), 16);\n\t\t\t\tconst c3 = parseInt(str.substr(i + 7, 2), 16);\n\t\t\t\tnewStr += String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));\n\t\t\t} else {\n\t\t\t\tnewStr += str.substr(i, 9);\n\t\t\t}\n\t\t\ti += 9;\n\t\t}\n\t\telse {\n\t\t\tnewStr += str.substr(i, 3);\n\t\t\ti += 3;\n\t\t}\n\t}\n\n\treturn newStr;\n}\n\nfunction _normalizeComponentEncoding(components:URIComponents, protocol:URIRegExps) {\n\tfunction decodeUnreserved(str:string):string {\n\t\tconst decStr = pctDecChars(str);\n\t\treturn (!decStr.match(protocol.UNRESERVED) ? str : decStr);\n\t}\n\n\tif (components.scheme) components.scheme = String(components.scheme).replace(protocol.PCT_ENCODED, decodeUnreserved).toLowerCase().replace(protocol.NOT_SCHEME, \"\");\n\tif (components.userinfo !== undefined) components.userinfo = String(components.userinfo).replace(protocol.PCT_ENCODED, decodeUnreserved).replace(protocol.NOT_USERINFO, pctEncChar).replace(protocol.PCT_ENCODED, toUpperCase);\n\tif (components.host !== undefined) components.host = String(components.host).replace(protocol.PCT_ENCODED, decodeUnreserved).toLowerCase().replace(protocol.NOT_HOST, pctEncChar).replace(protocol.PCT_ENCODED, toUpperCase);\n\tif (components.path !== undefined) components.path = String(components.path).replace(protocol.PCT_ENCODED, decodeUnreserved).replace((components.scheme ? protocol.NOT_PATH : protocol.NOT_PATH_NOSCHEME), pctEncChar).replace(protocol.PCT_ENCODED, toUpperCase);\n\tif (components.query !== undefined) components.query = String(components.query).replace(protocol.PCT_ENCODED, decodeUnreserved).replace(protocol.NOT_QUERY, pctEncChar).replace(protocol.PCT_ENCODED, toUpperCase);\n\tif (components.fragment !== undefined) components.fragment = String(components.fragment).replace(protocol.PCT_ENCODED, decodeUnreserved).replace(protocol.NOT_FRAGMENT, pctEncChar).replace(protocol.PCT_ENCODED, toUpperCase);\n\n\treturn components;\n};\n\nfunction _stripLeadingZeros(str:string):string {\n\treturn str.replace(/^0*(.*)/, \"$1\") || \"0\";\n}\n\nfunction _normalizeIPv4(host:string, protocol:URIRegExps):string {\n\tconst matches = host.match(protocol.IPV4ADDRESS) || [];\n\tconst [, address] = matches;\n\t\n\tif (address) {\n\t\treturn address.split(\".\").map(_stripLeadingZeros).join(\".\");\n\t} else {\n\t\treturn host;\n\t}\n}\n\nfunction _normalizeIPv6(host:string, protocol:URIRegExps):string {\n\tconst matches = host.match(protocol.IPV6ADDRESS) || [];\n\tconst [, address, zone] = matches;\n\n\tif (address) {\n\t\tconst [last, first] = address.toLowerCase().split('::').reverse();\n\t\tconst firstFields = first ? first.split(\":\").map(_stripLeadingZeros) : [];\n\t\tconst lastFields = last.split(\":\").map(_stripLeadingZeros);\n\t\tconst isLastFieldIPv4Address = protocol.IPV4ADDRESS.test(lastFields[lastFields.length - 1]);\n\t\tconst fieldCount = isLastFieldIPv4Address ? 7 : 8;\n\t\tconst lastFieldsStart = lastFields.length - fieldCount;\n\t\tconst fields = Array<string>(fieldCount);\n\n\t\tfor (let x = 0; x < fieldCount; ++x) {\n\t\t\tfields[x] = firstFields[x] || lastFields[lastFieldsStart + x] || '';\n\t\t}\n\n\t\tif (isLastFieldIPv4Address) {\n\t\t\tfields[fieldCount - 1] = _normalizeIPv4(fields[fieldCount - 1], protocol);\n\t\t}\n\n\t\tconst allZeroFields = fields.reduce<Array<{index:number,length:number}>>((acc, field, index) => {\n\t\t\tif (!field || field === \"0\") {\n\t\t\t\tconst lastLongest = acc[acc.length - 1];\n\t\t\t\tif (lastLongest && lastLongest.index + lastLongest.length === index) {\n\t\t\t\t\tlastLongest.length++;\n\t\t\t\t} else {\n\t\t\t\t\tacc.push({ index, length : 1 });\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn acc;\n\t\t}, []);\n\n\t\tconst longestZeroFields = allZeroFields.sort((a, b) => b.length - a.length)[0];\n\n\t\tlet newHost:string;\n\t\tif (longestZeroFields && longestZeroFields.length > 1) {\n\t\t\tconst newFirst = fields.slice(0, longestZeroFields.index) ;\n\t\t\tconst newLast = fields.slice(longestZeroFields.index + longestZeroFields.length);\n\t\t\tnewHost = newFirst.join(\":\") + \"::\" + newLast.join(\":\");\n\t\t} else {\n\t\t\tnewHost = fields.join(\":\");\n\t\t}\n\n\t\tif (zone) {\n\t\t\tnewHost += \"%\" + zone;\n\t\t}\n\n\t\treturn newHost;\n\t} else {\n\t\treturn host;\n\t}\n}\n\nconst URI_PARSE = /^(?:([^:\\/?#]+):)?(?:\\/\\/((?:([^\\/?#@]*)@)?(\\[[^\\/?#\\]]+\\]|[^\\/?#:]*)(?:\\:(\\d*))?))?([^?#]*)(?:\\?([^#]*))?(?:#((?:.|\\n|\\r)*))?/i;\nconst NO_MATCH_IS_UNDEFINED = (<RegExpMatchArray>(\"\").match(/(){0}/))[1] === undefined;\n\nexport function parse(uriString:string, options:URIOptions = {}):URIComponents {\n\tconst components:URIComponents = {};\n\tconst protocol = (options.iri !== false ? IRI_PROTOCOL : URI_PROTOCOL);\n\n\tif (options.reference === \"suffix\") uriString = (options.scheme ? options.scheme + \":\" : \"\") + \"//\" + uriString;\n\n\tconst matches = uriString.match(URI_PARSE);\n\n\tif (matches) {\n\t\tif (NO_MATCH_IS_UNDEFINED) {\n\t\t\t//store each component\n\t\t\tcomponents.scheme = matches[1];\n\t\t\tcomponents.userinfo = matches[3];\n\t\t\tcomponents.host = matches[4];\n\t\t\tcomponents.port = parseInt(matches[5], 10);\n\t\t\tcomponents.path = matches[6] || \"\";\n\t\t\tcomponents.query = matches[7];\n\t\t\tcomponents.fragment = matches[8];\n\n\t\t\t//fix port number\n\t\t\tif (isNaN(components.port)) {\n\t\t\t\tcomponents.port = matches[5];\n\t\t\t}\n\t\t} else {  //IE FIX for improper RegExp matching\n\t\t\t//store each component\n\t\t\tcomponents.scheme = matches[1] || undefined;\n\t\t\tcomponents.userinfo = (uriString.indexOf(\"@\") !== -1 ? matches[3] : undefined);\n\t\t\tcomponents.host = (uriString.indexOf(\"//\") !== -1 ? matches[4] : undefined);\n\t\t\tcomponents.port = parseInt(matches[5], 10);\n\t\t\tcomponents.path = matches[6] || \"\";\n\t\t\tcomponents.query = (uriString.indexOf(\"?\") !== -1 ? matches[7] : undefined);\n\t\t\tcomponents.fragment = (uriString.indexOf(\"#\") !== -1 ? matches[8] : undefined);\n\n\t\t\t//fix port number\n\t\t\tif (isNaN(components.port)) {\n\t\t\t\tcomponents.port = (uriString.match(/\\/\\/(?:.|\\n)*\\:(?:\\/|\\?|\\#|$)/) ? matches[4] : undefined);\n\t\t\t}\n\t\t}\n\n\t\tif (components.host) {\n\t\t\t//normalize IP hosts\n\t\t\tcomponents.host = _normalizeIPv6(_normalizeIPv4(components.host, protocol), protocol);\n\t\t}\n\n\t\t//determine reference type\n\t\tif (components.scheme === undefined && components.userinfo === undefined && components.host === undefined && components.port === undefined && !components.path && components.query === undefined) {\n\t\t\tcomponents.reference = \"same-document\";\n\t\t} else if (components.scheme === undefined) {\n\t\t\tcomponents.reference = \"relative\";\n\t\t} else if (components.fragment === undefined) {\n\t\t\tcomponents.reference = \"absolute\";\n\t\t} else {\n\t\t\tcomponents.reference = \"uri\";\n\t\t}\n\n\t\t//check for reference errors\n\t\tif (options.reference && options.reference !== \"suffix\" && options.reference !== components.reference) {\n\t\t\tcomponents.error = components.error || \"URI is not a \" + options.reference + \" reference.\";\n\t\t}\n\n\t\t//find scheme handler\n\t\tconst schemeHandler = SCHEMES[(options.scheme || components.scheme || \"\").toLowerCase()];\n\n\t\t//check if scheme can't handle IRIs\n\t\tif (!options.unicodeSupport && (!schemeHandler || !schemeHandler.unicodeSupport)) {\n\t\t\t//if host component is a domain name\n\t\t\tif (components.host && (options.domainHost || (schemeHandler && schemeHandler.domainHost))) {\n\t\t\t\t//convert Unicode IDN -> ASCII IDN\n\t\t\t\ttry {\n\t\t\t\t\tcomponents.host = punycode.toASCII(components.host.replace(protocol.PCT_ENCODED, pctDecChars).toLowerCase());\n\t\t\t\t} catch (e) {\n\t\t\t\t\tcomponents.error = components.error || \"Host's domain name can not be converted to ASCII via punycode: \" + e;\n\t\t\t\t}\n\t\t\t}\n\t\t\t//convert IRI -> URI\n\t\t\t_normalizeComponentEncoding(components, URI_PROTOCOL);\n\t\t} else {\n\t\t\t//normalize encodings\n\t\t\t_normalizeComponentEncoding(components, protocol);\n\t\t}\n\n\t\t//perform scheme specific parsing\n\t\tif (schemeHandler && schemeHandler.parse) {\n\t\t\tschemeHandler.parse(components, options);\n\t\t}\n\t} else {\n\t\tcomponents.error = components.error || \"URI can not be parsed.\";\n\t}\n\n\treturn components;\n};\n\nfunction _recomposeAuthority(components:URIComponents, options:URIOptions):string|undefined {\n\tconst protocol = (options.iri !== false ? IRI_PROTOCOL : URI_PROTOCOL);\n\tconst uriTokens:Array<string> = [];\n\n\tif (components.userinfo !== undefined) {\n\t\turiTokens.push(components.userinfo);\n\t\turiTokens.push(\"@\");\n\t}\n\n\tif (components.host !== undefined) {\n\t\t//normalize IP hosts, add brackets and escape zone separator for IPv6\n\t\turiTokens.push(_normalizeIPv6(_normalizeIPv4(String(components.host), protocol), protocol).replace(protocol.IPV6ADDRESS, (_, $1, $2) => \"[\" + $1 + ($2 ? \"%25\" + $2 : \"\") + \"]\"));\n\t}\n\n\tif (typeof components.port === \"number\" || typeof components.port === \"string\") {\n\t\turiTokens.push(\":\");\n\t\turiTokens.push(String(components.port));\n\t}\n\n\treturn uriTokens.length ? uriTokens.join(\"\") : undefined;\n};\n\nconst RDS1 = /^\\.\\.?\\//;\nconst RDS2 = /^\\/\\.(\\/|$)/;\nconst RDS3 = /^\\/\\.\\.(\\/|$)/;\nconst RDS4 = /^\\.\\.?$/;\nconst RDS5 = /^\\/?(?:.|\\n)*?(?=\\/|$)/;\n\nexport function removeDotSegments(input:string):string {\n\tconst output:Array<string> = [];\n\n\twhile (input.length) {\n\t\tif (input.match(RDS1)) {\n\t\t\tinput = input.replace(RDS1, \"\");\n\t\t} else if (input.match(RDS2)) {\n\t\t\tinput = input.replace(RDS2, \"/\");\n\t\t} else if (input.match(RDS3)) {\n\t\t\tinput = input.replace(RDS3, \"/\");\n\t\t\toutput.pop();\n\t\t} else if (input === \".\" || input === \"..\") {\n\t\t\tinput = \"\";\n\t\t} else {\n\t\t\tconst im = input.match(RDS5);\n\t\t\tif (im) {\n\t\t\t\tconst s = im[0];\n\t\t\t\tinput = input.slice(s.length);\n\t\t\t\toutput.push(s);\n\t\t\t} else {\n\t\t\t\tthrow new Error(\"Unexpected dot segment condition\");\n\t\t\t}\n\t\t}\n\t}\n\n\treturn output.join(\"\");\n};\n\nexport function serialize(components:URIComponents, options:URIOptions = {}):string {\n\tconst protocol = (options.iri ? IRI_PROTOCOL : URI_PROTOCOL);\n\tconst uriTokens:Array<string> = [];\n\n\t//find scheme handler\n\tconst schemeHandler = SCHEMES[(options.scheme || components.scheme || \"\").toLowerCase()];\n\n\t//perform scheme specific serialization\n\tif (schemeHandler && schemeHandler.serialize) schemeHandler.serialize(components, options);\n\n\tif (components.host) {\n\t\t//if host component is an IPv6 address\n\t\tif (protocol.IPV6ADDRESS.test(components.host)) {\n\t\t\t//TODO: normalize IPv6 address as per RFC 5952\n\t\t}\n\n\t\t//if host component is a domain name\n\t\telse if (options.domainHost || (schemeHandler && schemeHandler.domainHost)) {\n\t\t\t//convert IDN via punycode\n\t\t\ttry {\n\t\t\t\tcomponents.host = (!options.iri ? punycode.toASCII(components.host.replace(protocol.PCT_ENCODED, pctDecChars).toLowerCase()) : punycode.toUnicode(components.host));\n\t\t\t} catch (e) {\n\t\t\t\tcomponents.error = components.error || \"Host's domain name can not be converted to \" + (!options.iri ? \"ASCII\" : \"Unicode\") + \" via punycode: \" + e;\n\t\t\t}\n\t\t}\n\t}\n\n\t//normalize encoding\n\t_normalizeComponentEncoding(components, protocol);\n\n\tif (options.reference !== \"suffix\" && components.scheme) {\n\t\turiTokens.push(components.scheme);\n\t\turiTokens.push(\":\");\n\t}\n\n\tconst authority = _recomposeAuthority(components, options);\n\tif (authority !== undefined) {\n\t\tif (options.reference !== \"suffix\") {\n\t\t\turiTokens.push(\"//\");\n\t\t}\n\n\t\turiTokens.push(authority);\n\n\t\tif (components.path && components.path.charAt(0) !== \"/\") {\n\t\t\turiTokens.push(\"/\");\n\t\t}\n\t}\n\n\tif (components.path !== undefined) {\n\t\tlet s = components.path;\n\n\t\tif (!options.absolutePath && (!schemeHandler || !schemeHandler.absolutePath)) {\n\t\t\ts = removeDotSegments(s);\n\t\t}\n\n\t\tif (authority === undefined) {\n\t\t\ts = s.replace(/^\\/\\//, \"/%2F\");  //don't allow the path to start with \"//\"\n\t\t}\n\n\t\turiTokens.push(s);\n\t}\n\n\tif (components.query !== undefined) {\n\t\turiTokens.push(\"?\");\n\t\turiTokens.push(components.query);\n\t}\n\n\tif (components.fragment !== undefined) {\n\t\turiTokens.push(\"#\");\n\t\turiTokens.push(components.fragment);\n\t}\n\n\treturn uriTokens.join(\"\");  //merge tokens into a string\n};\n\nexport function resolveComponents(base:URIComponents, relative:URIComponents, options:URIOptions = {}, skipNormalization?:boolean):URIComponents {\n\tconst target:URIComponents = {};\n\n\tif (!skipNormalization) {\n\t\tbase = parse(serialize(base, options), options);  //normalize base components\n\t\trelative = parse(serialize(relative, options), options);  //normalize relative components\n\t}\n\toptions = options || {};\n\n\tif (!options.tolerant && relative.scheme) {\n\t\ttarget.scheme = relative.scheme;\n\t\t//target.authority = relative.authority;\n\t\ttarget.userinfo = relative.userinfo;\n\t\ttarget.host = relative.host;\n\t\ttarget.port = relative.port;\n\t\ttarget.path = removeDotSegments(relative.path || \"\");\n\t\ttarget.query = relative.query;\n\t} else {\n\t\tif (relative.userinfo !== undefined || relative.host !== undefined || relative.port !== undefined) {\n\t\t\t//target.authority = relative.authority;\n\t\t\ttarget.userinfo = relative.userinfo;\n\t\t\ttarget.host = relative.host;\n\t\t\ttarget.port = relative.port;\n\t\t\ttarget.path = removeDotSegments(relative.path || \"\");\n\t\t\ttarget.query = relative.query;\n\t\t} else {\n\t\t\tif (!relative.path) {\n\t\t\t\ttarget.path = base.path;\n\t\t\t\tif (relative.query !== undefined) {\n\t\t\t\t\ttarget.query = relative.query;\n\t\t\t\t} else {\n\t\t\t\t\ttarget.query = base.query;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (relative.path.charAt(0) === \"/\") {\n\t\t\t\t\ttarget.path = removeDotSegments(relative.path);\n\t\t\t\t} else {\n\t\t\t\t\tif ((base.userinfo !== undefined || base.host !== undefined || base.port !== undefined) && !base.path) {\n\t\t\t\t\t\ttarget.path = \"/\" + relative.path;\n\t\t\t\t\t} else if (!base.path) {\n\t\t\t\t\t\ttarget.path = relative.path;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttarget.path = base.path.slice(0, base.path.lastIndexOf(\"/\") + 1) + relative.path;\n\t\t\t\t\t}\n\t\t\t\t\ttarget.path = removeDotSegments(target.path);\n\t\t\t\t}\n\t\t\t\ttarget.query = relative.query;\n\t\t\t}\n\t\t\t//target.authority = base.authority;\n\t\t\ttarget.userinfo = base.userinfo;\n\t\t\ttarget.host = base.host;\n\t\t\ttarget.port = base.port;\n\t\t}\n\t\ttarget.scheme = base.scheme;\n\t}\n\n\ttarget.fragment = relative.fragment;\n\n\treturn target;\n};\n\nexport function resolve(baseURI:string, relativeURI:string, options?:URIOptions):string {\n\tconst schemelessOptions = assign({ scheme : 'null' }, options);\n\treturn serialize(resolveComponents(parse(baseURI, schemelessOptions), parse(relativeURI, schemelessOptions), schemelessOptions, true), schemelessOptions);\n};\n\nexport function normalize(uri:string, options?:URIOptions):string;\nexport function normalize(uri:URIComponents, options?:URIOptions):URIComponents;\nexport function normalize(uri:any, options?:URIOptions):any {\n\tif (typeof uri === \"string\") {\n\t\turi = serialize(parse(uri, options), options);\n\t} else if (typeOf(uri) === \"object\") {\n\t\turi = parse(serialize(<URIComponents>uri, options), options);\n\t}\n\n\treturn uri;\n};\n\nexport function equal(uriA:string, uriB:string, options?: URIOptions):boolean;\nexport function equal(uriA:URIComponents, uriB:URIComponents, options?:URIOptions):boolean;\nexport function equal(uriA:any, uriB:any, options?:URIOptions):boolean {\n\tif (typeof uriA === \"string\") {\n\t\turiA = serialize(parse(uriA, options), options);\n\t} else if (typeOf(uriA) === \"object\") {\n\t\turiA = serialize(<URIComponents>uriA, options);\n\t}\n\n\tif (typeof uriB === \"string\") {\n\t\turiB = serialize(parse(uriB, options), options);\n\t} else if (typeOf(uriB) === \"object\") {\n\t\turiB = serialize(<URIComponents>uriB, options);\n\t}\n\n\treturn uriA === uriB;\n};\n\nexport function escapeComponent(str:string, options?:URIOptions):string {\n\treturn str && str.toString().replace((!options || !options.iri ? URI_PROTOCOL.ESCAPE : IRI_PROTOCOL.ESCAPE), pctEncChar);\n};\n\nexport function unescapeComponent(str:string, options?:URIOptions):string {\n\treturn str && str.toString().replace((!options || !options.iri ? URI_PROTOCOL.PCT_ENCODED : IRI_PROTOCOL.PCT_ENCODED), pctDecChars);\n};\n","import { URISchemeHandler, URIComponents, URIOptions } from \"../uri\";\n\nconst handler:URISchemeHandler = {\n\tscheme : \"http\",\n\n\tdomainHost : true,\n\n\tparse : function (components:URIComponents, options:URIOptions):URIComponents {\n\t\t//report missing host\n\t\tif (!components.host) {\n\t\t\tcomponents.error = components.error || \"HTTP URIs must have a host.\";\n\t\t}\n\n\t\treturn components;\n\t},\n\n\tserialize : function (components:URIComponents, options:URIOptions):URIComponents {\n\t\tconst secure = String(components.scheme).toLowerCase() === \"https\";\n\n\t\t//normalize the default port\n\t\tif (components.port === (secure ? 443 : 80) || components.port === \"\") {\n\t\t\tcomponents.port = undefined;\n\t\t}\n\t\t\n\t\t//normalize the empty path\n\t\tif (!components.path) {\n\t\t\tcomponents.path = \"/\";\n\t\t}\n\n\t\t//NOTE: We do not parse query strings for HTTP URIs\n\t\t//as WWW Form Url Encoded query strings are part of the HTML4+ spec,\n\t\t//and not the HTTP spec.\n\n\t\treturn components;\n\t}\n};\n\nexport default handler;","import { URISchemeHandler, URIComponents, URIOptions } from \"../uri\";\nimport http from \"./http\";\n\nconst handler:URISchemeHandler = {\n\tscheme : \"https\",\n\tdomainHost : http.domainHost,\n\tparse : http.parse,\n\tserialize : http.serialize\n}\n\nexport default handler;","import { URISchemeHandler, URIComponents, URIOptions } from \"../uri\";\n\nexport interface WSComponents extends URIComponents {\n\tresourceName?: string;\n\tsecure?: boolean;\n}\n\nfunction isSecure(wsComponents:WSComponents):boolean {\n\treturn typeof wsComponents.secure === 'boolean' ? wsComponents.secure : String(wsComponents.scheme).toLowerCase() === \"wss\";\n}\n\n//RFC 6455\nconst handler:URISchemeHandler = {\n\tscheme : \"ws\",\n\n\tdomainHost : true,\n\n\tparse : function (components:URIComponents, options:URIOptions):WSComponents {\n\t\tconst wsComponents = components as WSComponents;\n\n\t\t//indicate if the secure flag is set\n\t\twsComponents.secure = isSecure(wsComponents);\n\n\t\t//construct resouce name\n\t\twsComponents.resourceName = (wsComponents.path || '/') + (wsComponents.query ? '?' + wsComponents.query : '');\n\t\twsComponents.path = undefined;\n\t\twsComponents.query = undefined;\n\n\t\treturn wsComponents;\n\t},\n\n\tserialize : function (wsComponents:WSComponents, options:URIOptions):URIComponents {\n\t\t//normalize the default port\n\t\tif (wsComponents.port === (isSecure(wsComponents) ? 443 : 80) || wsComponents.port === \"\") {\n\t\t\twsComponents.port = undefined;\n\t\t}\n\n\t\t//ensure scheme matches secure flag\n\t\tif (typeof wsComponents.secure === 'boolean') {\n\t\t\twsComponents.scheme = (wsComponents.secure ? 'wss' : 'ws');\n\t\t\twsComponents.secure = undefined;\n\t\t}\n\n\t\t//reconstruct path from resource name\n\t\tif (wsComponents.resourceName) {\n\t\t\tconst [path, query] = wsComponents.resourceName.split('?');\n\t\t\twsComponents.path = (path && path !== '/' ? path : undefined);\n\t\t\twsComponents.query = query;\n\t\t\twsComponents.resourceName = undefined;\n\t\t}\n\n\t\t//forbid fragment component\n\t\twsComponents.fragment = undefined;\n\n\t\treturn wsComponents;\n\t}\n};\n\nexport default handler;","import { URISchemeHandler, URIComponents, URIOptions } from \"../uri\";\nimport ws from \"./ws\";\n\nconst handler:URISchemeHandler = {\n\tscheme : \"wss\",\n\tdomainHost : ws.domainHost,\n\tparse : ws.parse,\n\tserialize : ws.serialize\n}\n\nexport default handler;","import { URISchemeHandler, URIComponents, URIOptions } from \"../uri\";\nimport { pctEncChar, pctDecChars, unescapeComponent } from \"../uri\";\nimport punycode from \"punycode\";\nimport { merge, subexp, toUpperCase, toArray } from \"../util\";\n\nexport interface MailtoHeaders {\n\t[hfname:string]:string\n}\n\nexport interface MailtoComponents extends URIComponents {\n\tto:Array<string>,\n\theaders?:MailtoHeaders,\n\tsubject?:string,\n\tbody?:string\n}\n\nconst O:MailtoHeaders = {};\nconst isIRI = true;\n\n//RFC 3986\nconst UNRESERVED$$ = \"[A-Za-z0-9\\\\-\\\\.\\\\_\\\\~\" + (isIRI ? \"\\\\xA0-\\\\u200D\\\\u2010-\\\\u2029\\\\u202F-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFEF\" : \"\") + \"]\";\nconst HEXDIG$$ = \"[0-9A-Fa-f]\";  //case-insensitive\nconst PCT_ENCODED$ = subexp(subexp(\"%[EFef]\" + HEXDIG$$ + \"%\" + HEXDIG$$ + HEXDIG$$ + \"%\" + HEXDIG$$ + HEXDIG$$) + \"|\" + subexp(\"%[89A-Fa-f]\" + HEXDIG$$ + \"%\" + HEXDIG$$ + HEXDIG$$) + \"|\" + subexp(\"%\" + HEXDIG$$ + HEXDIG$$));  //expanded\n\n//RFC 5322, except these symbols as per RFC 6068: @ : / ? # [ ] & ; =\n//const ATEXT$$ = \"[A-Za-z0-9\\\\!\\\\#\\\\$\\\\%\\\\&\\\\'\\\\*\\\\+\\\\-\\\\/\\\\=\\\\?\\\\^\\\\_\\\\`\\\\{\\\\|\\\\}\\\\~]\";\n//const WSP$$ = \"[\\\\x20\\\\x09]\";\n//const OBS_QTEXT$$ = \"[\\\\x01-\\\\x08\\\\x0B\\\\x0C\\\\x0E-\\\\x1F\\\\x7F]\";  //(%d1-8 / %d11-12 / %d14-31 / %d127)\n//const QTEXT$$ = merge(\"[\\\\x21\\\\x23-\\\\x5B\\\\x5D-\\\\x7E]\", OBS_QTEXT$$);  //%d33 / %d35-91 / %d93-126 / obs-qtext\n//const VCHAR$$ = \"[\\\\x21-\\\\x7E]\";\n//const WSP$$ = \"[\\\\x20\\\\x09]\";\n//const OBS_QP$ = subexp(\"\\\\\\\\\" + merge(\"[\\\\x00\\\\x0D\\\\x0A]\", OBS_QTEXT$$));  //%d0 / CR / LF / obs-qtext\n//const FWS$ = subexp(subexp(WSP$$ + \"*\" + \"\\\\x0D\\\\x0A\") + \"?\" + WSP$$ + \"+\");\n//const QUOTED_PAIR$ = subexp(subexp(\"\\\\\\\\\" + subexp(VCHAR$$ + \"|\" + WSP$$)) + \"|\" + OBS_QP$);\n//const QUOTED_STRING$ = subexp('\\\\\"' + subexp(FWS$ + \"?\" + QCONTENT$) + \"*\" + FWS$ + \"?\" + '\\\\\"');\nconst ATEXT$$ = \"[A-Za-z0-9\\\\!\\\\$\\\\%\\\\'\\\\*\\\\+\\\\-\\\\^\\\\_\\\\`\\\\{\\\\|\\\\}\\\\~]\";\nconst QTEXT$$ = \"[\\\\!\\\\$\\\\%\\\\'\\\\(\\\\)\\\\*\\\\+\\\\,\\\\-\\\\.0-9\\\\<\\\\>A-Z\\\\x5E-\\\\x7E]\";\nconst VCHAR$$ = merge(QTEXT$$, \"[\\\\\\\"\\\\\\\\]\");\nconst DOT_ATOM_TEXT$ = subexp(ATEXT$$ + \"+\" + subexp(\"\\\\.\" + ATEXT$$ + \"+\") + \"*\");\nconst QUOTED_PAIR$ = subexp(\"\\\\\\\\\" + VCHAR$$);\nconst QCONTENT$ = subexp(QTEXT$$ + \"|\" + QUOTED_PAIR$);\nconst QUOTED_STRING$ = subexp('\\\\\"' + QCONTENT$ + \"*\" + '\\\\\"');\n\n//RFC 6068\nconst DTEXT_NO_OBS$$ = \"[\\\\x21-\\\\x5A\\\\x5E-\\\\x7E]\";  //%d33-90 / %d94-126\nconst SOME_DELIMS$$ = \"[\\\\!\\\\$\\\\'\\\\(\\\\)\\\\*\\\\+\\\\,\\\\;\\\\:\\\\@]\";\nconst QCHAR$ = subexp(UNRESERVED$$ + \"|\" + PCT_ENCODED$ + \"|\" + SOME_DELIMS$$);\nconst DOMAIN$ = subexp(DOT_ATOM_TEXT$ + \"|\" + \"\\\\[\" + DTEXT_NO_OBS$$ + \"*\" + \"\\\\]\");\nconst LOCAL_PART$ = subexp(DOT_ATOM_TEXT$ + \"|\" + QUOTED_STRING$);\nconst ADDR_SPEC$ = subexp(LOCAL_PART$ + \"\\\\@\" + DOMAIN$);\nconst TO$ = subexp(ADDR_SPEC$ + subexp(\"\\\\,\" + ADDR_SPEC$) + \"*\");\nconst HFNAME$ = subexp(QCHAR$ + \"*\");\nconst HFVALUE$ = HFNAME$;\nconst HFIELD$ = subexp(HFNAME$ + \"\\\\=\" + HFVALUE$);\nconst HFIELDS2$ = subexp(HFIELD$ + subexp(\"\\\\&\" + HFIELD$) + \"*\");\nconst HFIELDS$ = subexp(\"\\\\?\" + HFIELDS2$);\nconst MAILTO_URI = new RegExp(\"^mailto\\\\:\" + TO$ + \"?\" + HFIELDS$ + \"?$\");\n\nconst UNRESERVED = new RegExp(UNRESERVED$$, \"g\");\nconst PCT_ENCODED = new RegExp(PCT_ENCODED$, \"g\");\nconst NOT_LOCAL_PART = new RegExp(merge(\"[^]\", ATEXT$$, \"[\\\\.]\", '[\\\\\"]', VCHAR$$), \"g\");\nconst NOT_DOMAIN = new RegExp(merge(\"[^]\", ATEXT$$, \"[\\\\.]\", \"[\\\\[]\", DTEXT_NO_OBS$$, \"[\\\\]]\"), \"g\");\nconst NOT_HFNAME = new RegExp(merge(\"[^]\", UNRESERVED$$, SOME_DELIMS$$), \"g\");\nconst NOT_HFVALUE = NOT_HFNAME;\nconst TO = new RegExp(\"^\" + TO$ + \"$\");\nconst HFIELDS = new RegExp(\"^\" + HFIELDS2$ + \"$\");\n\nfunction decodeUnreserved(str:string):string {\n\tconst decStr = pctDecChars(str);\n\treturn (!decStr.match(UNRESERVED) ? str : decStr);\n}\n\nconst handler:URISchemeHandler<MailtoComponents> =  {\n\tscheme : \"mailto\",\n\n\tparse : function (components:URIComponents, options:URIOptions):MailtoComponents {\n\t\tconst mailtoComponents = components as MailtoComponents;\n\t\tconst to = mailtoComponents.to = (mailtoComponents.path ? mailtoComponents.path.split(\",\") : []);\n\t\tmailtoComponents.path = undefined;\n\n\t\tif (mailtoComponents.query) {\n\t\t\tlet unknownHeaders = false\n\t\t\tconst headers:MailtoHeaders = {};\n\t\t\tconst hfields = mailtoComponents.query.split(\"&\");\n\n\t\t\tfor (let x = 0, xl = hfields.length; x < xl; ++x) {\n\t\t\t\tconst hfield = hfields[x].split(\"=\");\n\n\t\t\t\tswitch (hfield[0]) {\n\t\t\t\t\tcase \"to\":\n\t\t\t\t\t\tconst toAddrs = hfield[1].split(\",\");\n\t\t\t\t\t\tfor (let x = 0, xl = toAddrs.length; x < xl; ++x) {\n\t\t\t\t\t\t\tto.push(toAddrs[x]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"subject\":\n\t\t\t\t\t\tmailtoComponents.subject = unescapeComponent(hfield[1], options);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"body\":\n\t\t\t\t\t\tmailtoComponents.body = unescapeComponent(hfield[1], options);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tunknownHeaders = true;\n\t\t\t\t\t\theaders[unescapeComponent(hfield[0], options)] = unescapeComponent(hfield[1], options);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (unknownHeaders) mailtoComponents.headers = headers;\n\t\t}\n\n\t\tmailtoComponents.query = undefined;\n\n\t\tfor (let x = 0, xl = to.length; x < xl; ++x) {\n\t\t\tconst addr = to[x].split(\"@\");\n\n\t\t\taddr[0] = unescapeComponent(addr[0]);\n\n\t\t\tif (!options.unicodeSupport) {\n\t\t\t\t//convert Unicode IDN -> ASCII IDN\n\t\t\t\ttry {\n\t\t\t\t\taddr[1] = punycode.toASCII(unescapeComponent(addr[1], options).toLowerCase());\n\t\t\t\t} catch (e) {\n\t\t\t\t\tmailtoComponents.error = mailtoComponents.error || \"Email address's domain name can not be converted to ASCII via punycode: \" + e;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\taddr[1] = unescapeComponent(addr[1], options).toLowerCase();\n\t\t\t}\n\n\t\t\tto[x] = addr.join(\"@\");\n\t\t}\n\n\t\treturn mailtoComponents;\n\t},\n\n\tserialize : function (mailtoComponents:MailtoComponents, options:URIOptions):URIComponents {\n\t\tconst components = mailtoComponents as URIComponents;\n\t\tconst to = toArray(mailtoComponents.to);\n\t\tif (to) {\n\t\t\tfor (let x = 0, xl = to.length; x < xl; ++x) {\n\t\t\t\tconst toAddr = String(to[x]);\n\t\t\t\tconst atIdx = toAddr.lastIndexOf(\"@\");\n\t\t\t\tconst localPart = (toAddr.slice(0, atIdx)).replace(PCT_ENCODED, decodeUnreserved).replace(PCT_ENCODED, toUpperCase).replace(NOT_LOCAL_PART, pctEncChar);\n\t\t\t\tlet domain = toAddr.slice(atIdx + 1);\n\n\t\t\t\t//convert IDN via punycode\n\t\t\t\ttry {\n\t\t\t\t\tdomain = (!options.iri ? punycode.toASCII(unescapeComponent(domain, options).toLowerCase()) : punycode.toUnicode(domain));\n\t\t\t\t} catch (e) {\n\t\t\t\t\tcomponents.error = components.error || \"Email address's domain name can not be converted to \" + (!options.iri ? \"ASCII\" : \"Unicode\") + \" via punycode: \" + e;\n\t\t\t\t}\n\n\t\t\t\tto[x] = localPart + \"@\" + domain;\n\t\t\t}\n\n\t\t\tcomponents.path = to.join(\",\");\n\t\t}\n\n\t\tconst headers = mailtoComponents.headers = mailtoComponents.headers || {};\n\n\t\tif (mailtoComponents.subject) headers[\"subject\"] = mailtoComponents.subject;\n\t\tif (mailtoComponents.body) headers[\"body\"] = mailtoComponents.body;\n\n\t\tconst fields = [];\n\t\tfor (const name in headers) {\n\t\t\tif (headers[name] !== O[name]) {\n\t\t\t\tfields.push(\n\t\t\t\t\tname.replace(PCT_ENCODED, decodeUnreserved).replace(PCT_ENCODED, toUpperCase).replace(NOT_HFNAME, pctEncChar) +\n\t\t\t\t\t\"=\" +\n\t\t\t\t\theaders[name].replace(PCT_ENCODED, decodeUnreserved).replace(PCT_ENCODED, toUpperCase).replace(NOT_HFVALUE, pctEncChar)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tif (fields.length) {\n\t\t\tcomponents.query = fields.join(\"&\");\n\t\t}\n\n\t\treturn components;\n\t}\n}\n\nexport default handler;","import { URISchemeHandler, URIComponents, URIOptions } from \"../uri\";\nimport { pctEncChar, SCHEMES } from \"../uri\";\n\nexport interface URNComponents extends URIComponents {\n\tnid?:string;\n\tnss?:string;\n}\n\nexport interface URNOptions extends URIOptions {\n\tnid?:string;\n}\n\nconst NID$ = \"(?:[0-9A-Za-z][0-9A-Za-z\\\\-]{1,31})\";\nconst PCT_ENCODED$ = \"(?:\\\\%[0-9A-Fa-f]{2})\";\nconst TRANS$$ = \"[0-9A-Za-z\\\\(\\\\)\\\\+\\\\,\\\\-\\\\.\\\\:\\\\=\\\\@\\\\;\\\\$\\\\_\\\\!\\\\*\\\\'\\\\/\\\\?\\\\#]\";\nconst NSS$ = \"(?:(?:\" + PCT_ENCODED$ + \"|\" + TRANS$$ + \")+)\";\nconst URN_SCHEME = new RegExp(\"^urn\\\\:(\" + NID$ + \")$\");\nconst URN_PATH = new RegExp(\"^(\" + NID$ + \")\\\\:(\" + NSS$ + \")$\");\nconst URN_PARSE = /^([^\\:]+)\\:(.*)/;\nconst URN_EXCLUDED = /[\\x00-\\x20\\\\\\\"\\&\\<\\>\\[\\]\\^\\`\\{\\|\\}\\~\\x7F-\\xFF]/g;\n\n//RFC 2141\nconst handler:URISchemeHandler<URNComponents,URNOptions> = {\n\tscheme : \"urn\",\n\n\tparse : function (components:URIComponents, options:URNOptions):URNComponents {\n\t\tconst matches = components.path && components.path.match(URN_PARSE);\n\t\tlet urnComponents = components as URNComponents;\n\n\t\tif (matches) {\n\t\t\tconst scheme = options.scheme || urnComponents.scheme || \"urn\";\n\t\t\tconst nid = matches[1].toLowerCase();\n\t\t\tconst nss = matches[2];\n\t\t\tconst urnScheme = `${scheme}:${options.nid || nid}`;\n\t\t\tconst schemeHandler = SCHEMES[urnScheme];\n\n\t\t\turnComponents.nid = nid;\n\t\t\turnComponents.nss = nss;\n\t\t\turnComponents.path = undefined;\n\n\t\t\tif (schemeHandler) {\n\t\t\t\turnComponents = schemeHandler.parse(urnComponents, options) as URNComponents;\n\t\t\t}\n\t\t} else {\n\t\t\turnComponents.error = urnComponents.error || \"URN can not be parsed.\";\n\t\t}\n\n\t\treturn urnComponents;\n\t},\n\n\tserialize : function (urnComponents:URNComponents, options:URNOptions):URIComponents {\n\t\tconst scheme = options.scheme || urnComponents.scheme || \"urn\";\n\t\tconst nid = urnComponents.nid;\n\t\tconst urnScheme = `${scheme}:${options.nid || nid}`;\n\t\tconst schemeHandler = SCHEMES[urnScheme];\n\n\t\tif (schemeHandler) {\n\t\t\turnComponents = schemeHandler.serialize(urnComponents, options) as URNComponents;\n\t\t}\n\n\t\tconst uriComponents = urnComponents as URIComponents;\n\t\tconst nss = urnComponents.nss;\n\t\turiComponents.path = `${nid || options.nid}:${nss}`;\n\n\t\treturn uriComponents;\n\t},\n};\n\nexport default handler;","import { URISchemeHandler, URIComponents, URIOptions } from \"../uri\";\nimport { URNComponents } from \"./urn\";\nimport { SCHEMES } from \"../uri\";\n\nexport interface UUIDComponents extends URNComponents {\n\tuuid?: string;\n}\n\nconst UUID = /^[0-9A-Fa-f]{8}(?:\\-[0-9A-Fa-f]{4}){3}\\-[0-9A-Fa-f]{12}$/;\nconst UUID_PARSE = /^[0-9A-Fa-f\\-]{36}/;\n\n//RFC 4122\nconst handler:URISchemeHandler<UUIDComponents, URIOptions, URNComponents> = {\n\tscheme : \"urn:uuid\",\n\n\tparse : function (urnComponents:URNComponents, options:URIOptions):UUIDComponents {\n\t\tconst uuidComponents = urnComponents as UUIDComponents;\n\t\tuuidComponents.uuid = uuidComponents.nss;\n\t\tuuidComponents.nss = undefined;\n\n\t\tif (!options.tolerant && (!uuidComponents.uuid || !uuidComponents.uuid.match(UUID))) {\n\t\t\tuuidComponents.error = uuidComponents.error || \"UUID is not valid.\";\n\t\t}\n\n\t\treturn uuidComponents;\n\t},\n\n\tserialize : function (uuidComponents:UUIDComponents, options:URIOptions):URNComponents {\n\t\tconst urnComponents = uuidComponents as URNComponents;\n\t\t//normalize UUID\n\t\turnComponents.nss = (uuidComponents.uuid || \"\").toLowerCase();\n\t\treturn urnComponents;\n\t},\n};\n\nexport default handler;","import { SCHEMES } from \"./uri\";\n\nimport http from \"./schemes/http\";\nSCHEMES[http.scheme] = http;\n\nimport https from \"./schemes/https\";\nSCHEMES[https.scheme] = https;\n\nimport ws from \"./schemes/ws\";\nSCHEMES[ws.scheme] = ws;\n\nimport wss from \"./schemes/wss\";\nSCHEMES[wss.scheme] = wss;\n\nimport mailto from \"./schemes/mailto\";\nSCHEMES[mailto.scheme] = mailto;\n\nimport urn from \"./schemes/urn\";\nSCHEMES[urn.scheme] = urn;\n\nimport uuid from \"./schemes/urn-uuid\";\nSCHEMES[uuid.scheme] = uuid;\n\nexport * from \"./uri\";\n","const extendedMath = require('../tanks/lib/extendedMath.js');\n\nclass TankController {\n  constructor() {\n    this._initCallback = () => {};\n    this._loopCallback = () => {};\n  }\n\n  loop(callback) {\n    this._loopCallback = callback;\n  }\n\n  init(callback) {\n    this._initCallback = callback;\n  }\n}\n\nclass EvalWorker {\n\n  constructor() {\n    this.onmessage = (msg) => {};\n    this._callStackLimit = 100;\n    this._callStackCount = 0;\n    this._tankController = new TankController();\n  }\n\n  postMessage(inputData) {\n    let response = null;\n    if(inputData.command == 'init') {\n      if(!inputData.code) throw \"The code is required!\";\n      let settings = inputData.settings;\n      let info = inputData.info;\n      var Math = extendedMath();\n\n      let tank = this._tankController;\n      eval(inputData.code);  // jshint ignore:line\n      tank._initCallback(settings, info);\n      response = {data: {type: 'init', settings: settings}};\n    } else if (inputData.command == 'update') {\n      let state = inputData.state;\n      let control = inputData.control;\n      if(this._tankController._loopCallback) {\n        this._tankController._loopCallback(state, control);\n        response = {data: control};\n      } else {\n        response = {data: control};\n      }\n    }\n    if(this._callStackCount < this._callStackLimit) {\n      this._callStackCount++;\n      this.onmessage(response);\n    } else {\n      this._callStackCount = 0;\n      setTimeout(() => {\n        this.onmessage(response);\n      }, 1);\n    }\n\n  }\n\n  terminate() {\n\n  }\n}\n\nexport default EvalWorker;\n","module.exports = function() {\n  var result = {};\n  var items = [\"LN10\", \"PI\", \"E\", \"LOG10E\", \"SQRT2\", \"LOG2E\", \"SQRT1_2\", \"LN2\", \"cos\", \"pow\", \"log\", \"tan\", \"sqrt\", \"ceil\", \"asin\", \"abs\", \"max\", \"exp\", \"atan2\", \"random\", \"round\", \"floor\", \"acos\", \"atan\", \"min\", \"sin\"];\n  for(var i in items) {\n    result[items[i]] = Math[items[i]];\n  }\n\n  result.deg = {};\n\n  result.rad = {};\n\n  result.deg.normalize = function(a) {\n    a = Number(a);\n    while(a > 180) a -= 360;\n    while(a <= -180) a += 360;\n    return a;\n  };\n\n  result.rad.normalize = function(a) {\n    a = Number(a);\n    while(a > result.PI) a -= result.PI*2;\n    while(a <= -result.PI) a += result.PI*2;\n    return a;\n  };\n\n  result.deg2rad = function(v) {\n    return result.rad.normalize(v*(result.PI/180));\n  };\n\n  result.rad2deg = function(v) {\n    return result.deg.normalize(v*(180/result.PI));\n  };\n\n  result.rad.atan2 = result.atan2;\n\n  result.deg.atan2 = function(y, x) {\n    return result.rad2deg(result.rad.atan2(y, x));\n  };\n\n  result.distance = function(x1, y1, x2, y2) {\n    var dx = x2 - x1;\n    var dy = y2 - y1;\n    return result.sqrt(dx*dx + dy*dy);\n  };\n\n  result.randomRange = function(a, b) {\n    if(a > b) throw \"The range is incorrect. First number must be lower than second\";\n    return a + result.random()*(b-a);\n  };\n  return result;\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","__webpack_require__.amdD = function () {\n\tthrow new Error('define cannot be used indirect');\n};","__webpack_require__.amdO = {};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => module['default'] :\n\t\t() => module;\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop)","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","'use strict';\n\nimport seedrandom from \"seedrandom\";\n\nfunction normalizeAngle(a) {\n  while(a > 180) a -= 360;\n  while(a < -180) a += 360;\n  return a;\n}\n\n/**\n * Object represents a tank that is involved in the battle during simulation\n */\nclass Tank {\n\n  /**\n   * Constructor should not be called directly but through\n   * `Simulation.addTank()` method\n   * @param {AiDefinition} aiDefinition - definition of tank's AI Script\n   * @param {Number} id - unique id of the tank\n   * @param {Team} team - reference to team object where the tank belongs\n   */\n  constructor(aiDefinition, id) {\n    if(typeof aiDefinition != 'object') {\n      throw \"AI definition must be an object\";\n    }\n    this._id = id;\n    this._name = aiDefinition.name;\n    this._team =  null;\n    this._maxEnergy = 100;\n    this._energy = this._maxEnergy;\n    this._x = 0;\n    this._y = 0;\n    this._lastX = 0;\n    this._lastY = 0;\n    this._angle = 0;\n    this._gunAngle = 0;\n    this._radarAngle = 0;\n    this._throttle = 0;\n    this._actualThrottle = 0;\n    this._speed = 0;\n    this._turn = 0;\n    this._gunTurn = 0;\n    this._radarTurn = 0;\n    this._wallHit = false;\n    this._enemyHit = false;\n    this._allyHit = false;\n    this._beingRammed = false;\n    this._radarRange = 300;\n    this._radarFocal = 6;\n    this._enemySpot = null;\n    this._allySpot = null;\n    this._bulletsSpot = [];\n    this._gunReloadTime = 70;\n    this._gunTimer = 0;\n    this._shootingPower = 0;\n    this._targetingAlarmTimer = 0;\n    this._debugData = {};\n    this._score = 0;\n    this._state = null;\n    this._hasBoost = false;\n    this._maxBoost = 400;\n    this._boost = this._maxBoost;\n    this._wallDistance = null;\n    this._skin = 'zebra';\n  }\n\n  /**\n   * @return unique id of the tank\n   */\n  get id() {\n    return this._id;\n  }\n  /**\n   * @return skin name applied to the tank\n   */\n  get skin() {\n    return this._skin;\n  }\n\n  /**\n   * @return an object that represents current state of the tank\n   */\n  get state() {\n    return this._state;\n  }\n\n  /**\n   * @return amount of energy that the tank has\n   */\n  get energy() {\n    return this._energy;\n  }\n\n  /**\n   * @return current score of the tank\n   */\n  get score() {\n    return this._score;\n  }\n\n  onEnemyHitScore(damage) {\n    this._score += damage;\n  }\n\n  onEnemyKillScore() {\n    this._score += 20;\n  }\n\n  onSurviveScore() {\n    this._score += 10;\n  }\n\n  /**\n   * @return initial amount of the energy\n   */\n  get maxEnergy() {\n    return this._maxEnergy;\n  }\n\n  /**\n   * @return range of tank's radar\n   */\n  get radarRange() {\n    return this._radarRange;\n  }\n\n  /**\n   * @return angle that radar field covers\n   */\n  get radarFocal() {\n    return this._radarFocal;\n  }\n\n  /**\n   * @return name of the tank\n   */\n  get name() {\n    return this._name;\n  }\n\n  /**\n   * @return full name contains name of the tank and its unique ID\n   */\n  get fullName() {\n    return this._name + \" #\" + this._id;\n  }\n\n  /**\n   * @return name of the team\n   */\n  get team() {\n    return this._team;\n  }\n\n  /**\n   * @return x position of the tank\n   */\n  get x() {\n    return this._x;\n  }\n\n  /**\n   * @return y position of the tank\n   */\n  get y() {\n    return this._y;\n  }\n\n  /**\n   * @return linear speed of the tank\n   */\n  get speed() {\n    return this._speed;\n  }\n\n  get gunLength() {\n    return 25;\n  }\n\n  /**\n   * @return rotation of tank's body\n   */\n  get angle() {\n    return this._angle;\n  }\n\n  /**\n   * @return current throttle of the tank\n   */\n  get throttle() {\n    return this._throttle;\n  }\n  /**\n   * @return true if tank has boost turned on. Otherwise false\n   */\n  get hasBoost() {\n    return (this._hasBoost && this._boost > 0);\n  }\n\n  /**\n   * @return amount of boost that has left\n   */\n  get boost() {\n    return this._boost;\n  }\n\n  /**\n   * @return initial amount of boost\n   */\n  get maxBoost() {\n    return this._maxBoost;\n  }\n\n  /**\n   * @return rotation of tank's gun (relative to tank's body)\n   */\n  get gunAngle() {\n    return this._gunAngle;\n  }\n\n  /**\n   * @return rotation of tank's radar (relative to tank's body)\n   */\n  get radarAngle() {\n    return this._radarAngle;\n  }\n\n  get enemySpot() {\n    return this._enemySpot;\n  }\n\n  get allySpot() {\n    return this._allySpot;\n  }\n\n  setThrottle(v) {\n    this._throttle = Math.min(1, Math.max(-1, v));\n  }\n\n  setTurn(v) {\n    this._turn = Math.min(1, Math.max(-1, v));\n  }\n\n  setGunTurn(v) {\n    this._gunTurn = Math.min(1, Math.max(-1, v));\n  }\n\n  setRadarTurn(v) {\n    this._radarTurn = Math.min(1, Math.max(-1, v));\n  }\n\n  setBoost(v) {\n    this._hasBoost = v ? true : false;\n  }\n\n  setDebugData(v) {\n    this._debugData = v;\n  }\n\n  onWallHit() {\n    this._wallHit = true;\n    this.onDamage(0.2);\n  }\n\n  onEnemyHit() {\n    this._enemyHit = true;\n    this.onDamage(0.2);\n  }\n\n  onAllyHit() {\n    this._allyHit = true;\n    this.onDamage(0.2);\n  }\n\n  onBeingRam(speed) {\n    this._beingRammed = true;\n    this.onDamage(0.1 + Math.round(speed*4)*0.1);\n  }\n\n  onEnemySpot(enemy) {\n    this._enemySpot = enemy;\n  }\n\n  onAllySpot(ally) {\n    this._allySpot = ally;\n  }\n\n  onBulletSpot(bullet) {\n    this._bulletsSpot.push(bullet);\n  }\n\n  onWallSpot(distance) {\n    this._wallDistance = distance;\n  }\n\n  onTargetingAlarm() {\n    this._targetingAlarmTimer = 3;\n  }\n\n  isAlly(tank) {\n    if(!this._team) return false;\n    if(!tank.team) return false;\n    return this._team.name == tank.team.name;\n  }\n\n  /**\n   * @return true if tank is on the radar of an enemy. Otherwise false\n   */\n  get targetingAlarm() {\n    return this._targetingAlarmTimer > 0;\n  }\n\n  onDamage(damage) {\n    this._energy = Math.max(0, this._energy - damage);\n  }\n\n  moveTo(xPosition, yPosition, angle) {\n    this._x = xPosition;\n    this._y = yPosition;\n    this._lastX = xPosition;\n    this._lastY = yPosition;\n    if(angle !== undefined) {\n      this._angle = angle;\n    }\n  }\n\n  /**\n   * @return debug data set by AI script via `control.DEBUG`\n   */\n  get debugData() {\n    return this._debugData;\n  }\n\n  get isShooting() {\n    return this._shootingPower > 0;\n  }\n\n  get shootingPower() {\n    return this._shootingPower;\n  }\n\n  handleShoot() {\n    let value = this._shootingPower;\n    this._shootingPower = 0;\n    return value;\n  }\n\n  get isReloading() {\n    return this._gunTimer > 0;\n  }\n\n  shoot(value) {\n    value = Math.max(0.1, Math.min(1, value));\n    if(!this.isReloading) {\n      this._gunTimer = Math.round(value*this._gunReloadTime);\n      this._shootingPower = value;\n    }\n  }\n\n  randomize(seed) {\n    if(seed === undefined) {\n      seed = (new Date()).getTime() + Math.round(Math.random()*1000000);\n    }\n    let rng = seedrandom(seed);\n    this._angle = Math.round(360*rng())-180;\n  }\n\n  init(settings) {\n    if(settings && settings.SKIN) {\n      this._skin = settings.SKIN;\n    }\n  }\n\n  simulationStep(collisionResolver) {\n    let self = this;\n\n    if(self._energy == 0) {\n      return;\n    }\n\n    if(self._hasBoost && self._boost > 0) {\n      self._boost--;\n    }\n\n    let oldX = self._x;\n    let oldY = self._y;\n\n    let maxSpeed = self._throttle * (self.hasBoost ? 4 : 2);\n    let accelerationFactor = (self.hasBoost ? 10 : 20);\n    self._actualThrottle += (maxSpeed - self._actualThrottle)/accelerationFactor;\n\n    let v = self._actualThrottle;\n    let rotation = self._angle*(Math.PI/180);\n    self._x += v*Math.cos(rotation);\n    self._y += v*Math.sin(rotation);\n    self._wallHit = false;\n    self._enemyHit = false;\n    self._allyHit = false;\n    let hitTest = !collisionResolver.checkTank(self);\n    if(hitTest) {\n      self._x = oldX;\n      self._y = oldY;\n      self._actualThrottle = 0;\n    }\n    if(this._beingRammed) {\n      // must be done later because ramming is\n      // reported after collisionResolver.checkTank(self)\n      // it is detected when collisionResolver.checkTank\n      // is called for attacing tank\n      self._enemyHit = true;\n      this._beingRammed = false;\n    }\n\n    self._angle += 2*self._turn;\n    self._radarAngle += 6*self._radarTurn;\n    self._gunAngle += 3*self._gunTurn;\n\n    self._angle = normalizeAngle(self._angle);\n    self._radarAngle = normalizeAngle(self._radarAngle);\n    self._gunAngle = normalizeAngle(self._gunAngle);\n    collisionResolver.updateTank(self);\n\n    self._enemySpot = null;\n    self._allySpot = null;\n    self._wallDistance = null;\n    self._targetingAlarmTimer = Math.max(0, self._targetingAlarmTimer-1);\n    collisionResolver.scanTanks(self);\n    collisionResolver.scanBullets(self);\n    collisionResolver.scanWalls(self);\n\n    if(self._gunTimer > 0) {\n      self._gunTimer--;\n    }\n\n    let enemyData = null;\n    let allyData = null;\n    let bulletsData = [];\n    while(self._bulletsSpot.length) {\n      let bullet = self._bulletsSpot.shift();\n      bulletsData.push({\n        id: bullet.id,\n        x: bullet.x,\n        y: bullet.y,\n        angle: bullet.angle,\n        speed: bullet.speed,\n        damage: bullet.damage\n      });\n    }\n\n    if(self._enemySpot) {\n      enemyData = {\n        id: self._enemySpot.id,\n        x: self._enemySpot.x,\n        y: self._enemySpot.y,\n        angle: self._enemySpot.angle,\n        speed: self._enemySpot.speed * (self._enemySpot.throttle < 0 ? -1 : 1),\n        energy: self._enemySpot.energy,\n      };\n    }\n    if(self._allySpot) {\n      allyData = {\n        id: self._allySpot.id,\n        x: self._allySpot.x,\n        y: self._allySpot.y,\n        angle: self._allySpot.angle,\n        speed: self._allySpot.speed,\n        energy: self._allySpot.energy,\n      };\n    }\n\n    let dx = self._x - self._lastX;\n    let dy = self._y - self._lastY;\n    self._speed = Math.sqrt(dx*dx + dy*dy);\n\n    self._lastX = self._x;\n    self._lastY = self._y;\n\n    self._state = {\n      x: self._x,\n      y: self._y,\n      angle: self._angle,\n      energy: self._energy,\n      boost: self._boost,\n      collisions: {\n        wall: self._wallHit,\n        enemy: self._enemyHit,\n        ally: self._allyHit\n      },\n      radar: {\n        angle: self._radarAngle,\n        targetingAlarm: self.targetingAlarm,\n        wallDistance: self._wallDistance,\n        enemy: enemyData,\n        ally: allyData,\n        bullets: bulletsData\n      },\n      gun: {\n        angle: self._gunAngle,\n        reloading: self.isReloading\n      },\n      radio: {\n        inbox: self.team ? self.team.getMessages(self.id) : []\n      }\n    };\n  }\n}\n\nexport default Tank;\n","'use strict';\n\nclass Team {\n  constructor(name) {\n    this._name = name;\n    this._members = [];\n    this._inboxMap = [];\n    this._outboxMap = [];\n  }\n\n  addTank(tank) {\n    if(tank.team) throw \"Tank \" + tank.fullName + \" is already assigned to team \" + tank.team.name;\n    for(let i in this._members) {\n      if(this._members[i].id == tank.id) return;\n    }\n    this._members.push(tank);\n    tank._team = this;\n    this._inboxMap[tank.id] = [];\n    this._outboxMap[tank.id] = [];\n  }\n\n  get size() {\n    return this._members.length;\n  }\n\n  get name() {\n    return this._name;\n  }\n\n  get aliveCount() {\n    let count = 0;\n    for(let i=0; i < this._members.length; i++ ) {\n      if(this._members[i].energy > 0) {\n        count++;\n      }\n    }\n    return count;\n  }\n\n  get score() {\n    let sum = 0;\n    for(let i=0; i < this._members.length; i++ ) {\n      sum += this._members[i].score;\n    }\n    return sum;\n  }\n\n  get energy() {\n    let sum = 0;\n    for(let i=0; i < this._members.length; i++ ) {\n      sum += this._members[i].energy;\n    }\n    return sum;\n  }\n\n  get maxEnergy() {\n    let sum = 0;\n    for(let i=0; i < this._members.length; i++ ) {\n      sum += this._members[i].maxEnergy;\n    }\n    return sum;\n  }\n\n  get isAlive() {\n    return this.aliveCount > 0;\n  }\n\n  get members() {\n    return this._members;\n  }\n\n  getMessages(receiverId) {\n    return this._outboxMap[receiverId];\n  }\n\n  sendMessages(senderId, messages) {\n    for(let i in this._inboxMap) {\n      if(i == senderId) continue;\n      this._inboxMap[i] = this._inboxMap[i].concat(messages);\n    }\n  }\n\n  processMessages() {\n    let i;\n    for(i in this._inboxMap) {\n      this._outboxMap[i] = this._inboxMap[i];\n      this._inboxMap[i] = [];\n    }\n  }\n\n}\n\nexport default Team;\n","'use strict';\n\nexport default class Bullet {\n\n  constructor(owner, id, power) {\n    this._id = id;\n    this._owner = owner;\n    this._angle = owner.angle + owner.gunAngle;\n    while(this._angle > 180) this._angle -= 360;\n    while(this._angle < -180) this._angle += 360;\n    this._x = owner.x + owner.gunLength*Math.cos(this._angle*(Math.PI/180));\n    this._y = owner.y + owner.gunLength*Math.sin(this._angle*(Math.PI/180));\n    this._speed = 4;\n    this._power = power;\n    this._damage = Math.round(1000 * power + 300 * power * power) * 0.01;\n    this._exploded = false;\n  }\n\n  get id() {\n    return this._id;\n  }\n\n  get x() {\n    return this._x;\n  }\n\n  get y() {\n    return this._y;\n  }\n\n  get angle() {\n    return this._angle;\n  }\n\n  get speed() {\n    return this._speed;\n  }\n\n  get damage() {\n    return this._damage;\n  }\n\n  get power() {\n    return this._power;\n  }\n  get owner() {\n    return this._owner;\n  }\n\n  get exploded() {\n    return this._exploded;\n  }\n\n  onWallHit() {\n    this._exploded = true;\n  }\n\n  onEnemyHit(enemy) {\n    this._exploded = true;\n    enemy.onDamage(this._damage);\n  }\n\n  simulationStep() {\n    this._x += this._speed*Math.cos(this._angle*(Math.PI/180));\n    this._y += this._speed*Math.sin(this._angle*(Math.PI/180));\n  }\n}\n","'use strict';\n\nimport seedrandom from \"seedrandom\";\n\nexport default class Battlefield {\n\n  constructor(width, height) {\n    this._width = null;\n    this._height = null;\n    this._startSlotList = [];\n    this._offsetX = 0;\n    this._offsetY = 0;\n  }\n\n  setSize(width, height) {\n    this._width = width-this.margin*2;\n    this._height = height-this.margin*2;\n\n\n  }\n\n  randomize(seed) { // remember to call it after setSize !!!\n    if(seed === undefined) {\n      seed = (new Date()).getTime() + Math.round(Math.random()*1000000);\n    }\n    let rng = seedrandom(seed);\n\n    this._offsetX = Math.round(rng()*10000-5000);\n    this._offsetY = Math.round(rng()*10000-5000);\n    \n    // generate list of start slots\n    this._startSlotList = [];\n    let slotSize = 90;\n    for(let x = this.minX + slotSize; x < this.maxX - slotSize; x += slotSize) {\n      for(let y = this.minY + slotSize; y < this.maxY - slotSize; y += slotSize) {\n        this._startSlotList.push({x: x, y: y});\n      }\n    }\n    // shuffle start slots\n    let currentIndex = this._startSlotList.length, temporaryValue, randomIndex;\n    while (0 !== currentIndex) {\n      randomIndex = Math.floor(rng() * currentIndex);\n      currentIndex -= 1;\n      temporaryValue = this._startSlotList[currentIndex];\n      this._startSlotList[currentIndex] = this._startSlotList[randomIndex];\n      this._startSlotList[randomIndex] = temporaryValue;\n    }\n  }\n\n  get width() {\n    return this._width;\n  }\n\n  get height() {\n    return this._height;\n  }\n\n  get margin() {\n    return 25;\n  }\n\n  get minX() {\n    return this._offsetX + this.margin;\n  }\n\n  get minY() {\n    return this._offsetY + this.margin;\n  }\n\n  get maxX() {\n    return this._offsetX + this._width + this.margin;\n  }\n\n  get maxY() {\n    return this._offsetY + this._height + this.margin;\n  }\n\n  get offsetX() {\n    return this._offsetX;\n  }\n\n  get offsetY() {\n    return this._offsetY;\n  }\n\n  getStartSlot() {\n    if(this._startSlotList.length) {\n      return this._startSlotList.pop();\n    }\n    return null;\n  }\n}\n","'use strict';\n\nexport default class EventStore {\n\n  constructor() {\n    this._data = [];\n  }\n\n  add(index, event) {\n    if(!this._data[index]) {\n      this._data[index] = [];\n    }\n    this._data[index].push(event);\n  }\n\n  get(index) {\n    if(!this._data[index]) {\n      this._data[index] = [];\n    }\n    return this._data[index];\n  }\n\n  clear(index) {\n    this._data = [];\n  }\n\n}\n","'use strict';\n\nimport SAT from 'sat';\n\nexport default class CollisionResolver {\n\n  constructor() {\n    this._wallList = [];\n    this._tankMap = [];\n    this._bulletMap = [];\n    this._radarBeamMap = [];\n    this._battlefield = null;\n  }\n\n  updateBattlefield(battlefield) {\n    this._battlefield = {\n      minX: battlefield.minX,\n      minY: battlefield.minY,\n      maxX: battlefield.maxX,\n      maxY: battlefield.maxY\n    };\n    let wall;\n    wall = (new SAT.Box(new SAT.Vector(battlefield.minX-10, battlefield.minY), 10, battlefield.height)).toPolygon();\n    this._wallList.push(wall);\n    wall = (new SAT.Box(new SAT.Vector(battlefield.minX, battlefield.minY-10), battlefield.width, 10)).toPolygon();\n    this._wallList.push(wall);\n    wall = (new SAT.Box(new SAT.Vector(battlefield.maxX, battlefield.minY), 10, battlefield.height)).toPolygon();\n    this._wallList.push(wall);\n    wall = (new SAT.Box(new SAT.Vector(battlefield.minX, battlefield.maxY), battlefield.width, 10)).toPolygon();\n    this._wallList.push(wall);\n  }\n\n  updateTank(tank) {\n    let tankShape =  this._getTankShape(tank);\n    tankShape.pos.x = tank.x;\n    tankShape.pos.y = tank.y;\n  }\n\n  removeBullet(bullet) {\n    this._bulletMap[bullet.id] = null;\n  }\n\n\n  removeTank(tank) {\n    this._tankMap[tank.id] = null;\n    this._radarBeamMap[tank.id] = null;\n  }\n\n  hitTestBullet(bullet) {\n    let bulletShape =  this._getBulletShape(bullet);\n    let tankShape =  bullet.owner.energy ? this._getTankShape(bullet.owner) : null;\n\n    bulletShape.pos.x = bullet.x;\n    bulletShape.pos.y = bullet.y;\n\n    let i;\n    let hitTest;\n    let wall;\n    for(i in this._wallList ) {\n      wall = this._wallList[i];\n      hitTest = SAT.testCirclePolygon(bulletShape, wall);\n      if(hitTest) {\n        bullet.onWallHit();\n        return true;\n      }\n    }\n    let enemyShape;\n    for(i in this._tankMap ) {\n      enemyShape = this._tankMap[i];\n      if(!enemyShape) continue;\n      if(enemyShape == tankShape) {\n        continue;\n      }\n      hitTest = SAT.testCircleCircle(bulletShape, enemyShape);\n      if(hitTest) {\n        let energyBefore = enemyShape.tank.energy;\n        bullet.onEnemyHit(enemyShape.tank);\n        let areAllies = bullet.owner.isAlly(enemyShape.tank);\n        if(!areAllies) {\n          bullet.owner.onEnemyHitScore(energyBefore - enemyShape.tank.energy);\n        }\n        if(enemyShape.tank.energy == 0) {\n          bullet.owner.onEnemyKillScore();\n        }\n        return true;\n      }\n    }\n    return false;\n  }\n\n  checkTank(tank) {\n    let tankShape =  this._getTankShape(tank);\n\n    tankShape.pos.x = tank.x;\n    tankShape.pos.y = tank.y;\n\n    let i;\n    let hitTest;\n    let wall;\n    for(i in this._wallList ) {\n      wall = this._wallList[i];\n      hitTest = SAT.testCirclePolygon(tankShape, wall);\n      if(hitTest) {\n        tank.onWallHit();\n        return false;\n      }\n    }\n    let enemyShape;\n    for(i in this._tankMap ) {\n      enemyShape = this._tankMap[i];\n      if(!enemyShape) continue;\n      if(enemyShape == tankShape) {\n        continue;\n      }\n      hitTest = SAT.testCircleCircle(tankShape, enemyShape);\n      let areAllies = tank.isAlly(enemyShape.tank);\n      if(hitTest) {\n        if(!areAllies) {\n          let energyBefore = enemyShape.tank.energy;\n          tank.onEnemyHit();\n          enemyShape.tank.onBeingRam(tank.speed);\n          tank.onEnemyHitScore(energyBefore - enemyShape.tank.energy);\n          return false;\n        } else {\n          tank.onAllyHit();\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n\n  scanTanks(tank) {\n    let radarBeamShape =  this._getRadarBeamShape(tank);\n    let tankShape =  this._getTankShape(tank);\n    radarBeamShape.setAngle((tank.angle + tank.radarAngle)*Math.PI/180);\n    radarBeamShape.pos.x = tank.x;\n    radarBeamShape.pos.y = tank.y;\n\n    let i;\n    let enemyShape;\n    let hitTest;\n    let enemies = [];\n\n    for(i in this._tankMap ) {\n      enemyShape = this._tankMap[i];\n      if(!enemyShape) continue;\n      if(enemyShape == tankShape) {\n        continue;\n      }\n      hitTest = SAT.testPolygonCircle(radarBeamShape, enemyShape);\n      if(hitTest) {\n        enemies.push(enemyShape.tank);\n      }\n    }\n    if(enemies.length == 0) {\n      return false;\n    }\n    let closestEnemy = null;\n    let closestEnemyDistance = tank.radarRange;\n    let closestAlly = null;\n    let closestAllyDistance = tank.radarRange;\n    let d, dx, dy, ally;\n    for(i in enemies ) {\n      dx = enemies[i].x - tank.x;\n      dy = enemies[i].y - tank.y;\n      d = Math.sqrt(dx*dx + dy*dy);\n      ally = enemies[i].isAlly(tank);\n      if(!ally && (!closestEnemy || d < closestEnemyDistance)) {\n        closestEnemy = enemies[i];\n        closestEnemyDistance = d;\n      } else if(ally && (!closestAlly || d < closestAllyDistance)) {\n        closestAlly = enemies[i];\n        closestAllyDistance = d;\n      }\n    }\n    if(closestAlly) {\n      tank.onAllySpot(closestAlly);\n    }\n    if(closestEnemy) {\n      tank.onEnemySpot(closestEnemy);\n      closestEnemy.onTargetingAlarm();\n    }\n\n\n    return true;\n  }\n\n  scanBullets(tank) {\n    let radarBeamShape =  this._getRadarBeamShape(tank);\n    radarBeamShape.setAngle((tank.angle + tank.radarAngle)*Math.PI/180);\n    radarBeamShape.pos.x = tank.x;\n    radarBeamShape.pos.y = tank.y;\n\n    let i;\n    let hitTest;\n    let bulletShape;\n    let spottedBullets = false;\n\n    for(i in this._bulletMap) {\n      bulletShape = this._bulletMap[i];\n      if(!bulletShape) continue;\n      if(bulletShape.bullet.owner == tank) continue;\n      hitTest = SAT.testCirclePolygon(bulletShape, radarBeamShape);\n      if(hitTest) {\n        tank.onBulletSpot(bulletShape.bullet);\n        spottedBullets = true;\n      }\n    }\n\n    return spottedBullets;\n  }\n\n\n  scanWalls(tank) {\n    let distance = this._getWallDistance(tank);\n    if(distance < tank.radarRange) {\n      tank.onWallSpot(distance);\n      return true;\n    }\n    return false;\n  }\n\n  _getWallDistance(tank) {\n    let angle = tank.angle + tank.radarAngle;\n    while(angle > 180) angle -= 360;\n    while(angle < -180) angle += 360;\n\n    let distanceNorth = tank.y - this._battlefield.minY;\n    let distanceSouth = this._battlefield.maxY - tank.y;\n    let distanceWest = tank.x - this._battlefield.minX;\n    let distanceEast = this._battlefield.maxX - tank.x;\n\n    if(angle == -180 || angle == 180) { // W\n      return distanceWest;\n    } else if(angle == 0) { // E\n      return distanceEast;\n    } else if(angle == -90) { // N\n      return distanceNorth;\n    } else if(angle == 90) { // S\n      return  distanceSouth;\n    }\n\n    let d1, d2;\n\n    if(angle > -180 && angle < -90) { // NW\n      d1 = distanceWest / Math.cos((angle+180)*(Math.PI/180));\n      d2 = distanceNorth / Math.sin((angle+180)*(Math.PI/180));\n    } else if(angle > -90 && angle < 0) { // NE\n      d1 = distanceEast / Math.cos((-angle)*(Math.PI/180));\n      d2 = distanceNorth / Math.sin((-angle)*(Math.PI/180));\n    } else if(angle > 0 && angle < 90) { // SE\n      d1 = distanceEast / Math.cos((angle)*(Math.PI/180));\n      d2 = distanceSouth / Math.sin((angle)*(Math.PI/180));\n    } else { // SW\n      d1 = distanceWest / Math.cos((180-angle)*(Math.PI/180));\n      d2 = distanceSouth / Math.sin((180-angle)*(Math.PI/180));\n    }\n\n    return Math.min(d1, d2);\n  }\n\n  _getTankShape(tank) {\n    if(!this._tankMap[tank.id]) {\n      if(tank.energy == 0) {\n        throw \"Cannot create shape for destroyed tank\";\n      }\n      let shape = new SAT.Circle(new SAT.Vector(tank.x,tank.y), 18);\n      this._tankMap[tank.id] = shape;\n      shape.tank = tank;\n    }\n    return this._tankMap[tank.id];\n  }\n\n  _getBulletShape(bullet) {\n    if(!this._bulletMap[bullet.id]) {\n      if(bullet.exploded) {\n        throw \"Cannot create shape for exploded bullet\";\n      }\n      let shape = new SAT.Circle(new SAT.Vector(bullet.x,bullet.y), 3);\n      this._bulletMap[bullet.id] = shape;\n      shape.bullet = bullet;\n    }\n    return this._bulletMap[bullet.id];\n  }\n\n  _getRadarBeamShape(tank) {\n    if(!this._radarBeamMap[tank.id]) {\n      if(tank.energy == 0) {\n        throw \"Cannot create radar beam shape for destroyed tank\";\n      }\n      let width = tank.radarRange * Math.tan(tank.radarFocal*(Math.PI/180))/2;\n      let shape = new SAT.Polygon(new SAT.Vector(tank.x, tank.y), [\n        new SAT.Vector(0, 3),\n        new SAT.Vector(0, -3),\n        new SAT.Vector(tank.radarRange,-width),\n        new SAT.Vector(tank.radarRange,width)\n      ]);\n\n      this._radarBeamMap[tank.id] = shape;\n      shape.tank = tank;\n    }\n    return this._radarBeamMap[tank.id];\n  }\n\n}\n","'use strict';\n\nimport EvalWorker from './EvalWorker.js';\n\nexport default class AiWrapper {\n\n  constructor(tank, aiDefinition) {\n    if(!tank) throw \"Tank is required\";\n    if(!aiDefinition) throw \"AiDefinition is required\";\n    this._tank = tank;\n    this._aiWorker = null;\n    this._aiProcessingStart = 0;\n    this._aiProcessingCheckInterval = null;\n    this._aiProcessingResolveCallback = null;\n    this._aiProcessingRejectCallback = null;\n    this._slowAiChances = 10;\n    this._onActivationCallback = [];\n    this._onDectivationCallback = [];\n    this._aiProcessingTimeLimit = 3000;\n    this._aiDefinition = aiDefinition;\n    this._isReady = false;\n    this._controlData = {\n      THROTTLE: 0,\n      BOOST: 0,\n      TURN: 0,\n      RADAR_TURN: 0,\n      GUN_TURN: 0,\n      SHOOT: 0,\n      OUTBOX: [],\n      DEBUG: {}\n    };\n  }\n\n  setProcessingLimit(v) {\n    this._aiProcessingTimeLimit = v;\n  }\n\n  get tank() {\n    return this._tank;\n  }\n\n  get worker() {\n    return this._aiWorker;\n  }\n\n  onActivation(callback) {\n    this._onActivationCallback.push(callback);\n  }\n\n  onDectivation(callback) {\n    this._onDeactivationCallback.push(callback);\n  }\n\n  _formatError(err) {\n    if(!err.message) return 'unknown';\n    let msg = err.message;\n    if(err.lineno) {\n      msg = \"Line #\" + err.lineno + \": \" + msg;\n    }\n    return msg;\n  }\n\n  activate(seed, resolve, reject) {\n    if(typeof seed != 'number') throw \"seed must be a number, '\" + (typeof seed) + \"' given\";\n    if(typeof resolve != 'function') throw \"resolve callback must be a function, '\" + (typeof resolve) + \"' given\";\n    if(typeof reject != 'function') throw \"reject callback must be a function, '\" + (typeof reject) + \"' given\";\n    let self = this;\n    self._aiWorker = self._createWorker(this._aiDefinition);\n    self._aiWorker.onerror = (err) => {\n      console.error(err);\n      if(self._aiProcessingRejectCallback) {\n        self._aiProcessingRejectCallback({\n          message: \"Web Worker of '\" + self._tank.fullName + \"' returned an error: \" + self._formatError(err),\n          performanceIssues: false,\n          tankName: self._tank.name,\n          tankId: self._tank.id\n        });\n        self._aiProcessingResolveCallback = null;\n        self._aiProcessingRejectCallback = null;\n      }\n    };\n\n    if(self._aiProcessingCheckInterval) {\n      clearInterval(self._aiProcessingCheckInterval);\n      self._aiProcessingCheckInterval = null;\n    }\n\n    self._aiProcessingCheckInterval = setInterval(() => {\n      if(self._aiProcessingRejectCallback) {\n        let now = (new Date()).getTime();\n        let dt = now - self._aiProcessingStart;\n        if(dt > self._aiProcessingTimeLimit) {\n          clearInterval(self._aiProcessingCheckInterval);\n          self._aiProcessingCheckInterval = null;\n          self._aiProcessingRejectCallback({\n            message: \"Simulation cannot be continued because \" + self._tank.name + \" #\" + self._tank.id + \" does not respond\",\n            performanceIssues: true,\n            tankName: self._tank.name,\n            tankId: self._tank.id\n          });\n        }\n      }\n    }, Math.max(self._aiDefinition.executionLimit, Math.round(self._aiProcessingTimeLimit/2)));\n\n    self._aiWorker.onmessage = (commandEvent) => {\n      let value = commandEvent.data;\n      if(self._aiProcessingResolveCallback) {\n        if(value.type == 'init') {\n          self._configureTank(value.settings ? value.settings : {});\n          self._isReady = true;\n          for(let i=0; i < self._onActivationCallback.length; i++) self._onActivationCallback[i].bind(self)();\n        } else {\n          self._controlTank(value);\n        }\n\n        let callback;\n        let now = (new Date()).getTime();\n        let dt = now - self._aiProcessingStart;\n        if(dt > self._aiDefinition.executionLimit && value.type != 'init') {\n          self._slowAiChances--;\n          console.warn(\"Execution of AI for tank \" + self._tank.name + \" #\" + self._tank.id + \" takes too long (\" + dt + \"ms). If problem repeats, AI will be terminated.\");\n          if(self._slowAiChances <= 0) {\n            callback = self._aiProcessingRejectCallback;\n            self._aiProcessingResolveCallback = null;\n            self._aiProcessingRejectCallback = null;\n            callback({\n              message: \"Simulation cannot be continued because \" + self._tank.name + \" #\" + self._tank.id + \" has performance issues\",\n              performanceIssues: true,\n              tankName: self._tank.name,\n              tankId: self._tank.id\n            });\n            return;\n          }\n        }\n        callback = self._aiProcessingResolveCallback;\n        self._aiProcessingResolveCallback = null;\n        self._aiProcessingRejectCallback = null;\n        callback();\n      }\n\n    };\n\n    let teamInfo = null;\n    if(self._tank.team && self._tank.team.size > 1) {\n      teamInfo = {\n        name: self._tank.team.name,\n        mates: self._tank.team.members.map((t) => t.id),\n      };\n    } else {\n      teamInfo = {\n        name: self._tank.fullName,\n        mates: [self._tank.id],\n      };\n    }\n    let infoData = {\n      id: self._tank.id,\n      team: teamInfo\n    };\n    if(self._aiDefinition.initData) {\n      infoData.initData = self._aiDefinition.initData;\n    }\n    self._aiProcessingStart = (new Date()).getTime();\n    self._aiProcessingResolveCallback = resolve;\n    self._aiProcessingRejectCallback = reject;\n    self._aiWorker.postMessage({\n      command: 'init',\n      seed: seed + \":\" + self._tank.id,\n      settings: {\n        SKIN: 'zebra'\n      },\n      info: infoData,\n      code: self._aiDefinition.code\n    });\n  }\n\n  deactivate() {\n    if(this._aiWorker) {\n      this._aiWorker.terminate();\n      this._aiWorker = null;\n    }\n\n    if(this._aiProcessingCheckInterval) {\n      clearInterval(this._aiProcessingCheckInterval);\n      this._aiProcessingCheckInterval = null;\n    }\n    for(let i=0; i < this._onDectivationCallback.length; i++) this._onDectivationCallback[i].bind(this)();\n  }\n\n  simulationStep(resolve, reject) {\n    if(typeof resolve != 'function') throw \"resolve callback must be a function, '\" + (typeof resolve) + \"' given\";\n    if(typeof reject != 'function') throw \"reject callback must be a function, '\" + (typeof reject) + \"' given\";\n    if(!this._isReady) {\n      throw \"AI of \" + this._tank.fullName + \" not initliazed\";\n    }\n    let self = this;\n    if(self._aiWorker && self._tank.energy == 0) {\n      self._aiWorker.terminate();\n      self._aiWorker = null;\n      resolve();\n      return;\n    }\n\n    self._aiProcessingStart = (new Date()).getTime();\n    self._aiProcessingResolveCallback = resolve;\n    self._aiProcessingRejectCallback = reject;\n    self._aiWorker.postMessage({\n      command: 'update',\n      state: self._tank.state,\n      control: self._controlData\n    });\n\n  }\n\n  _configureTank(input) {\n    let settings = {};\n\n    let skinList = ['zebra', 'forest', 'black', 'tiger', 'desert', 'lava', 'ocean'];\n    if(skinList.indexOf(input.SKIN) != -1) {\n      settings.SKIN = input.SKIN;\n    }\n    this._tank.init(settings);\n  }\n\n  _controlTank(value) {\n    let self = this;\n    self._controlData.THROTTLE = Number(value.THROTTLE);\n    self._controlData.TURN = Number(value.TURN);\n    self._controlData.GUN_TURN = Number(value.GUN_TURN);\n    self._controlData.RADAR_TURN = Number(value.RADAR_TURN);\n    self._controlData.SHOOT = Number(value.SHOOT);\n    self._controlData.DEBUG = value.DEBUG;\n    self._controlData.BOOST = value.BOOST ? 1 : 0;\n\n    self._controlData.THROTTLE = isNaN(self._controlData.THROTTLE) ? 0 : self._controlData.THROTTLE;\n    self._controlData.TURN = isNaN(self._controlData.TURN) ? 0 : self._controlData.TURN;\n    self._controlData.GUN_TURN = isNaN(self._controlData.GUN_TURN) ? 0 : self._controlData.GUN_TURN;\n    self._controlData.RADAR_TURN = isNaN(self._controlData.RADAR_TURN) ? 0 : self._controlData.RADAR_TURN;\n    self._controlData.SHOOT = isNaN(self._controlData.SHOOT) ? 0 : self._controlData.SHOOT;\n\n    self._controlData.THROTTLE = Math.min(1, Math.max(-1, Number(self._controlData.THROTTLE)));\n    self._controlData.TURN = Math.min(1, Math.max(-1, Number(self._controlData.TURN)));\n    self._controlData.GUN_TURN = Math.min(1, Math.max(-1, Number(self._controlData.GUN_TURN)));\n    self._controlData.RADAR_TURN = Math.min(1, Math.max(-1, Number(self._controlData.RADAR_TURN)));\n    self._controlData.SHOOT = Math.min(1, Math.max(0, Number(self._controlData.SHOOT)));\n\n    self._tank.setThrottle(self._controlData.THROTTLE );\n    self._tank.setBoost(self._controlData.BOOST );\n    self._tank.setTurn(self._controlData.TURN);\n    self._tank.setRadarTurn(self._controlData.RADAR_TURN);\n    self._tank.setGunTurn(self._controlData.GUN_TURN );\n    self._tank.setDebugData(self._controlData.DEBUG);\n    if(self._controlData.SHOOT) {\n      self._tank.shoot(self._controlData.SHOOT);\n    }\n    self._controlData.SHOOT = 0;\n\n    let messages = [];\n    for(let i  in value.OUTBOX) {\n      messages.push(JSON.parse(JSON.stringify(value.OUTBOX[i])));\n    }\n\n    if(self._tank.team) {\n      self._tank.team.sendMessages(self._tank.id, messages);\n    }\n\n    self._controlData.OUTBOX = [];\n  }\n\n  _createWorker(def) {\n    if(def.useSandbox) {\n      return new Worker(def.filePath);\n    } else {\n      return new EvalWorker();\n    }\n  }\n}\n","'use strict';\n\nexport default class PerformanceMonitor {\n\n  constructor() {\n    this._simulationStepDuration = 30;\n    this._stepCounter=0;\n    this._checkLoop=0;\n    this._started=false;\n    this._desiredPerfomance = Math.floor(1000/this._simulationStepDuration);\n    this._actualPerfomance = this._desiredPerfomance;\n    this._perfomanceIndex = 1;\n    this._desiredQuality = 1;\n    this._quality = this._desiredQuality;\n    this._checkInterval = 500;\n  }\n\n  get started() {\n    return this._started;\n  }\n\n  get desiredPerfomance() {\n    return this._desiredPerfomance;\n  }\n\n  get actualPerfomance() {\n    return this._actualPerfomance;\n  }\n\n  start() {\n    this._started = true;\n    let self = this;\n    this._checkLoop = setInterval(() => {\n      self._check();\n    }, this._checkInterval);\n  }\n\n  stop() {\n    this._started = false;\n    if(this._checkLoop) {\n      clearInterval(this._checkLoop);\n      this._checkLoop = null;\n    }\n  }\n\n  setSimulationStepDuration(v) {\n    if(v != this._simulationStepDuration) {\n      this._quality = this._desiredQuality;\n    }\n    this._simulationStepDuration = v;\n    this._desiredPerfomance = Math.floor(1000/v);\n  }\n\n  onSimulationStep() {\n    if(this._started) {\n      this._stepCounter++;\n    }\n  }\n\n  get qualityLevel() {\n    return this._quality;\n  }\n\n  _check() {\n    this._actualPerfomance = Math.ceil(this._stepCounter*(1000/this._checkInterval));\n    this._stepCounter = 0;\n    let index = this._desiredPerfomance ? this._actualPerfomance/this._desiredPerfomance : 1;\n    this._perfomanceIndex = (this._perfomanceIndex + index)/2;\n    this._updateQuality();\n  }\n\n  _updateQuality() {\n    let lowestQuality = 2.5*this._perfomanceIndex - 1.25;\n    lowestQuality = Math.max(0, Math.min(1, lowestQuality));\n    let decreaseStep = -0.5*this._perfomanceIndex + 0.45;\n\n    if(this._perfomanceIndex > 1) {\n      this._desiredQuality += 0.1;\n    } else {\n      this._desiredQuality -= decreaseStep;\n    }\n\n    this._desiredQuality = Math.max(0, Math.min(1, this._desiredQuality));\n\n    let targetQuality = Math.max(lowestQuality, this._desiredQuality);\n\n    this._desiredQuality = (this._desiredQuality + targetQuality)/2;\n    if(this._desiredQuality < this._quality ) {\n      this._quality = this._desiredQuality;\n    } else {\n      this._quality = (this._desiredQuality + 9*this._quality)/10;\n    }\n  }\n}\n","'use strict';\n\nvar SUSSPEND_AI_SANDBOX_WARNING = false;\n\n/**\n * Describes AI algorithm of the tank. There could be two sources of AI scripts:\n * files or string variable. Depending on source of scripts `fromFile()` or `fromCode()`\n * methods should be used to initialize the object\n */\nclass AiDefinition {\n\n  /**\n   * Creates AiDefinition. Constructor is not available outside of\n   * `JsBattle.min.js` library. To create AiDefinition object use\n   * `JsBattle.createAiDefinition()` instead\n   */\n  constructor() {\n    let uid = (new Date()).getTime().toString();\n    uid = uid.substr(uid.length-6, 6) + \"\" + Math.round(10000000*Math.random());\n    uid = Number(uid);\n    uid = uid.toString(35);\n    this._name = \"\";\n    this._team = uid;\n    this._code = null;\n    this._initData = null;\n    this._useSandbox = true;\n    this._executionLimit = 100;\n  }\n\n  /**\n   * @return JSON representation of AiDefiniton\n   */\n  toJSON() {\n    return {\n      name: this._name,\n      team: this._team,\n      code: this._code,\n      initData: this._initData,\n      useSandbox: this._useSandbox,\n      executionLimit: this.executionLimit\n    };\n  }\n\n  /**\n   * @param {object} data - JSON data to be parsed\n   */\n  fromJSON(data) {\n    this._name = data.name;\n    this._team = data.team;\n    this._code = data.code ? data.code.replace(/importScripts\\w*\\([^\\)]*\\)/g, '') : data.code;\n    this._initData = data.initData;\n    this._useSandbox = data.useSandbox;\n    this._executionLimit = data.executionLimit;\n  }\n\n  /**\n   * @return copy of the object\n   */\n  clone() {\n    let result = new AiDefinition();\n    result.fromJSON(this.toJSON());\n    return result;\n  }\n\n  /**\n   * @return name of the AI. The same name will be assigned to the tank\n   */\n  get name() {\n    return this._name;\n  }\n\n  /**\n   * @return name of the team\n   */\n  get teamName() {\n    return this._team;\n  }\n\n  /**\n   * @return Maximum time for execution of AI script (in milliseconds)\n   */\n  get executionLimit() {\n    return this._executionLimit;\n  }\n\n  /**\n   * @param {Number} limit -  Maximum time for execution of AI script (in milliseconds)\n   */\n  set executionLimit(v) {\n    this._executionLimit = v;\n  }\n\n  /**\n   * @return path to file with code of Web Worker where the AI will be ran.\n   */\n  get filePath() {\n    if(!this._useSandbox) return null;\n    if(this._code !== null) {\n      return \"tanks/lib/codeWorker.js\";\n    } else {\n      return `tanks/${this._name}.tank.js`;\n    }\n  }\n\n  /**\n   * @return source code of AI algorithm as a string. This property is not empty only for AIs created by `fromCode()` call\n   * @see AiDefinition.fromCode()\n   */\n  get code() {\n    return this._code;\n  }\n\n  /**\n   * @return optional initial data that is passed to the AI and can be accessed from tank info object (`info.initData`)\n   */\n  get initData() {\n    return this._initData;\n  }\n\n  /**\n   * @return true if AI should be sandboxed. Otherwise false. By default, all AIs are sandboxed.\n   */\n  get useSandbox() {\n    return this._useSandbox;\n  }\n\n  /**\n   * Creates AI definition that has source codes in a file. All AI scripts\n   * are kept in `/tanks/[tankName].tank.js` files\n   * @param {String} tankName - name of the tank. Its source code is kept in `/tanks/[tankName].tank.js`\n   * @param {object} initData - optional initial data that is passed to the AI and can be accessed from tank info object (`info.initData`)\n   */\n  fromFile(tankName, initData) {\n    if(!tankName) throw new Error(\"tankName is required\");\n    this._name = tankName;\n    this._code = null;\n    this._initData = initData !== undefined ? initData : null;\n  }\n\n  /**\n   * Creates AI definition that has the algorithm codded in provided in string parameter.\n   * @param {String} tankName - name of the tank.\n   * @param {String} code - JavaScript code of AI script.\n   * @param {object} initData - optional initial data that is passed to the AI and can be accessed from tank info object (`info.initData`)\n   */\n  fromCode(tankName, code, initData) {\n    if(!tankName) throw new Error(\"tankName is required\");\n    if(!code) throw new Error(\"Code is required\");\n    if(typeof(tankName) != 'string') throw new Error(\"tankName must be a string\");\n    if(typeof(code) != 'string') throw new Error(\"code must be a string\");\n    code = code.replace(/importScripts\\w*\\([^\\)]*\\)/g, '');\n    this._name = tankName;\n    this._code = code;\n    this._initData = initData !== undefined ? initData : null;\n  }\n\n  /**\n   * Set name of the team. Tanks from the same team can coomunicate with eachother and cooperate\n   * @param {string} name - unique name of the team\n   */\n  assignToTeam(teamName) {\n    this._team = teamName;\n  }\n\n  /**\n   * Allows to running code of AI in the same sandbox as the core of JsBattle game. It is\n   * potentially dangerous since code of AI Script can access code of JS Battle and\n   * influence it. However disabling sandbox can significantly increase performance\n   * (especially if you run several simulations in concurrent). Use this approach\n   * only for trusted AI code.\n   */\n  disableSandbox() {\n    if(this._code === null) {\n      throw new Error(\"Sandbox can be disabled for AI created from code only (AI name: '\" + this._name + \"')\");\n    }\n    if(!SUSSPEND_AI_SANDBOX_WARNING) {\n      console.warn(\"Disabling sandbox for AI! It could be dangerous.\");\n      SUSSPEND_AI_SANDBOX_WARNING = true;\n    }\n    this._useSandbox = false;\n  }\n\n}\n\nexport default AiDefinition;\n","'use strict';\n\nimport AiDefinition from \"./AiDefinition.js\";\nimport Ajv from 'ajv';\nimport schema from '../schema/ubd-schema-v4.json';\n\nclass UltimateBattleDescriptor {\n\n  constructor() {\n    this._version = 4;\n    this._aiList = [];\n    this._rngSeed = (new Date()).getTime();\n    this._teamMode = false;\n    this._timeLimit = 0;\n  }\n\n  addAiDefinition(ai) {\n    this._aiList.push(ai);\n  }\n\n  setTeamMode(v) {\n    this._teamMode = v;\n  }\n\n  getTeamMode() {\n    return this._teamMode;\n  }\n\n  setRngSeed(seed) {\n    this._rngSeed = seed;\n  }\n\n  getVersion() {\n    return this._version;\n  }\n\n  getAiList() {\n    return this._aiList;\n  }\n\n  setTimeLimit(limit) {\n    this._timeLimit = limit;\n  }\n\n  getTimeLimit() {\n    return this._timeLimit;\n  }\n\n  getRngSeed() {\n    return this._rngSeed;\n  }\n\n  encode() {\n    let json = {\n      version: this._version,\n      rngSeed: this._rngSeed,\n      teamMode: this._teamMode,\n      timeLimit: this._timeLimit,\n      aiList: []\n    };\n    let count;\n    for(let ai of this._aiList) {\n      count = ai.count || 1;\n      for(let i=0; i< count; i++) {\n        json.aiList.push(ai.toJSON());\n      }\n    }\n    let raw = JSON.stringify(json);\n    return raw;\n  }\n\n  decode(data, unsecureMode) {\n    let json;\n    try {\n      json = JSON.parse(data);\n    } catch(err) {\n        throw new Error(`Cannot parse UBD file! ${err}`);\n    }\n    if(this._version !=json.version) {\n      throw new Error(`Version of UBD does not match. Version ${json.version} is not supported. Please convert to version ${this._version}`);\n    }\n    this.validateJsonData(json);\n    this._rngSeed = json.rngSeed;\n    this._teamMode = json.teamMode;\n    this._timeLimit = json.timeLimit;\n\n    let ai;\n    for(let aiJson of json.aiList) {\n      ai = new AiDefinition();\n      if(!unsecureMode) {\n        aiJson.useSandbox = true;\n        aiJson.executionLimit = 100;\n        aiJson.initData = null;\n      }\n      ai.fromJSON(aiJson);\n      this._aiList.push(ai);\n    }\n  }\n\n  validateJsonData(json) {\n    var ajv = new Ajv();\n    var validate = ajv.compile(schema);\n    var valid = validate(json);\n    if (!valid) {\n      throw new Error(\"UBD validation failed - \" + validate.errors[0].message);\n    }\n  }\n\n  clone() {\n    let result = new UltimateBattleDescriptor();\n    result.setRngSeed(this.getRngSeed());\n    result.setTeamMode(this.getTeamMode());\n    result.setTimeLimit(this.getTimeLimit());\n    let aiList = this.getAiList();\n    let aiClone;\n    for(let ai of aiList) {\n      aiClone = ai.clone();\n      result.addAiDefinition(aiClone);\n    }\n    return result;\n  }\n\n}\n\nexport default UltimateBattleDescriptor;\n","'use strict';\n\nfunction finishCondition(simulaiton) {\n  let teamsLeft = 0;\n  for(let i in simulaiton._teamMap) {\n    if(!simulaiton._teamMap[i].isAlive) continue;\n    teamsLeft++;\n  }\n  return (teamsLeft <= 1);\n}\n\nexport default finishCondition;\n","'use strict';\n\nimport Tank from \"./Tank.js\";\nimport Team from \"./Team.js\";\nimport Bullet from \"./Bullet.js\";\nimport Battlefield from \"./Battlefield.js\";\nimport EventStore from \"./EventStore.js\";\nimport CollisionResolver from \"./CollisionResolver.js\";\nimport AiWrapper from \"./AiWrapper.js\";\nimport PerformanceMonitor from \"./PerformanceMonitor.js\";\nimport UltimateBattleDescriptor from \"./UltimateBattleDescriptor.js\";\nimport seedrandom from \"seedrandom\";\nimport finishCondition from \"./finishCondition.js\";\n\n/**\n * Battle simulation component. Process the simulation updating all related objects\n * and refreshing the renderer.\n */\nclass Simulation {\n  /**\n   * Create Simulation object. Constructor is not available outside of\n   * `JsBattle.min.js` library. To create Simulation object use\n   * `JsBattle.createSimulation(renderer)` instead\n   * @param {Renderer} renderer - Renderer used to present results of the simulation\n   * @param {Boolean} debug - turn on logging on the console\n   */\n  constructor(renderer, debug) {\n    this._debug = debug;\n    this._aiList = [];\n    this._allTankList = [];\n    this._tankList = [];\n    this._bulletList = [];\n    this._explodedTankList = [];\n    this._explodedBulletList = [];\n    this._battlefield = null;\n    this._simulationTimeout = null;\n    this._renderInterval = null;\n    this._simulationStepDuration = 17;\n    this._renderStepDuration = 30;\n    this._renderer = renderer;\n    this._isRunning = false;\n    this._collisionResolver = new CollisionResolver();\n    this._rngSeed = (new Date()).getTime() + Math.round(Math.random()*1000000);\n    this._rng = seedrandom(this._rngSeed);\n    this._speedMultiplier = 1;\n    this._onSimulationStepCallback = [];\n    this._onRenderStepCallback = [];\n    this._onFinishCallback = [];\n    this._onErrorCallback = [];\n    this._onStartCallback = [];\n    this._timeElapsed = 0;\n    this._timeLimit = 30000;\n    this._finishCondition = finishCondition;\n    this._customFinishCondition = false;\n    this._eventStore = new EventStore();\n    this._nextTankId = 1;\n    this._nextBulletId = 1;\n    this._rendererQuality = 'auto';\n    this._perfMon = new PerformanceMonitor();\n    this._perfMon.setSimulationStepDuration(this._simulationStepDuration/this._speedMultiplier);\n    this._callStackLimit = Number.MAX_VALUE;\n    this._callStackCount = 0;\n    this._teamMap = [];\n    this._teamList = [];\n    this._ultimateBattleDescriptor = new UltimateBattleDescriptor();\n    this.log('Contructing Simulation');\n  }\n\n  /**\n    * Seed random number generator. Each time when you seed rng with the same data\n    * it will return the same sequence of numbers. That feature can be used\n    * to reconstruct exactly the same, \"randomized\" simulation condidtions.\n    *\n    * IMPORTANT! set it just after calling constructor of the calss. Otherwise\n    * some RNG calls could be unseeded.\n    *\n    * @param {Number} seed - rng seed data\n    */\n  setRngSeed(seed) {\n    this.log(`Set renderer RNG Seed to '${seed}'`);\n    this._rngSeed = seed;\n    this._ultimateBattleDescriptor.setRngSeed(seed);\n    this._rng = seedrandom(this._rngSeed);\n  }\n\n  /**\n   * @return seed of random number generator\n   */\n  getRngSeed() {\n    return this._rngSeed;\n  }\n\n  /**\n   * @return random number from seeded rng\n   */\n  getRandom() {\n    return this._rng();\n  }\n\n  /**\n   * log message if logging is enabled\n   * @param {string} msg - message to log\n   */\n  log(msg) {\n    if(this._debug) {\n      console.log('[SIM] ' + msg);\n    }\n  }\n\n  /**\n   * set custom condition of battle finish. Once provided callbacl return true, the simulation will be over\n   * @param {Function} callback - callback determining end of the battle. It takes one argument (simulation object) and return true (stop simulation) or false (continue simulation)\n   */\n  setFinishCondition(callback) {\n    this.log(`Setting custom finish conditioins`);\n    this._customFinishCondition = true;\n    this._finishCondition = callback;\n  }\n\n  /**\n   * Initialize the battle field. Must be called before any other calls\n   * to simulation object\n   * @param {Number} width - width of the battlefield\n   * @param {Number} height - height of the battlefield\n   */\n  init(width, height) {\n    this.log(`Initialize the battlefield (width=${width}, height=${height})`);\n    this._battlefield = new Battlefield();\n    this._battlefield.setSize(width, height);\n    this._battlefield.randomize(this._rng());\n    this._renderer.initBatlefield(this._battlefield);\n    this._collisionResolver.updateBattlefield(this._battlefield);\n    this.log(`The battlefiield initialized. Done.`);\n  }\n\n  /**\n   * @return all tanks that were added to the battle\n   */\n  get tankList() {\n    return this._allTankList;\n  }\n\n  /**\n   * @return list of teams\n   */\n  get teamList() {\n    return this._teamList;\n  }\n\n  /**\n   * @return renderer attached to the simulation\n   */\n  get renderer() {\n    return this._renderer;\n  }\n\n  get battlefield() {\n    return this._battlefield;\n  }\n\n  /**\n   * @return amount of time that has elapsed from the beginning of the battle (in milliseconds)\n   */\n  get timeElapsed() {\n    return this._timeElapsed;\n  }\n\n  /**\n   * @return maximum duration of the battle (in milliseconds). The battle will be over after that time.\n   */\n  get timeLimit() {\n    return this._timeLimit;\n  }\n\n  set timeLimit(v) {\n    this.log(`Set time limit to '${v}'`);\n    this._ultimateBattleDescriptor.setTimeLimit(v);\n    this._timeLimit = v;\n  }\n\n  /**\n   * Starts simulation of the battle. It will initialize all AI scripts, trigger `onStart` event\n   * and launch rendering and simulation processing loops. Remember to call `Simulation.init()` and\n   * `Simulation.addTank()` before executing this method.\n   * @see Simulation.onStart()\n   */\n  start() {\n    this.log(`Starting the simulation`);\n    if(this._tankList.length == 0) {\n      throw new Error(\"To start simulation, the tank list cannot be empty!\");\n    }\n    this._isRunning = true;\n    let i;\n    let self = this;\n\n    if(this._renderInterval) {\n      this.log(`Clearing existing render interval`);\n      clearInterval(this._renderInterval);\n      this._renderInterval = null;\n    }\n\n    this.log(`Activating AIs...`);\n    this._activateAi(\n      () => {\n        self._renderInterval = setInterval(() => {\n          self._updateView();\n        }, self._renderStepDuration);\n\n        if(self._simulationTimeout) {\n          clearTimeout(self._simulationTimeout);\n        }\n        self._perfMon.start();\n        self.log(`Notify onStartCallback`);\n        for(i=0; i < self._onStartCallback.length; i++) self._onStartCallback[i]();\n        self.log(`Run first simulation step`);\n        self._simulationStep();\n      },\n      (err) => {\n        console.error(err);\n        for(i=0; i < self._onErrorCallback.length; i++) self._onErrorCallback[i](err.message ? err.message : \"Error during simulation\");\n      }\n    );\n  }\n\n  _simulationStep() {\n    this._perfMon.onSimulationStep();\n    let startTime = (new Date()).getTime();\n    let self = this;\n    let i;\n    this._updateModel();\n    this._updateAi(\n      () => {\n        if(self._simulationTimeout) {\n          clearTimeout(self._simulationTimeout);\n          self._simulationTimeout = null;\n        }\n        if((self._timeLimit > 0 && self._timeElapsed == self._timeLimit) || self._finishCondition(self)) {\n          self.stop();\n          self._updateModel();\n          self._updateView();\n          for(i=0; i < self._onFinishCallback.length; i++) self._onFinishCallback[i]();\n        }\n        if(self._isRunning) {\n          let processingTime = (new Date()).getTime() - startTime;\n          let dt = self._simulationStepDuration/self._speedMultiplier - processingTime;\n          dt = Math.round(dt);\n          for(i=0; i < self._onSimulationStepCallback.length; i++) self._onSimulationStepCallback[i]();\n          self._timeElapsed += self._simulationStepDuration;\n          if(self._timeLimit > 0) {\n            self._timeElapsed = Math.min(self._timeElapsed, self._timeLimit);\n          }\n          if(dt > 0) {\n            self._callStackCount=0;\n            self._simulationTimeout = setTimeout(self._simulationStep.bind(self), dt);\n          } else if(self._callStackCount >= self._callStackLimit) {\n            self._simulationTimeout = setTimeout(self._simulationStep.bind(self), 1);\n          } else {\n            self._callStackCount++;\n            self._simulationStep();\n          }\n        }\n      },\n      (err) => {\n        console.error(err);\n        for(i=0; i < self._onErrorCallback.length; i++) self._onErrorCallback[i](err.message ? err.message : \"Error during simulation\");\n      }\n    );\n  }\n\n  /**\n   * Create a tank according to provided `AiDefinition`. Remember to add at\n   * least two tanks to the battle. Otherwise, it will stop immediately and\n   * the winner will be recognized\n   * @param {AiDefinition} - defintion of tank AI script\n   */\n  addTank(aiDefinition) {\n    this.log(`Adding tank...`);\n    if(typeof aiDefinition != 'object') {\n      throw \"AI definition must be an object\";\n    }\n    if(!this._battlefield) {\n      throw \"Simulation not initialized\";\n    }\n    if(!aiDefinition.teamName) {\n      throw \"Team name cannot be empty!\";\n    }\n    let startSlot = this._battlefield.getStartSlot();\n    if(!startSlot) {\n      throw \"No free space in the battlefield\";\n    }\n    this._ultimateBattleDescriptor.addAiDefinition(aiDefinition);\n    this._ultimateBattleDescriptor.setTeamMode(this.hasTeams());\n    let tank = this._createTank(aiDefinition);\n    tank.randomize(this.getRandom());\n    tank.moveTo(startSlot.x, startSlot.y);\n    this._tankList.push(tank);\n    this._allTankList.push(tank);\n    if(this._timeLimit > 0 && this._allTankList.length > 2) {\n      this._timeLimit += 2000;\n    }\n\n    if(!this._teamMap[aiDefinition.teamName]) {\n      this._teamMap[aiDefinition.teamName] = new Team(aiDefinition.teamName);\n      this._teamList.push(this._teamMap[aiDefinition.teamName]);\n    }\n    this._teamMap[aiDefinition.teamName].addTank(tank);\n\n    let ai = this._createAiWrapper(tank, aiDefinition);\n    this._aiList.push(ai);\n\n    return ai;\n  }\n\n  /**\n   * Set speed multiplier of the simulation. Setting to `2`means that everything will be\n   * two times faster than usual. Setting to `0.5` will simulate the battle 2 times slower\n   * than usual\n   * @param {Number} multiplier - simulation speed multiplier\n   */\n  setSpeed(v) {\n    this.log(`Set speed to '${v}'`);\n    this._speedMultiplier = Math.max(0.01, Number(v));\n    this._perfMon.setSimulationStepDuration(this._simulationStepDuration/this._speedMultiplier);\n    this._renderer.setSpeed(v);\n  }\n\n  /**\n   * Sets quality of renderer controlled by simulation object.\n   * You can specify a value between 0 (lowest quality) and 1 (highest quality)\n   * or allow the simulation to adjust it automatically by passing 'auto' string\n   * Automatic quality adjustment try to keep the speed of the animation at proper level.\n   * If simulation is lagging, quality will be reduced to ensure that the simulation\n   * does not take longer than it should\n   * @param {Number|String} qualityLevel - number between 0 and 1 or 'auto' string\n   */\n  setRendererQuality(v) {\n    this.log(`Set rederer quality to '${v}'`);\n    if(isNaN(v) && v != 'auto') return;\n    if(!isNaN(v)) {\n      v = Math.min(1, Math.max(0, v));\n    }\n    this._rendererQuality = v;\n  }\n\n  /**\n   * Stops battle simulation. It also stops rendering loop.\n   * After calling this method you should not try to call\n   * start to resume the battle but rather create a new\n   * Simulation object and initialize it from the beginning\n   */\n  stop() {\n    this.log(`stopping the simulation`);\n    this._isRunning = false;\n    this._perfMon.stop();\n    this._renderer.stop();\n    if(this._simulationTimeout) {\n      clearTimeout(this._simulationTimeout);\n      this._simulationTimeout = null;\n    }\n    if(this._renderInterval) {\n      clearInterval(this._renderInterval);\n      this._renderInterval = null;\n    }\n    let ai, i;\n    for(i=0; i < this._aiList.length; i++) {\n      ai = this._aiList[i];\n      if(!ai) continue;\n      ai.deactivate();\n    }\n    this._aiList = [];\n  }\n\n\n  /**\n   * Allow adding a callback that will be called after each step of simulation\n   * processing loop. The callback takes no arguments. The frequency of this event\n   * depends on simulation speed.\n   * @param {Function} callback - callback that will be called on each event occurence.\n   * @see `Simulation.setSpeed()`\n   */\n  onStep(callback) {\n    this._onSimulationStepCallback.push(callback);\n  }\n\n  /**\n   * Allow adding a callback that will be called after each refresh of the renderer.\n   * The callback takes no arguments. `onRender` and `onStep` event are not synchronized\n   * and may be called at different intervals. Increasing of animation speed will not\n   * increase rendering frequency. Rendering frequency is affected by quality of\n   * rendering parameter\n   * @param {Function} callback - callback that will be called on each event occurence.\n   * @see `Simulation.setSpeed()`\n   * @see `Simulation.setRendererQuality()`\n   */\n  onRender(callback) {\n    this._onRenderStepCallback.push(callback);\n  }\n\n  /**\n   * Allow adding a callback that will be called when the battle is started.\n   * It is executed after initialization of all AI Scripts, just before\n   * first step of simulation processing loop. The callback takes no arguments.\n   * @param {Function} callback - callback that will be called on each event occurence.\n   */\n  onStart(callback) {\n    this._onStartCallback.push(callback);\n  }\n\n  /**\n   * Allow adding a callback that will be called when the battle is over.\n   * The callback takes no arguments.\n   * @param {Function} callback - callback that will be called on each event occurence.\n   */\n  onFinish(callback) {\n    this._onFinishCallback.push(callback);\n  }\n\n  /**\n   * Allow adding a callback that will be called when an error occur.\n   * The callback takes one arguments: error message\n   * @param {Function} callback - callback that will be called on each event occurence.\n   */\n  onError(callback) {\n    this._onErrorCallback.push(callback);\n  }\n\n  /**\n   * Create Ultimate Battle Descriptor that contains all data requied to replay\n   * the battle and reflect its exact course.\n   * @return UltimateBattleDescriptor object\n   */\n  createUltimateBattleDescriptor() {\n    if(this._customFinishCondition) {\n      throw new Error('Cannot create UBD for battles with custom battle finish condition!');\n    }\n    return this._ultimateBattleDescriptor.clone();\n  }\n\n  /**\n   * @return true if at least two tanks are cooperating within one team\n   */\n  hasTeams() {\n    return this._teamList.length != this._tankList.length;\n  }\n\n  _activateAi(done, error) {\n    this._runInSequence(this._aiList, 'activate', this._rng(), done, error);\n  }\n\n  _updateAi(done, error) {\n    this._runInSequence(this._aiList, 'simulationStep', null, done, error);\n  }\n\n  _runInSequence(objectList, methodName, argument, done, error) {\n    if(objectList.length == 0) {\n      return done();\n    }\n    function wrapCallback() {\n      let args = [];\n      let callback = arguments[1];\n      let self = arguments[0];\n      for(let i=2; i < arguments.length; i++) {\n        args.push(arguments[i]);\n      }\n      return (args2) => {\n        callback.apply(self, args.concat(args2));\n      };\n    }\n\n    let self = null;\n    let doneWrapper = wrapCallback(self, done);\n    let errorWrapper = wrapCallback(self, error);\n\n    let c;\n    if(argument) {\n      c = wrapCallback(objectList[objectList.length-1], objectList[objectList.length-1][methodName], argument, doneWrapper, errorWrapper);\n    } else {\n      c = wrapCallback(objectList[objectList.length-1], objectList[objectList.length-1][methodName], doneWrapper, errorWrapper);\n    }\n    for(let i=objectList.length-2; i >=0; i--) {\n      if(argument) {\n        c = wrapCallback(objectList[i], objectList[i][methodName], argument, c, errorWrapper);\n      } else {\n        c = wrapCallback(objectList[i], objectList[i][methodName], c, errorWrapper);\n      }\n    }\n    c();\n  }\n\n  _updateModel() {\n    let i, tank, bullet, ai;\n\n    for(i=0; i < this._tankList.length; i++) {\n      tank = this._tankList[i];\n      if(!tank) continue;\n      tank.simulationStep(this._collisionResolver);\n    }\n\n    let killCount = 0;\n    for(i=0; i < this._tankList.length; i++) {\n      tank = this._tankList[i];\n      if(!tank) continue;\n      if(tank.energy <= 0) {\n        killCount++;\n        this._tankList[i] = null;\n        this._explodedTankList.push(tank);\n        this._collisionResolver.removeTank(tank);\n        this._eventStore.add(\"tank_\" + tank.id, {\n          type: \"destroy\",\n          tank: tank\n        });\n      }\n    }\n    let newAiList = [];\n    for(i=0; i < this._aiList.length; i++) {\n      ai = this._aiList[i];\n      if(!ai) continue;\n      if(ai.tank.energy <= 0) {\n        this._aiList[i] = null;\n        ai.deactivate();\n        continue;\n      }\n      newAiList.push(ai);\n    }\n    this._aiList = newAiList;\n\n    for(i=0; i < this._tankList.length; i++) {\n      tank = this._tankList[i];\n      if(!tank) continue;\n      if(tank.isShooting) {\n        let power = tank.handleShoot();\n        bullet = this._createBullet(tank, power);\n        this._bulletList.push(bullet);\n        this._eventStore.add(\"tank_\" + tank.id, {\n          type: \"shoot\",\n          tank: tank,\n          bullet: bullet\n        });\n      }\n    }\n    for(i=0; i < this._tankList.length; i++) {\n      tank = this._tankList[i];\n      if(!tank) continue;\n      for(let j=0; j < killCount; j++) {\n        tank.onSurviveScore();\n      }\n    }\n    let hitTest;\n    for(i=0; i < this._bulletList.length; i++) {\n      bullet = this._bulletList[i];\n      if(!bullet) continue;\n      bullet.simulationStep();\n      hitTest = this._collisionResolver.hitTestBullet(bullet);\n      if(hitTest) {\n        this._bulletList[i] = null;\n        this._explodedBulletList.push(bullet);\n        this._collisionResolver.removeBullet(bullet);\n        this._eventStore.add(\"bullet_\" + bullet.id, {\n          type: \"explode\",\n          bullet: bullet\n        });\n      }\n    }\n    for(i in this._teamMap) {\n      this._teamMap[i].processMessages();\n    }\n  }\n\n  _updateView() {\n    if(this._rendererQuality == 'auto') {\n      this._renderer.quality = this._perfMon.qualityLevel;\n    } else {\n      this._renderer.quality = this._rendererQuality;\n    }\n    let i, tank, bullet;\n    this._renderer.preRender();\n    this._renderer.renderClock(this._timeElapsed, this._timeLimit);\n    for(i=0; i < this._tankList.length; i++) {\n      tank = this._tankList[i];\n      if(!tank) continue;\n      this._renderer.renderTank(tank, this._eventStore.get(\"tank_\" + tank.id));\n    }\n    for(i=0; i < this._bulletList.length; i++) {\n      bullet = this._bulletList[i];\n      if(!bullet) continue;\n      this._renderer.renderBullet(bullet, this._eventStore.get(\"bullet_\" + bullet.id));\n    }\n    while(this._explodedTankList.length) {\n      tank = this._explodedTankList.pop();\n      this._renderer.renderTank(tank, this._eventStore.get(\"tank_\" + tank.id));\n    }\n    while(this._explodedBulletList.length) {\n      bullet = this._explodedBulletList.pop();\n      this._renderer.renderBullet(bullet, this._eventStore.get(\"bullet_\" + bullet.id));\n    }\n    this._renderer.renderTankStats(this._allTankList);\n    this._renderer.postRender();\n    for(i=0; i < this._onRenderStepCallback.length; i++) this._onRenderStepCallback[i]();\n    this._eventStore.clear();\n  }\n\n  _createAiWrapper(tank, aiDefinition) {\n    return new AiWrapper(tank, aiDefinition);\n  }\n\n  _createTank(aiDefinition) {\n    let tank = new Tank(aiDefinition, this._nextTankId++);\n    return tank;\n  }\n\n  _createBullet(owner, power) {\n    let bullet = new Bullet(owner, this._nextBulletId++, power);\n    return bullet;\n  }\n\n}\nexport default Simulation;\n","'use strict';\n/**\n * Renders simulation of the battle. The object must be passed to\n * constructor of Simulation object\n * @see Simulation\n */\nclass Renderer {\n\n  constructor() {\n\n  }\n\n  /**\n   * Renders the battlefield. Called only at the beginning. Used usually to render\n   * background of the Simulation\n   * @param {Battlefield} - battlefield object\n   */\n  initBatlefield(battlefield) {\n\n  }\n\n  /**\n   * @return value from 0 to 1 that represents the current quality of the renderer. This parameter is controlled by Simulation object\n   * @see Simulation.setRendererQuality()\n   */\n  get quality() {\n    return 1;\n  }\n\n  set quality(v) {\n\n  }\n\n  /**\n   * Called before rendering of each frame\n   */\n  preRender() {\n\n  }\n\n  /**\n   * Called after rendering of each frame\n   */\n  postRender() {\n\n  }\n\n  /**\n   * Render a tank\n   * @param {Tank} tank - a tank to be rendered\n   * @param {Array} events - list of events related to the tank that occurred since the last call of this method\n   */\n  renderTank(tank, events) {\n\n  }\n\n  /**\n   * Renders clock of the battle\n   * @param {Number} msElapsed - time that has elapsed (in milliseconds)\n   * @param {Number} msLimit - maximum battle duration (in milliseconds)\n   */\n  renderClock(msElapsed, msLimit) {\n\n  }\n\n  /**\n   * Renders statistics of all tanks. Called once per frame\n   * @param {Array} tankList - list of all tanks that are involved in the battle\n   */\n  renderTankStats(tankList) {\n\n  }\n\n  /**\n   * Render a bullet\n   * @param {Bullet} bullet - a bullet to be rendered\n   * @param {Array} events - list of events related to the bullet that occurred since the last call of this method\n   */\n  renderBullet(bullet, events) {\n\n  }\n  /**\n   * Sets speed of the simulation. Could be used to time-scale animations so they match simulation speed\n   * @pram {Number} multiplier - simulation speed multiplier\n   */\n  setSpeed(v) {\n\n  }\n\n  /**\n   * Stops renderinf loop of the battle. After this call, renderinig cannot be resumed.\n   */\n  stop() {\n\n  }\n\n  /**\n   * Clean up and remove all resources used by renderer\n   */\n  dispose() {\n\n  }\n}\nexport default Renderer;\n","const __WEBPACK_NAMESPACE_OBJECT__ = PIXI;","'use strict';\n\nexport default class AbstractView  {\n\n  constructor(model) {\n    this._model = model;\n    this._view = null;\n    this._isAlive = true;\n  }\n\n  get isAlive() {\n    return this._isAlive;\n  }\n\n  destroy() {\n    this._isAlive = false;\n  }\n\n  get model () {\n    return this._model;\n  }\n\n  get view () {\n    return this._view;\n  }\n\n  update(events) {\n\n  }\n\n}\n","'use strict';\n\nimport Renderer from \"../Renderer.js\";\nimport AbstractView from \"./AbstractView.js\";\n\nexport default class AbstractRenderer extends Renderer  {\n\n  constructor(debug) {\n    super();\n    this._debug = debug;\n    this._tankMap = [];\n    this._bulletMap = [];\n    this._offsetX = 0;\n    this._offsetY = 0;\n    this._speedMultiplier = 1;\n  }\n\n  log(msg) {\n    if(this._debug) {\n      console.log('[RENDERER] ' + msg);\n    }\n  }\n\n  get offsetX() {\n    return this._offsetX;\n  }\n\n  get offsetY() {\n    return this._offsetY;\n  }\n\n  get speedMultiplier () {\n    return this._speedMultiplier;\n  }\n\n  initBatlefield(battlefield) {\n    this._offsetX = battlefield.offsetX;\n    this._offsetY = battlefield.offsetY;\n  }\n\n  renderTank(tank, events) {\n    this._renderModel(tank, events, this._tankMap, this._createTankView);\n  }\n\n  renderBullet(bullet, events) {\n    this._renderModel(bullet, events, this._bulletMap, this._createBulletView);\n  }\n\n  getBulletView(id) {\n    return this._bulletMap[id];\n  }\n\n  getTankView(id) {\n    return this._tankMap[id];\n  }\n\n  setSpeed(v) {\n    this._speedMultiplier = v;\n  }\n\n  _renderModel(model, events, map, factory) {\n    let view = null;\n    if(map[model.id]) {\n      view = map[model.id];\n    } else {\n      view = factory(model);\n      map[model.id] = view;\n    }\n    view.update(events);\n    return view;\n  }\n\n  _createTankView(tank) {\n    return new AbstractView(tank);\n  }\n\n  _createBulletView(bullet) {\n    return new AbstractView(bullet);\n  }\n\n  dispose() {\n\n  }\n}\n","'use strict';\nimport { Container } from 'pixi.js';\nimport AbstractView from \"../abstract/AbstractView.js\";\n\nexport default class AbstractPixiView extends AbstractView {\n\n  constructor(model) {\n    super(model);\n    this._model = model;\n    this._view = new Container();\n    this._create(this._view);\n  }\n\n  update(events) {\n    super.update(events);\n    if(this._model.x !== undefined) {\n      this._view.x = this._model.x;\n    }\n    if(this._model.y !== undefined) {\n      this._view.y = this._model.y;\n    }\n    if(this._model.angle !== undefined) {\n      this._view.rotation = this._model.angle * (Math.PI / 180);\n    }\n  }\n\n  destroy() {\n    super.destroy();\n    if(this.view.parent) {\n      this.view.parent.removeChild(this.view);\n    }\n  }\n\n  _create(container) {\n\n  }\n\n}\n","'use strict';\nimport { Container } from 'pixi.js';\nimport { Sprite } from 'pixi.js';\nimport { Text } from 'pixi.js';\nimport AbstractPixiView from \"./AbstractPixiView.js\";\n\nexport default class AbstractPixiTankView extends AbstractPixiView {\n\n  constructor(model) {\n    super(model);\n    this._hudView = new Container();\n    this._createHud(this._hudView);\n  }\n\n  get body() {\n    return this._body;\n  }\n\n  get hudView() {\n    return this._hudView;\n  }\n\n  get gun() {\n    return this._gun;\n  }\n\n  get radar() {\n    return this._radar;\n  }\n\n  get label() {\n    return this._label;\n  }\n\n  get energyBar() {\n    return this._energyBar;\n  }\n\n  update(events) {\n    super.update(events);\n    this.view.rotation = 0;\n    this.body.rotation = this.model.angle * (Math.PI/180);\n    this.gun.rotation = (this.model.angle + this.model.gunAngle) * (Math.PI/180);\n    this.radar.rotation = (this.model.angle + this.model.radarAngle) * (Math.PI/180);\n    this.energyBar.scale.x = this.model.energy / this.model.maxEnergy;\n    this.label.text = this.model.fullName;\n\n    this.hudView.x = this.view.x;\n    this.hudView.y = this.view.y;\n\n    for(let i=0; i < events.length; i++) {\n      this._onEvent(events[i]);\n    }\n  }\n\n  _onEvent(event) {\n    switch (event.type) {\n      case 'shoot':\n        this._onShoot(event);\n        break;\n      case 'destroy':\n        this._onDestroy(event);\n        break;\n    }\n  }\n\n  _onShoot(event) {\n\n  }\n\n\n  _onDestroy(event) {\n    this.destroy();\n  }\n\n  _create(container) {\n    super._create(container);\n    this._body = this._createBody();\n    this._gun = this._createGun();\n    this._radar = this._createRadar();\n    container.addChild(this._body);\n    container.addChild(this._gun);\n    container.addChild(this._radar);\n  }\n\n  _createHud(container) {\n    this._label = this._createLabel();\n    this._energyBar = this._createEnergyBar();\n    container.addChild(this._createHudBackground());\n    container.addChild(this._energyBar);\n    container.addChild(this._label);\n  }\n\n  _createBody() {\n    return new Sprite();\n  }\n\n  _createGun() {\n    return new Sprite();\n  }\n\n  _createRadar() {\n    return new Sprite();\n  }\n\n  _createHudBackground() {\n    return new Sprite();\n  }\n\n  _createEnergyBar() {\n    return new Sprite();\n  }\n\n  _createLabel() {\n    return new Text();\n  }\n  destroy() {\n    super.destroy();\n    if(this.hudView.parent) {\n      this.hudView.parent.removeChild(this.hudView);\n    }\n  }\n\n}\n","export default class PixiRendererClockModel {\n\n  construct() {\n    this._msElapsed = 0;\n    this._msLimit = 0;\n  }\n\n  update(msElapsed, msLimit) {\n    this._msElapsed = msElapsed;\n    this._msLimit = msLimit;\n  }\n\n  get msElapsed() {\n    return this._msElapsed;\n  }\n\n  get msLimit() {\n    return this._msLimit;\n  }\n\n  get text() {\n    let msTotal = Math.max(0, this._msLimit - this._msElapsed);\n    let s = Math.floor(msTotal/1000);\n    let ms = msTotal % 1000;\n    s = s.toString();\n    while(s.length < 2) s = \"0\" + s;\n    ms = ms.toString();\n    while(ms.length < 3) ms = \"0\" + ms;\n\n    return \"0:\" + s + \".\" + ms;\n  }\n\n}\n","'use strict';\nimport { Application } from 'pixi.js';\nimport { Container } from 'pixi.js';\nimport { Loader } from 'pixi.js';\nimport { autoDetectRenderer } from 'pixi.js';\nimport { settings } from 'pixi.js';\nimport { utils } from 'pixi.js';\nimport AbstractRenderer from \"../abstract/AbstractRenderer.js\";\nimport AbstractPixiView from \"./AbstractPixiView.js\";\nimport AbstractPixiTankView from \"./AbstractPixiTankView.js\";\nimport PixiRendererClockModel from \"./PixiRendererClockModel.js\";\n\nexport default class AbstractPixiRenderer extends AbstractRenderer  {\n\n  constructor(name, debug) {\n    super(debug);\n    this._name = name;\n    this._isDisposed = false;\n    settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT = false;\n\n    this._masterContainer = new Container();\n    this._tankContainer = new Container();\n    this._bulletContainer = new Container();\n    this._hudContainer = new Container();\n    this._masterContainer.addChild(this._tankContainer );\n    this._masterContainer.addChild(this._bulletContainer);\n    this._masterContainer.addChild(this._hudContainer);\n    this._renderer = null;\n    this._stage = null;\n    this._clockModel = new PixiRendererClockModel();\n    this._clockView = null;\n    this._battlefieldView = null;\n    if(window.devicePixelRatio >= 2) {\n      this._rendererScale = 2;\n    } else {\n      this._rendererScale = 1;\n    }\n    this.log('Contructing Renderer');\n  }\n\n  get stage() {\n    return this._stage;\n  }\n\n  get battlefieldView() {\n    return this._battlefieldView;\n  }\n\n  get masterContainer() {\n    return this._masterContainer;\n  }\n\n  initBatlefield(battlefield) {\n    this.log('initializing the battlefield');\n    super.initBatlefield(battlefield);\n    this._masterContainer.x = -this.offsetX;\n    this._masterContainer.y = -this.offsetY;\n    this.log(`battlefield offset: x=${this._masterContainer.x}, y=${this._masterContainer.y}`);\n\n    let rendererSettings = {\n      view: this._canvas,\n      antialias: false,\n      backgroundColor: 0xffffff,\n      resolution: this._rendererScale,\n      width: battlefield.width + 2 * battlefield.margin,\n      height: battlefield.height + 2 * battlefield.margin\n    };\n\n    this.log(`renderer settings: width=${rendererSettings.width}, height=${rendererSettings.width}`);\n\n    this._renderer = new autoDetectRenderer(\n      rendererSettings\n    );\n    this._stage = new Container();\n\n    this._battlefieldView = this._createBattlefieldView(battlefield);\n    this._clockView = this._createClockView(this._clockModel);\n\n    this._stage.addChild(this._battlefieldView.view);\n    this._stage.addChild(this._masterContainer);\n    this._stage.addChild(this._clockView.view);\n\n    this._renderer.render(this._stage);\n    this.log(`battlefield initialized`);\n  }\n\n  init(canvas) {\n    this._canvas = canvas;\n  }\n\n  loadAssets(done, urlPrefix) {\n    this.log(`loading assets, urlPrefix: '${urlPrefix}'`);\n    urlPrefix = urlPrefix || '';\n    if(!this._name) {\n      this.log('No assets to load for that renderer. Done.');\n      done();\n      return;\n    }\n    let loader = new Loader();\n    let loadedResources = [];\n    for(let res in loader.resources) {\n      this.log(`adding resource to load '${res}'`);\n      loadedResources.push(res);\n    }\n\n    this._getSpritesheetUrls(this._name, this._rendererScale)\n      .filter((url) => {\n        return loadedResources.indexOf(url) == -1;\n      })\n      .forEach((url) => {\n        loader.add(urlPrefix + url);\n      });\n    this.log(`loading assets...`);\n    loader.load((resLoader, resources) => {\n      if(this._isDisposed) {\n        this.log(`Renderer disposed: Clearing texture cache`);\n        utils.clearTextureCache();\n        this.log(`Renderer disposed: Skipping onAssetsLoaded handler`);\n        return;\n      }\n      this.log(`onAssetsLoaded()`);\n      this.onAssetsLoaded();\n      this.log(`Assets loaded`);\n      done();\n    });\n  }\n\n\n  onAssetsLoaded() {\n\n  }\n\n  preRender() {\n    this._battlefieldView.update();\n  }\n\n  renderTank(tank, events) {\n    super.renderTank(tank, events);\n    let view = this.getTankView(tank.id);\n    if(!view.parent && view.isAlive) {\n      this._tankContainer.addChild(view.view);\n      this._hudContainer.addChild(view.hudView);\n    }\n  }\n\n  renderBullet(bullet, events) {\n    super.renderBullet(bullet, events);\n    let view = this.getBulletView(bullet.id);\n    if(!view.parent && view.isAlive) {\n      this._bulletContainer.addChild(view.view);\n    }\n  }\n\n  renderClock(msElapsed, msLimit) {\n    this._clockModel.update(msElapsed, msLimit);\n    this._clockView.update();\n  }\n\n  postRender() {\n    super.postRender();\n    this._renderer.render(this._stage);\n  }\n\n  _getSpritesheetUrls(rendererName, rendererScale) {\n    let resolution = (rendererScale == 2) ? \"retina@2x\" : \"web\";\n    return [\n      `img/spritesheets/${rendererName}/${resolution}/jsbattle.json`\n    ];\n  }\n\n  _createTankView(tank) {\n    return new AbstractPixiTankView(tank);\n  }\n\n  _createBulletView(bullet) {\n    return new AbstractPixiView(bullet);\n  }\n\n  _createBattlefieldView(battlefield) {\n    return new AbstractPixiView(battlefield);\n  }\n\n  _createClockView(clock) {\n    return new AbstractPixiView(clock);\n  }\n\n  dispose() {\n    this.log(`Disposing...`);\n    this._isDisposed = true;\n    if(this._renderer) {\n      this._renderer.context.gl.getExtension('WEBGL_lose_context').loseContext();\n      this._renderer.destroy();\n      this._renderer = null;\n    } else {\n      this.log(`Already disposed`);\n    }\n    this._canvas = null;\n    this._stage = null;\n\n    this.log(`Clearing texture cache`);\n    utils.clearTextureCache();\n  }\n\n}\n","'use strict';\nimport { Graphics } from 'pixi.js';\nimport AbstractPixiView from \"../abstractPixi/AbstractPixiView.js\";\n\nexport default class DebugBattlefieldView extends AbstractPixiView  {\n\n  _create(container) {\n    let background = new Graphics();\n    background.beginFill(0x000000);\n    background.lineStyle(1, 0xffff00, 0.8);\n    background.drawRect(0, 0, this.model.width+2*this.model.margin, this.model.height+2*this.model.margin);\n    background.endFill();\n    container.addChild(background);\n    background = new Graphics();\n    background.beginFill(0x000000);\n    background.lineStyle(1, 0xffff00, 0.8);\n    background.drawRect(this.model.margin, this.model.margin, this.model.width, this.model.height);\n    background.endFill();\n    container.addChild(background);\n  }\n\n  update(events) {\n\n  }\n}\n","'use strict';\nimport {\n  Text,\n  TextStyle\n} from 'pixi.js';\n\nimport AbstractPixiView from \"../abstractPixi/AbstractPixiView.js\";\n\nexport default class DebugClockView extends AbstractPixiView  {\n\n  constructor(model) {\n    super(model);\n  }\n\n  _create(container) {\n    let labelStyle = new TextStyle({\n        fontFamily: 'Arial',\n        fontSize: 12,\n        fill: '#00ff00'\n    });\n\n    this._label = new Text(\"clock\", labelStyle);\n    this._label.x = 5;\n    this._label.y = 5;\n    container.addChild(this._label);\n  }\n\n  update(events) {\n    this._label.text = this.model.text;\n  }\n}\n","'use strict';\n\nimport AbstractPixiView from \"./AbstractPixiView.js\";\n\nexport default class AbstractPixiBulletView extends AbstractPixiView {\n\n  constructor(model) {\n    super(model);\n  }\n\n  update(events) {\n    super.update(events);\n    this.view.scale.x = this.view.scale.y = this.model.power * 0.7 + 0.3;\n    if(this.model.exploded) {\n      this.destroy();\n    }\n  }\n\n}\n","'use strict';\nimport { Graphics } from 'pixi.js';\nimport AbstractPixiBulletView from \"../abstractPixi/AbstractPixiBulletView.js\";\n\nexport default class DebugBulletView extends AbstractPixiBulletView  {\n\n  constructor(model) {\n    super(model);\n  }\n\n  _create(container) {\n    let bullet = new Graphics();\n    bullet.beginFill(0x00ff00, 0.5);\n    bullet.drawCircle(0, 0, 5);\n    bullet.endFill();\n    container.addChild(bullet);\n  }\n\n}\n","'use strict';\nimport {\n  Text,\n  TextStyle\n} from 'pixi.js';\nimport { Graphics } from 'pixi.js';\nimport AbstractPixiTankView from \"../abstractPixi/AbstractPixiTankView.js\";\n\nexport default class DebugTankView extends AbstractPixiTankView  {\n\n  constructor(model) {\n    super(model);\n  }\n\n  _createBody() {\n    let body = new Graphics();\n    body.lineStyle(1, 0xffff00, 0.8);\n    body.beginFill(0x00ff00, 0.5);\n    body.drawRect(-15, -15, 30, 30);\n    body.endFill();\n    return body;\n  }\n\n  _createGun() {\n    let body = new Graphics();\n    body.beginFill(0x00ff00, 0.5);\n    body.lineStyle(1, 0xffff00, 0.8);\n    body.drawCircle(0, 0, 10);\n    body.drawRect(0, -3, 30, 6);\n    body.endFill();\n    return body;\n  }\n\n  _createRadar() {\n    let body = new Graphics();\n    body.beginFill(0x00ff00, 0.5);\n    body.lineStyle(1, 0xffff00, 0.8);\n    body.drawRect(-3, -10, 6, 20);\n    body.endFill();\n    body.lineStyle();\n    body.beginFill(0xaaffaa, 0.1);\n    body.moveTo(0, -3);\n    let radarRange = 300;\n    let radarFocal = 6;\n    let width = radarRange * Math.tan(radarFocal*(Math.PI/180))/2;\n    body.lineTo(radarRange, -width);\n    body.lineTo(radarRange, width);\n    body.lineTo(0, 3);\n    return body;\n  }\n\n  _createLabel() {\n    let labelStyle = new TextStyle({\n        fontFamily: 'Arial',\n        fontSize: 12,\n        fill: 0x00ff00\n    });\n    let label = new Text(\"\", labelStyle);\n    label.anchor.set(0.5, 0.5);\n    label.x = 0;\n    label.y = -40;\n    return label;\n  }\n\n  _createHudBackground() {\n    let statusBarBg =  new Graphics();\n    statusBarBg.beginFill(0x000000, 1);\n    statusBarBg.lineStyle(1, 0xffff00, 0.8);\n    statusBarBg.drawRect(-26, -3, 52, 6);\n    statusBarBg.y = -30;\n    return statusBarBg;\n  }\n\n  _createEnergyBar() {\n    let energyBar =  new Graphics();\n    energyBar.beginFill(0x00ff00, 1);\n    energyBar.drawRect(0, -2, 50, 4);\n    energyBar.x = -25;\n    energyBar.y = -30;\n    return energyBar;\n  }\n\n}\n","'use strict';\nimport {\n  Text,\n  TextStyle\n} from 'pixi.js';\nimport AbstractPixiRenderer from \"../abstractPixi/AbstractPixiRenderer.js\";\nimport DebugBattlefieldView from \"./DebugBattlefieldView.js\";\nimport DebugClockView from \"./DebugClockView.js\";\nimport DebugBulletView from \"./DebugBulletView.js\";\nimport DebugTankView from \"./DebugTankView.js\";\n\nexport default class DebugRenderer extends AbstractPixiRenderer  {\n\n  constructor(debug) {\n    super(undefined, debug);\n    this._frameCounter = 0;\n    this._fpsLabel = null;\n    this._scoreBoard = null;\n  }\n\n  initBatlefield(battlefield) {\n    super.initBatlefield(battlefield);\n\n    let labelStyle = new TextStyle({\n      fontFamily: 'Arial',\n      fontSize: 12,\n      fill: '#00ff00'\n    });\n\n    this._fpsLabel = new Text(\"FPS\", labelStyle);\n    this._fpsLabel.x = 100;\n    this._fpsLabel.y = 5;\n    this.stage.addChild(this._fpsLabel);\n\n    let self = this;\n    setInterval(() => {\n      self._fpsLabel.text = \"FPS: \" + self._frameCounter;\n      self._frameCounter = 0;\n    }, 1000);\n\n    labelStyle = new TextStyle({\n      fontFamily: 'Arial',\n      fontSize: 12,\n      fill: '#00ff00'\n    });\n\n    this._scoreBoard = new Text(\"scores\", labelStyle);\n    this._scoreBoard.x = battlefield.margin+2;\n    this._scoreBoard.y = battlefield.margin+2;\n    this._scoreBoard.alpha = 0.5;\n    this.stage.addChild(this._scoreBoard);\n  }\n\n  renderTankStats(tankList) {\n    super.renderTankStats(tankList);\n    let scores = [];\n    let i;\n    for(i=0; i < tankList.length; i++) {\n      scores.push({\n        name: tankList[i].fullName,\n        energy: tankList[i].energy,\n        value: tankList[i].score,\n      });\n    }\n    scores.sort((a,b) => {\n      if (a.value < b.value) return 1;\n      if (a.value > b.value) return -1;\n      return 0;\n    });\n    let msg = \"\";\n    for(i=0; i < scores.length; i++) {\n      msg += scores[i].value.toFixed(3) + \" - \" + scores[i].name + (scores[i].energy == 0 ? \" [X]\" : \"\" ) + \"\\n\";\n    }\n    this._scoreBoard.text = msg;\n  }\n\n  postRender() {\n    super.postRender();\n    this._frameCounter++;\n  }\n\n  _createBattlefieldView(battlefield) {\n    return new DebugBattlefieldView(battlefield);\n  }\n\n  _createClockView(clock) {\n    return new DebugClockView(clock);\n  }\n\n  _createBulletView(bullet) {\n    return new DebugBulletView(bullet);\n  }\n\n  _createTankView(tank) {\n    return new DebugTankView(tank);\n  }\n\n}\n","'use strict';\nimport { Sprite } from 'pixi.js';\nimport AbstractPixiView from \"../abstractPixi/AbstractPixiView.js\";\n\nexport default class BWBattlefieldView extends AbstractPixiView  {\n\n  _create(container) {\n    let background = Sprite.from('battlefield');\n    container.addChild(background);\n  }\n\n  update(events) {\n\n  }\n}\n","'use strict';\nimport {\n  Text,\n  TextStyle\n} from 'pixi.js';\n\nimport AbstractPixiView from \"../abstractPixi/AbstractPixiView.js\";\n\nexport default class BWClockView extends AbstractPixiView  {\n\n  constructor(model) {\n    super(model);\n  }\n\n  _create(container) {\n    let labelStyle = new TextStyle({\n        fontFamily: 'Arial',\n        fontSize: 15,\n        fill: '#000000'\n    });\n\n    this._label = new Text(\"clock\", labelStyle);\n    this._label.x = 10;\n    this._label.y = 600 - 20;\n    container.addChild(this._label);\n  }\n\n  update(events) {\n    this._label.text = this.model.text;\n  }\n}\n","'use strict';\nimport { Sprite } from 'pixi.js';\n\nimport AbstractPixiBulletView from \"../abstractPixi/AbstractPixiBulletView.js\";\n\nexport default class BWBulletView extends AbstractPixiBulletView  {\n\n  constructor(model) {\n    super(model);\n  }\n\n  _create(container) {\n    let bullet = Sprite.from('bullet');\n    bullet.anchor.set(0.5);\n    container.addChild(bullet);\n  }\n\n}\n","'use strict';\nimport {\n  Text,\n  TextStyle\n} from 'pixi.js';\nimport { Container } from 'pixi.js';\nimport { Sprite } from 'pixi.js';\nimport { Graphics } from 'pixi.js';\n\nimport AbstractPixiTankView from \"../abstractPixi/AbstractPixiTankView.js\";\n\nexport default class BWTankView extends AbstractPixiTankView  {\n\n  constructor(model) {\n    super(model);\n  }\n\n  update(events) {\n    super.update(events);\n    this._shoot.alpha = this.model.isShooting ? 1 : this._shoot.alpha*0.7;\n  }\n\n  _createBody() {\n    let body = Sprite.from('tank_body');\n    body.anchor.set(0.5);\n    return body;\n  }\n\n  _createGun() {\n    let gunContainer = new Container();\n\n    let tankGun = Sprite.from('tank_gun');\n    tankGun.anchor.set(0.3, 0.5);\n    gunContainer.addChild(tankGun);\n\n    this._shoot = Sprite.from('tank_shoot');\n    this._shoot.anchor.set(-1.2, 0.5);\n    this._shoot.alpha = 0;\n    gunContainer.addChild(this._shoot);\n\n    return gunContainer;\n  }\n\n  _createRadar() {\n    let tankRadar = Sprite.from('tank_radar');\n    tankRadar.anchor.set(0.5);\n    return tankRadar;\n  }\n\n  _createLabel() {\n    let labelStyle = new TextStyle({\n        fontFamily: 'Arial',\n        fontSize: 12,\n        fill: 0x000000\n    });\n    let label = new Text(\"\", labelStyle);\n    label.anchor.set(0.5, 0.5);\n    label.x = 0;\n    label.y = -40;\n    return label;\n  }\n\n  _createHudBackground() {\n    let statusBarBg =  new Graphics();\n    statusBarBg.beginFill(0x000000, 1);\n    statusBarBg.drawRect(-26, -3, 52, 6);\n    statusBarBg.y = -30;\n    return statusBarBg;\n  }\n\n  _createEnergyBar() {\n    let energyBar =  new Graphics();\n    energyBar.beginFill(0xff0000, 1);\n    energyBar.drawRect(0, -2, 50, 4);\n    energyBar.x = -25;\n    energyBar.y = -30;\n    return energyBar;\n  }\n\n}\n","'use strict';\nimport { AnimatedSprite } from 'pixi.js';\nimport { Texture } from 'pixi.js';\nimport AbstractPixiRenderer from \"../abstractPixi/AbstractPixiRenderer.js\";\nimport BWBattlefieldView from \"./BWBattlefieldView.js\";\nimport BWClockView from \"./BWClockView.js\";\nimport BWBulletView from \"./BWBulletView.js\";\nimport BWTankView from \"./BWTankView.js\";\n\nexport default class BWRenderer extends AbstractPixiRenderer  {\n\n  constructor(debug) {\n    super('bw', debug);\n    this._bigBoomAnim = [];\n    this._smallBoomAnim = [];\n    this._shakeTimer = 0;\n  }\n\n  onAssetsLoaded() {\n    for(let i=0; i <= 9; i++) {\n      this._bigBoomAnim.push(Texture.from('big_boom_00' + i));\n      this._smallBoomAnim.push(Texture.from('small_boom_00' + i));\n    }\n  }\n\n  initBatlefield(battlefield) {\n    super.initBatlefield(battlefield);\n  }\n\n  renderTank(tank, events) {\n    super.renderTank(tank, events);\n    if(tank.energy == 0) {\n      this._shakeTimer = 10;\n      this._addExplosion(tank.x, tank.y, this._bigBoomAnim);\n    }\n  }\n\n  renderBullet(bullet, events) {\n    super.renderBullet(bullet, events);\n    if(bullet.exploded) {\n      this._addExplosion(bullet.x, bullet.y, this._smallBoomAnim);\n    }\n  }\n\n  postRender() {\n    super.postRender();\n    if(this._shakeTimer > 0) {\n      this._shakeTimer--;\n      this.masterContainer.x = Math.random()*10-5-this.offsetX;\n      this.masterContainer.y = Math.random()*10-5-this.offsetY;\n    } else {\n      this.masterContainer.x = -this.offsetX;\n      this.masterContainer.y = -this.offsetY;\n    }\n  }\n\n  _createBattlefieldView(battlefield) {\n    return new BWBattlefieldView(battlefield);\n  }\n\n  _createClockView(clock) {\n    return new BWClockView(clock);\n  }\n\n  _createBulletView(bullet) {\n    return new BWBulletView(bullet);\n  }\n\n  _createTankView(tank) {\n    return new BWTankView(tank);\n  }\n\n  _addExplosion(x, y, type) {\n    let anim = new AnimatedSprite(type);\n    anim.anchor.set(0.5);\n    this.masterContainer.addChild(anim);\n    anim.x = x;\n    anim.y = y;\n    anim.loop = false;\n    anim.onComplete = function() {\n      this.stop();\n      this.parent.removeChild(this);\n    };\n    anim.play();\n  }\n\n}\n","'use strict';\nimport { Container } from 'pixi.js';\nimport { Sprite } from 'pixi.js';\nimport { BLEND_MODES } from 'pixi.js';\nimport { Graphics } from 'pixi.js';\nimport AbstractPixiView from \"../abstractPixi/AbstractPixiView.js\";\n\nexport default class BrodyBattlefieldView extends AbstractPixiView  {\n\n  constructor(model) {\n    super(model);\n    this._holeList = [];\n    this._settings = null;\n  }\n\n  configure(settings) {\n    this._settings = settings;\n  }\n\n  _create(container) {\n    let background = Sprite.from('battlefield');\n    container.addChild(background);\n\n    let groundMask = new Graphics();\n    groundMask.beginFill(0x0000ff, 1);\n    groundMask.moveTo(25, 25);\n    groundMask.lineTo(900-25, 25);\n    groundMask.lineTo(900-25, 600-25);\n    groundMask.lineTo(90, 600-25);\n    groundMask.lineTo(90, 600-35);\n    groundMask.lineTo(25, 600-35);\n    groundMask.lineTo(25, 25);\n    groundMask.endFill();\n\n    this._craterContainer = new Container();\n    this._craterContainer.mask = groundMask;\n    container.addChild(this._craterContainer);\n    container.addChild(groundMask);\n\n    let wallMask = new Graphics();\n    wallMask.beginFill(0x0000ff, 0.4);\n    wallMask.moveTo(15, 15);\n    wallMask.lineTo(900-15, 15);\n    wallMask.lineTo(900-15, 600-15);\n    wallMask.lineTo(80, 600-15);\n    wallMask.lineTo(80, 600-25);\n    wallMask.lineTo(15, 600-25);\n    wallMask.lineTo(15, 15);\n    wallMask.lineTo(25, 25);\n    wallMask.lineTo(25, 600-25);\n    wallMask.lineTo(80, 600-25);\n    wallMask.lineTo(80, 600-25);\n    wallMask.lineTo(900-25, 600-25);\n    wallMask.lineTo(900-25, 25);\n    wallMask.lineTo(25, 25);\n    wallMask.endFill();\n    this._holesContainer = new Container();\n    this._holesContainer.mask = wallMask;\n    container.addChild(this._holesContainer);\n    container.addChild(wallMask);\n  }\n\n  addCrater(x, y) {\n    let crater = Sprite.from('crater');\n    crater.anchor.set(0.5);\n    crater.x = x - this.model.offsetX;\n    crater.y = y - this.model.offsetY;\n    crater.blendMode = BLEND_MODES.MULTIPLY;\n    crater.alpha = 0.8;\n    this._craterContainer.addChild(crater);\n  }\n\n  update() {\n    super.update();\n    this._holesContainer.visible = (this._settings.skratchLimit > 0);\n    this._craterContainer.visible = this._settings.showCraters;\n  }\n\n  addBulletHole(x, y, power) {\n    let rotation = 0;\n    if(Math.abs(y - this.model.maxY) < 10) {\n      y = this.model.maxY + 3 +  Math.random()*3;\n    } else if(Math.abs(y - this.model.minY) < 10) {\n      y = this.model.minY - 3 -  Math.random()*3;\n    } else if(Math.abs(x - this.model.maxX) < 10) {\n      x = this.model.maxX + 3 +  Math.random()*3;\n      rotation = Math.PI/2;\n    } else if(Math.abs(x - this.model.minX) < 10) {\n      x = this.model.minX - 3 -  Math.random()*3;\n      rotation = Math.PI/2;\n    } else {\n      return;\n    }\n\n    let hole = Sprite.from('hole');\n    hole.anchor.set(0.5);\n    hole.x = x - this.model.offsetX;\n    hole.y = y - this.model.offsetY;\n    hole.rotation = rotation;\n    hole.scale.x = hole.scale.y = 0.7 + 0.5*power;\n    this._holesContainer.addChild(hole);\n    this._holeList.push(hole);\n    let limit = this._settings ? this._settings.skratchLimit : 20;\n    while(this._holeList.length > limit) {\n      hole = this._holeList.shift();\n      hole.parent.removeChild(hole);\n    }\n  }\n\n}\n","'use strict';\nimport {\n  Text,\n  TextStyle\n} from 'pixi.js';\nimport AbstractPixiView from \"../abstractPixi/AbstractPixiView.js\";\n\nexport default class BrodyClockView extends AbstractPixiView  {\n\n  constructor(model) {\n    super(model);\n  }\n\n  _create(container) {\n    let labelStyle = new TextStyle({\n        fontFamily: 'Arial',\n        fontSize: 15,\n        fill: '#000000'\n    });\n\n    this._label = new Text(\"clock\", labelStyle);\n    this._label.x = 10;\n    this._label.y = 600 - 20;\n    container.addChild(this._label);\n  }\n\n  update(events) {\n    this._label.text = this.model.text;\n  }\n}\n","'use strict';\nimport { Sprite } from 'pixi.js';\nimport { BLEND_MODES } from 'pixi.js';\nimport AbstractPixiBulletView from \"../abstractPixi/AbstractPixiBulletView.js\";\n\nexport default class BrodyBulletView extends AbstractPixiBulletView  {\n\n  constructor(model, settings) {\n    super(model);\n  }\n\n  configure(settings) {\n    this._settings = settings;\n  }\n\n  update(events) {\n    super.update(events);\n    this._glow.visible = this._settings && this._settings.showGlow;\n  }\n\n  _create(container) {\n    let bullet = Sprite.from('bullet');\n    bullet.anchor.set(0.5);\n    let glow = Sprite.from('glow');\n    glow.anchor.set(0.5);\n    glow.blendMode = BLEND_MODES.ADD;\n    glow.alpha = 0.1;\n    this._glow = glow;\n    container.addChild(glow);\n    container.addChild(bullet);\n  }\n\n}\n","'use strict';\nimport { Sprite } from 'pixi.js';\nimport {\n  Text,\n  TextStyle\n} from 'pixi.js';\nimport { Container } from 'pixi.js';\nimport { Graphics } from 'pixi.js';\nimport AbstractPixiTankView from \"../abstractPixi/AbstractPixiTankView.js\";\n\nexport default class BrodyTankView extends AbstractPixiTankView  {\n\n  constructor(model) {\n    super(model);\n    this._lightTimer = 0;\n  }\n\n  update(events) {\n    super.update(events);\n    this._shoot.alpha =  this._shoot.alpha*0.8;\n    this._tankGun.x = this._tankGun.x*0.8;\n    this.radar.rotation = (- this.model.gunAngle + this._model.radarAngle) * (Math.PI/180);\n\n    this._lightTimer = this.model.enemySpot ? this._lightTimer+1 : 0;\n\n    this._light.alpha = -Math.cos(this._lightTimer * 0.25) * 0.5 + 0.5;\n  }\n\n  _onShoot(event) {\n    super._onShoot(event);\n    this._tankGun.x = -1-3*event.bullet.power;\n    this._shoot.alpha = 1;\n  }\n\n  _create(container) {\n    super._create(container);\n    this._tankGun.addChild(this.radar);\n  }\n\n  _createBody() {\n    let body = Sprite.from('tank_body_' + this.model.skin);\n    body.anchor.set(0.3, 0.5);\n    return body;\n  }\n\n  _createGun() {\n    let gunContainer = new Container();\n\n    let tankGun = Sprite.from('tank_gun_' + this.model.skin);\n    tankGun.anchor.set(0.3, 0.5);\n    gunContainer.addChild(tankGun);\n    this._tankGun = tankGun;\n\n    this._shoot = Sprite.from('tank_shoot');\n    this._shoot.anchor.set(0.3, 0.5);\n    this._shoot.alpha = 0;\n\n    this._light = Sprite.from('tank_light');\n    this._light.anchor.set(0.3, 0.5);\n    this._light.alpha = 0;\n\n    gunContainer.addChild(this._shoot);\n    gunContainer.addChild(this._light);\n\n    return gunContainer;\n  }\n\n  _createRadar() {\n    let tankRadar = Sprite.from('tank_radar_' + this.model.skin);\n    tankRadar.anchor.set(0.2, 0.5);\n    tankRadar.x=-5;\n    return tankRadar;\n  }\n\n  _createLabel() {\n    let labelStyle = new TextStyle({\n        fontFamily: 'Arial',\n        fontSize: 10,\n        stroke: 0x000000,\n        strokeThickness: 2,\n        fill: 0xffffbb\n    });\n    let label = new Text(\"\", labelStyle);\n    label.anchor.set(0.5, 0.5);\n    label.x = 0;\n    label.y = -40;\n    return label;\n  }\n\n  _createHudBackground() {\n    let statusBarBg =  new Graphics();\n    statusBarBg.beginFill(0x000000, 1);\n    statusBarBg.drawRect(-26, -3, 52, 6);\n    statusBarBg.y = -30;\n    return statusBarBg;\n  }\n\n  _createEnergyBar() {\n    let energyBar =  new Graphics();\n    energyBar.beginFill(0xffff99, 1);\n    energyBar.drawRect(0, -2, 50, 4);\n    energyBar.x = -25;\n    energyBar.y = -30;\n    return energyBar;\n  }\n\n}\n","'use strict';\n\nexport default class BrodySettings   {\n\n  constructor(model) {\n    this._particleLimit = 1000;\n    this._skratchLimit = 100;\n    this._showDirt = true;\n    this._showGlow = true;\n    this._showCraters = true;\n    this._dropFrames = 1;\n    this._quality = 1;\n    this.quality = this._quality;\n  }\n  get dropFrames() {\n    return this._dropFrames;\n  }\n  get particleLimit() {\n    return this._particleLimit;\n  }\n  get skratchLimit() {\n    return this._skratchLimit;\n  }\n  get showDirt() {\n    return this._showDirt;\n  }\n  get showGlow() {\n    return this._showGlow;\n  }\n  get showCraters() {\n    return this._showCraters;\n  }\n  get quality() {\n    return this._quality;\n  }\n  set quality(v) {\n    v = Math.min(1, Math.max(0, v));\n    this._quality = v;\n    this._particleLimit = Math.round(1000*v*v);\n    this._skratchLimit = Math.round(100*v);\n    this._showDirt = (v > 0.2);\n    this._showGlow = (v > 0.5);\n    this._showCraters = (v > 0.1);\n    if(v > 0.3) {\n      this._dropFrames = 1;\n    } else if(v > 0.2) {\n      this._dropFrames = 2;\n    } else if(v > 0.1) {\n      this._dropFrames = 3;\n    } else {\n      this._dropFrames = 4;\n    }\n    this._quality = v;\n  }\n\n}\n","'use strict';\nimport { Sprite } from 'pixi.js';\nimport { BLEND_MODES } from 'pixi.js';\nimport { AnimatedSprite } from 'pixi.js';\nimport { ParticleContainer } from 'pixi.js';\nimport { Texture } from 'pixi.js';\nimport AbstractPixiRenderer from \"../abstractPixi/AbstractPixiRenderer.js\";\nimport BrodyBattlefieldView from \"./BrodyBattlefieldView.js\";\nimport BrodyClockView from \"./BrodyClockView.js\";\nimport BrodyBulletView from \"./BrodyBulletView.js\";\nimport BrodyTankView from \"./BrodyTankView.js\";\nimport BrodySettings from \"./BrodySettings.js\";\n\nexport default class BrodyRenderer extends AbstractPixiRenderer  {\n\n  constructor(debug) {\n    super('brody', debug);\n    this._bigBoomAnim = [];\n    this._shakeTimer = 0;\n    this._particleContainer = null;\n    this._particleList = [];\n    this._explosionList = [];\n    this._settings = new BrodySettings();\n    this._masterContainer.addChild(this._bulletContainer);\n    this._frameTimer = 0;\n    this._frameCounter = 0;\n    this._fpsInterval = null;\n    this._fps = 30;\n  }\n\n  onAssetsLoaded() {\n    let i;\n    for(i=0; i <= 22; i++) {\n      this._bigBoomAnim.push(Texture.from('big_boom_0' + (i < 10 ? \"0\" + i : i)));\n    }\n  }\n\n  get quality() {\n    return this._settings.quality;\n  }\n\n  set quality(v) {\n    this._settings.quality = v;\n  }\n\n  initBatlefield(battlefield) {\n    super.initBatlefield(battlefield);\n    this.battlefieldView.configure(this._settings);\n    this._particleContainer = new ParticleContainer(1000, {\n      position: true,\n      rotation: true,\n      alpha: true\n    });\n    this._masterContainer.addChild(this._particleContainer);\n    this._masterContainer.addChild(this._hudContainer);\n\n    let self = this;\n    this._fpsInterval = setInterval(() => {\n      self._fps = self._frameCounter;\n      self._frameCounter = 0;\n    }, 1000);\n  }\n\n  renderTank(tank, events) {\n    super.renderTank(tank, events);\n\n    let i;\n    for(i in events) {\n      if(events[i].type == 'destroy') {\n        this._shakeTimer = 10;\n        this._addTankExplosion(tank);\n        break;\n      }\n    }\n\n    let directionCorrection = tank.throttle > 0 ? 180 : 0;\n    let dirtAngle = (tank.angle+directionCorrection)*(Math.PI/180);\n    if(tank.speed > 1) {\n      let corner1X = tank.x + 20*Math.cos(dirtAngle-Math.PI/4) + 7*Math.cos(dirtAngle);\n      let corner1Y = tank.y + 20*Math.sin(dirtAngle-Math.PI/4) + 7*Math.sin(dirtAngle);\n      let corner2X = tank.x + 20*Math.cos(dirtAngle+Math.PI/4) + 7*Math.cos(dirtAngle);\n      let corner2Y = tank.y + 20*Math.sin(dirtAngle+Math.PI/4) + 7*Math.sin(dirtAngle);\n\n      if(Math.random() < this.speedMultiplier) {\n        this._addDirt(\n          corner1X,\n          corner1Y\n        );\n        this._addDirt(\n          corner2X,\n          corner2Y\n        );\n      }\n    }\n  }\n\n  renderBullet(bullet, events) {\n    super.renderBullet(bullet, events);\n    let view = this.getBulletView(bullet.id);\n    view.configure(this._settings);\n    if(bullet.exploded) {\n      this._addBulletExplosion(bullet);\n      this.battlefieldView.addBulletHole(bullet.x, bullet.y, bullet.power);\n    }\n  }\n\n  preRender() {\n    super.preRender();\n    let particle;\n    let particleCount = 0;\n    let i;\n    for(i = this._particleList.length-1; i >= 0; i--) {\n      particle = this._particleList[i];\n      if(!particle) {\n        continue;\n      }\n\n      particle.x += this.speedMultiplier * particle.speed * particle.rotation * Math.cos(particle.rotation);\n      particle.y += this.speedMultiplier * particle.speed * particle.rotation * Math.sin(particle.rotation);\n      particle.alpha = Math.max(0, particle.alpha - this.speedMultiplier * particle.alphaSpeed);\n\n      particle.lifetime -= this.speedMultiplier;\n      if(particle.lifetime <= 0 || particleCount > this._settings.particleLimit) {\n        particle.parent.removeChild(particle);\n        this._particleList[i] = null;\n      } else {\n        particleCount++;\n      }\n    }\n    for(i=0; i < this._explosionList.length; i++) {\n      if(!this._explosionList[i]) continue;\n      this._explosionList[i].alpha = (this._explosionList[i].alpha - 0.12 * this.speedMultiplier);\n      if(this._explosionList[i].alpha < 0.01) {\n        this._explosionList[i].parent.removeChild(this._explosionList[i]);\n        this._explosionList[i] = null;\n      }\n    }\n\n  }\n\n  postRender() {\n    this._frameTimer++;\n    this._frameCounter++;\n    if(this._frameTimer % this._settings.dropFrames == 0){\n      super.postRender();\n    }\n    if(this._shakeTimer > 0) {\n      this._shakeTimer--;\n      this.masterContainer.x = Math.random()*10-5-this.offsetX;\n      this.masterContainer.y = Math.random()*10-5-this.offsetY;\n      this._battlefieldView.view.x = Math.random()*10-5;\n      this._battlefieldView.view.y = Math.random()*10-5;\n    } else {\n      this.masterContainer.x = -this.offsetX;\n      this.masterContainer.y = -this.offsetY;\n      this._battlefieldView.view.x = 0;\n      this._battlefieldView.view.y = 0;\n    }\n  }\n\n  stop() {\n    if(this._fpsInterval) {\n      clearInterval(this._fpsInterval);\n    }\n  }\n\n  _getSpritesheetUrls(rendererName, rendererScale) {\n    if(rendererScale >= 2) {\n      return [\n        `img/spritesheets/${rendererName}/retina@2x/jsbattle_0.json`,\n        `img/spritesheets/${rendererName}/retina@2x/jsbattle_1.json`\n      ];\n    } else {\n      return [\n        `img/spritesheets/${rendererName}/web/jsbattle.json`\n      ];\n    }\n\n  }\n\n  _addTankExplosion(tank) {\n    this._addExplosion(tank.x, tank.y, this._bigBoomAnim);\n    this.battlefieldView.addCrater(tank.x, tank.y);\n    this._addSparks(\n      tank.x,\n      tank.y,\n      300\n    );\n  }\n\n  _addBulletExplosion(bullet) {\n    this._addGlow(bullet.x, bullet.y, 0.3 + 0.6*bullet.power);\n    let sparks = 5 + 40 * bullet.power;\n    this._addSparks(\n      bullet.x,\n      bullet.y,\n      sparks\n    );\n  }\n\n  _createBattlefieldView(battlefield) {\n    return new BrodyBattlefieldView(battlefield);\n  }\n\n  _createClockView(clock) {\n    return new BrodyClockView(clock);\n  }\n\n  _createBulletView(bullet) {\n    return new BrodyBulletView(bullet);\n  }\n\n  _createTankView(tank) {\n    return new BrodyTankView(tank);\n  }\n\n  _addExplosion(x, y, type) {\n    this._addGlow(x, y, 5);\n\n    let anim = new AnimatedSprite(type);\n    anim.animationSpeed = this.speedMultiplier;\n    anim.anchor.set(0.5);\n    this.masterContainer.addChild(anim);\n    anim.x = x;\n    anim.y = y;\n    anim.loop = false;\n    anim.blendMode = BLEND_MODES.ADD;\n    anim.onComplete = function() {\n      this.stop();\n      this.parent.removeChild(this);\n    };\n    anim.play();\n  }\n\n  _addGlow(x, y, scale) {\n    if(!this._settings.showGlow) return;\n    let glow = Sprite.from('glow');\n    glow.anchor.set(0.5);\n    glow.scale.x = glow.scale.y = scale;\n    glow.alpha = 0.4;\n    glow.blendMode = BLEND_MODES.ADD;\n    glow.x = x;\n    glow.y = y;\n    this.masterContainer.addChild(glow);\n    this._explosionList.push(glow);\n  }\n\n  _addSparks(x, y, amount) {\n    amount = Math.ceil(amount*this._settings.quality);\n    for(let i=0; i < amount; i++) {\n      let particle = Sprite.from('spark');\n      particle.x = x;\n      particle.y = y;\n      particle.alphaSpeed = 0;\n      particle.anchor.set(0.5);\n      particle.speed = 1+Math.random()*2;\n      particle.rotation = Math.random()*2*Math.PI;\n      particle.lifetime = 5+Math.random()*5;\n      this._particleContainer.addChild(particle);\n      this._particleList.push(particle);\n    }\n  }\n\n  _addDirt(x, y) {\n    if(!this._settings.showDirt) return;\n    for(let i=0; i < 5; i++) {\n      let index = Math.floor(Math.random()*3);\n      let particle = Sprite.from('dirt_' + index);\n      particle.x = x+Math.random()*4-2;\n      particle.y = y+Math.random()*4-2;\n      particle.anchor.set(0.5);\n      particle.speed = 0;\n      particle.alphaSpeed = 0.02 + Math.random()*0.02;\n      particle.rotation = 0;\n      particle.alpha = 0.1+0.4*Math.random();\n      particle.lifetime = 25;\n      particle.scale.x = particle.scale.y = 0.5 + 2*Math.random();\n      this._particleContainer.addChild(particle);\n      this._particleList.push(particle);\n    }\n  }\n\n}\n","'use strict';\n\nimport Renderer from \"../Renderer.js\";\n\nexport default class VoidRenderer extends Renderer  {\n\n  renderTank(tank, events) {\n\n  }\n\n  renderBullet(bullet, events) {\n\n  }\n\n  loadAssets(done) {\n    done();\n  }\n\n  init() {\n    \n  }\n\n}\n","import Simulation from \"./Simulation.js\";\nimport Renderer from \"./renderers/Renderer.js\";\nimport DebugRenderer from \"./renderers/debug/DebugRenderer.js\";\nimport BWRenderer from \"./renderers/bw/BWRenderer.js\";\nimport BrodyRenderer from \"./renderers/brody/BrodyRenderer.js\";\nimport VoidRenderer from \"./renderers/void/VoidRenderer.js\";\nimport AiDefinition from \"./AiDefinition.js\";\nimport UltimateBattleDescriptor from \"./UltimateBattleDescriptor.js\";\n\nconst JsBattleLib = {\n  createSimulation: (renderer, debug) => {\n    renderer = renderer ? renderer : new Renderer(debug);\n    let sim = new Simulation(renderer, debug);\n    return sim;\n  },\n\n  createAiDefinition: () => {\n    return new AiDefinition();\n  },\n\n  createUBD: () => {\n    return new UltimateBattleDescriptor();\n  },\n\n  createRenderer: (name, debug) => {\n    switch(name) {\n      case 'debug':   return new DebugRenderer(debug);\n      case 'bw':      return new BWRenderer(debug);\n      case 'brody':   return new BrodyRenderer(debug);\n      case 'void':    return new VoidRenderer(debug);\n      default:        throw \"Unknown rederer \" + name;\n    }\n  }\n};\n\nexport default JsBattleLib;\n","'use strict';\n\nimport JsBattleLib from \"./lib.js\";\n\n(function(self) {\n  if(!self) {\n    console.warn(\"self is not defined\");\n    return;\n  }\n  self.JsBattle = JsBattleLib;\n})(window);\n"],"sourceRoot":""}